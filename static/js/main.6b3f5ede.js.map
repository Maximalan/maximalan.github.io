{"version":3,"file":"static/js/main.6b3f5ede.js","mappings":"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","sources":["consts/tagCollections.ts","consts/tags.ts","models.ts","../node_modules/events/events.js","../node_modules/react-dom/cjs/react-dom.production.min.js","../node_modules/react-dom/client.js","../node_modules/react-dom/index.js","../node_modules/react/cjs/react-jsx-runtime.production.min.js","../node_modules/react/cjs/react.production.min.js","../node_modules/react/index.js","../node_modules/react/jsx-runtime.js","../node_modules/scheduler/cjs/scheduler.production.min.js","../node_modules/scheduler/index.js","../webpack/bootstrap","../webpack/runtime/compat get default export","../webpack/runtime/define property getters","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/make namespace object","../webpack/runtime/publicPath","components/UI/cimage.tsx","consts/general.ts","components/schedule.tsx","components/UI/moreInfoButton.tsx","components/managerContexts.tsx","consts/states.ts","consts/characterConsts.ts","components/UI/attributeDisplay.tsx","components/characterCard.tsx","components/UI/fillBar.tsx","components/playerCard.tsx","components/UI/cbox.tsx","components/UI/FlavorTagPill.tsx","components/UI/TagPill.tsx","components/UI/notebookEncounter.tsx","components/UI/TooltipWrapper.tsx","components/UI/RangedFillBar.tsx","components/UI/notebookCharacter.tsx","components/UI/notebookLocation.tsx","components/UI/notebookPlayer.tsx","components/UI/notebookGroup.tsx","components/UI/groupSchedule.tsx","components/UI/notebookTutorial.tsx","components/UI/notebook.tsx","components/UI/navBar.tsx","components/playerRecruitment.tsx","components/characterCreation.tsx","components/encounter-display.tsx","components/campaign-display-body.tsx","components/campaign-display-header.tsx","components/campaignDisplay.tsx","components/campaignSetup.tsx","consts/themes.ts","consts/campaigns/generticEncounterEvents.ts","consts/campaigns/cultOfTheDeep.ts","consts/campaigns/millstoneMystery.ts","consts/campaigns/mountainMystery.ts","consts/campaigns.ts","components/UI/DiceScore.tsx","components/UI/CampaignHeader.tsx","components/UI/encounterOverview.tsx","components/GameRoom/encounterEventDisplay.tsx","components/GameRoom/gameEncounterOverview.tsx","components/GameRoom/rangeCard.tsx","components/UI/numderDie.tsx","components/GameRoom/combatModifiers.tsx","components/GameRoom/addCombatants.tsx","components/GameRoom/combatBar.tsx","consts/enemies.ts","managers/combatManager.ts","components/UI/themedButton.tsx","components/withRandomTheme.tsx","components/GameRoom/gameEncounterCombat.tsx","components/GameRoom/gameEncounterExploration.tsx","components/GameRoom/encounterHeader.tsx","components/UI/tooltip.tsx","components/GameRoom/gameEncounterPerception.tsx","components/UI/InstructionsPanel.tsx","components/GameRoom/gameEncounterRoleplay.tsx","components/GameRoom/characterToken.tsx","components/GameRoom/buildingCard.tsx","components/GameRoom/characterSelector.tsx","consts/buildings.ts","components/GameRoom/gameEncounterTown.tsx","components/GameRoom/gameEncounterTrap.tsx","components/UI/CContainer.tsx","components/GameRoom/enhancedSkillChallenge.tsx","components/GameRoom/gameEncounterSkillChallenge.tsx","components/GameRoom/gameEncounterPuzzle.tsx","components/GameRoom/gameEncounterStory.tsx","components/UI/effectDisplay.tsx","components/GameRoom/resultsDisplay.tsx","components/UI/travelOption.tsx","components/GameRoom/gameEncounterTravel.tsx","components/UI/treeShapeProps.tsx","consts/sceneryConsts.ts","components/UI/encounterScenery.tsx","components/GameRoom/gameEncounterDungeonCrawl.tsx","components/GameRoom/gameEncounter.tsx","consts/rewards.ts","components/GameRoom/rewardModal.tsx","components/GameRoom/gameTable.tsx","components/UI/needleGauge.tsx","components/GameRoom/stressInfo.tsx","components/GameRoom/bottomBar.tsx","components/UI/chatmessagedisplay.tsx","components/UI/chatEventTile.tsx","components/UI/chat.tsx","components/GameRoom/toneTracker.tsx","components/UI/TagCollectionsScreen.tsx","components/UI/ComingSoon.tsx","consts/score.ts","components/UI/DMAbilitiesScreen.tsx","components/UI/DMCollectionsModal.tsx","components/UI/LLMConfigModal.tsx","services/chatRuleEngine.ts","components/ChatRuleTestPanel.tsx","components/UI/GameToast.tsx","components/GameRoom/rightSidebar.tsx","components/GameRoom/PlayerDisplay.tsx","components/UI/treasureDisplay.tsx","components/UI/LevelUpButton.tsx","components/UI/CharacterLevelRow.tsx","components/UI/PlayerCharacterLevelRow.tsx","components/UI/PartyLevelUpModal.tsx","components/GameRoom/gameRoom.tsx","components/sessionControl.tsx","components/sessionRun.tsx","components/finalStats.tsx","components/mainMenu.tsx","components/modecontainer.tsx","components/UI/SetSceneModal.tsx","components/UI/ConversationSection.tsx","utils/scoreUtils.ts","components/UI/RewardFillBar.tsx","components/UI/EncounterTagModal.tsx","components/UI/NextEncounterModal.tsx","components/UI/WelcomeModal.tsx","components/UI/TagModal.tsx","components/UI/modal.tsx","hooks/useModal.ts","components/UI/RewardDisplay.tsx","components/UI/SelectQuestModal.tsx","components/UI/QuestTerminalModal.tsx","components/UI/QuestProgressModal.tsx","components/UI/ActiveQuestsModal.tsx","components/UI/globalUi.tsx","App.tsx","consts/travel.ts","managers/campaignManager.ts","consts/names.ts","utils/utils.ts","consts/playerTraits.ts","consts/quickStart.ts","managers/playerManager.ts","managers/sessionManager.ts","managers/partyManager.ts","managers/uiManager.ts","managers/dataManager.ts","managers/characterManager.ts","consts/tutorials.ts","managers/tutorialManager.ts","services/llmService.ts","managers/gameContextManager.ts","managers/chatManager.ts","managers/chatEventManager.ts","managers/townManager.ts","managers/tagManager.ts","consts/quests.ts","managers/questManager.ts","managers/appManager.ts","index.tsx"],"sourcesContent":["import { TAG } from \"./tags\";\r\nimport { TagCollection } from \"../models\";\r\n\r\n// Placeholder tag collections for testing\r\nexport const TAG_COLLECTIONS: TagCollection[] = [\r\n  {\r\n    name: \"Combat Enthusiasts\",\r\n    tags: [TAG.ARMOR, TAG.WEAPONS, TAG.ARCHERY, TAG.FIGHTING],\r\n    type: \"basic\",\r\n    unlocks: [TAG.BATTLES],\r\n    theme: \"collection-basic\",\r\n    chat: \"We seem to discuss fighting a lot.\",\r\n    reward: \"dmPoint\"\r\n  },\r\n  {\r\n    name: \"Treasure Seekers\",\r\n    tags: [TAG.GOLD, TAG.TREASURE, TAG.GEMS],\r\n    type: \"basic\",\r\n    unlocks: [],\r\n    theme: \"collection-basic\",\r\n    chat: \"All that glitters is glittery...\",\r\n    reward: \"dmPoint\"\r\n  },\r\n  {\r\n    name: \"Chit Chat\",\r\n    tags: [TAG.GOSSIP, TAG.SOCIALIZING],\r\n    type: \"basic\",\r\n    unlocks: [],\r\n    theme: \"collection-basic\",\r\n    chat: \"You guys sure like to talk!\",\r\n    reward: \"dmPoint\"\r\n  },\r\n  {\r\n    name: \"Arcania\",\r\n    tags: [TAG.MAGIC, TAG.SPELLS, TAG.BOOKS],\r\n    type: \"basic\",\r\n    unlocks: [],\r\n    theme: \"collection-basic\",\r\n    chat: \"This is my magic dog...it's an abracadabradoodle\",\r\n    reward: \"dmPoint\"\r\n  },\r\n  {\r\n    name: \"Fellowship\",\r\n    tags: [TAG.HUMANS, TAG.ELVES, TAG.DWARVES, TAG.HALFLINGS],\r\n    type: \"advanced\",\r\n    unlocks: [],\r\n    theme: \"collection-advanced\",\r\n    chat: \"A Human and an Elf walk into a bar. The Dwarf and the Halfling walk under it.\",\r\n    reward: \"dmPoint\"\r\n  },\r\n  {\r\n    name: \"Beast Friends\",\r\n    tags: [TAG.DEER, TAG.COWS, TAG.BEARS, TAG.WOLVES],\r\n    type: \"advanced\",\r\n    unlocks: [],\r\n    theme: \"collection-advanced\",\r\n    chat: \"Sometimes I feel like we talk about animals more than people.\",\r\n    reward: \"dmPoint\"\r\n  },\r\n  {\r\n    name: \"Merchant Guild\",\r\n    tags: [TAG.TRADING, TAG.TOWN, TAG.GOLD],\r\n    type: \"advanced\",\r\n    unlocks: [],\r\n    theme: \"collection-advanced\",\r\n    chat: \"This game is a really bad lesson in economics.\",\r\n    reward: \"dmPoint\"\r\n  },\r\n \r\n  {\r\n    name: \"Typical Fantasy Monsters\",\r\n    tags: [TAG.GOBLINS, TAG.DRAGONS, TAG.UNDEAD],\r\n    type: \"advanced\",\r\n    unlocks: [TAG.FIGHTING],\r\n    theme: \"collection-advanced\",\r\n    chat: \"Sometimes the cliche monsters are the best ones.\",\r\n    reward: \"dmPoint\"\r\n  },\r\n  {\r\n    name: \"Epic Fantasy\",\r\n    tags: [TAG.BORING_THINGS, TAG.FARMING, TAG.FURNITURE],\r\n    type: \"advanced\",\r\n    unlocks: [],\r\n    theme: \"collection-advanced\",\r\n    chat: \"Wait...Why are we talking about this? This was supposed to be a fantasy game.\",\r\n    reward: \"dmPoint\"\r\n  },\r\n \r\n {\r\n    name: \"Groundskeeper\",\r\n    tags: [TAG.TREES, TAG.FOLIAGE, TAG.GRASS],\r\n    type: \"advanced\",\r\n    unlocks: [],\r\n    theme: \"collection-advanced\",\r\n    chat: \"Well-tended plants have their place in my game.\",\r\n    reward: \"dmPoint\"\r\n  },\r\n   {\r\n    name: \"Innkeeper\",\r\n    tags: [TAG.BEER, TAG.WINE, TAG.FIRE, TAG.FOOD],\r\n    type: \"advanced\",\r\n    unlocks: [],\r\n    theme: \"collection-advanced\",\r\n    chat: \"A nice fire, a warm meal, and a good drink. Sounds nice in or out of the game.\",\r\n    reward: \"dmPoint\"\r\n  },\r\n  {\r\n    name: \"Holy Roleplay\",\r\n    tags: [TAG.CULTISTS, TAG.RELIGION, TAG.PRIESTS, TAG.CHURCHES, TAG.RITUALS],\r\n    type: \"advanced\",\r\n    unlocks: [],\r\n    theme: \"collection-advanced\",\r\n    chat: \"We have covered a lot of religious topics in this session!\",\r\n    reward: \"dmPoint\"\r\n  },\r\n  {\r\n    name: \"Catecombs\",\r\n    tags: [TAG.DUNGEON, TAG.RUINS, TAG.CAVES, TAG.UNDERGROUND],\r\n    type: \"advanced\",\r\n    unlocks: [],\r\n    theme: \"collection-advanced\",\r\n    chat: \"Deep in the dark places underground, we can find some pretty hard to see things.\",\r\n    reward: \"dmPoint\"\r\n  },\r\n    {\r\n    name: \"Animal Companions\",\r\n    tags: [TAG.DOGS, TAG.CATS, TAG.HORSES, TAG.FALCONS],\r\n    type: \"advanced\",\r\n    unlocks: [],\r\n    theme: \"collection-advanced\",\r\n    chat: \"I hope you guys stopped by the petfood vendor before setting off on your journey.\",\r\n    reward: \"dmPoint\"\r\n  },\r\n];\r\n","import { ScriptElementKindModifier } from \"typescript\"\r\nimport { PREFERENCE, Tag } from \"../models\"\r\n\r\nexport const TAG: Record<string, Tag> = {\r\n    // RACE\r\n    HUMANS: { name: \"humans\", preference: PREFERENCE.MAIN, friendly: true, category: \"RACE\"},\r\n    ELVES: { name: \"elves\", preference: PREFERENCE.MAIN, friendly: true, category: \"RACE\"},\r\n    DWARVES: { name: \"dwarves\", preference: PREFERENCE.MAIN, friendly: true, category: \"RACE\"},\r\n    ORCS: { name: \"orcs\", preference: PREFERENCE.MAIN, friendly: true, category: \"RACE\"},\r\n    HALFLINGS: { name: \"halflings\", preference: PREFERENCE.MAIN, friendly: true, category: \"RACE\"},\r\n//    HALF_ORCS: { name: \"half-orcs\", preference: PREFERENCE.MAIN, friendly: true, category: \"RACE\"},\r\n    HALF_ELVES: { name: \"half-elves\", preference: PREFERENCE.MAIN, friendly: true, category: \"RACE\"},\r\n\r\n    // PEOPLE\r\n    HUNTERS: { name: \"hunters\", friendly: true, category: \"PEOPLE\"},\r\n    PRIESTS: { name: \"priests\", friendly: true, category: \"PEOPLE\"},\r\n    MERCHANTS: { name: \"merchants\", friendly: true, category: \"PEOPLE\"},\r\n\r\n\r\n    // MONSTERS\r\n    GOBLINS: { name: \"goblins\", enemy: true, category: \"MONSTERS\"},\r\n    GNOMES: { name: \"gnomes\", enemy: true, category: \"MONSTERS\"},\r\n    DRAGONS: { name: \"dragons\", enemy: true, category: \"MONSTERS\"},\r\n    UNDEAD: { name: \"undead\", preference: PREFERENCE.MAIN, enemy: true, category: \"MONSTERS\"},\r\n    BEASTS: { name: \"beasts\", enemy: true, category: \"MONSTERS\"},\r\n    CULTISTS: { name: \"cultists\", enemy: true, category: \"MONSTERS\"},\r\n    BANDITS: { name: \"bandits\", enemy: true, category: \"MONSTERS\"},\r\n    MONSTERS: { name: \"monsters\", enemy: true, category: \"MONSTERS\"},\r\n\r\n    // GAME\r\n   // EXPOSITION: { name: \"exposition\", category: \"GAME\"},\r\n    FIGHTING: { name: \"fighting\", preference: PREFERENCE.MAIN, category: \"GAME\"},\r\n    PUZZLES: { name: \"puzzles\", preference: PREFERENCE.MAIN, category: \"GAME\"},\r\n    SOCIALIZING: { name: \"socializing\", category: \"GAME\"},\r\n    STRATEGY: { name: \"strategy\", category: \"GAME\"},\r\n    TOWN: { name: \"town\", preference: PREFERENCE.START, category: \"GAME\"},\r\n    EXPLORATION: { name: \"exploration\", category: \"GAME\"},\r\n    TREASURE_HUNTING: { name: \"treasure hunting\", category: \"GAME\"},\r\n    POLITICS: { name: \"politics\", category: \"GAME\"},\r\n    //SCARY: { name: \"scary\", category: \"GAME\"},\r\n    MAGIC: { name: \"magic\", preference: PREFERENCE.START, category: \"GAME\"},\r\n    TOOLS: { name: \"tools\", category: \"GAME\"},\r\n   // TECHNOLOGY: { name: \"technology\", category: \"GAME\"},\r\n    RELIGION: { name: \"religion\", category: \"GAME\"},\r\n   // ECONOMICS: { name: \"economics\", category: \"GAME\"},\r\n    CRAFTING: { name: \"crafting\", category: \"GAME\"},\r\n    TRADING: { name: \"trading\", category: \"GAME\"},\r\n    FARMING: { name: \"farming\", category: \"GAME\"},\r\n    //TRAVEL: { name: \"travel\", preference: PREFERENCE.START, category: \"GAME\"},\r\n    BORING_THINGS: { name: \"boring things\", category: \"GAME\"},\r\n    GOSSIP: { name: \"gossip\", category: \"GAME\"},\r\n    HEALING: { name: \"healing\", category: \"GAME\"},\r\n    CURSE: { name: \"curse\", category: \"GAME\"},\r\n    ARCHERY: { name: \"archery\", category: \"GAME\"},\r\n    EVIL: { name: \"evil\", category: \"GAME\"},\r\n   // MACHINES: { name: \"machines\", category: \"GAME\"},\r\n    TRAPS: { name: \"traps\", category: \"GAME\"},\r\n    MYSTERY: { name: \"mystery\", category: \"GAME\"},\r\n\r\n    // TREASURE\r\n    TREASURE: { name: \"treasure\", category: \"TREASURE\"},\r\n    WEAPONS: { name: \"weapons\", category: \"TREASURE\"},\r\n    ARMOR: { name: \"armor\", category: \"TREASURE\"},\r\n    //KNOWLEDGE: { name: \"knowledge\", category: \"TREASURE\"},\r\n    SPELLS: { name: \"spells\", category: \"TREASURE\"},\r\n    //GLORY: { name: \"glory\", category: \"TREASURE\"},\r\n    GOLD: { name: \"gold\", category: \"TREASURE\"},\r\n    ARTIFACTS: { name: \"artifacts\", category: \"TREASURE\"},\r\n    GEMS: { name: \"gems\", category: \"TREASURE\"},\r\n\r\n    // LOCATION \r\n    DUNGEON: { name: \"dungeons\", category: \"LOCATION\"},\r\n    CITIES: { name: \"cities\", category: \"LOCATION\"},\r\n    WILDERNESS: { name: \"the wilderness\", category: \"LOCATION\"},\r\n    UNDERGROUND: { name: \"underground\", preference: PREFERENCE.START, category: \"LOCATION\"},\r\n    FORESTS: { name: \"forests\", preference: PREFERENCE.START, category: \"LOCATION\"},\r\n    DESERTS: { name: \"deserts\", category: \"LOCATION\"},\r\n    SWAMPS: { name: \"swamps\", category: \"LOCATION\"},\r\n    OCEANS: { name: \"oceans\", category: \"LOCATION\"},\r\n    ISLANDS: { name: \"islands\", category: \"LOCATION\"},\r\n    VILLAGES: { name: \"villages\", category: \"LOCATION\"},\r\n    RUINS: { name: \"ruins\", preference: PREFERENCE.START, category: \"LOCATION\"},\r\n    CASTLES: { name: \"castles\", preference: PREFERENCE.START, category: \"LOCATION\"},\r\n    CAVE: { name: \"caves\", preference: PREFERENCE.START, category: \"LOCATION\"},\r\n    PLAINS: { name: \"plains\", category: \"LOCATION\"},\r\n    TAVERNS: { name: \"taverns\", category: \"LOCATION\"},\r\n    BEACHES: { name: \"beaches\", category: \"LOCATION\"},\r\n    BRIDGES: { name: \"bridges\", category: \"LOCATION\"},\r\n    BUILDINGS: { name: \"buildings\", category: \"LOCATION\"},\r\n    CAMP: { name: \"camp\", category: \"LOCATION\"},\r\n    TOWER: { name: \"tower\", category: \"LOCATION\"},\r\n    CABIN: { name: \"cabin\", category: \"LOCATION\"},\r\n    CHURCHES: { name: \"churches\", category: \"LOCATION\"},\r\n\r\n    // TRAVEL\r\n    SHIPS: { name: \"ships\", travel: true, category: \"TRAVEL\"},\r\n    ROADS: { name: \"roads\", travel: true, category: \"TRAVEL\"},\r\n    HORSES: { name: \"horses\", travel: true, category: \"TRAVEL\"},\r\n\r\n    // PROPS\r\n    \r\n    FURNITURE: { name: \"furniture\", attributeDefault: \"furniture\", category: \"PROPS\"},\r\n    TABLES: { name: \"tables\", attributeDefault: \"furniture\", category: \"PROPS\"},\r\n    BARRELS: { name: \"barrels\", attributeDefault: \"furniture\", category: \"PROPS\"},\r\n    BOOKS: { name: \"books\", attributeDefault: \"furniture\", category: \"PROPS\"},\r\n    CANDLES: { name: \"candles\", attributeDefault: \"furniture\", category: \"PROPS\"},\r\n    FOOD: { name: \"food\", attributeDefault: \"food\", category: \"PROPS\"},\r\n    DRINKS: { name: \"drinks\", attributeDefault: \"food\", category: \"PROPS\"},\r\n    BEER: { name: \"beer\", attributeDefault: \"food\", category: \"PROPS\"},\r\n    WINE: { name: \"wine\", attributeDefault: \"food\", category: \"PROPS\"},\r\n    BELL: { name: \"bell\", attributeDefault: \"furniture\", category: \"PROPS\"},\r\n    COULDRON: { name: \"couldron\", attributeDefault: \"furniture\", category: \"PROPS\"},\r\n    ROPE: { name: \"rope\", attributeDefault: \"furniture\", category: \"PROPS\"},\r\n    STATUES: { name: \"statues\", category: \"PROPS\"},\r\n    RUNES: { name: \"runes\", category: \"PROPS\"},\r\n\r\n    // EVENTS\r\n    FESTIVALS: { name: \"festivals\", category: \"EVENTS\"},\r\n    BATTLES: { name: \"battles\", category: \"EVENTS\"},\r\n    TOURNAMENTS: { name: \"tournaments\", category: \"EVENTS\"},\r\n    QUESTS: { name: \"quests\", preference: PREFERENCE.START, category: \"EVENTS\"},\r\n    MYSTERIES: { name: \"mysteries\", category: \"EVENTS\"},\r\n    DISASTERS: { name: \"disasters\", category: \"EVENTS\"},\r\n    CELEBRATIONS: { name: \"celebrations\", category: \"EVENTS\"},\r\n    RITUALS: { name: \"rituals\", category: \"EVENTS\"},\r\n    NOBILITY: { name: \"nobility\", category: \"EVENTS\"},\r\n\r\n    // ELEMENTS\r\n    FIRE: { name: \"fire\", category: \"ELEMENTS\"},\r\n    DARKNESS: { name: \"darkness\", category: \"ELEMENTS\"},\r\n    WATER: { name: \"water\", category: \"ELEMENTS\"},\r\n    FOLIAGE: { name: \"foliage\", category: \"ELEMENTS\"},\r\n    FOG: { name: \"fog\", category: \"ELEMENTS\"},\r\n    SMOKE: { name: \"smoke\", category: \"ELEMENTS\"},\r\n\r\n    // SCENERY \r\n    TREES: { name: \"trees\", category: \"SCENERY\"},\r\n    MOUNTAINS: { name: \"mountains\", category: \"SCENERY\"},\r\n    RIVERS: { name: \"rivers\", category: \"SCENERY\"},\r\n    LAKES: { name: \"lakes\", category: \"SCENERY\"},\r\n    CAVES: { name: \"caves\", category: \"SCENERY\"},\r\n    BOULDERS: { name: \"boulders\", category: \"SCENERY\"},\r\n    GRASS: { name: \"grass\", category: \"SCENERY\"},\r\n\r\n    // ANIMALS\r\n    CHICKENS: { name: \"chickens\", category: \"ANIMALS\"},\r\n    COWS: { name: \"cows\", category: \"ANIMALS\"},\r\n    DEER: { name: \"deer\", category: \"ANIMALS\"},\r\n    BEARS: { name: \"bears\", category: \"ANIMALS\"},\r\n    WOLVES: { name: \"wolves\", category: \"ANIMALS\"},\r\n    DOGS: { name: \"dogs\", category: \"ANIMALS\"},\r\n    CATS: { name: \"cats\", category: \"ANIMALS\"},\r\n    FALCONS: { name: \"falcons\", category: \"ANIMALS\"},\r\n\r\n    // SOUNDS\r\n    CLICKING: { name: \"clicking\", category: \"SOUNDS\"}\r\n}","import { NewLineKind } from \"typescript\";\r\nimport { RACE, CHARACTER_CLASS, ENCOUNTER_EVENT_TYPE } from \"./consts/general\";\r\nimport { APP_STATE } from \"./consts/states\";\r\n\r\nexport class Graph {\r\n  private nodes: Map<string, any>;\r\n  private edges: Map<string, Map<string, number>>;\r\n\r\n  constructor() {\r\n    this.nodes = new Map();\r\n    this.edges = new Map();\r\n  }\r\n\r\n  addNode(node: any) {\r\n    this.nodes.set(node.name, node);\r\n    this.edges.set(node.name, new Map());\r\n  }\r\n\r\n  addEdge(from: string, to: string, weight: number) {\r\n    this.edges.get(from)?.set(to, weight);\r\n  }\r\n\r\n  getNode(name: string) {\r\n    return this.nodes.get(name);\r\n  }\r\n}\r\n\r\nexport type Character = {\r\n  race: RACE,\r\n  character_class: CHARACTER_CLASS,\r\n  abilities: string[],\r\n  level: number,\r\n  experience: number;\r\n  name: string\r\n  id: number;\r\n  icon: string;\r\n  gear: Gear[];\r\n  backstory: Backstory[];\r\n  attributeLoss?: Attribute;\r\n  injury?: string;\r\n}\r\n\r\nexport type Backstory = {\r\n  tag: Tag;\r\n  completed: boolean;\r\n  description?: string;\r\n}\r\n\r\nexport enum PREFERENCE {\r\n  MAIN,\r\n  START,\r\n}\r\n\r\nexport type PlayerTrait = {\r\n  name: string;\r\n  description: string;\r\n}\r\n\r\nexport type PlayerStats = {\r\n  stress: number;\r\n  enjoyment: number;\r\n  engagement: number;\r\n  involvement: number;\r\n  experience: number;\r\n  level: number;\r\n\r\n  maxEnjoyment: number;\r\n  maxInvolvement: number;\r\n  maxEngagement: number;\r\n  stressBuffer: number;\r\n\r\n}\r\n\r\nexport type Player = {\r\n  name: string;\r\n  characters: Character[];\r\n  id: number;\r\n  icon: string;\r\n  schedule: number[];\r\n  preferences: [Tag, ATTITUDE][];\r\n  traits: PlayerTrait[];\r\n  playerStats: PlayerStats;\r\n};\r\n\r\nexport type StateConfig = {\r\n  nextState: APP_STATE;\r\n  ui: Record<string, any>;\r\n  background_image_id: string | undefined;\r\n  secondary_bg_image_id: string | undefined;\r\n  secondary_image_pos: string | undefined;\r\n  bg_transition_mode: string | undefined;\r\n};\r\n  \r\nexport type Campaign = {\r\n  name: string;\r\n  id: number;\r\n  description: string;\r\n  icon: string;\r\n  background?: string;\r\n  theme: string;\r\n  nbCharacters: [number, number];\r\n  nbSessions: [number, number];\r\n  // these are to be generated!\r\n  encounters: Encounter[];\r\n  processedEncounters: Encounter[][];\r\n  startingEncounter: Encounter;\r\n  finaleEncounter: Encounter;\r\n  chatTriggers?: Record<string, Record<string, ChatTrigger | string | ChatMessage[]>>;\r\n  tooltipTags?:  Record<string, Record<string, string>>;\r\n  plotHooks?: string[];\r\n  \r\n};\r\n\r\nexport type ChatTrigger = {\r\n  message?: string;\r\n  speaker?: ChatSpeaker;\r\n  conversation?: string;\r\n\r\n}\r\n\r\nexport type ChatMessage = {\r\n  message: string;\r\n  speaker: ChatSpeaker;\r\n  timestamp?: number;\r\n}\r\n\r\nexport interface ScoreEntry {\r\n\tdescription: string;\r\n\tpoints: number;\r\n  multiplier?: boolean;\r\n  color?: string;\r\n}\r\n\r\n\r\n// ONLY type gear if it is super useful - I have a feeling this is going to get REAL BUGGY\r\nexport enum TAG_TYPE  {\r\n  GEAR,\r\n  PLOT,\r\n  NONE\r\n}\r\n\r\n\r\nexport type Tag = {\r\n  name: string;\r\n  preference?: PREFERENCE;\r\n  type?: TAG_TYPE;\r\n  enemy?: boolean;\r\n  friendly?: boolean;\r\n  travel?: boolean;\r\n  attributeDefault?: string;\r\n  category?: string;\r\n}\r\n\r\nexport type session = {\r\n\r\n}\r\n\r\nexport type Location = {\r\n  name: string;\r\n  description: string;\r\n  icon: string;\r\n  tags: Tag[];\r\n  themes: string[];\r\n}\r\n\r\nexport type EncounterEvent = {\r\n  name: string;\r\n  type: ENCOUNTER_EVENT_TYPE;\r\n  flavorText?: string;\r\n  tags?: Tag[];\r\n}\r\n\r\nexport type Encounter = {\r\n  name: string;\r\n  description: string;\r\n  icon: string;\r\n  location: Location;\r\n  tags: Tag[];\r\n  branches: Encounter[];\r\n  events: EncounterEvent[];\r\n  id: number;\r\n  combat?: Combat[];\r\n  challenge?: Challenge[];\r\n  town?: Town[];\r\n  travel?: boolean;\r\n\r\n  // npcs: NPC[]; // wheeee\r\n  // other junk\r\n}\r\n\r\nexport const enum ATTITUDE {\r\n  HATE = -1,\r\n  CONFLICTED = 0,\r\n  LIKE = 1,\r\n  NEUTRAL = 100\r\n}\r\n\r\nexport enum ATTRIBUTE_TYPE {\r\n  COMBAT = \"combat\",\r\n  MAGIC = \"magic\",\r\n  TOOLS = \"tools\"\r\n\r\n}\r\n\r\nexport enum ATTRIBUTE_CONTRIBUTOR {\r\n  RACE = \"race\",\r\n  GEAR = \"gear\",\r\n  CHARACTER_CLASS = \"character_class\",\r\n  ALL = \"all\",\r\n  NPC = \"npc\",\r\n}\r\n\r\n\r\nexport const NOTEBOOK_CATEGORY = {\r\n  ENCOUNTER: \"encounter\",\r\n  LOCATION: \"location\", \r\n  CHARACTER: \"character\",\r\n  PLAYER: \"player\",\r\n  MESSAGE:   \"message\",\r\n  TUTORIAL: \"tutorial\",\r\n  TOC: \"toc\",\r\n  GROUP: \"group\",\r\n}\r\n\r\n\r\nexport const NAV_ENTRY = {\r\n  CAMPAIGN: \"campaign\",\r\n  PLAYER_RECRUITMENT: \"player recruitment\",\r\n  CHARACTER_ASSIGNMENT: \"character assignment\",\r\n}\r\n\r\n\r\nexport type EncounterNotebookEntry = {\r\n  encounter: Encounter;\r\n  message: string;\r\n}\r\n\r\nexport type GroupNotebookEntry = {\r\n  players: Player[];\r\n  message: string;\r\n}\r\n\r\nexport type LocationNotebookEntry = {\r\n  location: Location;\r\n  message: string;\r\n}\r\n\r\nexport type CharacterNotebookEntry = {\r\n  character: Character;\r\n  message: string;\r\n}\r\n\r\nexport type PlayerNotebookEntry = {\r\n  player: Player;\r\n  message: string;\r\n}\r\n\r\nexport type TutorialNotebookEntry = {\r\n  message: string,\r\n  showNext?: number,\r\n  showPrev?: number,\r\n  icon?: string,\r\n  title: string\r\n\r\n}\r\n\r\n\r\nexport type NotebookState = {\r\n  title: string;\r\n  category: string;\r\n  content: any; // define types for the different categories\r\n}\r\n\r\nexport type Attribute = {\r\n  [ATTRIBUTE_TYPE.COMBAT]?: number;\r\n  [ATTRIBUTE_TYPE.MAGIC]?: number;\r\n  [ATTRIBUTE_TYPE.TOOLS]?: number;\r\n}\r\n\r\n\r\n// Enemey attributes can be simply multiplied by number of enemies, or use the array index\r\nexport type EnemyAttribute = {\r\n  defense: number[];\r\n  magic_defense: number[]; \r\n  health: number[];\r\n  attack: number[];\r\n}\r\n\r\nexport type EnemyAttributeInstance = {\r\n  defense: number;\r\n  magic_defense: number; \r\n  health: number;\r\n  attack: number;\r\n}\r\n\r\nexport type Gear = {\r\n    name: string;\r\n    attributes: Attribute;\r\n}\r\n\r\nexport type TutorialStep = {\r\n  title: string;\r\n  content: string[];\r\n  icons?: string[];\r\n}\r\n\r\nexport enum CHAT_TYPE {\r\n  PLAYER = \"player\",\r\n  CHARACTER = \"character\",\r\n  HELPER = \"helper\",\r\n  SYSTEM = \"system\",\r\n  DM = \"dm\"\r\n}\r\nexport type ChatSpeaker = {\r\n  type: CHAT_TYPE,\r\n  id: number;\r\n}\r\n\r\nexport enum CHAT_EVENT_TYPE {\r\n  CAMPAIGN_START = \"campaign_start\",\r\n  ENCOUNTER_EVENT = \"encounter_event\",\r\n  LOCATION_CHANGE = \"location_change\",\r\n  COMBAT_START = \"combat_start\",\r\n  COMBAT_END = \"combat_end\"\r\n}\r\n\r\nexport type ChatEvent = {\r\n  type: CHAT_EVENT_TYPE;\r\n  title: string;\r\n  subtitle?: string;\r\n  data?: any;\r\n  timestamp: number;\r\n}\r\n\r\n\r\n\r\nexport type EncounterState = {\r\n  sessionState: SESSION_STATE;\r\n  eventIndex: number;\r\n}\r\n\r\nexport enum SESSION_STATE {\r\n  LOCATION_INTRO = \"location_intro\",\r\n  INTRO_EVENTS = \"intro_events\",\r\n  INTRO_MAIN = \"intro_main\",\r\n  MAIN_EVENTS = \"main_events\",\r\n  INTRO_EXIT = \"intro_exit\",\r\n  EXIT_EVENTS = \"exit_events\",\r\n  EXIT = \"exit\",\r\n}\r\n\r\nexport enum FlavorTagSource { \r\n  LOCATION = \"location\",\r\n  LOCATION_EXPECTED = \"location-expected\",\r\n  ENCOUNTER = \"encounter\",\r\n  ENCOUNTER_EXPECTED = \"encounter-expected\",\r\n  PLAYERS = \"players\",\r\n  QUESTS = \"quests\",\r\n  RUMOR = \"rumor\",\r\n  PLOT = \"plot\",\r\n  DM = \"dm\",\r\n  ALL = \"all\",\r\n  MAGIC_ITEM_EXPECTED = \"magic-item-expected\",\r\n  MAGIC_ITEM = \"magic-item\",\r\n  FORESHADOWING = \"foreshadowing\",\r\n  FORESHADOWING_EXPECTED = \"foreshadowing-expected\",\r\n  FORESHADOWING_RANDOM = \"foreshadowing-random\",\r\n  BACKSTORY = \"backstory\",\r\n  PLOT_HOOK = \"plot-hook\",\r\n  EXPOSITION = \"exposition\",\r\n  ENEMY = \"enemy\",\r\n  TREASURE = \"treasure\",\r\n  DM_POINT = \"dmpoint\", // Added DM points source\r\n  COLLECTION = \"collection\",\r\n  COLLECTION_COLLECTED = \"collection-collected\",\r\n  QUEST = \"quest\",\r\n  QUEST_TERMINAL = \"quest-terminal\",\r\n  PUZZLE = \"puzzle\",\r\n  PUZZLE_ANSWER = \"puzzle-answer\",\r\n  NONE = \"none\",\r\n}\r\n\r\nexport enum FlavorTagTheme {\r\n  COMEDIC = \"comedic\",\r\n  HEROIC = \"heroic\",\r\n  SERIOUS = \"serious\",\r\n  DRAMATIC = \"dramatic\",\r\n  GRIM   = \"grim\",\r\n  ROMANTIC  = \"romantic\",\r\n  FANTASY = \"fantasy\",\r\n  HORROR  = \"horror\",\r\n  NONE = \"none\",\r\n  GLOW = \"glow\",\r\n  length = \"length\",\r\n}\r\n\r\nexport type EncounterFlavorTag = {\r\n  tag: Tag;\r\n  source: FlavorTagSource;\r\n  theme: FlavorTagTheme;\r\n}\r\n\r\nexport type RPEncounterFlavorTag = {\r\n  tag?: EncounterFlavorTag;\r\n  character?: Character;\r\n  type: 'tag' | 'character' | 'treasure' | 'dmpoint';\r\n}\r\n\r\n\r\nexport enum TAGS_TYPE {\r\n  CURRENT_LOCATION,\r\n  BRANCH_LOCATION,\r\n  MAGIC_ITEM,\r\n  PLOT_HOOK,\r\n  CHARACTER_BACKSTORY,\r\n  CHARACTER_BACKSTORY_PROGRESS,\r\n  AMBUSH\r\n}\r\n\r\nexport type PerceptionTags = {\r\n  type: TAGS_TYPE;\r\n  name: string;\r\n  tags: EncounterFlavorTag[];  \r\n}\r\n\r\nexport interface ShapeConfig {\r\n  type: 'rectangle' | 'circle' | 'tree' | 'furniture' | 'wall';\r\n  minSize: number;\r\n  maxSize: number;\r\n  count: { min: number; max: number };\r\n  color: string;\r\n  rotate?: boolean;\r\n}\r\n\r\nexport interface ThemeConfig {\r\n  backgroundColor: string;\r\n  shapes: ShapeConfig[];\r\n}\r\n\r\n\r\nexport type Combat = {\r\n  enemy: Tag;\r\n  nbEnemies: number;\r\n  name: string;\r\n  description: string;\r\n}\r\n\r\nexport type Challenge = {\r\n  name: string;\r\n  description: string;\r\n  assistTags?: Tag[];\r\n  revealTag?: Tag;\r\n  skillThresholds?: {combat: number, gear: number, magic: number}; // thresholds for combat, magic, tools\r\n  generateRandomAssistTags?: boolean; // if true, the challenge will generate random tags\r\n  successText?: string;\r\n}\r\n\r\nexport type Town = {\r\n  buildings: Building[];\r\n  nbBuildings: number[];\r\n}\r\n\r\nexport type HeroCombatant = {\r\n  character?: Character;\r\n  npcTag?: Tag;\r\n  icon: string;\r\n  name: string;\r\n}\r\n\r\n\r\n\r\nexport type CombatState = {\r\n  round: {\r\n    number: number;\r\n    phase: 'balance' | 'setup' | 'heroes_attack' | 'heroes_resolve' | 'enemies_attack' | 'enemy_resolve_damage' | 'end_combat';\r\n  }\r\n  attacker: 'heroes' | 'enemy';\r\n  currentCharacterIndex: number;\r\n  currentEnemyIndex: number;\r\n  enemyType: Tag;\r\n  enemyStats: EnemyAttribute;\r\n  nbEnemies: number;\r\n  riskCenter: number;\r\n  usedTags: boolean[];\r\n  friendlyTags: Tag[];\r\n  //usedFriendlyTags: boolean[];\r\n  hostileTags: Tag[];\r\n  npcs: Tag[];\r\n // usedHostileTags: boolean[];\r\n perilResult: number[];\r\n heroAttacks: Record<string, string>;\r\n enemyStatsInstance: EnemyAttributeInstance;\r\n barAnimating?: boolean;\r\n combatMessage?: string;\r\n rewards: number;\r\n}\r\n\r\nexport const enum PERIL_INDEX {\r\n  INDEX,\r\n  DANGER, \r\n  STRESS, \r\n  SCORE\r\n}\r\n\r\n\r\nexport const enum REWARD_TYPE {\r\n  TREASURE,\r\n  XP,\r\n  ITEM,\r\n  PLOT_HOOK,\r\n  HEALING,\r\n  BACKSTORY,\r\n  TOOLS, \r\n  MAGIC,\r\n  BACKSTORY_PROGRESS,\r\n}\r\n\r\nexport type RewardItem = {\r\n  name: string;\r\n  type: REWARD_TYPE;\r\n  value: number;\r\n  cost: number;\r\n  description: string;\r\n  tag?: Tag;\r\n\r\n}\r\n\r\nexport interface Building {\r\n  name: string;\r\n  description: string;\r\n  type: BUILDING_TYPE;\r\n  tags: Tag[];\r\n  nbTags?: number;\r\n  allowMagicItems?: boolean;\r\n  addFriendlyTags?: boolean;\r\n  effects: BuildingEffect[];\r\n  maxCapacity?: number;\r\n  required?: boolean; // if true, this building must be present in the town\r\n}\r\n\r\n\r\nexport enum BUILDING_EFFECT_TYPE {\r\n  ADD_TENSION = \"add_tension\",\r\n  ADD_ENJOYMENT = \"add_enjoyment\",\r\n // ADD_INVOLVEMENT = \"add_involvement\",\r\n  ADD_HAPPINESS = \"add_happiness\",\r\n  ADD_REWARDS = \"add_rewards\",\r\n  REPLENISH_MAGIC = \"replenish_magic\",\r\n  REPLENISH_TOOLS = \"replenish_tools\",\r\n  ADD_BACKSTORY = \"add_backstory\",\r\n  HEAL = \"heal\",\r\n  RESURRECT = \"resurrect\",\r\n  INJURE = \"add_injury\",\r\n  USE_TOOLS = \"use_tools\",  \r\n  USE_MAGIC = \"use_magic\",\r\n  ADD_TREASURE = \"add_treasure\",\r\n  CAMPAIGN_POINT = \"CAMPAIGN_POINT\",\r\n  //ADD_PLAYER_POINT = \"add_player_point\",\r\n  //ADD_SCORE = \"add_score\",\r\n  NONE = 'none',\r\n}\r\n\r\nexport interface BuildingEffect {\r\n  type: BUILDING_EFFECT_TYPE;\r\n  value: number;\r\n  chance?: number;\r\n}\r\n\r\n\r\nexport enum BUILDING_TYPE {\r\n  TEMPLE = 'temple',\r\n  SHOP = 'shop',\r\n  TAVERN = 'tavern',\r\n  MARKETPLACE = 'marketplace',\r\n  GUILD_HALL = 'guild_hall',\r\n  BARRACKS = 'barracks',\r\n  LIBRARY = 'library',\r\n  FIRE = 'fire',\r\n  CONFRONTATION = 'confrontation',\r\n}\r\n\r\nexport interface TownBuilding {\r\n  building: Building;\r\n  tags: EncounterFlavorTag[];\r\n  effects: BuildingEffect[];\r\n  positionEffects: BuildingEffect[][];\r\n  isHighlighted?: boolean;\r\n  resolvedTags: Tag[];\r\n  capacity: number;\r\n  currentVisitors: Character[];\r\n  position?: { x: number; y: number };\r\n  size?: { width: number; height: number };\r\n  id?: string;\r\n  level?: number;\r\n // score: number;\r\n}\r\n\r\n\r\nexport interface EffectData {\r\n  object: Character | Player | 'party';\r\n  effects?: {\r\n    effect: string;\r\n    class: string;\r\n  }[];\r\n}\r\n\r\nexport interface ResultConfig {\r\n  results: any[];\r\n  title: string;\r\n  description: string;\r\n  tags: EncounterFlavorTag[];\r\n  travelOption: {\r\n    tagInstructions?: string;\r\n    [key: string]: any;\r\n  };\r\n  info: {\r\n    [key: string]: any;\r\n  };\r\n}\r\n\r\nexport interface TownResultConfig {\r\n  results: EffectData[];\r\n  title: string;\r\n  description: string;\r\n  tags: EncounterFlavorTag[];\r\n  info: {\r\n    score: number;\r\n    time: number;\r\n    boredom: number;\r\n    exhaustion: number;\r\n  }\r\n}\r\n\r\nexport interface TravelResultConfig {\r\n  results: EffectData[];\r\n  travelOption: TravelOption;\r\n  title: string;\r\n  description: string;\r\n  tags: EncounterFlavorTag[];\r\n  info: {\r\n    score: number;\r\n    time: number;\r\n    boredom: number;\r\n    exhaustion: number;\r\n  }\r\n}\r\n\r\nexport interface ChallengeAssistConfig {\r\n  title: string;\r\n  description: string;\r\n  tags: EncounterFlavorTag[];\r\n}\r\n\r\n\r\nexport interface PuzzleResultConfig {\r\n  results: EffectData[];\r\n  title: string;\r\n  description: string;\r\n  tags: EncounterFlavorTag[];\r\n  info: {\r\n    score: number;\r\n    time: number;\r\n    boredom: number;\r\n    exhaustion: number;\r\n  }\r\n}\r\n\r\nexport interface TagModalConfig {\r\n  title: string;\r\n  description?: string;\r\n  tags: EncounterFlavorTag[];\r\n  effects?: EffectData[];\r\n  selectedTags: Tag[];\r\n  remainingClicks: number;\r\n  tagInstructions?: string;\r\n  onTagClick: (tag: EncounterFlavorTag) => void;\r\n  onClose: () => void;\r\n}\r\n\r\nexport interface ModalOption {\r\n  id: string;\r\n  title: string;\r\n  description?: string;\r\n  icon?: string;\r\n  callback: () => void;\r\n  level?: number;\r\n  class?: string; // for custom styling\r\n  \r\n}\r\n\r\nexport interface ModalConfig {\r\n  challengeAssistConfig?: ChallengeAssistConfig;\r\n  title: string;\r\n  options: ModalOption[];\r\n \r\n  onClose?: () => void;\r\n  type?: string;\r\n  // custom modal data\r\n  travelConfig?: TravelResultConfig;\r\n  effectData?: EffectData[];\r\n  tagModalConfig?: TagModalConfig;\r\n  sceneData?: {\r\n    location: Location;\r\n    encounter: Encounter;\r\n  };\r\n  tagData?: {\r\n    tag: Tag;\r\n    chatTrigger: any;\r\n    encounter: Encounter;\r\n  };\r\n  encounterData?: {\r\n    branches: Encounter[];\r\n    branchPreferences: { [branchName: string]: Player[] };\r\n    currentEncounter: Encounter;\r\n  };\r\n}\r\n\r\nexport enum TRAVEL_LENGTH {\r\n  SHORT = 'short',\r\n  MEDIUM = 'medium',\r\n  LONG = 'long'\r\n}\r\n\r\n\r\nexport enum TRAVEL_OPTION {\r\n  EXPLORE_CURRENT_LOCATION = 'explore_current_location',\r\n  EXPLORE_UPCOMING_LOCATION = 'explore_upcoming_location',\r\n  CHARACTER_BACKSTORY = 'character_backstory',\r\n  AMBUSH = 'ambush',\r\n  AMBUSH2 = 'ambush2',\r\n  EXPLORE = 'explore',\r\n  CAMP = 'camp',\r\n  TRAVEL = 'travel',\r\n  TRADERS = 'traders',\r\n  SIDE_QUEST = 'side_quest',\r\n  MAGIC_CACHE = 'magic_cache',\r\n}\r\n\r\n\r\nexport interface TravelOption {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  time: number;\r\n  tags: number;\r\n  score: number;\r\n  boredom: number;\r\n  exhaustion?: number;\r\n  travelOptionType?: TRAVEL_OPTION;\r\n  tagInstructions?: string;\r\n  tag?: Tag;\r\n  repeatable?: boolean;\r\n}\r\n\r\nexport interface TagCollection {\r\n  tags: Tag[];\r\n  name: string;\r\n  type: string;\r\n  unlocks: Tag[];\r\n  theme: string;\r\n  chat: string;\r\n  reward: string;\r\n}\r\n\r\n// Define the game mastery structure\r\nexport interface GameMastery {\r\n  id: string;\r\n  name: string;\r\n  currentLevel: number;\r\n  maxLevel: number;\r\n  color: string;\r\n  rankLabels: string[];\r\n}\r\n\r\nexport enum DMUPGRADE {\r\n  SNACKS,\r\n  BREAKS,\r\n  COMFORT,\r\n  PROPS\r\n}\r\n\r\n\r\n// Define the consumable structure\r\nexport interface DMUpgrade {\r\n  id: string;\r\n  name: string;\r\n  value: number;\r\n  cost: number;\r\n  color: string;\r\n  icon: string;\r\n  unlockedBy?: string; // Optional field to indicate which ability unlocks this consumable\r\n  unlockLevel?: number; // Optional level required to unlock this consumable\r\n}\r\n\r\n\r\nexport interface QuestCost {\r\n  type: string; // e.g., 'gold', 'xp'\r\n  amount: number;\r\n}\r\nexport interface QuestReward {\r\n  type: string; // e.g., 'item', 'xp', 'gold'\r\n  amount: number;\r\n  name?: string; // Optional name of the reward\r\n  tag?: Tag; // specific backstory or magic item\r\n  description?: string; // Optional description of the reward\r\n}\r\nexport interface Quest {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  icon: string;\r\n  cost: QuestCost[];\r\n  rewards: QuestReward[];\r\n  startingNode: QuestNode; // Optional starting node for the quest\r\n  playerChoices? :[{\r\n    name: string;\r\n    description: string;\r\n    conversation: ChatMessage[];\r\n  }]\r\n}\r\n\r\nexport interface QuestNode {\r\n  children: QuestNode[];\r\n  tag: Tag;\r\n  conversation: ChatMessage[]; // Optional conversation associated with the quest\r\n}","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","/**\n * @license React\n * react-dom.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/*\n Modernizr 3.0.0pre (Custom Build) | MIT\n*/\n'use strict';var aa=require(\"react\"),ca=require(\"scheduler\");function p(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}var da=new Set,ea={};function fa(a,b){ha(a,b);ha(a+\"Capture\",b)}\nfunction ha(a,b){ea[a]=b;for(a=0;a<b.length;a++)da.add(b[a])}\nvar ia=!(\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,la=\n{},ma={};function oa(a){if(ja.call(ma,a))return!0;if(ja.call(la,a))return!1;if(ka.test(a))return ma[a]=!0;la[a]=!0;return!1}function pa(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case \"function\":case \"symbol\":return!0;case \"boolean\":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return\"data-\"!==a&&\"aria-\"!==a;default:return!1}}\nfunction qa(a,b,c,d){if(null===b||\"undefined\"===typeof b||pa(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function v(a,b,c,d,e,f,g){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f;this.removeEmptyString=g}var z={};\n\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(a){z[a]=new v(a,0,!1,a,null,!1,!1)});[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(a){var b=a[0];z[b]=new v(b,1,!1,a[1],null,!1,!1)});[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(a){z[a]=new v(a,2,!1,a.toLowerCase(),null,!1,!1)});\n[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(a){z[a]=new v(a,2,!1,a,null,!1,!1)});\"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(a){z[a]=new v(a,3,!1,a.toLowerCase(),null,!1,!1)});\n[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(a){z[a]=new v(a,3,!0,a,null,!1,!1)});[\"capture\",\"download\"].forEach(function(a){z[a]=new v(a,4,!1,a,null,!1,!1)});[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(a){z[a]=new v(a,6,!1,a,null,!1,!1)});[\"rowSpan\",\"start\"].forEach(function(a){z[a]=new v(a,5,!1,a.toLowerCase(),null,!1,!1)});var ra=/[\\-:]([a-z])/g;function sa(a){return a[1].toUpperCase()}\n\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(a){var b=a.replace(ra,\nsa);z[b]=new v(b,1,!1,a,null,!1,!1)});\"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(a){var b=a.replace(ra,sa);z[b]=new v(b,1,!1,a,\"http://www.w3.org/1999/xlink\",!1,!1)});[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(a){var b=a.replace(ra,sa);z[b]=new v(b,1,!1,a,\"http://www.w3.org/XML/1998/namespace\",!1,!1)});[\"tabIndex\",\"crossOrigin\"].forEach(function(a){z[a]=new v(a,1,!1,a.toLowerCase(),null,!1,!1)});\nz.xlinkHref=new v(\"xlinkHref\",1,!1,\"xlink:href\",\"http://www.w3.org/1999/xlink\",!0,!1);[\"src\",\"href\",\"action\",\"formAction\"].forEach(function(a){z[a]=new v(a,1,!1,a.toLowerCase(),null,!0,!0)});\nfunction ta(a,b,c,d){var e=z.hasOwnProperty(b)?z[b]:null;if(null!==e?0!==e.type:d||!(2<b.length)||\"o\"!==b[0]&&\"O\"!==b[0]||\"n\"!==b[1]&&\"N\"!==b[1])qa(b,c,e,d)&&(c=null),d||null===e?oa(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,\"\"+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:\"\":c:(b=e.attributeName,d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?\"\":\"\"+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c)))}\nvar ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for(\"react.element\"),wa=Symbol.for(\"react.portal\"),ya=Symbol.for(\"react.fragment\"),za=Symbol.for(\"react.strict_mode\"),Aa=Symbol.for(\"react.profiler\"),Ba=Symbol.for(\"react.provider\"),Ca=Symbol.for(\"react.context\"),Da=Symbol.for(\"react.forward_ref\"),Ea=Symbol.for(\"react.suspense\"),Fa=Symbol.for(\"react.suspense_list\"),Ga=Symbol.for(\"react.memo\"),Ha=Symbol.for(\"react.lazy\");Symbol.for(\"react.scope\");Symbol.for(\"react.debug_trace_mode\");\nvar Ia=Symbol.for(\"react.offscreen\");Symbol.for(\"react.legacy_hidden\");Symbol.for(\"react.cache\");Symbol.for(\"react.tracing_marker\");var Ja=Symbol.iterator;function Ka(a){if(null===a||\"object\"!==typeof a)return null;a=Ja&&a[Ja]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}var A=Object.assign,La;function Ma(a){if(void 0===La)try{throw Error();}catch(c){var b=c.stack.trim().match(/\\n( *(at )?)/);La=b&&b[1]||\"\"}return\"\\n\"+La+a}var Na=!1;\nfunction Oa(a,b){if(!a||Na)return\"\";Na=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(b)if(b=function(){throw Error();},Object.defineProperty(b.prototype,\"props\",{set:function(){throw Error();}}),\"object\"===typeof Reflect&&Reflect.construct){try{Reflect.construct(b,[])}catch(l){var d=l}Reflect.construct(a,[],b)}else{try{b.call()}catch(l){d=l}a.call(b.prototype)}else{try{throw Error();}catch(l){d=l}a()}}catch(l){if(l&&d&&\"string\"===typeof l.stack){for(var e=l.stack.split(\"\\n\"),\nf=d.stack.split(\"\\n\"),g=e.length-1,h=f.length-1;1<=g&&0<=h&&e[g]!==f[h];)h--;for(;1<=g&&0<=h;g--,h--)if(e[g]!==f[h]){if(1!==g||1!==h){do if(g--,h--,0>h||e[g]!==f[h]){var k=\"\\n\"+e[g].replace(\" at new \",\" at \");a.displayName&&k.includes(\"<anonymous>\")&&(k=k.replace(\"<anonymous>\",a.displayName));return k}while(1<=g&&0<=h)}break}}}finally{Na=!1,Error.prepareStackTrace=c}return(a=a?a.displayName||a.name:\"\")?Ma(a):\"\"}\nfunction Pa(a){switch(a.tag){case 5:return Ma(a.type);case 16:return Ma(\"Lazy\");case 13:return Ma(\"Suspense\");case 19:return Ma(\"SuspenseList\");case 0:case 2:case 15:return a=Oa(a.type,!1),a;case 11:return a=Oa(a.type.render,!1),a;case 1:return a=Oa(a.type,!0),a;default:return\"\"}}\nfunction Qa(a){if(null==a)return null;if(\"function\"===typeof a)return a.displayName||a.name||null;if(\"string\"===typeof a)return a;switch(a){case ya:return\"Fragment\";case wa:return\"Portal\";case Aa:return\"Profiler\";case za:return\"StrictMode\";case Ea:return\"Suspense\";case Fa:return\"SuspenseList\"}if(\"object\"===typeof a)switch(a.$$typeof){case Ca:return(a.displayName||\"Context\")+\".Consumer\";case Ba:return(a._context.displayName||\"Context\")+\".Provider\";case Da:var b=a.render;a=a.displayName;a||(a=b.displayName||\nb.name||\"\",a=\"\"!==a?\"ForwardRef(\"+a+\")\":\"ForwardRef\");return a;case Ga:return b=a.displayName||null,null!==b?b:Qa(a.type)||\"Memo\";case Ha:b=a._payload;a=a._init;try{return Qa(a(b))}catch(c){}}return null}\nfunction Ra(a){var b=a.type;switch(a.tag){case 24:return\"Cache\";case 9:return(b.displayName||\"Context\")+\".Consumer\";case 10:return(b._context.displayName||\"Context\")+\".Provider\";case 18:return\"DehydratedFragment\";case 11:return a=b.render,a=a.displayName||a.name||\"\",b.displayName||(\"\"!==a?\"ForwardRef(\"+a+\")\":\"ForwardRef\");case 7:return\"Fragment\";case 5:return b;case 4:return\"Portal\";case 3:return\"Root\";case 6:return\"Text\";case 16:return Qa(b);case 8:return b===za?\"StrictMode\":\"Mode\";case 22:return\"Offscreen\";\ncase 12:return\"Profiler\";case 21:return\"Scope\";case 13:return\"Suspense\";case 19:return\"SuspenseList\";case 25:return\"TracingMarker\";case 1:case 0:case 17:case 2:case 14:case 15:if(\"function\"===typeof b)return b.displayName||b.name||null;if(\"string\"===typeof b)return b}return null}function Sa(a){switch(typeof a){case \"boolean\":case \"number\":case \"string\":case \"undefined\":return a;case \"object\":return a;default:return\"\"}}\nfunction Ta(a){var b=a.type;return(a=a.nodeName)&&\"input\"===a.toLowerCase()&&(\"checkbox\"===b||\"radio\"===b)}\nfunction Ua(a){var b=Ta(a)?\"checked\":\"value\",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=\"\"+a[b];if(!a.hasOwnProperty(b)&&\"undefined\"!==typeof c&&\"function\"===typeof c.get&&\"function\"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=\"\"+a;f.call(this,a)}});Object.defineProperty(a,b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=\"\"+a},stopTracking:function(){a._valueTracker=\nnull;delete a[b]}}}}function Va(a){a._valueTracker||(a._valueTracker=Ua(a))}function Wa(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d=\"\";a&&(d=Ta(a)?a.checked?\"true\":\"false\":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function Xa(a){a=a||(\"undefined\"!==typeof document?document:void 0);if(\"undefined\"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}\nfunction Ya(a,b){var c=b.checked;return A({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=c?c:a._wrapperState.initialChecked})}function Za(a,b){var c=null==b.defaultValue?\"\":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=Sa(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:\"checkbox\"===b.type||\"radio\"===b.type?null!=b.checked:null!=b.value}}function ab(a,b){b=b.checked;null!=b&&ta(a,\"checked\",b,!1)}\nfunction bb(a,b){ab(a,b);var c=Sa(b.value),d=b.type;if(null!=c)if(\"number\"===d){if(0===c&&\"\"===a.value||a.value!=c)a.value=\"\"+c}else a.value!==\"\"+c&&(a.value=\"\"+c);else if(\"submit\"===d||\"reset\"===d){a.removeAttribute(\"value\");return}b.hasOwnProperty(\"value\")?cb(a,b.type,c):b.hasOwnProperty(\"defaultValue\")&&cb(a,b.type,Sa(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}\nfunction db(a,b,c){if(b.hasOwnProperty(\"value\")||b.hasOwnProperty(\"defaultValue\")){var d=b.type;if(!(\"submit\"!==d&&\"reset\"!==d||void 0!==b.value&&null!==b.value))return;b=\"\"+a._wrapperState.initialValue;c||b===a.value||(a.value=b);a.defaultValue=b}c=a.name;\"\"!==c&&(a.name=\"\");a.defaultChecked=!!a._wrapperState.initialChecked;\"\"!==c&&(a.name=c)}\nfunction cb(a,b,c){if(\"number\"!==b||Xa(a.ownerDocument)!==a)null==c?a.defaultValue=\"\"+a._wrapperState.initialValue:a.defaultValue!==\"\"+c&&(a.defaultValue=\"\"+c)}var eb=Array.isArray;\nfunction fb(a,b,c,d){a=a.options;if(b){b={};for(var e=0;e<c.length;e++)b[\"$\"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty(\"$\"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=\"\"+Sa(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}\nfunction gb(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(p(91));return A({},b,{value:void 0,defaultValue:void 0,children:\"\"+a._wrapperState.initialValue})}function hb(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(p(92));if(eb(c)){if(1<c.length)throw Error(p(93));c=c[0]}b=c}null==b&&(b=\"\");c=b}a._wrapperState={initialValue:Sa(c)}}\nfunction ib(a,b){var c=Sa(b.value),d=Sa(b.defaultValue);null!=c&&(c=\"\"+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=\"\"+d)}function jb(a){var b=a.textContent;b===a._wrapperState.initialValue&&\"\"!==b&&null!==b&&(a.value=b)}function kb(a){switch(a){case \"svg\":return\"http://www.w3.org/2000/svg\";case \"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}\nfunction lb(a,b){return null==a||\"http://www.w3.org/1999/xhtml\"===a?kb(b):\"http://www.w3.org/2000/svg\"===a&&\"foreignObject\"===b?\"http://www.w3.org/1999/xhtml\":a}\nvar mb,nb=function(a){return\"undefined\"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if(\"http://www.w3.org/2000/svg\"!==a.namespaceURI||\"innerHTML\"in a)a.innerHTML=b;else{mb=mb||document.createElement(\"div\");mb.innerHTML=\"<svg>\"+b.valueOf().toString()+\"</svg>\";for(b=mb.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}});\nfunction ob(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b}\nvar pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,\nzoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(pb).forEach(function(a){qb.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);pb[b]=pb[a]})});function rb(a,b,c){return null==b||\"boolean\"===typeof b||\"\"===b?\"\":c||\"number\"!==typeof b||0===b||pb.hasOwnProperty(a)&&pb[a]?(\"\"+b).trim():b+\"px\"}\nfunction sb(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf(\"--\"),e=rb(c,b[c],d);\"float\"===c&&(c=\"cssFloat\");d?a.setProperty(c,e):a[c]=e}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});\nfunction ub(a,b){if(b){if(tb[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(p(137,a));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(p(60));if(\"object\"!==typeof b.dangerouslySetInnerHTML||!(\"__html\"in b.dangerouslySetInnerHTML))throw Error(p(61));}if(null!=b.style&&\"object\"!==typeof b.style)throw Error(p(62));}}\nfunction vb(a,b){if(-1===a.indexOf(\"-\"))return\"string\"===typeof b.is;switch(a){case \"annotation-xml\":case \"color-profile\":case \"font-face\":case \"font-face-src\":case \"font-face-uri\":case \"font-face-format\":case \"font-face-name\":case \"missing-glyph\":return!1;default:return!0}}var wb=null;function xb(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:a}var yb=null,zb=null,Ab=null;\nfunction Bb(a){if(a=Cb(a)){if(\"function\"!==typeof yb)throw Error(p(280));var b=a.stateNode;b&&(b=Db(b),yb(a.stateNode,a.type,b))}}function Eb(a){zb?Ab?Ab.push(a):Ab=[a]:zb=a}function Fb(){if(zb){var a=zb,b=Ab;Ab=zb=null;Bb(a);if(b)for(a=0;a<b.length;a++)Bb(b[a])}}function Gb(a,b){return a(b)}function Hb(){}var Ib=!1;function Jb(a,b,c){if(Ib)return a(b,c);Ib=!0;try{return Gb(a,b,c)}finally{if(Ib=!1,null!==zb||null!==Ab)Hb(),Fb()}}\nfunction Kb(a,b){var c=a.stateNode;if(null===c)return null;var d=Db(c);if(null===d)return null;c=d[b];a:switch(b){case \"onClick\":case \"onClickCapture\":case \"onDoubleClick\":case \"onDoubleClickCapture\":case \"onMouseDown\":case \"onMouseDownCapture\":case \"onMouseMove\":case \"onMouseMoveCapture\":case \"onMouseUp\":case \"onMouseUpCapture\":case \"onMouseEnter\":(d=!d.disabled)||(a=a.type,d=!(\"button\"===a||\"input\"===a||\"select\"===a||\"textarea\"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&\"function\"!==\ntypeof c)throw Error(p(231,b,typeof c));return c}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,\"passive\",{get:function(){Lb=!0}});window.addEventListener(\"test\",Mb,Mb);window.removeEventListener(\"test\",Mb,Mb)}catch(a){Lb=!1}function Nb(a,b,c,d,e,f,g,h,k){var l=Array.prototype.slice.call(arguments,3);try{b.apply(c,l)}catch(m){this.onError(m)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(a){Ob=!0;Pb=a}};function Tb(a,b,c,d,e,f,g,h,k){Ob=!1;Pb=null;Nb.apply(Sb,arguments)}\nfunction Ub(a,b,c,d,e,f,g,h,k){Tb.apply(this,arguments);if(Ob){if(Ob){var l=Pb;Ob=!1;Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=l)}}function Vb(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.flags&4098)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function Wb(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function Xb(a){if(Vb(a)!==a)throw Error(p(188));}\nfunction Yb(a){var b=a.alternate;if(!b){b=Vb(a);if(null===b)throw Error(p(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return Xb(e),a;if(f===d)return Xb(e),b;f=f.sibling}throw Error(p(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=f.child;h;){if(h===\nc){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(p(189));}}if(c.alternate!==d)throw Error(p(190));}if(3!==c.tag)throw Error(p(188));return c.stateNode.current===c?a:b}function Zb(a){a=Yb(a);return null!==a?$b(a):null}function $b(a){if(5===a.tag||6===a.tag)return a;for(a=a.child;null!==a;){var b=$b(a);if(null!==b)return b;a=a.sibling}return null}\nvar ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(a){if(lc&&\"function\"===typeof lc.onCommitFiberRoot)try{lc.onCommitFiberRoot(kc,a,void 0,128===(a.current.flags&128))}catch(b){}}\nvar oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(a){a>>>=0;return 0===a?32:31-(pc(a)/qc|0)|0}var rc=64,sc=4194304;\nfunction tc(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;\ndefault:return a}}function uc(a,b){var c=a.pendingLanes;if(0===c)return 0;var d=0,e=a.suspendedLanes,f=a.pingedLanes,g=c&268435455;if(0!==g){var h=g&~e;0!==h?d=tc(h):(f&=g,0!==f&&(d=tc(f)))}else g=c&~e,0!==g?d=tc(g):0!==f&&(d=tc(f));if(0===d)return 0;if(0!==b&&b!==d&&0===(b&e)&&(e=d&-d,f=b&-b,e>=f||16===e&&0!==(f&4194240)))return b;0!==(d&4)&&(d|=c&16);b=a.entangledLanes;if(0!==b)for(a=a.entanglements,b&=d;0<b;)c=31-oc(b),e=1<<c,d|=a[c],b&=~e;return d}\nfunction vc(a,b){switch(a){case 1:case 2:case 4:return b+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5E3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}\nfunction wc(a,b){for(var c=a.suspendedLanes,d=a.pingedLanes,e=a.expirationTimes,f=a.pendingLanes;0<f;){var g=31-oc(f),h=1<<g,k=e[g];if(-1===k){if(0===(h&c)||0!==(h&d))e[g]=vc(h,b)}else k<=b&&(a.expiredLanes|=h);f&=~h}}function xc(a){a=a.pendingLanes&-1073741825;return 0!==a?a:a&1073741824?1073741824:0}function yc(){var a=rc;rc<<=1;0===(rc&4194240)&&(rc=64);return a}function zc(a){for(var b=[],c=0;31>c;c++)b.push(a);return b}\nfunction Ac(a,b,c){a.pendingLanes|=b;536870912!==b&&(a.suspendedLanes=0,a.pingedLanes=0);a=a.eventTimes;b=31-oc(b);a[b]=c}function Bc(a,b){var c=a.pendingLanes&~b;a.pendingLanes=b;a.suspendedLanes=0;a.pingedLanes=0;a.expiredLanes&=b;a.mutableReadLanes&=b;a.entangledLanes&=b;b=a.entanglements;var d=a.eventTimes;for(a=a.expirationTimes;0<c;){var e=31-oc(c),f=1<<e;b[e]=0;d[e]=-1;a[e]=-1;c&=~f}}\nfunction Cc(a,b){var c=a.entangledLanes|=b;for(a=a.entanglements;c;){var d=31-oc(c),e=1<<d;e&b|a[d]&b&&(a[d]|=b);c&=~e}}var C=0;function Dc(a){a&=-a;return 1<a?4<a?0!==(a&268435455)?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit\".split(\" \");\nfunction Sc(a,b){switch(a){case \"focusin\":case \"focusout\":Lc=null;break;case \"dragenter\":case \"dragleave\":Mc=null;break;case \"mouseover\":case \"mouseout\":Nc=null;break;case \"pointerover\":case \"pointerout\":Oc.delete(b.pointerId);break;case \"gotpointercapture\":case \"lostpointercapture\":Pc.delete(b.pointerId)}}\nfunction Tc(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a={blockedOn:b,domEventName:c,eventSystemFlags:d,nativeEvent:f,targetContainers:[e]},null!==b&&(b=Cb(b),null!==b&&Fc(b)),a;a.eventSystemFlags|=d;b=a.targetContainers;null!==e&&-1===b.indexOf(e)&&b.push(e);return a}\nfunction Uc(a,b,c,d,e){switch(b){case \"focusin\":return Lc=Tc(Lc,a,b,c,d,e),!0;case \"dragenter\":return Mc=Tc(Mc,a,b,c,d,e),!0;case \"mouseover\":return Nc=Tc(Nc,a,b,c,d,e),!0;case \"pointerover\":var f=e.pointerId;Oc.set(f,Tc(Oc.get(f)||null,a,b,c,d,e));return!0;case \"gotpointercapture\":return f=e.pointerId,Pc.set(f,Tc(Pc.get(f)||null,a,b,c,d,e)),!0}return!1}\nfunction Vc(a){var b=Wc(a.target);if(null!==b){var c=Vb(b);if(null!==c)if(b=c.tag,13===b){if(b=Wb(c),null!==b){a.blockedOn=b;Ic(a.priority,function(){Gc(c)});return}}else if(3===b&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}\nfunction Xc(a){if(null!==a.blockedOn)return!1;for(var b=a.targetContainers;0<b.length;){var c=Yc(a.domEventName,a.eventSystemFlags,b[0],a.nativeEvent);if(null===c){c=a.nativeEvent;var d=new c.constructor(c.type,c);wb=d;c.target.dispatchEvent(d);wb=null}else return b=Cb(c),null!==b&&Fc(b),a.blockedOn=c,!1;b.shift()}return!0}function Zc(a,b,c){Xc(a)&&c.delete(b)}function $c(){Jc=!1;null!==Lc&&Xc(Lc)&&(Lc=null);null!==Mc&&Xc(Mc)&&(Mc=null);null!==Nc&&Xc(Nc)&&(Nc=null);Oc.forEach(Zc);Pc.forEach(Zc)}\nfunction ad(a,b){a.blockedOn===b&&(a.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}\nfunction bd(a){function b(b){return ad(b,a)}if(0<Kc.length){ad(Kc[0],a);for(var c=1;c<Kc.length;c++){var d=Kc[c];d.blockedOn===a&&(d.blockedOn=null)}}null!==Lc&&ad(Lc,a);null!==Mc&&ad(Mc,a);null!==Nc&&ad(Nc,a);Oc.forEach(b);Pc.forEach(b);for(c=0;c<Qc.length;c++)d=Qc[c],d.blockedOn===a&&(d.blockedOn=null);for(;0<Qc.length&&(c=Qc[0],null===c.blockedOn);)Vc(c),null===c.blockedOn&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;\nfunction ed(a,b,c,d){var e=C,f=cd.transition;cd.transition=null;try{C=1,fd(a,b,c,d)}finally{C=e,cd.transition=f}}function gd(a,b,c,d){var e=C,f=cd.transition;cd.transition=null;try{C=4,fd(a,b,c,d)}finally{C=e,cd.transition=f}}\nfunction fd(a,b,c,d){if(dd){var e=Yc(a,b,c,d);if(null===e)hd(a,b,d,id,c),Sc(a,d);else if(Uc(e,a,b,c,d))d.stopPropagation();else if(Sc(a,d),b&4&&-1<Rc.indexOf(a)){for(;null!==e;){var f=Cb(e);null!==f&&Ec(f);f=Yc(a,b,c,d);null===f&&hd(a,b,d,id,c);if(f===e)break;e=f}null!==e&&d.stopPropagation()}else hd(a,b,d,null,c)}}var id=null;\nfunction Yc(a,b,c,d){id=null;a=xb(d);a=Wc(a);if(null!==a)if(b=Vb(a),null===b)a=null;else if(c=b.tag,13===c){a=Wb(b);if(null!==a)return a;a=null}else if(3===c){if(b.stateNode.current.memoizedState.isDehydrated)return 3===b.tag?b.stateNode.containerInfo:null;a=null}else b!==a&&(a=null);id=a;return null}\nfunction jd(a){switch(a){case \"cancel\":case \"click\":case \"close\":case \"contextmenu\":case \"copy\":case \"cut\":case \"auxclick\":case \"dblclick\":case \"dragend\":case \"dragstart\":case \"drop\":case \"focusin\":case \"focusout\":case \"input\":case \"invalid\":case \"keydown\":case \"keypress\":case \"keyup\":case \"mousedown\":case \"mouseup\":case \"paste\":case \"pause\":case \"play\":case \"pointercancel\":case \"pointerdown\":case \"pointerup\":case \"ratechange\":case \"reset\":case \"resize\":case \"seeked\":case \"submit\":case \"touchcancel\":case \"touchend\":case \"touchstart\":case \"volumechange\":case \"change\":case \"selectionchange\":case \"textInput\":case \"compositionstart\":case \"compositionend\":case \"compositionupdate\":case \"beforeblur\":case \"afterblur\":case \"beforeinput\":case \"blur\":case \"fullscreenchange\":case \"focus\":case \"hashchange\":case \"popstate\":case \"select\":case \"selectstart\":return 1;case \"drag\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"mousemove\":case \"mouseout\":case \"mouseover\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"scroll\":case \"toggle\":case \"touchmove\":case \"wheel\":case \"mouseenter\":case \"mouseleave\":case \"pointerenter\":case \"pointerleave\":return 4;\ncase \"message\":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var a,b=ld,c=b.length,d,e=\"value\"in kd?kd.value:kd.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return md=e.slice(a,1<d?1-d:void 0)}\nfunction od(a){var b=a.keyCode;\"charCode\"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}function pd(){return!0}function qd(){return!1}\nfunction rd(a){function b(b,d,e,f,g){this._reactName=b;this._targetInst=e;this.type=d;this.nativeEvent=f;this.target=g;this.currentTarget=null;for(var c in a)a.hasOwnProperty(c)&&(b=a[c],this[c]=b?b(f):f[c]);this.isDefaultPrevented=(null!=f.defaultPrevented?f.defaultPrevented:!1===f.returnValue)?pd:qd;this.isPropagationStopped=qd;return this}A(b.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():\"unknown\"!==typeof a.returnValue&&\n(a.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():\"unknown\"!==typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd});return b}\nvar sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(a){return void 0===a.relatedTarget?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){if(\"movementX\"in\na)return a.movementX;a!==yd&&(yd&&\"mousemove\"===a.type?(wd=a.screenX-yd.screenX,xd=a.screenY-yd.screenY):xd=wd=0,yd=a);return wd},movementY:function(a){return\"movementY\"in a?a.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(a){return\"clipboardData\"in a?a.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:\"Escape\",\nSpacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},Nd={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",116:\"F5\",117:\"F6\",118:\"F7\",\n119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},Od={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function Pd(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Od[a])?!!b[a]:!1}function zd(){return Pd}\nvar Qd=A({},ud,{key:function(a){if(a.key){var b=Md[a.key]||a.key;if(\"Unidentified\"!==b)return b}return\"keypress\"===a.type?(a=od(a),13===a?\"Enter\":String.fromCharCode(a)):\"keydown\"===a.type||\"keyup\"===a.type?Nd[a.keyCode]||\"Unidentified\":\"\"},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(a){return\"keypress\"===a.type?od(a):0},keyCode:function(a){return\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0},which:function(a){return\"keypress\"===\na.type?od(a):\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(a){return\"deltaX\"in a?a.deltaX:\"wheelDeltaX\"in a?-a.wheelDeltaX:0},\ndeltaY:function(a){return\"deltaY\"in a?a.deltaY:\"wheelDeltaY\"in a?-a.wheelDeltaY:\"wheelDelta\"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&\"CompositionEvent\"in window,be=null;ia&&\"documentMode\"in document&&(be=document.documentMode);var ce=ia&&\"TextEvent\"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;\nfunction ge(a,b){switch(a){case \"keyup\":return-1!==$d.indexOf(b.keyCode);case \"keydown\":return 229!==b.keyCode;case \"keypress\":case \"mousedown\":case \"focusout\":return!0;default:return!1}}function he(a){a=a.detail;return\"object\"===typeof a&&\"data\"in a?a.data:null}var ie=!1;function je(a,b){switch(a){case \"compositionend\":return he(b);case \"keypress\":if(32!==b.which)return null;fe=!0;return ee;case \"textInput\":return a=b.data,a===ee&&fe?null:a;default:return null}}\nfunction ke(a,b){if(ie)return\"compositionend\"===a||!ae&&ge(a,b)?(a=nd(),md=ld=kd=null,ie=!1,a):null;switch(a){case \"paste\":return null;case \"keypress\":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case \"compositionend\":return de&&\"ko\"!==b.locale?null:b.data;default:return null}}\nvar le={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return\"input\"===b?!!le[a.type]:\"textarea\"===b?!0:!1}function ne(a,b,c,d){Eb(d);b=oe(b,\"onChange\");0<b.length&&(c=new td(\"onChange\",\"change\",null,c,d),a.push({event:c,listeners:b}))}var pe=null,qe=null;function re(a){se(a,0)}function te(a){var b=ue(a);if(Wa(b))return a}\nfunction ve(a,b){if(\"change\"===a)return b}var we=!1;if(ia){var xe;if(ia){var ye=\"oninput\"in document;if(!ye){var ze=document.createElement(\"div\");ze.setAttribute(\"oninput\",\"return;\");ye=\"function\"===typeof ze.oninput}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent(\"onpropertychange\",Be),qe=pe=null)}function Be(a){if(\"value\"===a.propertyName&&te(qe)){var b=[];ne(b,qe,a,xb(a));Jb(re,b)}}\nfunction Ce(a,b,c){\"focusin\"===a?(Ae(),pe=b,qe=c,pe.attachEvent(\"onpropertychange\",Be)):\"focusout\"===a&&Ae()}function De(a){if(\"selectionchange\"===a||\"keyup\"===a||\"keydown\"===a)return te(qe)}function Ee(a,b){if(\"click\"===a)return te(b)}function Fe(a,b){if(\"input\"===a||\"change\"===a)return te(b)}function Ge(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var He=\"function\"===typeof Object.is?Object.is:Ge;\nfunction Ie(a,b){if(He(a,b))return!0;if(\"object\"!==typeof a||null===a||\"object\"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var e=c[d];if(!ja.call(b,e)||!He(a[e],b[e]))return!1}return!0}function Je(a){for(;a&&a.firstChild;)a=a.firstChild;return a}\nfunction Ke(a,b){var c=Je(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=Je(c)}}function Le(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?Le(a,b.parentNode):\"contains\"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}\nfunction Me(){for(var a=window,b=Xa();b instanceof a.HTMLIFrameElement;){try{var c=\"string\"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=Xa(a.document)}return b}function Ne(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&(\"input\"===b&&(\"text\"===a.type||\"search\"===a.type||\"tel\"===a.type||\"url\"===a.type||\"password\"===a.type)||\"textarea\"===b||\"true\"===a.contentEditable)}\nfunction Oe(a){var b=Me(),c=a.focusedElem,d=a.selectionRange;if(b!==c&&c&&c.ownerDocument&&Le(c.ownerDocument.documentElement,c)){if(null!==d&&Ne(c))if(b=d.start,a=d.end,void 0===a&&(a=b),\"selectionStart\"in c)c.selectionStart=b,c.selectionEnd=Math.min(a,c.value.length);else if(a=(b=c.ownerDocument||document)&&b.defaultView||window,a.getSelection){a=a.getSelection();var e=c.textContent.length,f=Math.min(d.start,e);d=void 0===d.end?f:Math.min(d.end,e);!a.extend&&f>d&&(e=d,d=f,f=e);e=Ke(c,f);var g=Ke(c,\nd);e&&g&&(1!==a.rangeCount||a.anchorNode!==e.node||a.anchorOffset!==e.offset||a.focusNode!==g.node||a.focusOffset!==g.offset)&&(b=b.createRange(),b.setStart(e.node,e.offset),a.removeAllRanges(),f>d?(a.addRange(b),a.extend(g.node,g.offset)):(b.setEnd(g.node,g.offset),a.addRange(b)))}b=[];for(a=c;a=a.parentNode;)1===a.nodeType&&b.push({element:a,left:a.scrollLeft,top:a.scrollTop});\"function\"===typeof c.focus&&c.focus();for(c=0;c<b.length;c++)a=b[c],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}\nvar Pe=ia&&\"documentMode\"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;\nfunction Ue(a,b,c){var d=c.window===c?c.document:9===c.nodeType?c:c.ownerDocument;Te||null==Qe||Qe!==Xa(d)||(d=Qe,\"selectionStart\"in d&&Ne(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Se&&Ie(Se,d)||(Se=d,d=oe(Re,\"onSelect\"),0<d.length&&(b=new td(\"onSelect\",\"select\",null,b,c),a.push({event:b,listeners:d}),b.target=Qe)))}\nfunction Ve(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c[\"Webkit\"+a]=\"webkit\"+b;c[\"Moz\"+a]=\"moz\"+b;return c}var We={animationend:Ve(\"Animation\",\"AnimationEnd\"),animationiteration:Ve(\"Animation\",\"AnimationIteration\"),animationstart:Ve(\"Animation\",\"AnimationStart\"),transitionend:Ve(\"Transition\",\"TransitionEnd\")},Xe={},Ye={};\nia&&(Ye=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),\"TransitionEvent\"in window||delete We.transitionend.transition);function Ze(a){if(Xe[a])return Xe[a];if(!We[a])return a;var b=We[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Ye)return Xe[a]=b[c];return a}var $e=Ze(\"animationend\"),af=Ze(\"animationiteration\"),bf=Ze(\"animationstart\"),cf=Ze(\"transitionend\"),df=new Map,ef=\"abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel\".split(\" \");\nfunction ff(a,b){df.set(a,b);fa(b,[a])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,\"on\"+kf)}ff($e,\"onAnimationEnd\");ff(af,\"onAnimationIteration\");ff(bf,\"onAnimationStart\");ff(\"dblclick\",\"onDoubleClick\");ff(\"focusin\",\"onFocus\");ff(\"focusout\",\"onBlur\");ff(cf,\"onTransitionEnd\");ha(\"onMouseEnter\",[\"mouseout\",\"mouseover\"]);ha(\"onMouseLeave\",[\"mouseout\",\"mouseover\"]);ha(\"onPointerEnter\",[\"pointerout\",\"pointerover\"]);\nha(\"onPointerLeave\",[\"pointerout\",\"pointerover\"]);fa(\"onChange\",\"change click focusin focusout input keydown keyup selectionchange\".split(\" \"));fa(\"onSelect\",\"focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange\".split(\" \"));fa(\"onBeforeInput\",[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]);fa(\"onCompositionEnd\",\"compositionend focusout keydown keypress keyup mousedown\".split(\" \"));fa(\"onCompositionStart\",\"compositionstart focusout keydown keypress keyup mousedown\".split(\" \"));\nfa(\"onCompositionUpdate\",\"compositionupdate focusout keydown keypress keyup mousedown\".split(\" \"));var lf=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),mf=new Set(\"cancel close invalid load scroll toggle\".split(\" \").concat(lf));\nfunction nf(a,b,c){var d=a.type||\"unknown-event\";a.currentTarget=c;Ub(d,b,void 0,a);a.currentTarget=null}\nfunction se(a,b){b=0!==(b&4);for(var c=0;c<a.length;c++){var d=a[c],e=d.event;d=d.listeners;a:{var f=void 0;if(b)for(var g=d.length-1;0<=g;g--){var h=d[g],k=h.instance,l=h.currentTarget;h=h.listener;if(k!==f&&e.isPropagationStopped())break a;nf(e,h,l);f=k}else for(g=0;g<d.length;g++){h=d[g];k=h.instance;l=h.currentTarget;h=h.listener;if(k!==f&&e.isPropagationStopped())break a;nf(e,h,l);f=k}}}if(Qb)throw a=Rb,Qb=!1,Rb=null,a;}\nfunction D(a,b){var c=b[of];void 0===c&&(c=b[of]=new Set);var d=a+\"__bubble\";c.has(d)||(pf(b,a,2,!1),c.add(d))}function qf(a,b,c){var d=0;b&&(d|=4);pf(c,a,d,b)}var rf=\"_reactListening\"+Math.random().toString(36).slice(2);function sf(a){if(!a[rf]){a[rf]=!0;da.forEach(function(b){\"selectionchange\"!==b&&(mf.has(b)||qf(b,!1,a),qf(b,!0,a))});var b=9===a.nodeType?a:a.ownerDocument;null===b||b[rf]||(b[rf]=!0,qf(\"selectionchange\",!1,b))}}\nfunction pf(a,b,c,d){switch(jd(b)){case 1:var e=ed;break;case 4:e=gd;break;default:e=fd}c=e.bind(null,b,c,a);e=void 0;!Lb||\"touchstart\"!==b&&\"touchmove\"!==b&&\"wheel\"!==b||(e=!0);d?void 0!==e?a.addEventListener(b,c,{capture:!0,passive:e}):a.addEventListener(b,c,!0):void 0!==e?a.addEventListener(b,c,{passive:e}):a.addEventListener(b,c,!1)}\nfunction hd(a,b,c,d,e){var f=d;if(0===(b&1)&&0===(b&2)&&null!==d)a:for(;;){if(null===d)return;var g=d.tag;if(3===g||4===g){var h=d.stateNode.containerInfo;if(h===e||8===h.nodeType&&h.parentNode===e)break;if(4===g)for(g=d.return;null!==g;){var k=g.tag;if(3===k||4===k)if(k=g.stateNode.containerInfo,k===e||8===k.nodeType&&k.parentNode===e)return;g=g.return}for(;null!==h;){g=Wc(h);if(null===g)return;k=g.tag;if(5===k||6===k){d=f=g;continue a}h=h.parentNode}}d=d.return}Jb(function(){var d=f,e=xb(c),g=[];\na:{var h=df.get(a);if(void 0!==h){var k=td,n=a;switch(a){case \"keypress\":if(0===od(c))break a;case \"keydown\":case \"keyup\":k=Rd;break;case \"focusin\":n=\"focus\";k=Fd;break;case \"focusout\":n=\"blur\";k=Fd;break;case \"beforeblur\":case \"afterblur\":k=Fd;break;case \"click\":if(2===c.button)break a;case \"auxclick\":case \"dblclick\":case \"mousedown\":case \"mousemove\":case \"mouseup\":case \"mouseout\":case \"mouseover\":case \"contextmenu\":k=Bd;break;case \"drag\":case \"dragend\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"dragstart\":case \"drop\":k=\nDd;break;case \"touchcancel\":case \"touchend\":case \"touchmove\":case \"touchstart\":k=Vd;break;case $e:case af:case bf:k=Hd;break;case cf:k=Xd;break;case \"scroll\":k=vd;break;case \"wheel\":k=Zd;break;case \"copy\":case \"cut\":case \"paste\":k=Jd;break;case \"gotpointercapture\":case \"lostpointercapture\":case \"pointercancel\":case \"pointerdown\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"pointerup\":k=Td}var t=0!==(b&4),J=!t&&\"scroll\"===a,x=t?null!==h?h+\"Capture\":null:h;t=[];for(var w=d,u;null!==\nw;){u=w;var F=u.stateNode;5===u.tag&&null!==F&&(u=F,null!==x&&(F=Kb(w,x),null!=F&&t.push(tf(w,F,u))));if(J)break;w=w.return}0<t.length&&(h=new k(h,n,null,c,e),g.push({event:h,listeners:t}))}}if(0===(b&7)){a:{h=\"mouseover\"===a||\"pointerover\"===a;k=\"mouseout\"===a||\"pointerout\"===a;if(h&&c!==wb&&(n=c.relatedTarget||c.fromElement)&&(Wc(n)||n[uf]))break a;if(k||h){h=e.window===e?e:(h=e.ownerDocument)?h.defaultView||h.parentWindow:window;if(k){if(n=c.relatedTarget||c.toElement,k=d,n=n?Wc(n):null,null!==\nn&&(J=Vb(n),n!==J||5!==n.tag&&6!==n.tag))n=null}else k=null,n=d;if(k!==n){t=Bd;F=\"onMouseLeave\";x=\"onMouseEnter\";w=\"mouse\";if(\"pointerout\"===a||\"pointerover\"===a)t=Td,F=\"onPointerLeave\",x=\"onPointerEnter\",w=\"pointer\";J=null==k?h:ue(k);u=null==n?h:ue(n);h=new t(F,w+\"leave\",k,c,e);h.target=J;h.relatedTarget=u;F=null;Wc(e)===d&&(t=new t(x,w+\"enter\",n,c,e),t.target=u,t.relatedTarget=J,F=t);J=F;if(k&&n)b:{t=k;x=n;w=0;for(u=t;u;u=vf(u))w++;u=0;for(F=x;F;F=vf(F))u++;for(;0<w-u;)t=vf(t),w--;for(;0<u-w;)x=\nvf(x),u--;for(;w--;){if(t===x||null!==x&&t===x.alternate)break b;t=vf(t);x=vf(x)}t=null}else t=null;null!==k&&wf(g,h,k,t,!1);null!==n&&null!==J&&wf(g,J,n,t,!0)}}}a:{h=d?ue(d):window;k=h.nodeName&&h.nodeName.toLowerCase();if(\"select\"===k||\"input\"===k&&\"file\"===h.type)var na=ve;else if(me(h))if(we)na=Fe;else{na=De;var xa=Ce}else(k=h.nodeName)&&\"input\"===k.toLowerCase()&&(\"checkbox\"===h.type||\"radio\"===h.type)&&(na=Ee);if(na&&(na=na(a,d))){ne(g,na,c,e);break a}xa&&xa(a,h,d);\"focusout\"===a&&(xa=h._wrapperState)&&\nxa.controlled&&\"number\"===h.type&&cb(h,\"number\",h.value)}xa=d?ue(d):window;switch(a){case \"focusin\":if(me(xa)||\"true\"===xa.contentEditable)Qe=xa,Re=d,Se=null;break;case \"focusout\":Se=Re=Qe=null;break;case \"mousedown\":Te=!0;break;case \"contextmenu\":case \"mouseup\":case \"dragend\":Te=!1;Ue(g,c,e);break;case \"selectionchange\":if(Pe)break;case \"keydown\":case \"keyup\":Ue(g,c,e)}var $a;if(ae)b:{switch(a){case \"compositionstart\":var ba=\"onCompositionStart\";break b;case \"compositionend\":ba=\"onCompositionEnd\";\nbreak b;case \"compositionupdate\":ba=\"onCompositionUpdate\";break b}ba=void 0}else ie?ge(a,c)&&(ba=\"onCompositionEnd\"):\"keydown\"===a&&229===c.keyCode&&(ba=\"onCompositionStart\");ba&&(de&&\"ko\"!==c.locale&&(ie||\"onCompositionStart\"!==ba?\"onCompositionEnd\"===ba&&ie&&($a=nd()):(kd=e,ld=\"value\"in kd?kd.value:kd.textContent,ie=!0)),xa=oe(d,ba),0<xa.length&&(ba=new Ld(ba,a,null,c,e),g.push({event:ba,listeners:xa}),$a?ba.data=$a:($a=he(c),null!==$a&&(ba.data=$a))));if($a=ce?je(a,c):ke(a,c))d=oe(d,\"onBeforeInput\"),\n0<d.length&&(e=new Ld(\"onBeforeInput\",\"beforeinput\",null,c,e),g.push({event:e,listeners:d}),e.data=$a)}se(g,b)})}function tf(a,b,c){return{instance:a,listener:b,currentTarget:c}}function oe(a,b){for(var c=b+\"Capture\",d=[];null!==a;){var e=a,f=e.stateNode;5===e.tag&&null!==f&&(e=f,f=Kb(a,c),null!=f&&d.unshift(tf(a,f,e)),f=Kb(a,b),null!=f&&d.push(tf(a,f,e)));a=a.return}return d}function vf(a){if(null===a)return null;do a=a.return;while(a&&5!==a.tag);return a?a:null}\nfunction wf(a,b,c,d,e){for(var f=b._reactName,g=[];null!==c&&c!==d;){var h=c,k=h.alternate,l=h.stateNode;if(null!==k&&k===d)break;5===h.tag&&null!==l&&(h=l,e?(k=Kb(c,f),null!=k&&g.unshift(tf(c,k,h))):e||(k=Kb(c,f),null!=k&&g.push(tf(c,k,h))));c=c.return}0!==g.length&&a.push({event:b,listeners:g})}var xf=/\\r\\n?/g,yf=/\\u0000|\\uFFFD/g;function zf(a){return(\"string\"===typeof a?a:\"\"+a).replace(xf,\"\\n\").replace(yf,\"\")}function Af(a,b,c){b=zf(b);if(zf(a)!==b&&c)throw Error(p(425));}function Bf(){}\nvar Cf=null,Df=null;function Ef(a,b){return\"textarea\"===a||\"noscript\"===a||\"string\"===typeof b.children||\"number\"===typeof b.children||\"object\"===typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}\nvar Ff=\"function\"===typeof setTimeout?setTimeout:void 0,Gf=\"function\"===typeof clearTimeout?clearTimeout:void 0,Hf=\"function\"===typeof Promise?Promise:void 0,Jf=\"function\"===typeof queueMicrotask?queueMicrotask:\"undefined\"!==typeof Hf?function(a){return Hf.resolve(null).then(a).catch(If)}:Ff;function If(a){setTimeout(function(){throw a;})}\nfunction Kf(a,b){var c=b,d=0;do{var e=c.nextSibling;a.removeChild(c);if(e&&8===e.nodeType)if(c=e.data,\"/$\"===c){if(0===d){a.removeChild(e);bd(b);return}d--}else\"$\"!==c&&\"$?\"!==c&&\"$!\"!==c||d++;c=e}while(c);bd(b)}function Lf(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break;if(8===b){b=a.data;if(\"$\"===b||\"$!\"===b||\"$?\"===b)break;if(\"/$\"===b)return null}}return a}\nfunction Mf(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(\"$\"===c||\"$!\"===c||\"$?\"===c){if(0===b)return a;b--}else\"/$\"===c&&b++}a=a.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of=\"__reactFiber$\"+Nf,Pf=\"__reactProps$\"+Nf,uf=\"__reactContainer$\"+Nf,of=\"__reactEvents$\"+Nf,Qf=\"__reactListeners$\"+Nf,Rf=\"__reactHandles$\"+Nf;\nfunction Wc(a){var b=a[Of];if(b)return b;for(var c=a.parentNode;c;){if(b=c[uf]||c[Of]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=Mf(a);null!==a;){if(c=a[Of])return c;a=Mf(a)}return b}a=c;c=a.parentNode}return null}function Cb(a){a=a[Of]||a[uf];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function ue(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(p(33));}function Db(a){return a[Pf]||null}var Sf=[],Tf=-1;function Uf(a){return{current:a}}\nfunction E(a){0>Tf||(a.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(a,b){Tf++;Sf[Tf]=a.current;a.current=b}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(a,b){var c=a.type.contextTypes;if(!c)return Vf;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}\nfunction Zf(a){a=a.childContextTypes;return null!==a&&void 0!==a}function $f(){E(Wf);E(H)}function ag(a,b,c){if(H.current!==Vf)throw Error(p(168));G(H,b);G(Wf,c)}function bg(a,b,c){var d=a.stateNode;b=b.childContextTypes;if(\"function\"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in b))throw Error(p(108,Ra(a)||\"Unknown\",e));return A({},c,d)}\nfunction cg(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Vf;Xf=H.current;G(H,a);G(Wf,Wf.current);return!0}function dg(a,b,c){var d=a.stateNode;if(!d)throw Error(p(169));c?(a=bg(a,b,Xf),d.__reactInternalMemoizedMergedChildContext=a,E(Wf),E(H),G(H,a)):E(Wf);G(Wf,c)}var eg=null,fg=!1,gg=!1;function hg(a){null===eg?eg=[a]:eg.push(a)}function ig(a){fg=!0;hg(a)}\nfunction jg(){if(!gg&&null!==eg){gg=!0;var a=0,b=C;try{var c=eg;for(C=1;a<c.length;a++){var d=c[a];do d=d(!0);while(null!==d)}eg=null;fg=!1}catch(e){throw null!==eg&&(eg=eg.slice(a+1)),ac(fc,jg),e;}finally{C=b,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg=\"\";function tg(a,b){kg[lg++]=ng;kg[lg++]=mg;mg=a;ng=b}\nfunction ug(a,b,c){og[pg++]=rg;og[pg++]=sg;og[pg++]=qg;qg=a;var d=rg;a=sg;var e=32-oc(d)-1;d&=~(1<<e);c+=1;var f=32-oc(b)+e;if(30<f){var g=e-e%5;f=(d&(1<<g)-1).toString(32);d>>=g;e-=g;rg=1<<32-oc(b)+e|c<<e|d;sg=f+a}else rg=1<<f|c<<e|d,sg=a}function vg(a){null!==a.return&&(tg(a,1),ug(a,1,0))}function wg(a){for(;a===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;a===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;\nfunction Ag(a,b){var c=Bg(5,null,null,0);c.elementType=\"DELETED\";c.stateNode=b;c.return=a;b=a.deletions;null===b?(a.deletions=[c],a.flags|=16):b.push(c)}\nfunction Cg(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,xg=a,yg=Lf(b.firstChild),!0):!1;case 6:return b=\"\"===a.pendingProps||3!==b.nodeType?null:b,null!==b?(a.stateNode=b,xg=a,yg=null,!0):!1;case 13:return b=8!==b.nodeType?null:b,null!==b?(c=null!==qg?{id:rg,overflow:sg}:null,a.memoizedState={dehydrated:b,treeContext:c,retryLane:1073741824},c=Bg(18,null,null,0),c.stateNode=b,c.return=a,a.child=c,xg=a,yg=\nnull,!0):!1;default:return!1}}function Dg(a){return 0!==(a.mode&1)&&0===(a.flags&128)}function Eg(a){if(I){var b=yg;if(b){var c=b;if(!Cg(a,b)){if(Dg(a))throw Error(p(418));b=Lf(c.nextSibling);var d=xg;b&&Cg(a,b)?Ag(d,c):(a.flags=a.flags&-4097|2,I=!1,xg=a)}}else{if(Dg(a))throw Error(p(418));a.flags=a.flags&-4097|2;I=!1;xg=a}}}function Fg(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;xg=a}\nfunction Gg(a){if(a!==xg)return!1;if(!I)return Fg(a),I=!0,!1;var b;(b=3!==a.tag)&&!(b=5!==a.tag)&&(b=a.type,b=\"head\"!==b&&\"body\"!==b&&!Ef(a.type,a.memoizedProps));if(b&&(b=yg)){if(Dg(a))throw Hg(),Error(p(418));for(;b;)Ag(a,b),b=Lf(b.nextSibling)}Fg(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(p(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(\"/$\"===c){if(0===b){yg=Lf(a.nextSibling);break a}b--}else\"$\"!==c&&\"$!\"!==c&&\"$?\"!==c||b++}a=a.nextSibling}yg=\nnull}}else yg=xg?Lf(a.stateNode.nextSibling):null;return!0}function Hg(){for(var a=yg;a;)a=Lf(a.nextSibling)}function Ig(){yg=xg=null;I=!1}function Jg(a){null===zg?zg=[a]:zg.push(a)}var Kg=ua.ReactCurrentBatchConfig;\nfunction Lg(a,b,c){a=c.ref;if(null!==a&&\"function\"!==typeof a&&\"object\"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(p(309));var d=c.stateNode}if(!d)throw Error(p(147,a));var e=d,f=\"\"+a;if(null!==b&&null!==b.ref&&\"function\"===typeof b.ref&&b.ref._stringRef===f)return b.ref;b=function(a){var b=e.refs;null===a?delete b[f]:b[f]=a};b._stringRef=f;return b}if(\"string\"!==typeof a)throw Error(p(284));if(!c._owner)throw Error(p(290,a));}return a}\nfunction Mg(a,b){a=Object.prototype.toString.call(b);throw Error(p(31,\"[object Object]\"===a?\"object with keys {\"+Object.keys(b).join(\", \")+\"}\":a));}function Ng(a){var b=a._init;return b(a._payload)}\nfunction Og(a){function b(b,c){if(a){var d=b.deletions;null===d?(b.deletions=[c],b.flags|=16):d.push(c)}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b){a=Pg(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return b.flags|=1048576,c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.flags|=2,c):d;b.flags|=2;return c}function g(b){a&&\nnull===b.alternate&&(b.flags|=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=Qg(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function k(a,b,c,d){var f=c.type;if(f===ya)return m(a,b,c.props.children,d,c.key);if(null!==b&&(b.elementType===f||\"object\"===typeof f&&null!==f&&f.$$typeof===Ha&&Ng(f)===b.type))return d=e(b,c.props),d.ref=Lg(a,b,c),d.return=a,d;d=Rg(c.type,c.key,c.props,null,a.mode,d);d.ref=Lg(a,b,c);d.return=a;return d}function l(a,b,c,d){if(null===b||4!==b.tag||\nb.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=Sg(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function m(a,b,c,d,f){if(null===b||7!==b.tag)return b=Tg(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function q(a,b,c){if(\"string\"===typeof b&&\"\"!==b||\"number\"===typeof b)return b=Qg(\"\"+b,a.mode,c),b.return=a,b;if(\"object\"===typeof b&&null!==b){switch(b.$$typeof){case va:return c=Rg(b.type,b.key,b.props,null,a.mode,c),\nc.ref=Lg(a,null,b),c.return=a,c;case wa:return b=Sg(b,a.mode,c),b.return=a,b;case Ha:var d=b._init;return q(a,d(b._payload),c)}if(eb(b)||Ka(b))return b=Tg(b,a.mode,c,null),b.return=a,b;Mg(a,b)}return null}function r(a,b,c,d){var e=null!==b?b.key:null;if(\"string\"===typeof c&&\"\"!==c||\"number\"===typeof c)return null!==e?null:h(a,b,\"\"+c,d);if(\"object\"===typeof c&&null!==c){switch(c.$$typeof){case va:return c.key===e?k(a,b,c,d):null;case wa:return c.key===e?l(a,b,c,d):null;case Ha:return e=c._init,r(a,\nb,e(c._payload),d)}if(eb(c)||Ka(c))return null!==e?null:m(a,b,c,d,null);Mg(a,c)}return null}function y(a,b,c,d,e){if(\"string\"===typeof d&&\"\"!==d||\"number\"===typeof d)return a=a.get(c)||null,h(b,a,\"\"+d,e);if(\"object\"===typeof d&&null!==d){switch(d.$$typeof){case va:return a=a.get(null===d.key?c:d.key)||null,k(b,a,d,e);case wa:return a=a.get(null===d.key?c:d.key)||null,l(b,a,d,e);case Ha:var f=d._init;return y(a,b,c,f(d._payload),e)}if(eb(d)||Ka(d))return a=a.get(c)||null,m(b,a,d,e,null);Mg(b,d)}return null}\nfunction n(e,g,h,k){for(var l=null,m=null,u=g,w=g=0,x=null;null!==u&&w<h.length;w++){u.index>w?(x=u,u=null):x=u.sibling;var n=r(e,u,h[w],k);if(null===n){null===u&&(u=x);break}a&&u&&null===n.alternate&&b(e,u);g=f(n,g,w);null===m?l=n:m.sibling=n;m=n;u=x}if(w===h.length)return c(e,u),I&&tg(e,w),l;if(null===u){for(;w<h.length;w++)u=q(e,h[w],k),null!==u&&(g=f(u,g,w),null===m?l=u:m.sibling=u,m=u);I&&tg(e,w);return l}for(u=d(e,u);w<h.length;w++)x=y(u,e,w,h[w],k),null!==x&&(a&&null!==x.alternate&&u.delete(null===\nx.key?w:x.key),g=f(x,g,w),null===m?l=x:m.sibling=x,m=x);a&&u.forEach(function(a){return b(e,a)});I&&tg(e,w);return l}function t(e,g,h,k){var l=Ka(h);if(\"function\"!==typeof l)throw Error(p(150));h=l.call(h);if(null==h)throw Error(p(151));for(var u=l=null,m=g,w=g=0,x=null,n=h.next();null!==m&&!n.done;w++,n=h.next()){m.index>w?(x=m,m=null):x=m.sibling;var t=r(e,m,n.value,k);if(null===t){null===m&&(m=x);break}a&&m&&null===t.alternate&&b(e,m);g=f(t,g,w);null===u?l=t:u.sibling=t;u=t;m=x}if(n.done)return c(e,\nm),I&&tg(e,w),l;if(null===m){for(;!n.done;w++,n=h.next())n=q(e,n.value,k),null!==n&&(g=f(n,g,w),null===u?l=n:u.sibling=n,u=n);I&&tg(e,w);return l}for(m=d(e,m);!n.done;w++,n=h.next())n=y(m,e,w,n.value,k),null!==n&&(a&&null!==n.alternate&&m.delete(null===n.key?w:n.key),g=f(n,g,w),null===u?l=n:u.sibling=n,u=n);a&&m.forEach(function(a){return b(e,a)});I&&tg(e,w);return l}function J(a,d,f,h){\"object\"===typeof f&&null!==f&&f.type===ya&&null===f.key&&(f=f.props.children);if(\"object\"===typeof f&&null!==f){switch(f.$$typeof){case va:a:{for(var k=\nf.key,l=d;null!==l;){if(l.key===k){k=f.type;if(k===ya){if(7===l.tag){c(a,l.sibling);d=e(l,f.props.children);d.return=a;a=d;break a}}else if(l.elementType===k||\"object\"===typeof k&&null!==k&&k.$$typeof===Ha&&Ng(k)===l.type){c(a,l.sibling);d=e(l,f.props);d.ref=Lg(a,l,f);d.return=a;a=d;break a}c(a,l);break}else b(a,l);l=l.sibling}f.type===ya?(d=Tg(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Rg(f.type,f.key,f.props,null,a.mode,h),h.ref=Lg(a,d,f),h.return=a,a=h)}return g(a);case wa:a:{for(l=f.key;null!==\nd;){if(d.key===l)if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=Sg(f,a.mode,h);d.return=a;a=d}return g(a);case Ha:return l=f._init,J(a,d,l(f._payload),h)}if(eb(f))return n(a,d,f,h);if(Ka(f))return t(a,d,f,h);Mg(a,f)}return\"string\"===typeof f&&\"\"!==f||\"number\"===typeof f?(f=\"\"+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):\n(c(a,d),d=Qg(f,a.mode,h),d.return=a,a=d),g(a)):c(a,d)}return J}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(a){var b=Wg.current;E(Wg);a._currentValue=b}function bh(a,b,c){for(;null!==a;){var d=a.alternate;(a.childLanes&b)!==b?(a.childLanes|=b,null!==d&&(d.childLanes|=b)):null!==d&&(d.childLanes&b)!==b&&(d.childLanes|=b);if(a===c)break;a=a.return}}\nfunction ch(a,b){Xg=a;Zg=Yg=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(0!==(a.lanes&b)&&(dh=!0),a.firstContext=null)}function eh(a){var b=a._currentValue;if(Zg!==a)if(a={context:a,memoizedValue:b,next:null},null===Yg){if(null===Xg)throw Error(p(308));Yg=a;Xg.dependencies={lanes:0,firstContext:a}}else Yg=Yg.next=a;return b}var fh=null;function gh(a){null===fh?fh=[a]:fh.push(a)}\nfunction hh(a,b,c,d){var e=b.interleaved;null===e?(c.next=c,gh(b)):(c.next=e.next,e.next=c);b.interleaved=c;return ih(a,d)}function ih(a,b){a.lanes|=b;var c=a.alternate;null!==c&&(c.lanes|=b);c=a;for(a=a.return;null!==a;)a.childLanes|=b,c=a.alternate,null!==c&&(c.childLanes|=b),c=a,a=a.return;return 3===c.tag?c.stateNode:null}var jh=!1;function kh(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}\nfunction lh(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function mh(a,b){return{eventTime:a,lane:b,tag:0,payload:null,callback:null,next:null}}\nfunction nh(a,b,c){var d=a.updateQueue;if(null===d)return null;d=d.shared;if(0!==(K&2)){var e=d.pending;null===e?b.next=b:(b.next=e.next,e.next=b);d.pending=b;return ih(a,c)}e=d.interleaved;null===e?(b.next=b,gh(d)):(b.next=e.next,e.next=b);d.interleaved=b;return ih(a,c)}function oh(a,b,c){b=b.updateQueue;if(null!==b&&(b=b.shared,0!==(c&4194240))){var d=b.lanes;d&=a.pendingLanes;c|=d;b.lanes=c;Cc(a,c)}}\nfunction ph(a,b){var c=a.updateQueue,d=a.alternate;if(null!==d&&(d=d.updateQueue,c===d)){var e=null,f=null;c=c.firstBaseUpdate;if(null!==c){do{var g={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};null===f?e=f=g:f=f.next=g;c=c.next}while(null!==c);null===f?e=f=b:f=f.next=b}else e=f=b;c={baseState:d.baseState,firstBaseUpdate:e,lastBaseUpdate:f,shared:d.shared,effects:d.effects};a.updateQueue=c;return}a=c.lastBaseUpdate;null===a?c.firstBaseUpdate=b:a.next=\nb;c.lastBaseUpdate=b}\nfunction qh(a,b,c,d){var e=a.updateQueue;jh=!1;var f=e.firstBaseUpdate,g=e.lastBaseUpdate,h=e.shared.pending;if(null!==h){e.shared.pending=null;var k=h,l=k.next;k.next=null;null===g?f=l:g.next=l;g=k;var m=a.alternate;null!==m&&(m=m.updateQueue,h=m.lastBaseUpdate,h!==g&&(null===h?m.firstBaseUpdate=l:h.next=l,m.lastBaseUpdate=k))}if(null!==f){var q=e.baseState;g=0;m=l=k=null;h=f;do{var r=h.lane,y=h.eventTime;if((d&r)===r){null!==m&&(m=m.next={eventTime:y,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,\nnext:null});a:{var n=a,t=h;r=b;y=c;switch(t.tag){case 1:n=t.payload;if(\"function\"===typeof n){q=n.call(y,q,r);break a}q=n;break a;case 3:n.flags=n.flags&-65537|128;case 0:n=t.payload;r=\"function\"===typeof n?n.call(y,q,r):n;if(null===r||void 0===r)break a;q=A({},q,r);break a;case 2:jh=!0}}null!==h.callback&&0!==h.lane&&(a.flags|=64,r=e.effects,null===r?e.effects=[h]:r.push(h))}else y={eventTime:y,lane:r,tag:h.tag,payload:h.payload,callback:h.callback,next:null},null===m?(l=m=y,k=q):m=m.next=y,g|=r;\nh=h.next;if(null===h)if(h=e.shared.pending,null===h)break;else r=h,h=r.next,r.next=null,e.lastBaseUpdate=r,e.shared.pending=null}while(1);null===m&&(k=q);e.baseState=k;e.firstBaseUpdate=l;e.lastBaseUpdate=m;b=e.shared.interleaved;if(null!==b){e=b;do g|=e.lane,e=e.next;while(e!==b)}else null===f&&(e.shared.lanes=0);rh|=g;a.lanes=g;a.memoizedState=q}}\nfunction sh(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=c;if(\"function\"!==typeof e)throw Error(p(191,e));e.call(d)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(a){if(a===th)throw Error(p(174));return a}\nfunction yh(a,b){G(wh,b);G(vh,a);G(uh,th);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:lb(null,\"\");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=lb(b,a)}E(uh);G(uh,b)}function zh(){E(uh);E(vh);E(wh)}function Ah(a){xh(wh.current);var b=xh(uh.current);var c=lb(b,a.type);b!==c&&(G(vh,a),G(uh,c))}function Bh(a){vh.current===a&&(E(uh),E(vh))}var L=Uf(0);\nfunction Ch(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||\"$?\"===c.data||\"$!\"===c.data))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.flags&128))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}var Dh=[];\nfunction Eh(){for(var a=0;a<Dh.length;a++)Dh[a]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321));}function Mh(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!He(a[c],b[c]))return!1;return!0}\nfunction Nh(a,b,c,d,e,f){Hh=f;M=b;b.memoizedState=null;b.updateQueue=null;b.lanes=0;Fh.current=null===a||null===a.memoizedState?Oh:Ph;a=c(d,e);if(Jh){f=0;do{Jh=!1;Kh=0;if(25<=f)throw Error(p(301));f+=1;O=N=null;b.updateQueue=null;Fh.current=Qh;a=c(d,e)}while(Jh)}Fh.current=Rh;b=null!==N&&null!==N.next;Hh=0;O=N=M=null;Ih=!1;if(b)throw Error(p(300));return a}function Sh(){var a=0!==Kh;Kh=0;return a}\nfunction Th(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===O?M.memoizedState=O=a:O=O.next=a;return O}function Uh(){if(null===N){var a=M.alternate;a=null!==a?a.memoizedState:null}else a=N.next;var b=null===O?M.memoizedState:O.next;if(null!==b)O=b,N=a;else{if(null===a)throw Error(p(310));N=a;a={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null};null===O?M.memoizedState=O=a:O=O.next=a}return O}\nfunction Vh(a,b){return\"function\"===typeof b?b(a):b}\nfunction Wh(a){var b=Uh(),c=b.queue;if(null===c)throw Error(p(311));c.lastRenderedReducer=a;var d=N,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){f=e.next;d=d.baseState;var h=g=null,k=null,l=f;do{var m=l.lane;if((Hh&m)===m)null!==k&&(k=k.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),d=l.hasEagerState?l.eagerState:a(d,l.action);else{var q={lane:m,action:l.action,hasEagerState:l.hasEagerState,\neagerState:l.eagerState,next:null};null===k?(h=k=q,g=d):k=k.next=q;M.lanes|=m;rh|=m}l=l.next}while(null!==l&&l!==f);null===k?g=d:k.next=h;He(d,b.memoizedState)||(dh=!0);b.memoizedState=d;b.baseState=g;b.baseQueue=k;c.lastRenderedState=d}a=c.interleaved;if(null!==a){e=a;do f=e.lane,M.lanes|=f,rh|=f,e=e.next;while(e!==a)}else null===e&&(c.lanes=0);return[b.memoizedState,c.dispatch]}\nfunction Xh(a){var b=Uh(),c=b.queue;if(null===c)throw Error(p(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);He(f,b.memoizedState)||(dh=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}function Yh(){}\nfunction Zh(a,b){var c=M,d=Uh(),e=b(),f=!He(d.memoizedState,e);f&&(d.memoizedState=e,dh=!0);d=d.queue;$h(ai.bind(null,c,d,a),[a]);if(d.getSnapshot!==b||f||null!==O&&O.memoizedState.tag&1){c.flags|=2048;bi(9,ci.bind(null,c,d,e,b),void 0,null);if(null===Q)throw Error(p(349));0!==(Hh&30)||di(c,b,e)}return e}function di(a,b,c){a.flags|=16384;a={getSnapshot:b,value:c};b=M.updateQueue;null===b?(b={lastEffect:null,stores:null},M.updateQueue=b,b.stores=[a]):(c=b.stores,null===c?b.stores=[a]:c.push(a))}\nfunction ci(a,b,c,d){b.value=c;b.getSnapshot=d;ei(b)&&fi(a)}function ai(a,b,c){return c(function(){ei(b)&&fi(a)})}function ei(a){var b=a.getSnapshot;a=a.value;try{var c=b();return!He(a,c)}catch(d){return!0}}function fi(a){var b=ih(a,1);null!==b&&gi(b,a,1,-1)}\nfunction hi(a){var b=Th();\"function\"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:a};b.queue=a;a=a.dispatch=ii.bind(null,M,a);return[b.memoizedState,a]}\nfunction bi(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=M.updateQueue;null===b?(b={lastEffect:null,stores:null},M.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}function ji(){return Uh().memoizedState}function ki(a,b,c,d){var e=Th();M.flags|=a;e.memoizedState=bi(1|b,c,void 0,void 0===d?null:d)}\nfunction li(a,b,c,d){var e=Uh();d=void 0===d?null:d;var f=void 0;if(null!==N){var g=N.memoizedState;f=g.destroy;if(null!==d&&Mh(d,g.deps)){e.memoizedState=bi(b,c,f,d);return}}M.flags|=a;e.memoizedState=bi(1|b,c,f,d)}function mi(a,b){return ki(8390656,8,a,b)}function $h(a,b){return li(2048,8,a,b)}function ni(a,b){return li(4,2,a,b)}function oi(a,b){return li(4,4,a,b)}\nfunction pi(a,b){if(\"function\"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function qi(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return li(4,4,pi.bind(null,b,a),c)}function ri(){}function si(a,b){var c=Uh();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&Mh(b,d[1]))return d[0];c.memoizedState=[a,b];return a}\nfunction ti(a,b){var c=Uh();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&Mh(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function ui(a,b,c){if(0===(Hh&21))return a.baseState&&(a.baseState=!1,dh=!0),a.memoizedState=c;He(c,b)||(c=yc(),M.lanes|=c,rh|=c,a.baseState=!0);return b}function vi(a,b){var c=C;C=0!==c&&4>c?c:4;a(!0);var d=Gh.transition;Gh.transition={};try{a(!1),b()}finally{C=c,Gh.transition=d}}function wi(){return Uh().memoizedState}\nfunction xi(a,b,c){var d=yi(a);c={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null};if(zi(a))Ai(b,c);else if(c=hh(a,b,c,d),null!==c){var e=R();gi(c,a,d,e);Bi(c,b,d)}}\nfunction ii(a,b,c){var d=yi(a),e={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null};if(zi(a))Ai(b,e);else{var f=a.alternate;if(0===a.lanes&&(null===f||0===f.lanes)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,h=f(g,c);e.hasEagerState=!0;e.eagerState=h;if(He(h,g)){var k=b.interleaved;null===k?(e.next=e,gh(b)):(e.next=k.next,k.next=e);b.interleaved=e;return}}catch(l){}finally{}c=hh(a,b,e,d);null!==c&&(e=R(),gi(c,a,d,e),Bi(c,b,d))}}\nfunction zi(a){var b=a.alternate;return a===M||null!==b&&b===M}function Ai(a,b){Jh=Ih=!0;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}function Bi(a,b,c){if(0!==(c&4194240)){var d=b.lanes;d&=a.pendingLanes;c|=d;b.lanes=c;Cc(a,c)}}\nvar Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(a,b){Th().memoizedState=[a,void 0===b?null:b];return a},useContext:eh,useEffect:mi,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return ki(4194308,\n4,pi.bind(null,b,a),c)},useLayoutEffect:function(a,b){return ki(4194308,4,a,b)},useInsertionEffect:function(a,b){return ki(4,2,a,b)},useMemo:function(a,b){var c=Th();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=Th();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};d.queue=a;a=a.dispatch=xi.bind(null,M,a);return[d.memoizedState,a]},useRef:function(a){var b=\nTh();a={current:a};return b.memoizedState=a},useState:hi,useDebugValue:ri,useDeferredValue:function(a){return Th().memoizedState=a},useTransition:function(){var a=hi(!1),b=a[0];a=vi.bind(null,a[1]);Th().memoizedState=a;return[b,a]},useMutableSource:function(){},useSyncExternalStore:function(a,b,c){var d=M,e=Th();if(I){if(void 0===c)throw Error(p(407));c=c()}else{c=b();if(null===Q)throw Error(p(349));0!==(Hh&30)||di(d,b,c)}e.memoizedState=c;var f={value:c,getSnapshot:b};e.queue=f;mi(ai.bind(null,d,\nf,a),[a]);d.flags|=2048;bi(9,ci.bind(null,d,f,c,b),void 0,null);return c},useId:function(){var a=Th(),b=Q.identifierPrefix;if(I){var c=sg;var d=rg;c=(d&~(1<<32-oc(d)-1)).toString(32)+c;b=\":\"+b+\"R\"+c;c=Kh++;0<c&&(b+=\"H\"+c.toString(32));b+=\":\"}else c=Lh++,b=\":\"+b+\"r\"+c.toString(32)+\":\";return a.memoizedState=b},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},\nuseDebugValue:ri,useDeferredValue:function(a){var b=Uh();return ui(b,N.memoizedState,a)},useTransition:function(){var a=Wh(Vh)[0],b=Uh().memoizedState;return[a,b]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(a){var b=Uh();return null===\nN?b.memoizedState=a:ui(b,N.memoizedState,a)},useTransition:function(){var a=Xh(Vh)[0],b=Uh().memoizedState;return[a,b]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(a,b){if(a&&a.defaultProps){b=A({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c]);return b}return b}function Di(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:A({},b,c);a.memoizedState=c;0===a.lanes&&(a.updateQueue.baseState=c)}\nvar Ei={isMounted:function(a){return(a=a._reactInternals)?Vb(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternals;var d=R(),e=yi(a),f=mh(d,e);f.payload=b;void 0!==c&&null!==c&&(f.callback=c);b=nh(a,f,e);null!==b&&(gi(b,a,e,d),oh(b,a,e))},enqueueReplaceState:function(a,b,c){a=a._reactInternals;var d=R(),e=yi(a),f=mh(d,e);f.tag=1;f.payload=b;void 0!==c&&null!==c&&(f.callback=c);b=nh(a,f,e);null!==b&&(gi(b,a,e,d),oh(b,a,e))},enqueueForceUpdate:function(a,b){a=a._reactInternals;var c=R(),d=\nyi(a),e=mh(c,d);e.tag=2;void 0!==b&&null!==b&&(e.callback=b);b=nh(a,e,d);null!==b&&(gi(b,a,d,c),oh(b,a,d))}};function Fi(a,b,c,d,e,f,g){a=a.stateNode;return\"function\"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,f,g):b.prototype&&b.prototype.isPureReactComponent?!Ie(c,d)||!Ie(e,f):!0}\nfunction Gi(a,b,c){var d=!1,e=Vf;var f=b.contextType;\"object\"===typeof f&&null!==f?f=eh(f):(e=Zf(b)?Xf:H.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?Yf(a,e):Vf);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Ei;a.stateNode=b;b._reactInternals=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}\nfunction Hi(a,b,c,d){a=b.state;\"function\"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);\"function\"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Ei.enqueueReplaceState(b,b.state,null)}\nfunction Ii(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs={};kh(a);var f=b.contextType;\"object\"===typeof f&&null!==f?e.context=eh(f):(f=Zf(b)?Xf:H.current,e.context=Yf(a,f));e.state=a.memoizedState;f=b.getDerivedStateFromProps;\"function\"===typeof f&&(Di(a,b,f,c),e.state=a.memoizedState);\"function\"===typeof b.getDerivedStateFromProps||\"function\"===typeof e.getSnapshotBeforeUpdate||\"function\"!==typeof e.UNSAFE_componentWillMount&&\"function\"!==typeof e.componentWillMount||(b=e.state,\n\"function\"===typeof e.componentWillMount&&e.componentWillMount(),\"function\"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Ei.enqueueReplaceState(e,e.state,null),qh(a,c,e,d),e.state=a.memoizedState);\"function\"===typeof e.componentDidMount&&(a.flags|=4194308)}function Ji(a,b){try{var c=\"\",d=b;do c+=Pa(d),d=d.return;while(d);var e=c}catch(f){e=\"\\nError generating stack: \"+f.message+\"\\n\"+f.stack}return{value:a,source:b,stack:e,digest:null}}\nfunction Ki(a,b,c){return{value:a,source:null,stack:null!=c?c:null,digest:null!=b?b:null}}function Li(a,b){try{console.error(b.value)}catch(c){setTimeout(function(){throw c;})}}var Mi=\"function\"===typeof WeakMap?WeakMap:Map;function Ni(a,b,c){c=mh(-1,c);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){Oi||(Oi=!0,Pi=d);Li(a,b)};return c}\nfunction Qi(a,b,c){c=mh(-1,c);c.tag=3;var d=a.type.getDerivedStateFromError;if(\"function\"===typeof d){var e=b.value;c.payload=function(){return d(e)};c.callback=function(){Li(a,b)}}var f=a.stateNode;null!==f&&\"function\"===typeof f.componentDidCatch&&(c.callback=function(){Li(a,b);\"function\"!==typeof d&&(null===Ri?Ri=new Set([this]):Ri.add(this));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:\"\"})});return c}\nfunction Si(a,b,c){var d=a.pingCache;if(null===d){d=a.pingCache=new Mi;var e=new Set;d.set(b,e)}else e=d.get(b),void 0===e&&(e=new Set,d.set(b,e));e.has(c)||(e.add(c),a=Ti.bind(null,a,b,c),b.then(a,a))}function Ui(a){do{var b;if(b=13===a.tag)b=a.memoizedState,b=null!==b?null!==b.dehydrated?!0:!1:!0;if(b)return a;a=a.return}while(null!==a);return null}\nfunction Vi(a,b,c,d,e){if(0===(a.mode&1))return a===b?a.flags|=65536:(a.flags|=128,c.flags|=131072,c.flags&=-52805,1===c.tag&&(null===c.alternate?c.tag=17:(b=mh(-1,1),b.tag=2,nh(c,b,1))),c.lanes|=1),a;a.flags|=65536;a.lanes=e;return a}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(a,b,c,d){b.child=null===a?Vg(b,null,c,d):Ug(b,a.child,c,d)}\nfunction Yi(a,b,c,d,e){c=c.render;var f=b.ref;ch(b,e);d=Nh(a,b,c,d,f,e);c=Sh();if(null!==a&&!dh)return b.updateQueue=a.updateQueue,b.flags&=-2053,a.lanes&=~e,Zi(a,b,e);I&&c&&vg(b);b.flags|=1;Xi(a,b,d,e);return b.child}\nfunction $i(a,b,c,d,e){if(null===a){var f=c.type;if(\"function\"===typeof f&&!aj(f)&&void 0===f.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=f,bj(a,b,f,d,e);a=Rg(c.type,null,d,b,b.mode,e);a.ref=b.ref;a.return=b;return b.child=a}f=a.child;if(0===(a.lanes&e)){var g=f.memoizedProps;c=c.compare;c=null!==c?c:Ie;if(c(g,d)&&a.ref===b.ref)return Zi(a,b,e)}b.flags|=1;a=Pg(f,d);a.ref=b.ref;a.return=b;return b.child=a}\nfunction bj(a,b,c,d,e){if(null!==a){var f=a.memoizedProps;if(Ie(f,d)&&a.ref===b.ref)if(dh=!1,b.pendingProps=d=f,0!==(a.lanes&e))0!==(a.flags&131072)&&(dh=!0);else return b.lanes=a.lanes,Zi(a,b,e)}return cj(a,b,c,d,e)}\nfunction dj(a,b,c){var d=b.pendingProps,e=d.children,f=null!==a?a.memoizedState:null;if(\"hidden\"===d.mode)if(0===(b.mode&1))b.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=c;else{if(0===(c&1073741824))return a=null!==f?f.baseLanes|c:c,b.lanes=b.childLanes=1073741824,b.memoizedState={baseLanes:a,cachePool:null,transitions:null},b.updateQueue=null,G(ej,fj),fj|=a,null;b.memoizedState={baseLanes:0,cachePool:null,transitions:null};d=null!==f?f.baseLanes:c;G(ej,fj);fj|=d}else null!==\nf?(d=f.baseLanes|c,b.memoizedState=null):d=c,G(ej,fj),fj|=d;Xi(a,b,e,c);return b.child}function gj(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.flags|=512,b.flags|=2097152}function cj(a,b,c,d,e){var f=Zf(c)?Xf:H.current;f=Yf(b,f);ch(b,e);c=Nh(a,b,c,d,f,e);d=Sh();if(null!==a&&!dh)return b.updateQueue=a.updateQueue,b.flags&=-2053,a.lanes&=~e,Zi(a,b,e);I&&d&&vg(b);b.flags|=1;Xi(a,b,c,e);return b.child}\nfunction hj(a,b,c,d,e){if(Zf(c)){var f=!0;cg(b)}else f=!1;ch(b,e);if(null===b.stateNode)ij(a,b),Gi(b,c,d),Ii(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var k=g.context,l=c.contextType;\"object\"===typeof l&&null!==l?l=eh(l):(l=Zf(c)?Xf:H.current,l=Yf(b,l));var m=c.getDerivedStateFromProps,q=\"function\"===typeof m||\"function\"===typeof g.getSnapshotBeforeUpdate;q||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||\n(h!==d||k!==l)&&Hi(b,g,d,l);jh=!1;var r=b.memoizedState;g.state=r;qh(b,d,g,e);k=b.memoizedState;h!==d||r!==k||Wf.current||jh?(\"function\"===typeof m&&(Di(b,c,m,d),k=b.memoizedState),(h=jh||Fi(b,c,h,d,r,k,l))?(q||\"function\"!==typeof g.UNSAFE_componentWillMount&&\"function\"!==typeof g.componentWillMount||(\"function\"===typeof g.componentWillMount&&g.componentWillMount(),\"function\"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),\"function\"===typeof g.componentDidMount&&(b.flags|=4194308)):\n(\"function\"===typeof g.componentDidMount&&(b.flags|=4194308),b.memoizedProps=d,b.memoizedState=k),g.props=d,g.state=k,g.context=l,d=h):(\"function\"===typeof g.componentDidMount&&(b.flags|=4194308),d=!1)}else{g=b.stateNode;lh(a,b);h=b.memoizedProps;l=b.type===b.elementType?h:Ci(b.type,h);g.props=l;q=b.pendingProps;r=g.context;k=c.contextType;\"object\"===typeof k&&null!==k?k=eh(k):(k=Zf(c)?Xf:H.current,k=Yf(b,k));var y=c.getDerivedStateFromProps;(m=\"function\"===typeof y||\"function\"===typeof g.getSnapshotBeforeUpdate)||\n\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||(h!==q||r!==k)&&Hi(b,g,d,k);jh=!1;r=b.memoizedState;g.state=r;qh(b,d,g,e);var n=b.memoizedState;h!==q||r!==n||Wf.current||jh?(\"function\"===typeof y&&(Di(b,c,y,d),n=b.memoizedState),(l=jh||Fi(b,c,l,d,r,n,k)||!1)?(m||\"function\"!==typeof g.UNSAFE_componentWillUpdate&&\"function\"!==typeof g.componentWillUpdate||(\"function\"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,n,k),\"function\"===typeof g.UNSAFE_componentWillUpdate&&\ng.UNSAFE_componentWillUpdate(d,n,k)),\"function\"===typeof g.componentDidUpdate&&(b.flags|=4),\"function\"===typeof g.getSnapshotBeforeUpdate&&(b.flags|=1024)):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=1024),b.memoizedProps=d,b.memoizedState=n),g.props=d,g.state=n,g.context=k,d=l):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&r===\na.memoizedState||(b.flags|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=1024),d=!1)}return jj(a,b,c,d,f,e)}\nfunction jj(a,b,c,d,e,f){gj(a,b);var g=0!==(b.flags&128);if(!d&&!g)return e&&dg(b,c,!1),Zi(a,b,f);d=b.stateNode;Wi.current=b;var h=g&&\"function\"!==typeof c.getDerivedStateFromError?null:d.render();b.flags|=1;null!==a&&g?(b.child=Ug(b,a.child,null,f),b.child=Ug(b,null,h,f)):Xi(a,b,h,f);b.memoizedState=d.state;e&&dg(b,c,!0);return b.child}function kj(a){var b=a.stateNode;b.pendingContext?ag(a,b.pendingContext,b.pendingContext!==b.context):b.context&&ag(a,b.context,!1);yh(a,b.containerInfo)}\nfunction lj(a,b,c,d,e){Ig();Jg(e);b.flags|=256;Xi(a,b,c,d);return b.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(a){return{baseLanes:a,cachePool:null,transitions:null}}\nfunction oj(a,b,c){var d=b.pendingProps,e=L.current,f=!1,g=0!==(b.flags&128),h;(h=g)||(h=null!==a&&null===a.memoizedState?!1:0!==(e&2));if(h)f=!0,b.flags&=-129;else if(null===a||null!==a.memoizedState)e|=1;G(L,e&1);if(null===a){Eg(b);a=b.memoizedState;if(null!==a&&(a=a.dehydrated,null!==a))return 0===(b.mode&1)?b.lanes=1:\"$!\"===a.data?b.lanes=8:b.lanes=1073741824,null;g=d.children;a=d.fallback;return f?(d=b.mode,f=b.child,g={mode:\"hidden\",children:g},0===(d&1)&&null!==f?(f.childLanes=0,f.pendingProps=\ng):f=pj(g,d,0,null),a=Tg(a,d,c,null),f.return=b,a.return=b,f.sibling=a,b.child=f,b.child.memoizedState=nj(c),b.memoizedState=mj,a):qj(b,g)}e=a.memoizedState;if(null!==e&&(h=e.dehydrated,null!==h))return rj(a,b,g,d,h,e,c);if(f){f=d.fallback;g=b.mode;e=a.child;h=e.sibling;var k={mode:\"hidden\",children:d.children};0===(g&1)&&b.child!==e?(d=b.child,d.childLanes=0,d.pendingProps=k,b.deletions=null):(d=Pg(e,k),d.subtreeFlags=e.subtreeFlags&14680064);null!==h?f=Pg(h,f):(f=Tg(f,g,c,null),f.flags|=2);f.return=\nb;d.return=b;d.sibling=f;b.child=d;d=f;f=b.child;g=a.child.memoizedState;g=null===g?nj(c):{baseLanes:g.baseLanes|c,cachePool:null,transitions:g.transitions};f.memoizedState=g;f.childLanes=a.childLanes&~c;b.memoizedState=mj;return d}f=a.child;a=f.sibling;d=Pg(f,{mode:\"visible\",children:d.children});0===(b.mode&1)&&(d.lanes=c);d.return=b;d.sibling=null;null!==a&&(c=b.deletions,null===c?(b.deletions=[a],b.flags|=16):c.push(a));b.child=d;b.memoizedState=null;return d}\nfunction qj(a,b){b=pj({mode:\"visible\",children:b},a.mode,0,null);b.return=a;return a.child=b}function sj(a,b,c,d){null!==d&&Jg(d);Ug(b,a.child,null,c);a=qj(b,b.pendingProps.children);a.flags|=2;b.memoizedState=null;return a}\nfunction rj(a,b,c,d,e,f,g){if(c){if(b.flags&256)return b.flags&=-257,d=Ki(Error(p(422))),sj(a,b,g,d);if(null!==b.memoizedState)return b.child=a.child,b.flags|=128,null;f=d.fallback;e=b.mode;d=pj({mode:\"visible\",children:d.children},e,0,null);f=Tg(f,e,g,null);f.flags|=2;d.return=b;f.return=b;d.sibling=f;b.child=d;0!==(b.mode&1)&&Ug(b,a.child,null,g);b.child.memoizedState=nj(g);b.memoizedState=mj;return f}if(0===(b.mode&1))return sj(a,b,g,null);if(\"$!\"===e.data){d=e.nextSibling&&e.nextSibling.dataset;\nif(d)var h=d.dgst;d=h;f=Error(p(419));d=Ki(f,d,void 0);return sj(a,b,g,d)}h=0!==(g&a.childLanes);if(dh||h){d=Q;if(null!==d){switch(g&-g){case 4:e=2;break;case 16:e=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:e=32;break;case 536870912:e=268435456;break;default:e=0}e=0!==(e&(d.suspendedLanes|g))?0:e;\n0!==e&&e!==f.retryLane&&(f.retryLane=e,ih(a,e),gi(d,a,e,-1))}tj();d=Ki(Error(p(421)));return sj(a,b,g,d)}if(\"$?\"===e.data)return b.flags|=128,b.child=a.child,b=uj.bind(null,a),e._reactRetry=b,null;a=f.treeContext;yg=Lf(e.nextSibling);xg=b;I=!0;zg=null;null!==a&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=a.id,sg=a.overflow,qg=b);b=qj(b,d.children);b.flags|=4096;return b}function vj(a,b,c){a.lanes|=b;var d=a.alternate;null!==d&&(d.lanes|=b);bh(a.return,b,c)}\nfunction wj(a,b,c,d,e){var f=a.memoizedState;null===f?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:e}:(f.isBackwards=b,f.rendering=null,f.renderingStartTime=0,f.last=d,f.tail=c,f.tailMode=e)}\nfunction xj(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;Xi(a,b,d.children,c);d=L.current;if(0!==(d&2))d=d&1|2,b.flags|=128;else{if(null!==a&&0!==(a.flags&128))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&vj(a,c,b);else if(19===a.tag)vj(a,c,b);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}G(L,d);if(0===(b.mode&1))b.memoizedState=\nnull;else switch(e){case \"forwards\":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===Ch(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);wj(b,!1,e,c,f);break;case \"backwards\":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===Ch(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}wj(b,!0,c,null,f);break;case \"together\":wj(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}\nfunction ij(a,b){0===(b.mode&1)&&null!==a&&(a.alternate=null,b.alternate=null,b.flags|=2)}function Zi(a,b,c){null!==a&&(b.dependencies=a.dependencies);rh|=b.lanes;if(0===(c&b.childLanes))return null;if(null!==a&&b.child!==a.child)throw Error(p(153));if(null!==b.child){a=b.child;c=Pg(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Pg(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}\nfunction yj(a,b,c){switch(b.tag){case 3:kj(b);Ig();break;case 5:Ah(b);break;case 1:Zf(b.type)&&cg(b);break;case 4:yh(b,b.stateNode.containerInfo);break;case 10:var d=b.type._context,e=b.memoizedProps.value;G(Wg,d._currentValue);d._currentValue=e;break;case 13:d=b.memoizedState;if(null!==d){if(null!==d.dehydrated)return G(L,L.current&1),b.flags|=128,null;if(0!==(c&b.child.childLanes))return oj(a,b,c);G(L,L.current&1);a=Zi(a,b,c);return null!==a?a.sibling:null}G(L,L.current&1);break;case 19:d=0!==(c&\nb.childLanes);if(0!==(a.flags&128)){if(d)return xj(a,b,c);b.flags|=128}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null,e.lastEffect=null);G(L,L.current);if(d)break;else return null;case 22:case 23:return b.lanes=0,dj(a,b,c)}return Zi(a,b,c)}var zj,Aj,Bj,Cj;\nzj=function(a,b){for(var c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};Aj=function(){};\nBj=function(a,b,c,d){var e=a.memoizedProps;if(e!==d){a=b.stateNode;xh(uh.current);var f=null;switch(c){case \"input\":e=Ya(a,e);d=Ya(a,d);f=[];break;case \"select\":e=A({},e,{value:void 0});d=A({},d,{value:void 0});f=[];break;case \"textarea\":e=gb(a,e);d=gb(a,d);f=[];break;default:\"function\"!==typeof e.onClick&&\"function\"===typeof d.onClick&&(a.onclick=Bf)}ub(c,d);var g;c=null;for(l in e)if(!d.hasOwnProperty(l)&&e.hasOwnProperty(l)&&null!=e[l])if(\"style\"===l){var h=e[l];for(g in h)h.hasOwnProperty(g)&&\n(c||(c={}),c[g]=\"\")}else\"dangerouslySetInnerHTML\"!==l&&\"children\"!==l&&\"suppressContentEditableWarning\"!==l&&\"suppressHydrationWarning\"!==l&&\"autoFocus\"!==l&&(ea.hasOwnProperty(l)?f||(f=[]):(f=f||[]).push(l,null));for(l in d){var k=d[l];h=null!=e?e[l]:void 0;if(d.hasOwnProperty(l)&&k!==h&&(null!=k||null!=h))if(\"style\"===l)if(h){for(g in h)!h.hasOwnProperty(g)||k&&k.hasOwnProperty(g)||(c||(c={}),c[g]=\"\");for(g in k)k.hasOwnProperty(g)&&h[g]!==k[g]&&(c||(c={}),c[g]=k[g])}else c||(f||(f=[]),f.push(l,\nc)),c=k;else\"dangerouslySetInnerHTML\"===l?(k=k?k.__html:void 0,h=h?h.__html:void 0,null!=k&&h!==k&&(f=f||[]).push(l,k)):\"children\"===l?\"string\"!==typeof k&&\"number\"!==typeof k||(f=f||[]).push(l,\"\"+k):\"suppressContentEditableWarning\"!==l&&\"suppressHydrationWarning\"!==l&&(ea.hasOwnProperty(l)?(null!=k&&\"onScroll\"===l&&D(\"scroll\",a),f||h===k||(f=[])):(f=f||[]).push(l,k))}c&&(f=f||[]).push(\"style\",c);var l=f;if(b.updateQueue=l)b.flags|=4}};Cj=function(a,b,c,d){c!==d&&(b.flags|=4)};\nfunction Dj(a,b){if(!I)switch(a.tailMode){case \"hidden\":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case \"collapsed\":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}\nfunction S(a){var b=null!==a.alternate&&a.alternate.child===a.child,c=0,d=0;if(b)for(var e=a.child;null!==e;)c|=e.lanes|e.childLanes,d|=e.subtreeFlags&14680064,d|=e.flags&14680064,e.return=a,e=e.sibling;else for(e=a.child;null!==e;)c|=e.lanes|e.childLanes,d|=e.subtreeFlags,d|=e.flags,e.return=a,e=e.sibling;a.subtreeFlags|=d;a.childLanes=c;return b}\nfunction Ej(a,b,c){var d=b.pendingProps;wg(b);switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(b),null;case 1:return Zf(b.type)&&$f(),S(b),null;case 3:d=b.stateNode;zh();E(Wf);E(H);Eh();d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null);if(null===a||null===a.child)Gg(b)?b.flags|=4:null===a||a.memoizedState.isDehydrated&&0===(b.flags&256)||(b.flags|=1024,null!==zg&&(Fj(zg),zg=null));Aj(a,b);S(b);return null;case 5:Bh(b);var e=xh(wh.current);\nc=b.type;if(null!==a&&null!=b.stateNode)Bj(a,b,c,d,e),a.ref!==b.ref&&(b.flags|=512,b.flags|=2097152);else{if(!d){if(null===b.stateNode)throw Error(p(166));S(b);return null}a=xh(uh.current);if(Gg(b)){d=b.stateNode;c=b.type;var f=b.memoizedProps;d[Of]=b;d[Pf]=f;a=0!==(b.mode&1);switch(c){case \"dialog\":D(\"cancel\",d);D(\"close\",d);break;case \"iframe\":case \"object\":case \"embed\":D(\"load\",d);break;case \"video\":case \"audio\":for(e=0;e<lf.length;e++)D(lf[e],d);break;case \"source\":D(\"error\",d);break;case \"img\":case \"image\":case \"link\":D(\"error\",\nd);D(\"load\",d);break;case \"details\":D(\"toggle\",d);break;case \"input\":Za(d,f);D(\"invalid\",d);break;case \"select\":d._wrapperState={wasMultiple:!!f.multiple};D(\"invalid\",d);break;case \"textarea\":hb(d,f),D(\"invalid\",d)}ub(c,f);e=null;for(var g in f)if(f.hasOwnProperty(g)){var h=f[g];\"children\"===g?\"string\"===typeof h?d.textContent!==h&&(!0!==f.suppressHydrationWarning&&Af(d.textContent,h,a),e=[\"children\",h]):\"number\"===typeof h&&d.textContent!==\"\"+h&&(!0!==f.suppressHydrationWarning&&Af(d.textContent,\nh,a),e=[\"children\",\"\"+h]):ea.hasOwnProperty(g)&&null!=h&&\"onScroll\"===g&&D(\"scroll\",d)}switch(c){case \"input\":Va(d);db(d,f,!0);break;case \"textarea\":Va(d);jb(d);break;case \"select\":case \"option\":break;default:\"function\"===typeof f.onClick&&(d.onclick=Bf)}d=e;b.updateQueue=d;null!==d&&(b.flags|=4)}else{g=9===e.nodeType?e:e.ownerDocument;\"http://www.w3.org/1999/xhtml\"===a&&(a=kb(c));\"http://www.w3.org/1999/xhtml\"===a?\"script\"===c?(a=g.createElement(\"div\"),a.innerHTML=\"<script>\\x3c/script>\",a=a.removeChild(a.firstChild)):\n\"string\"===typeof d.is?a=g.createElement(c,{is:d.is}):(a=g.createElement(c),\"select\"===c&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,c);a[Of]=b;a[Pf]=d;zj(a,b,!1,!1);b.stateNode=a;a:{g=vb(c,d);switch(c){case \"dialog\":D(\"cancel\",a);D(\"close\",a);e=d;break;case \"iframe\":case \"object\":case \"embed\":D(\"load\",a);e=d;break;case \"video\":case \"audio\":for(e=0;e<lf.length;e++)D(lf[e],a);e=d;break;case \"source\":D(\"error\",a);e=d;break;case \"img\":case \"image\":case \"link\":D(\"error\",\na);D(\"load\",a);e=d;break;case \"details\":D(\"toggle\",a);e=d;break;case \"input\":Za(a,d);e=Ya(a,d);D(\"invalid\",a);break;case \"option\":e=d;break;case \"select\":a._wrapperState={wasMultiple:!!d.multiple};e=A({},d,{value:void 0});D(\"invalid\",a);break;case \"textarea\":hb(a,d);e=gb(a,d);D(\"invalid\",a);break;default:e=d}ub(c,e);h=e;for(f in h)if(h.hasOwnProperty(f)){var k=h[f];\"style\"===f?sb(a,k):\"dangerouslySetInnerHTML\"===f?(k=k?k.__html:void 0,null!=k&&nb(a,k)):\"children\"===f?\"string\"===typeof k?(\"textarea\"!==\nc||\"\"!==k)&&ob(a,k):\"number\"===typeof k&&ob(a,\"\"+k):\"suppressContentEditableWarning\"!==f&&\"suppressHydrationWarning\"!==f&&\"autoFocus\"!==f&&(ea.hasOwnProperty(f)?null!=k&&\"onScroll\"===f&&D(\"scroll\",a):null!=k&&ta(a,f,k,g))}switch(c){case \"input\":Va(a);db(a,d,!1);break;case \"textarea\":Va(a);jb(a);break;case \"option\":null!=d.value&&a.setAttribute(\"value\",\"\"+Sa(d.value));break;case \"select\":a.multiple=!!d.multiple;f=d.value;null!=f?fb(a,!!d.multiple,f,!1):null!=d.defaultValue&&fb(a,!!d.multiple,d.defaultValue,\n!0);break;default:\"function\"===typeof e.onClick&&(a.onclick=Bf)}switch(c){case \"button\":case \"input\":case \"select\":case \"textarea\":d=!!d.autoFocus;break a;case \"img\":d=!0;break a;default:d=!1}}d&&(b.flags|=4)}null!==b.ref&&(b.flags|=512,b.flags|=2097152)}S(b);return null;case 6:if(a&&null!=b.stateNode)Cj(a,b,a.memoizedProps,d);else{if(\"string\"!==typeof d&&null===b.stateNode)throw Error(p(166));c=xh(wh.current);xh(uh.current);if(Gg(b)){d=b.stateNode;c=b.memoizedProps;d[Of]=b;if(f=d.nodeValue!==c)if(a=\nxg,null!==a)switch(a.tag){case 3:Af(d.nodeValue,c,0!==(a.mode&1));break;case 5:!0!==a.memoizedProps.suppressHydrationWarning&&Af(d.nodeValue,c,0!==(a.mode&1))}f&&(b.flags|=4)}else d=(9===c.nodeType?c:c.ownerDocument).createTextNode(d),d[Of]=b,b.stateNode=d}S(b);return null;case 13:E(L);d=b.memoizedState;if(null===a||null!==a.memoizedState&&null!==a.memoizedState.dehydrated){if(I&&null!==yg&&0!==(b.mode&1)&&0===(b.flags&128))Hg(),Ig(),b.flags|=98560,f=!1;else if(f=Gg(b),null!==d&&null!==d.dehydrated){if(null===\na){if(!f)throw Error(p(318));f=b.memoizedState;f=null!==f?f.dehydrated:null;if(!f)throw Error(p(317));f[Of]=b}else Ig(),0===(b.flags&128)&&(b.memoizedState=null),b.flags|=4;S(b);f=!1}else null!==zg&&(Fj(zg),zg=null),f=!0;if(!f)return b.flags&65536?b:null}if(0!==(b.flags&128))return b.lanes=c,b;d=null!==d;d!==(null!==a&&null!==a.memoizedState)&&d&&(b.child.flags|=8192,0!==(b.mode&1)&&(null===a||0!==(L.current&1)?0===T&&(T=3):tj()));null!==b.updateQueue&&(b.flags|=4);S(b);return null;case 4:return zh(),\nAj(a,b),null===a&&sf(b.stateNode.containerInfo),S(b),null;case 10:return ah(b.type._context),S(b),null;case 17:return Zf(b.type)&&$f(),S(b),null;case 19:E(L);f=b.memoizedState;if(null===f)return S(b),null;d=0!==(b.flags&128);g=f.rendering;if(null===g)if(d)Dj(f,!1);else{if(0!==T||null!==a&&0!==(a.flags&128))for(a=b.child;null!==a;){g=Ch(a);if(null!==g){b.flags|=128;Dj(f,!1);d=g.updateQueue;null!==d&&(b.updateQueue=d,b.flags|=4);b.subtreeFlags=0;d=c;for(c=b.child;null!==c;)f=c,a=d,f.flags&=14680066,\ng=f.alternate,null===g?(f.childLanes=0,f.lanes=a,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=g.childLanes,f.lanes=g.lanes,f.child=g.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=g.memoizedProps,f.memoizedState=g.memoizedState,f.updateQueue=g.updateQueue,f.type=g.type,a=g.dependencies,f.dependencies=null===a?null:{lanes:a.lanes,firstContext:a.firstContext}),c=c.sibling;G(L,L.current&1|2);return b.child}a=\na.sibling}null!==f.tail&&B()>Gj&&(b.flags|=128,d=!0,Dj(f,!1),b.lanes=4194304)}else{if(!d)if(a=Ch(g),null!==a){if(b.flags|=128,d=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.flags|=4),Dj(f,!0),null===f.tail&&\"hidden\"===f.tailMode&&!g.alternate&&!I)return S(b),null}else 2*B()-f.renderingStartTime>Gj&&1073741824!==c&&(b.flags|=128,d=!0,Dj(f,!1),b.lanes=4194304);f.isBackwards?(g.sibling=b.child,b.child=g):(c=f.last,null!==c?c.sibling=g:b.child=g,f.last=g)}if(null!==f.tail)return b=f.tail,f.rendering=\nb,f.tail=b.sibling,f.renderingStartTime=B(),b.sibling=null,c=L.current,G(L,d?c&1|2:c&1),b;S(b);return null;case 22:case 23:return Hj(),d=null!==b.memoizedState,null!==a&&null!==a.memoizedState!==d&&(b.flags|=8192),d&&0!==(b.mode&1)?0!==(fj&1073741824)&&(S(b),b.subtreeFlags&6&&(b.flags|=8192)):S(b),null;case 24:return null;case 25:return null}throw Error(p(156,b.tag));}\nfunction Ij(a,b){wg(b);switch(b.tag){case 1:return Zf(b.type)&&$f(),a=b.flags,a&65536?(b.flags=a&-65537|128,b):null;case 3:return zh(),E(Wf),E(H),Eh(),a=b.flags,0!==(a&65536)&&0===(a&128)?(b.flags=a&-65537|128,b):null;case 5:return Bh(b),null;case 13:E(L);a=b.memoizedState;if(null!==a&&null!==a.dehydrated){if(null===b.alternate)throw Error(p(340));Ig()}a=b.flags;return a&65536?(b.flags=a&-65537|128,b):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(b.type._context),null;case 22:case 23:return Hj(),\nnull;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=\"function\"===typeof WeakSet?WeakSet:Set,V=null;function Lj(a,b){var c=a.ref;if(null!==c)if(\"function\"===typeof c)try{c(null)}catch(d){W(a,b,d)}else c.current=null}function Mj(a,b,c){try{c()}catch(d){W(a,b,d)}}var Nj=!1;\nfunction Oj(a,b){Cf=dd;a=Me();if(Ne(a)){if(\"selectionStart\"in a)var c={start:a.selectionStart,end:a.selectionEnd};else a:{c=(c=a.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&0!==d.rangeCount){c=d.anchorNode;var e=d.anchorOffset,f=d.focusNode;d=d.focusOffset;try{c.nodeType,f.nodeType}catch(F){c=null;break a}var g=0,h=-1,k=-1,l=0,m=0,q=a,r=null;b:for(;;){for(var y;;){q!==c||0!==e&&3!==q.nodeType||(h=g+e);q!==f||0!==d&&3!==q.nodeType||(k=g+d);3===q.nodeType&&(g+=\nq.nodeValue.length);if(null===(y=q.firstChild))break;r=q;q=y}for(;;){if(q===a)break b;r===c&&++l===e&&(h=g);r===f&&++m===d&&(k=g);if(null!==(y=q.nextSibling))break;q=r;r=q.parentNode}q=y}c=-1===h||-1===k?null:{start:h,end:k}}else c=null}c=c||{start:0,end:0}}else c=null;Df={focusedElem:a,selectionRange:c};dd=!1;for(V=b;null!==V;)if(b=V,a=b.child,0!==(b.subtreeFlags&1028)&&null!==a)a.return=b,V=a;else for(;null!==V;){b=V;try{var n=b.alternate;if(0!==(b.flags&1024))switch(b.tag){case 0:case 11:case 15:break;\ncase 1:if(null!==n){var t=n.memoizedProps,J=n.memoizedState,x=b.stateNode,w=x.getSnapshotBeforeUpdate(b.elementType===b.type?t:Ci(b.type,t),J);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var u=b.stateNode.containerInfo;1===u.nodeType?u.textContent=\"\":9===u.nodeType&&u.documentElement&&u.removeChild(u.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163));}}catch(F){W(b,b.return,F)}a=b.sibling;if(null!==a){a.return=b.return;V=a;break}V=b.return}n=Nj;Nj=!1;return n}\nfunction Pj(a,b,c){var d=b.updateQueue;d=null!==d?d.lastEffect:null;if(null!==d){var e=d=d.next;do{if((e.tag&a)===a){var f=e.destroy;e.destroy=void 0;void 0!==f&&Mj(b,c,f)}e=e.next}while(e!==d)}}function Qj(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}function Rj(a){var b=a.ref;if(null!==b){var c=a.stateNode;switch(a.tag){case 5:a=c;break;default:a=c}\"function\"===typeof b?b(a):b.current=a}}\nfunction Sj(a){var b=a.alternate;null!==b&&(a.alternate=null,Sj(b));a.child=null;a.deletions=null;a.sibling=null;5===a.tag&&(b=a.stateNode,null!==b&&(delete b[Of],delete b[Pf],delete b[of],delete b[Qf],delete b[Rf]));a.stateNode=null;a.return=null;a.dependencies=null;a.memoizedProps=null;a.memoizedState=null;a.pendingProps=null;a.stateNode=null;a.updateQueue=null}function Tj(a){return 5===a.tag||3===a.tag||4===a.tag}\nfunction Uj(a){a:for(;;){for(;null===a.sibling;){if(null===a.return||Tj(a.return))return null;a=a.return}a.sibling.return=a.return;for(a=a.sibling;5!==a.tag&&6!==a.tag&&18!==a.tag;){if(a.flags&2)continue a;if(null===a.child||4===a.tag)continue a;else a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}\nfunction Vj(a,b,c){var d=a.tag;if(5===d||6===d)a=a.stateNode,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=Bf));else if(4!==d&&(a=a.child,null!==a))for(Vj(a,b,c),a=a.sibling;null!==a;)Vj(a,b,c),a=a.sibling}\nfunction Wj(a,b,c){var d=a.tag;if(5===d||6===d)a=a.stateNode,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Wj(a,b,c),a=a.sibling;null!==a;)Wj(a,b,c),a=a.sibling}var X=null,Xj=!1;function Yj(a,b,c){for(c=c.child;null!==c;)Zj(a,b,c),c=c.sibling}\nfunction Zj(a,b,c){if(lc&&\"function\"===typeof lc.onCommitFiberUnmount)try{lc.onCommitFiberUnmount(kc,c)}catch(h){}switch(c.tag){case 5:U||Lj(c,b);case 6:var d=X,e=Xj;X=null;Yj(a,b,c);X=d;Xj=e;null!==X&&(Xj?(a=X,c=c.stateNode,8===a.nodeType?a.parentNode.removeChild(c):a.removeChild(c)):X.removeChild(c.stateNode));break;case 18:null!==X&&(Xj?(a=X,c=c.stateNode,8===a.nodeType?Kf(a.parentNode,c):1===a.nodeType&&Kf(a,c),bd(a)):Kf(X,c.stateNode));break;case 4:d=X;e=Xj;X=c.stateNode.containerInfo;Xj=!0;\nYj(a,b,c);X=d;Xj=e;break;case 0:case 11:case 14:case 15:if(!U&&(d=c.updateQueue,null!==d&&(d=d.lastEffect,null!==d))){e=d=d.next;do{var f=e,g=f.destroy;f=f.tag;void 0!==g&&(0!==(f&2)?Mj(c,b,g):0!==(f&4)&&Mj(c,b,g));e=e.next}while(e!==d)}Yj(a,b,c);break;case 1:if(!U&&(Lj(c,b),d=c.stateNode,\"function\"===typeof d.componentWillUnmount))try{d.props=c.memoizedProps,d.state=c.memoizedState,d.componentWillUnmount()}catch(h){W(c,b,h)}Yj(a,b,c);break;case 21:Yj(a,b,c);break;case 22:c.mode&1?(U=(d=U)||null!==\nc.memoizedState,Yj(a,b,c),U=d):Yj(a,b,c);break;default:Yj(a,b,c)}}function ak(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=new Kj);b.forEach(function(b){var d=bk.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}\nfunction ck(a,b){var c=b.deletions;if(null!==c)for(var d=0;d<c.length;d++){var e=c[d];try{var f=a,g=b,h=g;a:for(;null!==h;){switch(h.tag){case 5:X=h.stateNode;Xj=!1;break a;case 3:X=h.stateNode.containerInfo;Xj=!0;break a;case 4:X=h.stateNode.containerInfo;Xj=!0;break a}h=h.return}if(null===X)throw Error(p(160));Zj(f,g,e);X=null;Xj=!1;var k=e.alternate;null!==k&&(k.return=null);e.return=null}catch(l){W(e,b,l)}}if(b.subtreeFlags&12854)for(b=b.child;null!==b;)dk(b,a),b=b.sibling}\nfunction dk(a,b){var c=a.alternate,d=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:ck(b,a);ek(a);if(d&4){try{Pj(3,a,a.return),Qj(3,a)}catch(t){W(a,a.return,t)}try{Pj(5,a,a.return)}catch(t){W(a,a.return,t)}}break;case 1:ck(b,a);ek(a);d&512&&null!==c&&Lj(c,c.return);break;case 5:ck(b,a);ek(a);d&512&&null!==c&&Lj(c,c.return);if(a.flags&32){var e=a.stateNode;try{ob(e,\"\")}catch(t){W(a,a.return,t)}}if(d&4&&(e=a.stateNode,null!=e)){var f=a.memoizedProps,g=null!==c?c.memoizedProps:f,h=a.type,k=a.updateQueue;\na.updateQueue=null;if(null!==k)try{\"input\"===h&&\"radio\"===f.type&&null!=f.name&&ab(e,f);vb(h,g);var l=vb(h,f);for(g=0;g<k.length;g+=2){var m=k[g],q=k[g+1];\"style\"===m?sb(e,q):\"dangerouslySetInnerHTML\"===m?nb(e,q):\"children\"===m?ob(e,q):ta(e,m,q,l)}switch(h){case \"input\":bb(e,f);break;case \"textarea\":ib(e,f);break;case \"select\":var r=e._wrapperState.wasMultiple;e._wrapperState.wasMultiple=!!f.multiple;var y=f.value;null!=y?fb(e,!!f.multiple,y,!1):r!==!!f.multiple&&(null!=f.defaultValue?fb(e,!!f.multiple,\nf.defaultValue,!0):fb(e,!!f.multiple,f.multiple?[]:\"\",!1))}e[Pf]=f}catch(t){W(a,a.return,t)}}break;case 6:ck(b,a);ek(a);if(d&4){if(null===a.stateNode)throw Error(p(162));e=a.stateNode;f=a.memoizedProps;try{e.nodeValue=f}catch(t){W(a,a.return,t)}}break;case 3:ck(b,a);ek(a);if(d&4&&null!==c&&c.memoizedState.isDehydrated)try{bd(b.containerInfo)}catch(t){W(a,a.return,t)}break;case 4:ck(b,a);ek(a);break;case 13:ck(b,a);ek(a);e=a.child;e.flags&8192&&(f=null!==e.memoizedState,e.stateNode.isHidden=f,!f||\nnull!==e.alternate&&null!==e.alternate.memoizedState||(fk=B()));d&4&&ak(a);break;case 22:m=null!==c&&null!==c.memoizedState;a.mode&1?(U=(l=U)||m,ck(b,a),U=l):ck(b,a);ek(a);if(d&8192){l=null!==a.memoizedState;if((a.stateNode.isHidden=l)&&!m&&0!==(a.mode&1))for(V=a,m=a.child;null!==m;){for(q=V=m;null!==V;){r=V;y=r.child;switch(r.tag){case 0:case 11:case 14:case 15:Pj(4,r,r.return);break;case 1:Lj(r,r.return);var n=r.stateNode;if(\"function\"===typeof n.componentWillUnmount){d=r;c=r.return;try{b=d,n.props=\nb.memoizedProps,n.state=b.memoizedState,n.componentWillUnmount()}catch(t){W(d,c,t)}}break;case 5:Lj(r,r.return);break;case 22:if(null!==r.memoizedState){gk(q);continue}}null!==y?(y.return=r,V=y):gk(q)}m=m.sibling}a:for(m=null,q=a;;){if(5===q.tag){if(null===m){m=q;try{e=q.stateNode,l?(f=e.style,\"function\"===typeof f.setProperty?f.setProperty(\"display\",\"none\",\"important\"):f.display=\"none\"):(h=q.stateNode,k=q.memoizedProps.style,g=void 0!==k&&null!==k&&k.hasOwnProperty(\"display\")?k.display:null,h.style.display=\nrb(\"display\",g))}catch(t){W(a,a.return,t)}}}else if(6===q.tag){if(null===m)try{q.stateNode.nodeValue=l?\"\":q.memoizedProps}catch(t){W(a,a.return,t)}}else if((22!==q.tag&&23!==q.tag||null===q.memoizedState||q===a)&&null!==q.child){q.child.return=q;q=q.child;continue}if(q===a)break a;for(;null===q.sibling;){if(null===q.return||q.return===a)break a;m===q&&(m=null);q=q.return}m===q&&(m=null);q.sibling.return=q.return;q=q.sibling}}break;case 19:ck(b,a);ek(a);d&4&&ak(a);break;case 21:break;default:ck(b,\na),ek(a)}}function ek(a){var b=a.flags;if(b&2){try{a:{for(var c=a.return;null!==c;){if(Tj(c)){var d=c;break a}c=c.return}throw Error(p(160));}switch(d.tag){case 5:var e=d.stateNode;d.flags&32&&(ob(e,\"\"),d.flags&=-33);var f=Uj(a);Wj(a,f,e);break;case 3:case 4:var g=d.stateNode.containerInfo,h=Uj(a);Vj(a,h,g);break;default:throw Error(p(161));}}catch(k){W(a,a.return,k)}a.flags&=-3}b&4096&&(a.flags&=-4097)}function hk(a,b,c){V=a;ik(a,b,c)}\nfunction ik(a,b,c){for(var d=0!==(a.mode&1);null!==V;){var e=V,f=e.child;if(22===e.tag&&d){var g=null!==e.memoizedState||Jj;if(!g){var h=e.alternate,k=null!==h&&null!==h.memoizedState||U;h=Jj;var l=U;Jj=g;if((U=k)&&!l)for(V=e;null!==V;)g=V,k=g.child,22===g.tag&&null!==g.memoizedState?jk(e):null!==k?(k.return=g,V=k):jk(e);for(;null!==f;)V=f,ik(f,b,c),f=f.sibling;V=e;Jj=h;U=l}kk(a,b,c)}else 0!==(e.subtreeFlags&8772)&&null!==f?(f.return=e,V=f):kk(a,b,c)}}\nfunction kk(a){for(;null!==V;){var b=V;if(0!==(b.flags&8772)){var c=b.alternate;try{if(0!==(b.flags&8772))switch(b.tag){case 0:case 11:case 15:U||Qj(5,b);break;case 1:var d=b.stateNode;if(b.flags&4&&!U)if(null===c)d.componentDidMount();else{var e=b.elementType===b.type?c.memoizedProps:Ci(b.type,c.memoizedProps);d.componentDidUpdate(e,c.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var f=b.updateQueue;null!==f&&sh(b,f,d);break;case 3:var g=b.updateQueue;if(null!==g){c=null;if(null!==b.child)switch(b.child.tag){case 5:c=\nb.child.stateNode;break;case 1:c=b.child.stateNode}sh(b,g,c)}break;case 5:var h=b.stateNode;if(null===c&&b.flags&4){c=h;var k=b.memoizedProps;switch(b.type){case \"button\":case \"input\":case \"select\":case \"textarea\":k.autoFocus&&c.focus();break;case \"img\":k.src&&(c.src=k.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(null===b.memoizedState){var l=b.alternate;if(null!==l){var m=l.memoizedState;if(null!==m){var q=m.dehydrated;null!==q&&bd(q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;\ndefault:throw Error(p(163));}U||b.flags&512&&Rj(b)}catch(r){W(b,b.return,r)}}if(b===a){V=null;break}c=b.sibling;if(null!==c){c.return=b.return;V=c;break}V=b.return}}function gk(a){for(;null!==V;){var b=V;if(b===a){V=null;break}var c=b.sibling;if(null!==c){c.return=b.return;V=c;break}V=b.return}}\nfunction jk(a){for(;null!==V;){var b=V;try{switch(b.tag){case 0:case 11:case 15:var c=b.return;try{Qj(4,b)}catch(k){W(b,c,k)}break;case 1:var d=b.stateNode;if(\"function\"===typeof d.componentDidMount){var e=b.return;try{d.componentDidMount()}catch(k){W(b,e,k)}}var f=b.return;try{Rj(b)}catch(k){W(b,f,k)}break;case 5:var g=b.return;try{Rj(b)}catch(k){W(b,g,k)}}}catch(k){W(b,b.return,k)}if(b===a){V=null;break}var h=b.sibling;if(null!==h){h.return=b.return;V=h;break}V=b.return}}\nvar lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=Infinity,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return 0!==(K&6)?B():-1!==Ak?Ak:Ak=B()}\nfunction yi(a){if(0===(a.mode&1))return 1;if(0!==(K&2)&&0!==Z)return Z&-Z;if(null!==Kg.transition)return 0===Bk&&(Bk=yc()),Bk;a=C;if(0!==a)return a;a=window.event;a=void 0===a?16:jd(a.type);return a}function gi(a,b,c,d){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(a,c,d);if(0===(K&2)||a!==Q)a===Q&&(0===(K&2)&&(qk|=c),4===T&&Ck(a,Z)),Dk(a,d),1===c&&0===K&&0===(b.mode&1)&&(Gj=B()+500,fg&&jg())}\nfunction Dk(a,b){var c=a.callbackNode;wc(a,b);var d=uc(a,a===Q?Z:0);if(0===d)null!==c&&bc(c),a.callbackNode=null,a.callbackPriority=0;else if(b=d&-d,a.callbackPriority!==b){null!=c&&bc(c);if(1===b)0===a.tag?ig(Ek.bind(null,a)):hg(Ek.bind(null,a)),Jf(function(){0===(K&6)&&jg()}),c=null;else{switch(Dc(d)){case 1:c=fc;break;case 4:c=gc;break;case 16:c=hc;break;case 536870912:c=jc;break;default:c=hc}c=Fk(c,Gk.bind(null,a))}a.callbackPriority=b;a.callbackNode=c}}\nfunction Gk(a,b){Ak=-1;Bk=0;if(0!==(K&6))throw Error(p(327));var c=a.callbackNode;if(Hk()&&a.callbackNode!==c)return null;var d=uc(a,a===Q?Z:0);if(0===d)return null;if(0!==(d&30)||0!==(d&a.expiredLanes)||b)b=Ik(a,d);else{b=d;var e=K;K|=2;var f=Jk();if(Q!==a||Z!==b)uk=null,Gj=B()+500,Kk(a,b);do try{Lk();break}catch(h){Mk(a,h)}while(1);$g();mk.current=f;K=e;null!==Y?b=0:(Q=null,Z=0,b=T)}if(0!==b){2===b&&(e=xc(a),0!==e&&(d=e,b=Nk(a,e)));if(1===b)throw c=pk,Kk(a,0),Ck(a,d),Dk(a,B()),c;if(6===b)Ck(a,d);\nelse{e=a.current.alternate;if(0===(d&30)&&!Ok(e)&&(b=Ik(a,d),2===b&&(f=xc(a),0!==f&&(d=f,b=Nk(a,f))),1===b))throw c=pk,Kk(a,0),Ck(a,d),Dk(a,B()),c;a.finishedWork=e;a.finishedLanes=d;switch(b){case 0:case 1:throw Error(p(345));case 2:Pk(a,tk,uk);break;case 3:Ck(a,d);if((d&130023424)===d&&(b=fk+500-B(),10<b)){if(0!==uc(a,0))break;e=a.suspendedLanes;if((e&d)!==d){R();a.pingedLanes|=a.suspendedLanes&e;break}a.timeoutHandle=Ff(Pk.bind(null,a,tk,uk),b);break}Pk(a,tk,uk);break;case 4:Ck(a,d);if((d&4194240)===\nd)break;b=a.eventTimes;for(e=-1;0<d;){var g=31-oc(d);f=1<<g;g=b[g];g>e&&(e=g);d&=~f}d=e;d=B()-d;d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*lk(d/1960))-d;if(10<d){a.timeoutHandle=Ff(Pk.bind(null,a,tk,uk),d);break}Pk(a,tk,uk);break;case 5:Pk(a,tk,uk);break;default:throw Error(p(329));}}}Dk(a,B());return a.callbackNode===c?Gk.bind(null,a):null}\nfunction Nk(a,b){var c=sk;a.current.memoizedState.isDehydrated&&(Kk(a,b).flags|=256);a=Ik(a,b);2!==a&&(b=tk,tk=c,null!==b&&Fj(b));return a}function Fj(a){null===tk?tk=a:tk.push.apply(tk,a)}\nfunction Ok(a){for(var b=a;;){if(b.flags&16384){var c=b.updateQueue;if(null!==c&&(c=c.stores,null!==c))for(var d=0;d<c.length;d++){var e=c[d],f=e.getSnapshot;e=e.value;try{if(!He(f(),e))return!1}catch(g){return!1}}}c=b.child;if(b.subtreeFlags&16384&&null!==c)c.return=b,b=c;else{if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return!0;b=b.return}b.sibling.return=b.return;b=b.sibling}}return!0}\nfunction Ck(a,b){b&=~rk;b&=~qk;a.suspendedLanes|=b;a.pingedLanes&=~b;for(a=a.expirationTimes;0<b;){var c=31-oc(b),d=1<<c;a[c]=-1;b&=~d}}function Ek(a){if(0!==(K&6))throw Error(p(327));Hk();var b=uc(a,0);if(0===(b&1))return Dk(a,B()),null;var c=Ik(a,b);if(0!==a.tag&&2===c){var d=xc(a);0!==d&&(b=d,c=Nk(a,d))}if(1===c)throw c=pk,Kk(a,0),Ck(a,b),Dk(a,B()),c;if(6===c)throw Error(p(345));a.finishedWork=a.current.alternate;a.finishedLanes=b;Pk(a,tk,uk);Dk(a,B());return null}\nfunction Qk(a,b){var c=K;K|=1;try{return a(b)}finally{K=c,0===K&&(Gj=B()+500,fg&&jg())}}function Rk(a){null!==wk&&0===wk.tag&&0===(K&6)&&Hk();var b=K;K|=1;var c=ok.transition,d=C;try{if(ok.transition=null,C=1,a)return a()}finally{C=d,ok.transition=c,K=b,0===(K&6)&&jg()}}function Hj(){fj=ej.current;E(ej)}\nfunction Kk(a,b){a.finishedWork=null;a.finishedLanes=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,Gf(c));if(null!==Y)for(c=Y.return;null!==c;){var d=c;wg(d);switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&$f();break;case 3:zh();E(Wf);E(H);Eh();break;case 5:Bh(d);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(d.type._context);break;case 22:case 23:Hj()}c=c.return}Q=a;Y=a=Pg(a.current,null);Z=fj=b;T=0;pk=null;rk=qk=rh=0;tk=sk=null;if(null!==fh){for(b=\n0;b<fh.length;b++)if(c=fh[b],d=c.interleaved,null!==d){c.interleaved=null;var e=d.next,f=c.pending;if(null!==f){var g=f.next;f.next=e;d.next=g}c.pending=d}fh=null}return a}\nfunction Mk(a,b){do{var c=Y;try{$g();Fh.current=Rh;if(Ih){for(var d=M.memoizedState;null!==d;){var e=d.queue;null!==e&&(e.pending=null);d=d.next}Ih=!1}Hh=0;O=N=M=null;Jh=!1;Kh=0;nk.current=null;if(null===c||null===c.return){T=1;pk=b;Y=null;break}a:{var f=a,g=c.return,h=c,k=b;b=Z;h.flags|=32768;if(null!==k&&\"object\"===typeof k&&\"function\"===typeof k.then){var l=k,m=h,q=m.tag;if(0===(m.mode&1)&&(0===q||11===q||15===q)){var r=m.alternate;r?(m.updateQueue=r.updateQueue,m.memoizedState=r.memoizedState,\nm.lanes=r.lanes):(m.updateQueue=null,m.memoizedState=null)}var y=Ui(g);if(null!==y){y.flags&=-257;Vi(y,g,h,f,b);y.mode&1&&Si(f,l,b);b=y;k=l;var n=b.updateQueue;if(null===n){var t=new Set;t.add(k);b.updateQueue=t}else n.add(k);break a}else{if(0===(b&1)){Si(f,l,b);tj();break a}k=Error(p(426))}}else if(I&&h.mode&1){var J=Ui(g);if(null!==J){0===(J.flags&65536)&&(J.flags|=256);Vi(J,g,h,f,b);Jg(Ji(k,h));break a}}f=k=Ji(k,h);4!==T&&(T=2);null===sk?sk=[f]:sk.push(f);f=g;do{switch(f.tag){case 3:f.flags|=65536;\nb&=-b;f.lanes|=b;var x=Ni(f,k,b);ph(f,x);break a;case 1:h=k;var w=f.type,u=f.stateNode;if(0===(f.flags&128)&&(\"function\"===typeof w.getDerivedStateFromError||null!==u&&\"function\"===typeof u.componentDidCatch&&(null===Ri||!Ri.has(u)))){f.flags|=65536;b&=-b;f.lanes|=b;var F=Qi(f,h,b);ph(f,F);break a}}f=f.return}while(null!==f)}Sk(c)}catch(na){b=na;Y===c&&null!==c&&(Y=c=c.return);continue}break}while(1)}function Jk(){var a=mk.current;mk.current=Rh;return null===a?Rh:a}\nfunction tj(){if(0===T||3===T||2===T)T=4;null===Q||0===(rh&268435455)&&0===(qk&268435455)||Ck(Q,Z)}function Ik(a,b){var c=K;K|=2;var d=Jk();if(Q!==a||Z!==b)uk=null,Kk(a,b);do try{Tk();break}catch(e){Mk(a,e)}while(1);$g();K=c;mk.current=d;if(null!==Y)throw Error(p(261));Q=null;Z=0;return T}function Tk(){for(;null!==Y;)Uk(Y)}function Lk(){for(;null!==Y&&!cc();)Uk(Y)}function Uk(a){var b=Vk(a.alternate,a,fj);a.memoizedProps=a.pendingProps;null===b?Sk(a):Y=b;nk.current=null}\nfunction Sk(a){var b=a;do{var c=b.alternate;a=b.return;if(0===(b.flags&32768)){if(c=Ej(c,b,fj),null!==c){Y=c;return}}else{c=Ij(c,b);if(null!==c){c.flags&=32767;Y=c;return}if(null!==a)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{T=6;Y=null;return}}b=b.sibling;if(null!==b){Y=b;return}Y=b=a}while(null!==b);0===T&&(T=5)}function Pk(a,b,c){var d=C,e=ok.transition;try{ok.transition=null,C=1,Wk(a,b,c,d)}finally{ok.transition=e,C=d}return null}\nfunction Wk(a,b,c,d){do Hk();while(null!==wk);if(0!==(K&6))throw Error(p(327));c=a.finishedWork;var e=a.finishedLanes;if(null===c)return null;a.finishedWork=null;a.finishedLanes=0;if(c===a.current)throw Error(p(177));a.callbackNode=null;a.callbackPriority=0;var f=c.lanes|c.childLanes;Bc(a,f);a===Q&&(Y=Q=null,Z=0);0===(c.subtreeFlags&2064)&&0===(c.flags&2064)||vk||(vk=!0,Fk(hc,function(){Hk();return null}));f=0!==(c.flags&15990);if(0!==(c.subtreeFlags&15990)||f){f=ok.transition;ok.transition=null;\nvar g=C;C=1;var h=K;K|=4;nk.current=null;Oj(a,c);dk(c,a);Oe(Df);dd=!!Cf;Df=Cf=null;a.current=c;hk(c,a,e);dc();K=h;C=g;ok.transition=f}else a.current=c;vk&&(vk=!1,wk=a,xk=e);f=a.pendingLanes;0===f&&(Ri=null);mc(c.stateNode,d);Dk(a,B());if(null!==b)for(d=a.onRecoverableError,c=0;c<b.length;c++)e=b[c],d(e.value,{componentStack:e.stack,digest:e.digest});if(Oi)throw Oi=!1,a=Pi,Pi=null,a;0!==(xk&1)&&0!==a.tag&&Hk();f=a.pendingLanes;0!==(f&1)?a===zk?yk++:(yk=0,zk=a):yk=0;jg();return null}\nfunction Hk(){if(null!==wk){var a=Dc(xk),b=ok.transition,c=C;try{ok.transition=null;C=16>a?16:a;if(null===wk)var d=!1;else{a=wk;wk=null;xk=0;if(0!==(K&6))throw Error(p(331));var e=K;K|=4;for(V=a.current;null!==V;){var f=V,g=f.child;if(0!==(V.flags&16)){var h=f.deletions;if(null!==h){for(var k=0;k<h.length;k++){var l=h[k];for(V=l;null!==V;){var m=V;switch(m.tag){case 0:case 11:case 15:Pj(8,m,f)}var q=m.child;if(null!==q)q.return=m,V=q;else for(;null!==V;){m=V;var r=m.sibling,y=m.return;Sj(m);if(m===\nl){V=null;break}if(null!==r){r.return=y;V=r;break}V=y}}}var n=f.alternate;if(null!==n){var t=n.child;if(null!==t){n.child=null;do{var J=t.sibling;t.sibling=null;t=J}while(null!==t)}}V=f}}if(0!==(f.subtreeFlags&2064)&&null!==g)g.return=f,V=g;else b:for(;null!==V;){f=V;if(0!==(f.flags&2048))switch(f.tag){case 0:case 11:case 15:Pj(9,f,f.return)}var x=f.sibling;if(null!==x){x.return=f.return;V=x;break b}V=f.return}}var w=a.current;for(V=w;null!==V;){g=V;var u=g.child;if(0!==(g.subtreeFlags&2064)&&null!==\nu)u.return=g,V=u;else b:for(g=w;null!==V;){h=V;if(0!==(h.flags&2048))try{switch(h.tag){case 0:case 11:case 15:Qj(9,h)}}catch(na){W(h,h.return,na)}if(h===g){V=null;break b}var F=h.sibling;if(null!==F){F.return=h.return;V=F;break b}V=h.return}}K=e;jg();if(lc&&\"function\"===typeof lc.onPostCommitFiberRoot)try{lc.onPostCommitFiberRoot(kc,a)}catch(na){}d=!0}return d}finally{C=c,ok.transition=b}}return!1}function Xk(a,b,c){b=Ji(c,b);b=Ni(a,b,1);a=nh(a,b,1);b=R();null!==a&&(Ac(a,1,b),Dk(a,b))}\nfunction W(a,b,c){if(3===a.tag)Xk(a,a,c);else for(;null!==b;){if(3===b.tag){Xk(b,a,c);break}else if(1===b.tag){var d=b.stateNode;if(\"function\"===typeof b.type.getDerivedStateFromError||\"function\"===typeof d.componentDidCatch&&(null===Ri||!Ri.has(d))){a=Ji(c,a);a=Qi(b,a,1);b=nh(b,a,1);a=R();null!==b&&(Ac(b,1,a),Dk(b,a));break}}b=b.return}}\nfunction Ti(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);b=R();a.pingedLanes|=a.suspendedLanes&c;Q===a&&(Z&c)===c&&(4===T||3===T&&(Z&130023424)===Z&&500>B()-fk?Kk(a,0):rk|=c);Dk(a,b)}function Yk(a,b){0===b&&(0===(a.mode&1)?b=1:(b=sc,sc<<=1,0===(sc&130023424)&&(sc=4194304)));var c=R();a=ih(a,b);null!==a&&(Ac(a,b,c),Dk(a,c))}function uj(a){var b=a.memoizedState,c=0;null!==b&&(c=b.retryLane);Yk(a,c)}\nfunction bk(a,b){var c=0;switch(a.tag){case 13:var d=a.stateNode;var e=a.memoizedState;null!==e&&(c=e.retryLane);break;case 19:d=a.stateNode;break;default:throw Error(p(314));}null!==d&&d.delete(b);Yk(a,c)}var Vk;\nVk=function(a,b,c){if(null!==a)if(a.memoizedProps!==b.pendingProps||Wf.current)dh=!0;else{if(0===(a.lanes&c)&&0===(b.flags&128))return dh=!1,yj(a,b,c);dh=0!==(a.flags&131072)?!0:!1}else dh=!1,I&&0!==(b.flags&1048576)&&ug(b,ng,b.index);b.lanes=0;switch(b.tag){case 2:var d=b.type;ij(a,b);a=b.pendingProps;var e=Yf(b,H.current);ch(b,c);e=Nh(null,b,d,a,e,c);var f=Sh();b.flags|=1;\"object\"===typeof e&&null!==e&&\"function\"===typeof e.render&&void 0===e.$$typeof?(b.tag=1,b.memoizedState=null,b.updateQueue=\nnull,Zf(d)?(f=!0,cg(b)):f=!1,b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,kh(b),e.updater=Ei,b.stateNode=e,e._reactInternals=b,Ii(b,d,a,c),b=jj(null,b,d,!0,f,c)):(b.tag=0,I&&f&&vg(b),Xi(null,b,e,c),b=b.child);return b;case 16:d=b.elementType;a:{ij(a,b);a=b.pendingProps;e=d._init;d=e(d._payload);b.type=d;e=b.tag=Zk(d);a=Ci(d,a);switch(e){case 0:b=cj(null,b,d,a,c);break a;case 1:b=hj(null,b,d,a,c);break a;case 11:b=Yi(null,b,d,a,c);break a;case 14:b=$i(null,b,d,Ci(d.type,a),c);break a}throw Error(p(306,\nd,\"\"));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),cj(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),hj(a,b,d,e,c);case 3:a:{kj(b);if(null===a)throw Error(p(387));d=b.pendingProps;f=b.memoizedState;e=f.element;lh(a,b);qh(b,d,null,c);var g=b.memoizedState;d=g.element;if(f.isDehydrated)if(f={element:d,isDehydrated:!1,cache:g.cache,pendingSuspenseBoundaries:g.pendingSuspenseBoundaries,transitions:g.transitions},b.updateQueue.baseState=\nf,b.memoizedState=f,b.flags&256){e=Ji(Error(p(423)),b);b=lj(a,b,d,c,e);break a}else if(d!==e){e=Ji(Error(p(424)),b);b=lj(a,b,d,c,e);break a}else for(yg=Lf(b.stateNode.containerInfo.firstChild),xg=b,I=!0,zg=null,c=Vg(b,null,d,c),b.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{Ig();if(d===e){b=Zi(a,b,c);break a}Xi(a,b,d,c)}b=b.child}return b;case 5:return Ah(b),null===a&&Eg(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:null,g=e.children,Ef(d,e)?g=null:null!==f&&Ef(d,f)&&(b.flags|=32),\ngj(a,b),Xi(a,b,g,c),b.child;case 6:return null===a&&Eg(b),null;case 13:return oj(a,b,c);case 4:return yh(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=Ug(b,null,d,c):Xi(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),Yi(a,b,d,e,c);case 7:return Xi(a,b,b.pendingProps,c),b.child;case 8:return Xi(a,b,b.pendingProps.children,c),b.child;case 12:return Xi(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;f=b.memoizedProps;\ng=e.value;G(Wg,d._currentValue);d._currentValue=g;if(null!==f)if(He(f.value,g)){if(f.children===e.children&&!Wf.current){b=Zi(a,b,c);break a}}else for(f=b.child,null!==f&&(f.return=b);null!==f;){var h=f.dependencies;if(null!==h){g=f.child;for(var k=h.firstContext;null!==k;){if(k.context===d){if(1===f.tag){k=mh(-1,c&-c);k.tag=2;var l=f.updateQueue;if(null!==l){l=l.shared;var m=l.pending;null===m?k.next=k:(k.next=m.next,m.next=k);l.pending=k}}f.lanes|=c;k=f.alternate;null!==k&&(k.lanes|=c);bh(f.return,\nc,b);h.lanes|=c;break}k=k.next}}else if(10===f.tag)g=f.type===b.type?null:f.child;else if(18===f.tag){g=f.return;if(null===g)throw Error(p(341));g.lanes|=c;h=g.alternate;null!==h&&(h.lanes|=c);bh(g,c,b);g=f.sibling}else g=f.child;if(null!==g)g.return=f;else for(g=f;null!==g;){if(g===b){g=null;break}f=g.sibling;if(null!==f){f.return=g.return;g=f;break}g=g.return}f=g}Xi(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,d=b.pendingProps.children,ch(b,c),e=eh(e),d=d(e),b.flags|=1,Xi(a,b,d,c),\nb.child;case 14:return d=b.type,e=Ci(d,b.pendingProps),e=Ci(d.type,e),$i(a,b,d,e,c);case 15:return bj(a,b,b.type,b.pendingProps,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Ci(d,e),ij(a,b),b.tag=1,Zf(d)?(a=!0,cg(b)):a=!1,ch(b,c),Gi(b,d,e),Ii(b,d,e,c),jj(null,b,d,!0,a,c);case 19:return xj(a,b,c);case 22:return dj(a,b,c)}throw Error(p(156,b.tag));};function Fk(a,b){return ac(a,b)}\nfunction $k(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.subtreeFlags=this.flags=0;this.deletions=null;this.childLanes=this.lanes=0;this.alternate=null}function Bg(a,b,c,d){return new $k(a,b,c,d)}function aj(a){a=a.prototype;return!(!a||!a.isReactComponent)}\nfunction Zk(a){if(\"function\"===typeof a)return aj(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===Da)return 11;if(a===Ga)return 14}return 2}\nfunction Pg(a,b){var c=a.alternate;null===c?(c=Bg(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null);c.flags=a.flags&14680064;c.childLanes=a.childLanes;c.lanes=a.lanes;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{lanes:b.lanes,firstContext:b.firstContext};\nc.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}\nfunction Rg(a,b,c,d,e,f){var g=2;d=a;if(\"function\"===typeof a)aj(a)&&(g=1);else if(\"string\"===typeof a)g=5;else a:switch(a){case ya:return Tg(c.children,e,f,b);case za:g=8;e|=8;break;case Aa:return a=Bg(12,c,b,e|2),a.elementType=Aa,a.lanes=f,a;case Ea:return a=Bg(13,c,b,e),a.elementType=Ea,a.lanes=f,a;case Fa:return a=Bg(19,c,b,e),a.elementType=Fa,a.lanes=f,a;case Ia:return pj(c,e,f,b);default:if(\"object\"===typeof a&&null!==a)switch(a.$$typeof){case Ba:g=10;break a;case Ca:g=9;break a;case Da:g=11;\nbreak a;case Ga:g=14;break a;case Ha:g=16;d=null;break a}throw Error(p(130,null==a?a:typeof a,\"\"));}b=Bg(g,c,b,e);b.elementType=a;b.type=d;b.lanes=f;return b}function Tg(a,b,c,d){a=Bg(7,a,d,b);a.lanes=c;return a}function pj(a,b,c,d){a=Bg(22,a,d,b);a.elementType=Ia;a.lanes=c;a.stateNode={isHidden:!1};return a}function Qg(a,b,c){a=Bg(6,a,null,b);a.lanes=c;return a}\nfunction Sg(a,b,c){b=Bg(4,null!==a.children?a.children:[],a.key,b);b.lanes=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}\nfunction al(a,b,c,d,e){this.tag=b;this.containerInfo=a;this.finishedWork=this.pingCache=this.current=this.pendingChildren=null;this.timeoutHandle=-1;this.callbackNode=this.pendingContext=this.context=null;this.callbackPriority=0;this.eventTimes=zc(0);this.expirationTimes=zc(-1);this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0;this.entanglements=zc(0);this.identifierPrefix=d;this.onRecoverableError=e;this.mutableSourceEagerHydrationData=\nnull}function bl(a,b,c,d,e,f,g,h,k){a=new al(a,b,c,h,k);1===b?(b=1,!0===f&&(b|=8)):b=0;f=Bg(3,null,null,b);a.current=f;f.stateNode=a;f.memoizedState={element:d,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null};kh(f);return a}function cl(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:wa,key:null==d?null:\"\"+d,children:a,containerInfo:b,implementation:c}}\nfunction dl(a){if(!a)return Vf;a=a._reactInternals;a:{if(Vb(a)!==a||1!==a.tag)throw Error(p(170));var b=a;do{switch(b.tag){case 3:b=b.stateNode.context;break a;case 1:if(Zf(b.type)){b=b.stateNode.__reactInternalMemoizedMergedChildContext;break a}}b=b.return}while(null!==b);throw Error(p(171));}if(1===a.tag){var c=a.type;if(Zf(c))return bg(a,c,b)}return b}\nfunction el(a,b,c,d,e,f,g,h,k){a=bl(c,d,!0,a,e,f,g,h,k);a.context=dl(null);c=a.current;d=R();e=yi(c);f=mh(d,e);f.callback=void 0!==b&&null!==b?b:null;nh(c,f,e);a.current.lanes=e;Ac(a,e,d);Dk(a,d);return a}function fl(a,b,c,d){var e=b.current,f=R(),g=yi(e);c=dl(c);null===b.context?b.context=c:b.pendingContext=c;b=mh(f,g);b.payload={element:a};d=void 0===d?null:d;null!==d&&(b.callback=d);a=nh(e,b,g);null!==a&&(gi(a,e,g,f),oh(a,e,g));return g}\nfunction gl(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function hl(a,b){a=a.memoizedState;if(null!==a&&null!==a.dehydrated){var c=a.retryLane;a.retryLane=0!==c&&c<b?c:b}}function il(a,b){hl(a,b);(a=a.alternate)&&hl(a,b)}function jl(){return null}var kl=\"function\"===typeof reportError?reportError:function(a){console.error(a)};function ll(a){this._internalRoot=a}\nml.prototype.render=ll.prototype.render=function(a){var b=this._internalRoot;if(null===b)throw Error(p(409));fl(a,b,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var a=this._internalRoot;if(null!==a){this._internalRoot=null;var b=a.containerInfo;Rk(function(){fl(null,a,null,null)});b[uf]=null}};function ml(a){this._internalRoot=a}\nml.prototype.unstable_scheduleHydration=function(a){if(a){var b=Hc();a={blockedOn:null,target:a,priority:b};for(var c=0;c<Qc.length&&0!==b&&b<Qc[c].priority;c++);Qc.splice(c,0,a);0===c&&Vc(a)}};function nl(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType)}function ol(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||\" react-mount-point-unstable \"!==a.nodeValue))}function pl(){}\nfunction ql(a,b,c,d,e){if(e){if(\"function\"===typeof d){var f=d;d=function(){var a=gl(g);f.call(a)}}var g=el(b,d,a,0,null,!1,!1,\"\",pl);a._reactRootContainer=g;a[uf]=g.current;sf(8===a.nodeType?a.parentNode:a);Rk();return g}for(;e=a.lastChild;)a.removeChild(e);if(\"function\"===typeof d){var h=d;d=function(){var a=gl(k);h.call(a)}}var k=bl(a,0,!1,null,null,!1,!1,\"\",pl);a._reactRootContainer=k;a[uf]=k.current;sf(8===a.nodeType?a.parentNode:a);Rk(function(){fl(b,k,c,d)});return k}\nfunction rl(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f;if(\"function\"===typeof e){var h=e;e=function(){var a=gl(g);h.call(a)}}fl(b,g,a,e)}else g=ql(c,b,a,e,d);return gl(g)}Ec=function(a){switch(a.tag){case 3:var b=a.stateNode;if(b.current.memoizedState.isDehydrated){var c=tc(b.pendingLanes);0!==c&&(Cc(b,c|1),Dk(b,B()),0===(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var b=ih(a,1);if(null!==b){var c=R();gi(b,a,1,c)}}),il(a,1)}};\nFc=function(a){if(13===a.tag){var b=ih(a,134217728);if(null!==b){var c=R();gi(b,a,134217728,c)}il(a,134217728)}};Gc=function(a){if(13===a.tag){var b=yi(a),c=ih(a,b);if(null!==c){var d=R();gi(c,a,b,d)}il(a,b)}};Hc=function(){return C};Ic=function(a,b){var c=C;try{return C=a,b()}finally{C=c}};\nyb=function(a,b,c){switch(b){case \"input\":bb(a,c);b=c.name;if(\"radio\"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+b)+'][type=\"radio\"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=Db(d);if(!e)throw Error(p(90));Wa(d);bb(d,e)}}}break;case \"textarea\":ib(a,c);break;case \"select\":b=c.value,null!=b&&fb(a,!!c.multiple,b,!1)}};Gb=Qk;Hb=Rk;\nvar sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:\"18.3.1\",rendererPackageName:\"react-dom\"};\nvar ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=Zb(a);return null===a?null:a.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||\njl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:\"18.3.1-next-f1338f8080-20240426\"};if(\"undefined\"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch(a){}}exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;\nexports.createPortal=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nl(b))throw Error(p(200));return cl(a,b,null,c)};exports.createRoot=function(a,b){if(!nl(a))throw Error(p(299));var c=!1,d=\"\",e=kl;null!==b&&void 0!==b&&(!0===b.unstable_strictMode&&(c=!0),void 0!==b.identifierPrefix&&(d=b.identifierPrefix),void 0!==b.onRecoverableError&&(e=b.onRecoverableError));b=bl(a,1,!1,null,null,c,!1,d,e);a[uf]=b.current;sf(8===a.nodeType?a.parentNode:a);return new ll(b)};\nexports.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternals;if(void 0===b){if(\"function\"===typeof a.render)throw Error(p(188));a=Object.keys(a).join(\",\");throw Error(p(268,a));}a=Zb(b);a=null===a?null:a.stateNode;return a};exports.flushSync=function(a){return Rk(a)};exports.hydrate=function(a,b,c){if(!ol(b))throw Error(p(200));return rl(null,a,b,!0,c)};\nexports.hydrateRoot=function(a,b,c){if(!nl(a))throw Error(p(405));var d=null!=c&&c.hydratedSources||null,e=!1,f=\"\",g=kl;null!==c&&void 0!==c&&(!0===c.unstable_strictMode&&(e=!0),void 0!==c.identifierPrefix&&(f=c.identifierPrefix),void 0!==c.onRecoverableError&&(g=c.onRecoverableError));b=el(b,null,a,1,null!=c?c:null,e,!1,f,g);a[uf]=b.current;sf(a);if(d)for(a=0;a<d.length;a++)c=d[a],e=c._getVersion,e=e(c._source),null==b.mutableSourceEagerHydrationData?b.mutableSourceEagerHydrationData=[c,e]:b.mutableSourceEagerHydrationData.push(c,\ne);return new ml(b)};exports.render=function(a,b,c){if(!ol(b))throw Error(p(200));return rl(null,a,b,!1,c)};exports.unmountComponentAtNode=function(a){if(!ol(a))throw Error(p(40));return a._reactRootContainer?(Rk(function(){rl(null,null,a,!1,function(){a._reactRootContainer=null;a[uf]=null})}),!0):!1};exports.unstable_batchedUpdates=Qk;\nexports.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!ol(c))throw Error(p(200));if(null==a||void 0===a._reactInternals)throw Error(p(38));return rl(a,b,c,!1,d)};exports.version=\"18.3.1-next-f1338f8080-20240426\";\n","'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","'use strict';\n\nfunction checkDCE() {\n  /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\n  if (\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ === 'undefined' ||\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE !== 'function'\n  ) {\n    return;\n  }\n  if (process.env.NODE_ENV !== 'production') {\n    // This branch is unreachable because this function is only called\n    // in production, but the condition is true only in development.\n    // Therefore if the branch is still here, dead code elimination wasn't\n    // properly applied.\n    // Don't change the message. React DevTools relies on it. Also make sure\n    // this message doesn't occur elsewhere in this function, or it will cause\n    // a false positive.\n    throw new Error('^_^');\n  }\n  try {\n    // Verify that the code above has been dead code eliminated (DCE'd).\n    __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE);\n  } catch (err) {\n    // DevTools shouldn't crash React, no matter what.\n    // We should still report in case we break this code.\n    console.error(err);\n  }\n}\n\nif (process.env.NODE_ENV === 'production') {\n  // DCE check should happen before ReactDOM bundle executes so that\n  // DevTools can report bad minification during injection.\n  checkDCE();\n  module.exports = require('./cjs/react-dom.production.min.js');\n} else {\n  module.exports = require('./cjs/react-dom.development.js');\n}\n","/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","/**\n * @license React\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var l=Symbol.for(\"react.element\"),n=Symbol.for(\"react.portal\"),p=Symbol.for(\"react.fragment\"),q=Symbol.for(\"react.strict_mode\"),r=Symbol.for(\"react.profiler\"),t=Symbol.for(\"react.provider\"),u=Symbol.for(\"react.context\"),v=Symbol.for(\"react.forward_ref\"),w=Symbol.for(\"react.suspense\"),x=Symbol.for(\"react.memo\"),y=Symbol.for(\"react.lazy\"),z=Symbol.iterator;function A(a){if(null===a||\"object\"!==typeof a)return null;a=z&&a[z]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}\nvar B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,D={};function E(a,b,e){this.props=a;this.context=b;this.refs=D;this.updater=e||B}E.prototype.isReactComponent={};\nE.prototype.setState=function(a,b){if(\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a)throw Error(\"setState(...): takes an object of state variables to update or a function which returns an object of state variables.\");this.updater.enqueueSetState(this,a,b,\"setState\")};E.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};function F(){}F.prototype=E.prototype;function G(a,b,e){this.props=a;this.context=b;this.refs=D;this.updater=e||B}var H=G.prototype=new F;\nH.constructor=G;C(H,E.prototype);H.isPureReactComponent=!0;var I=Array.isArray,J=Object.prototype.hasOwnProperty,K={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};\nfunction M(a,b,e){var d,c={},k=null,h=null;if(null!=b)for(d in void 0!==b.ref&&(h=b.ref),void 0!==b.key&&(k=\"\"+b.key),b)J.call(b,d)&&!L.hasOwnProperty(d)&&(c[d]=b[d]);var g=arguments.length-2;if(1===g)c.children=e;else if(1<g){for(var f=Array(g),m=0;m<g;m++)f[m]=arguments[m+2];c.children=f}if(a&&a.defaultProps)for(d in g=a.defaultProps,g)void 0===c[d]&&(c[d]=g[d]);return{$$typeof:l,type:a,key:k,ref:h,props:c,_owner:K.current}}\nfunction N(a,b){return{$$typeof:l,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function O(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===l}function escape(a){var b={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+a.replace(/[=:]/g,function(a){return b[a]})}var P=/\\/+/g;function Q(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(\"\"+a.key):b.toString(36)}\nfunction R(a,b,e,d,c){var k=typeof a;if(\"undefined\"===k||\"boolean\"===k)a=null;var h=!1;if(null===a)h=!0;else switch(k){case \"string\":case \"number\":h=!0;break;case \"object\":switch(a.$$typeof){case l:case n:h=!0}}if(h)return h=a,c=c(h),a=\"\"===d?\".\"+Q(h,0):d,I(c)?(e=\"\",null!=a&&(e=a.replace(P,\"$&/\")+\"/\"),R(c,b,e,\"\",function(a){return a})):null!=c&&(O(c)&&(c=N(c,e+(!c.key||h&&h.key===c.key?\"\":(\"\"+c.key).replace(P,\"$&/\")+\"/\")+a)),b.push(c)),1;h=0;d=\"\"===d?\".\":d+\":\";if(I(a))for(var g=0;g<a.length;g++){k=\na[g];var f=d+Q(k,g);h+=R(k,b,e,f,c)}else if(f=A(a),\"function\"===typeof f)for(a=f.call(a),g=0;!(k=a.next()).done;)k=k.value,f=d+Q(k,g++),h+=R(k,b,e,f,c);else if(\"object\"===k)throw b=String(a),Error(\"Objects are not valid as a React child (found: \"+(\"[object Object]\"===b?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":b)+\"). If you meant to render a collection of children, use an array instead.\");return h}\nfunction S(a,b,e){if(null==a)return a;var d=[],c=0;R(a,d,\"\",\"\",function(a){return b.call(e,a,c++)});return d}function T(a){if(-1===a._status){var b=a._result;b=b();b.then(function(b){if(0===a._status||-1===a._status)a._status=1,a._result=b},function(b){if(0===a._status||-1===a._status)a._status=2,a._result=b});-1===a._status&&(a._status=0,a._result=b)}if(1===a._status)return a._result.default;throw a._result;}\nvar U={current:null},V={transition:null},W={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:V,ReactCurrentOwner:K};function X(){throw Error(\"act(...) is not supported in production builds of React.\");}\nexports.Children={map:S,forEach:function(a,b,e){S(a,function(){b.apply(this,arguments)},e)},count:function(a){var b=0;S(a,function(){b++});return b},toArray:function(a){return S(a,function(a){return a})||[]},only:function(a){if(!O(a))throw Error(\"React.Children.only expected to receive a single React element child.\");return a}};exports.Component=E;exports.Fragment=p;exports.Profiler=r;exports.PureComponent=G;exports.StrictMode=q;exports.Suspense=w;\nexports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W;exports.act=X;\nexports.cloneElement=function(a,b,e){if(null===a||void 0===a)throw Error(\"React.cloneElement(...): The argument must be a React element, but you passed \"+a+\".\");var d=C({},a.props),c=a.key,k=a.ref,h=a._owner;if(null!=b){void 0!==b.ref&&(k=b.ref,h=K.current);void 0!==b.key&&(c=\"\"+b.key);if(a.type&&a.type.defaultProps)var g=a.type.defaultProps;for(f in b)J.call(b,f)&&!L.hasOwnProperty(f)&&(d[f]=void 0===b[f]&&void 0!==g?g[f]:b[f])}var f=arguments.length-2;if(1===f)d.children=e;else if(1<f){g=Array(f);\nfor(var m=0;m<f;m++)g[m]=arguments[m+2];d.children=g}return{$$typeof:l,type:a.type,key:c,ref:k,props:d,_owner:h}};exports.createContext=function(a){a={$$typeof:u,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null};a.Provider={$$typeof:t,_context:a};return a.Consumer=a};exports.createElement=M;exports.createFactory=function(a){var b=M.bind(null,a);b.type=a;return b};exports.createRef=function(){return{current:null}};\nexports.forwardRef=function(a){return{$$typeof:v,render:a}};exports.isValidElement=O;exports.lazy=function(a){return{$$typeof:y,_payload:{_status:-1,_result:a},_init:T}};exports.memo=function(a,b){return{$$typeof:x,type:a,compare:void 0===b?null:b}};exports.startTransition=function(a){var b=V.transition;V.transition={};try{a()}finally{V.transition=b}};exports.unstable_act=X;exports.useCallback=function(a,b){return U.current.useCallback(a,b)};exports.useContext=function(a){return U.current.useContext(a)};\nexports.useDebugValue=function(){};exports.useDeferredValue=function(a){return U.current.useDeferredValue(a)};exports.useEffect=function(a,b){return U.current.useEffect(a,b)};exports.useId=function(){return U.current.useId()};exports.useImperativeHandle=function(a,b,e){return U.current.useImperativeHandle(a,b,e)};exports.useInsertionEffect=function(a,b){return U.current.useInsertionEffect(a,b)};exports.useLayoutEffect=function(a,b){return U.current.useLayoutEffect(a,b)};\nexports.useMemo=function(a,b){return U.current.useMemo(a,b)};exports.useReducer=function(a,b,e){return U.current.useReducer(a,b,e)};exports.useRef=function(a){return U.current.useRef(a)};exports.useState=function(a){return U.current.useState(a)};exports.useSyncExternalStore=function(a,b,e){return U.current.useSyncExternalStore(a,b,e)};exports.useTransition=function(){return U.current.useTransition()};exports.version=\"18.3.1\";\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.min.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","/**\n * @license React\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';function f(a,b){var c=a.length;a.push(b);a:for(;0<c;){var d=c-1>>>1,e=a[d];if(0<g(e,b))a[d]=b,a[c]=e,c=d;else break a}}function h(a){return 0===a.length?null:a[0]}function k(a){if(0===a.length)return null;var b=a[0],c=a.pop();if(c!==b){a[0]=c;a:for(var d=0,e=a.length,w=e>>>1;d<w;){var m=2*(d+1)-1,C=a[m],n=m+1,x=a[n];if(0>g(C,c))n<e&&0>g(x,C)?(a[d]=x,a[n]=c,d=n):(a[d]=C,a[m]=c,d=m);else if(n<e&&0>g(x,c))a[d]=x,a[n]=c,d=n;else break a}}return b}\nfunction g(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}if(\"object\"===typeof performance&&\"function\"===typeof performance.now){var l=performance;exports.unstable_now=function(){return l.now()}}else{var p=Date,q=p.now();exports.unstable_now=function(){return p.now()-q}}var r=[],t=[],u=1,v=null,y=3,z=!1,A=!1,B=!1,D=\"function\"===typeof setTimeout?setTimeout:null,E=\"function\"===typeof clearTimeout?clearTimeout:null,F=\"undefined\"!==typeof setImmediate?setImmediate:null;\n\"undefined\"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(a){for(var b=h(t);null!==b;){if(null===b.callback)k(t);else if(b.startTime<=a)k(t),b.sortIndex=b.expirationTime,f(r,b);else break;b=h(t)}}function H(a){B=!1;G(a);if(!A)if(null!==h(r))A=!0,I(J);else{var b=h(t);null!==b&&K(H,b.startTime-a)}}\nfunction J(a,b){A=!1;B&&(B=!1,E(L),L=-1);z=!0;var c=y;try{G(b);for(v=h(r);null!==v&&(!(v.expirationTime>b)||a&&!M());){var d=v.callback;if(\"function\"===typeof d){v.callback=null;y=v.priorityLevel;var e=d(v.expirationTime<=b);b=exports.unstable_now();\"function\"===typeof e?v.callback=e:v===h(r)&&k(r);G(b)}else k(r);v=h(r)}if(null!==v)var w=!0;else{var m=h(t);null!==m&&K(H,m.startTime-b);w=!1}return w}finally{v=null,y=c,z=!1}}var N=!1,O=null,L=-1,P=5,Q=-1;\nfunction M(){return exports.unstable_now()-Q<P?!1:!0}function R(){if(null!==O){var a=exports.unstable_now();Q=a;var b=!0;try{b=O(!0,a)}finally{b?S():(N=!1,O=null)}}else N=!1}var S;if(\"function\"===typeof F)S=function(){F(R)};else if(\"undefined\"!==typeof MessageChannel){var T=new MessageChannel,U=T.port2;T.port1.onmessage=R;S=function(){U.postMessage(null)}}else S=function(){D(R,0)};function I(a){O=a;N||(N=!0,S())}function K(a,b){L=D(function(){a(exports.unstable_now())},b)}\nexports.unstable_IdlePriority=5;exports.unstable_ImmediatePriority=1;exports.unstable_LowPriority=4;exports.unstable_NormalPriority=3;exports.unstable_Profiling=null;exports.unstable_UserBlockingPriority=2;exports.unstable_cancelCallback=function(a){a.callback=null};exports.unstable_continueExecution=function(){A||z||(A=!0,I(J))};\nexports.unstable_forceFrameRate=function(a){0>a||125<a?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported\"):P=0<a?Math.floor(1E3/a):5};exports.unstable_getCurrentPriorityLevel=function(){return y};exports.unstable_getFirstCallbackNode=function(){return h(r)};exports.unstable_next=function(a){switch(y){case 1:case 2:case 3:var b=3;break;default:b=y}var c=y;y=b;try{return a()}finally{y=c}};exports.unstable_pauseExecution=function(){};\nexports.unstable_requestPaint=function(){};exports.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=y;y=a;try{return b()}finally{y=c}};\nexports.unstable_scheduleCallback=function(a,b,c){var d=exports.unstable_now();\"object\"===typeof c&&null!==c?(c=c.delay,c=\"number\"===typeof c&&0<c?d+c:d):c=d;switch(a){case 1:var e=-1;break;case 2:e=250;break;case 5:e=1073741823;break;case 4:e=1E4;break;default:e=5E3}e=c+e;a={id:u++,callback:b,priorityLevel:a,startTime:c,expirationTime:e,sortIndex:-1};c>d?(a.sortIndex=c,f(t,a),null===h(r)&&a===h(t)&&(B?(E(L),L=-1):B=!0,K(H,c-d))):(a.sortIndex=e,f(r,a),A||z||(A=!0,I(J)));return a};\nexports.unstable_shouldYield=M;exports.unstable_wrapCallback=function(a){var b=y;return function(){var c=y;y=b;try{return a.apply(this,arguments)}finally{y=c}}};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/scheduler.production.min.js');\n} else {\n  module.exports = require('./cjs/scheduler.development.js');\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/\";","import React from 'react';\r\nimport UiManager from \"../../managers/uiManager\";\r\n\r\n// Import all images from the icons folder:\r\nimport playerIcon0 from '../../assets/playerIcons/player_0.png';\r\nimport playerIcon1 from '../../assets/playerIcons/player_1.png';\r\nimport playerIcon2 from '../../assets/playerIcons/player_2.png';\r\nimport playerIcon3 from '../../assets/playerIcons/player_3.png';\r\nimport playerIcon4 from '../../assets/playerIcons/player_4.png';\r\nimport playerIcon5 from '../../assets/playerIcons/player_5.png';\r\nimport playerIcon6 from '../../assets/playerIcons/player_6.png';\r\nimport playerIcon7 from '../../assets/playerIcons/player_7.png';\r\nimport playerIcon8 from '../../assets/playerIcons/player_8.png';\r\nimport playerIcon9 from '../../assets/playerIcons/player_9.png';\r\nimport playerIcon10 from '../../assets/playerIcons/player_10.png';\r\n\r\nimport humanIcon1 from '../../assets/characterIcons/human_1.png';\r\nimport humanIcon2 from '../../assets/characterIcons/human_2.png';\r\nimport dwarfIcon1 from '../../assets/characterIcons/dwarf_1.png';\r\nimport dwarfIcon2 from '../../assets/characterIcons/dwarf_2.png';\r\nimport elfIcon1 from '../../assets/characterIcons/elf_1.png';\r\nimport elfIcon2 from '../../assets/characterIcons/elf_2.png';\r\nimport halfOrcIcon1 from '../../assets/characterIcons/halfOrc_1.png';\r\nimport halfOrcIcon2 from '../../assets/characterIcons/halfOrc_2.png';\r\nimport halfElfIcon1 from '../../assets/characterIcons/halfElf_1.png';\r\nimport halfElfIcon2 from '../../assets/characterIcons/halfElf_2.png';\r\nimport halflingIcon1 from '../../assets/characterIcons/halfling_1.png';\r\nimport halflingIcon2 from '../../assets/characterIcons/halfling_2.png';\r\n\r\nimport combat_human from '../../assets/combat/combat_humans.png';\r\nimport combat_cultists from '../../assets/combat/combat_cultists.png';\r\nimport combat_dragons from '../../assets/combat/combat_dragons.png';\r\nimport combat_dwarves from '../../assets/combat/combat_dwarves.png';\r\nimport combat_elves from '../../assets/combat/combat_elves.png';\r\nimport combat_goblins from '../../assets/combat/combat_goblins.png';\r\n//import combat_half_orcs from '../../assets/combat/combat_half_orcs.png';\r\nimport combat_halflings from '../../assets/combat/combat_halflings.png';\r\nimport combat_humans from  '../../assets/combat/combat_humans.png';\r\nimport combat_orcs from '../../assets/combat/combat_orcs.png';\r\nimport combat_undead from '../../assets/combat/combat_undead.png';\r\nimport combat_half_elves from '../../assets/combat/combat_half_elves.png';\r\nimport combat_bandits from '../../assets/combat/combat_bandits.png';\r\nimport combat_beasts from '../../assets/combat/combat_beasts.png';\r\n\r\nimport combat_deer from '../../assets/combat/combat_deer.png'; // Used in millstone mystery\r\nimport combat_bear from '../../assets/combat/combat_bear.png'; // Used in millstone mystery\r\n\r\nimport mainMenuBG from '../../assets/fullscreen/title.png'\r\nimport defaultBg from '../../assets/fullscreen/not-implemented.png'\r\nimport campaignBg from '../../assets/fullscreen/campaign.png'\r\nimport gameroomBg from '../../assets/fullscreen/gameroom.png'\r\n\r\nimport cultOfTheDeep1 from '../../assets/campaign/cult_of_the_deep_1.png';\r\nimport trolls1 from '../../assets/campaign/trolls_1.png';\r\nimport millstoneMystery1 from '../../assets/campaign/millstone_mystery.png';\r\n\r\n//Locations \r\nimport mm_TheOldMill from '../../assets/location/theoldmill.png';\r\nimport mm_l_quarry from '../../assets/location/mm_l_quarry.png';\r\nimport mm_l_road from '../../assets/location/mm_l_road.png';\r\nimport mm_l_entrance from '../../assets/location/mm_l_entrance.png';\r\nimport mm_l_tunnel from '../../assets/location/mm_l_tunnel2.png';\r\nimport mm_l_bridge from '../../assets/location/mm_l_bridge.png';\r\nimport mm_l_beach from '../../assets/location/mm_l_beach.png';\r\nimport mm_l_townville from '../../assets/location/mm_l_townville.png';\r\n\r\nimport cd_l_underthewell from '../../assets/location/cd_l_underthewell.png';\r\nimport cd_l_lakeside from '../../assets/location/cd_l_lakeside.png';\r\nimport cd_l_lakesidebrewery from '../../assets/location/cd_l_lakesidebrewery.png';\r\nimport cd_l_lakesidecliffs from '../../assets/location/cd_l_lakesidecliffs.png';\r\nimport cd_l_sagewoodtavern from '../../assets/location/cd_l_sagewoodtavern.png';\r\nimport cd_l_sagewoodbrewery from '../../assets/location/cd_l_sagewoodbrewery.png';\r\n\r\n//Encounters\r\nimport mm_millstone from '../../assets/encounter/millstone.png';\r\nimport mm_e_road from '../../assets/encounter/mm_e_road.png';\r\nimport mm_e_quarry from '../../assets/encounter/mm_e_quarry.png';\r\nimport mm_e_tunnels from '../../assets/encounter/mm_e_tunnels.png';\r\nimport mm_e_bandits from '../../assets/encounter/mm_e_bandits.png';\r\nimport mm_e_beach from '../../assets/encounter/mm_e_beach.png';\r\nimport mm_e_shipwreck from '../../assets/encounter/mm_e_shipwreck.png';\r\nimport mm_e_fire from '../../assets/encounter/mm_e_fire.png';\r\nimport mm_e_townville from '../../assets/encounter/mm_e_townville.png';\r\n\r\nimport cd_e_breweryexploration from '../../assets/encounter/cd_e_breweryexploration.png';\r\nimport cd_e_breweryfight from '../../assets/encounter/cd_e_breweryfight.png';\r\nimport cd_e_bythelake from '../../assets/encounter/cd_e_bythelake.png';\r\nimport cd_e_lakesidecliffs from '../../assets/encounter/cd_e_lakesidecliffs.png';\r\nimport cd_e_underthewell from '../../assets/encounter/cd_e_underthewell.png';\r\nimport cd_e_sagewoodtavern from '../../assets/encounter/cd_e_sagewoodtavern4.png';\r\nimport cd_e_sagewoodbrewery from '../../assets/encounter/cd_e_sagewoodbrewery.png';\r\n\r\nimport mm_l_mountain_camp from '../../assets/location/mm_l_mountain_camp.png'; \r\nimport mm_l_elven_town from '../../assets/location/mm_l_elven_town.png';\r\n\r\nimport mm_e_up_the_mountain from '../../assets/encounter/mm_e_mountain_path.png'; \r\nimport mm_e_pointed from '../../assets/encounter/mm_e_pointed.png';\r\nimport mm_l_witch from '../../assets/location/mm_l_witch.png'; \r\nimport mm_e_cabin from '../../assets/encounter/mm_e_cabin2.png'; \r\nimport mm_l_tunnel3 from '../../assets/location/mm_l_tunnel2.png'; \r\nimport mm_e_dwarves from '../../assets/encounter/mm_e_dwarves.png';\r\nimport mm_e_fairlight from '../../assets/encounter/mm_e_fairlight.png';\r\nimport mm_l_fairlight from '../../assets/location/mm_l_fairlight.png';\r\n\r\n// icons\r\nimport icon_treasure1 from '../../assets/icons/icon_treasure.png';\r\nimport icon_dmpoint from '../../assets/icons/icon_dm.png';\r\nimport icon_playerpoint from '../../assets/icons/icon_player.png';\r\n\r\n\r\n//Messages\r\nimport imp_icon from '../../assets/chat/imp.png';\r\nimport dm_icon from '../../assets/chat/dm.png';\r\nimport chat_die from '../../assets/chat/die.png';\r\n\r\n// Tutorial\r\nimport imp from '../../assets/tutorial/imp.png';\r\n\r\nimport event_combat from '../../assets/icons/event_combat.png';\r\nimport event_roleplay from '../../assets/icons/event_roleplay.png';\r\nimport event_puzzle from '../../assets/icons/event_puzzle.png';\r\nimport event_dungeon from '../../assets/icons/event_dungeon.png';\r\nimport event_perception from '../../assets/icons/event_perception.png';\r\nimport event_town from '../../assets/icons/event_town.png';\r\nimport event_travel from '../../assets/icons/event_travel.png';\r\nimport event_challenge from '../../assets/icons/event_challenge.png';\r\nimport event_trap from '../../assets/icons/event_trap.png';\r\nimport event_exploration from '../../assets/icons/event_exploration.png';\r\nimport event_exposition from '../../assets/icons/event_exposition.png';\r\n\r\n\r\n// scoring icons\r\nimport die_d4 from '../../assets/icons/d4.png';\r\nimport die_d6 from '../../assets/icons/d6.png';\r\nimport die_d20 from '../../assets/icons/d20.png';\r\n\r\n\r\n// Quest icons \r\nimport rickyrose from '../../assets/quest/rose.png';\r\nimport theface from '../../assets/quest/face.png';\r\n\r\n// Create a map of icon paths:\r\nconst imageMap: { [key: string]: string } = {\r\n    // Player Icons\r\n    player_0: playerIcon0,\r\n    player_1: playerIcon1,\r\n    player_2: playerIcon2,\r\n    player_3: playerIcon3,\r\n    player_4: playerIcon4,\r\n    player_5: playerIcon5,\r\n    player_6: playerIcon6,\r\n    player_7: playerIcon7,\r\n    player_8: playerIcon8,\r\n    player_9: playerIcon9,\r\n    player_10: playerIcon10,\r\n    // Character Icons\r\n    human_1: humanIcon1,\r\n    human_2: humanIcon2,\r\n    dwarf_1: dwarfIcon1,\r\n    dwarf_2: dwarfIcon2,\r\n    elf_1: elfIcon1,\r\n    elf_2: elfIcon2,\r\n    halfOrc_1: halfOrcIcon1,\r\n    halfOrc_2: halfOrcIcon2,\r\n    halfElf_1: halfElfIcon1,\r\n    halfElf_2: halfElfIcon2,\r\n    halfling_1: halflingIcon1,\r\n    halfling_2: halflingIcon2, \r\n     \r\n    // Fullscreens\r\n    main_menu: mainMenuBG,\r\n    default_bg: defaultBg,\r\n    campaign_bg: campaignBg,\r\n    gameroom_bg: gameroomBg,\r\n\r\n    // Campaign Icons\r\n    cult_of_the_deep_1: cultOfTheDeep1,\r\n    trolls_1: trolls1,\r\n    millstone_mystery_1: millstoneMystery1,\r\n    mountain_mystery: millstoneMystery1,\r\n\r\n    // Millstone Mystery\r\n    mm_l_oldMill: mm_TheOldMill,\r\n    mm_l_quarry: mm_l_quarry,\r\n    mm_l_road: mm_l_road,\r\n    mm_l_entrance: mm_l_entrance,\r\n    mm_l_tunnel: mm_l_tunnel,\r\n    mm_l_bridge: mm_l_bridge,\r\n    mm_l_beach: mm_l_beach,\r\n    mm_l_townville: mm_l_townville,\r\n    mm_e_millstone: mm_millstone,\r\n    mm_e_road: mm_e_road,\r\n    mm_e_quarry: mm_e_quarry,\r\n    mm_e_tunnels: mm_e_tunnels,\r\n    mm_e_bandits: mm_e_bandits,\r\n    mm_e_beach: mm_e_beach,\r\n    mm_e_shipwreck: mm_e_shipwreck,\r\n    mm_e_fire: mm_e_fire,\r\n    mm_e_townville: mm_e_townville,\r\n\r\n    // Cult of the Deep\r\n    cd_l_underthewell: cd_l_underthewell,\r\n    cd_l_lakeside: cd_l_lakeside,\r\n    cd_l_lakesidebrewery: cd_l_lakesidebrewery,\r\n    cd_l_lakesidecliffs: cd_l_lakesidecliffs,\r\n    cd_l_sagewoodtavern: cd_l_sagewoodtavern,\r\n    cd_l_sagewoodbrewery: cd_l_sagewoodbrewery,\r\n    cd_e_breweryexploration: cd_e_breweryexploration,\r\n    cd_e_breweryfight: cd_e_breweryfight,\r\n    cd_e_bythelake: cd_e_bythelake,\r\n    cd_e_lakesidecliffs: cd_e_lakesidecliffs,\r\n    cd_e_underthewell: cd_e_underthewell,\r\n    cd_e_sagewoodtavern: cd_e_sagewoodtavern,\r\n    cd_e_sagewoodbrewery: cd_e_sagewoodbrewery,\r\n    \r\n\r\n    // Mountain Mystery\r\n    mm_l_mountain_camp: mm_l_mountain_camp, // Used in mountain mystery\r\n    mm_l_elven_town: mm_l_elven_town, // Used in mountain mystery\r\n    mm_e_up_the_mountain: mm_e_up_the_mountain, // Used in mountain mystery\r\n    mm_e_pointed: mm_e_pointed,\r\n    mm_l_witch: mm_l_witch, \r\n    mm_e_cabin: mm_e_cabin, \r\n    mm_l_tunnel23: mm_l_tunnel3,\r\n    mm_e_dwarves: mm_e_dwarves, \r\n    mm_e_fairlight: mm_e_fairlight,\r\n    mm_l_fairlight: mm_l_fairlight,\r\n\r\n\r\n\r\n    // Tutorial\r\n    tutorial_mascot: imp,\r\n\r\n    // Messages\r\n    chat_imp: imp_icon,\r\n    chat_dm: dm_icon,\r\n    chat_die: chat_die,\r\n    number_die_4: chat_die,\r\n    number_die_6: chat_die,\r\n    number_die_8: chat_die,\r\n    number_die_10: chat_die,\r\n    number_die_12: chat_die,\r\n    number_die_20: chat_die,\r\n    number_die_100: chat_die,\r\n\r\n    // Combat Icons\r\n    combat_human: combat_human,\r\n    combat_cultists: combat_cultists,\r\n    combat_dragons: combat_dragons,\r\n    combat_dwarves: combat_dwarves,\r\n    combat_elves: combat_elves,\r\n    combat_goblins: combat_goblins,\r\n  //  combat_half_orcs: combat_half_orcs,\r\n    combat_halflings: combat_halflings,\r\n    combat_humans: combat_humans,\r\n    combat_orcs: combat_orcs,\r\n    combat_undead: combat_undead,\r\n    combat_half_elves: combat_half_elves,\r\n    combat_bandits: combat_bandits,\r\n    combat_beasts: combat_beasts,\r\n   \r\n    combat_deer: combat_deer, \r\n    combat_bear: combat_bear, \r\n\r\n    // Icons\r\n    icon_treasure1: icon_treasure1,\r\n    icon_dmpoint: icon_dmpoint, \r\n    icon_playerpoint: icon_playerpoint,\r\n\r\n    // Event Icons\r\n    event_combat: event_combat,\r\n    event_roleplay: event_roleplay,\r\n    event_puzzle: event_puzzle,\r\n    event_dungeon: event_dungeon,\r\n    event_perception: event_perception,\r\n    event_town: event_town,\r\n    event_travel: event_travel,\r\n    event_challenge: event_challenge,\r\n    event_trap: event_trap,\r\n    event_exposition: event_exposition,\r\n    \r\n    event_exploration: event_exploration,\r\n    // Scoring Icons\r\n    die_d4: die_d4,\r\n    die_d6: die_d6,   \r\n    die_d20: die_d20,\r\n\r\n    // Quests\r\n    rickyrose: rickyrose,\r\n    theface: theface,\r\n\r\n\r\n};\r\n\r\ninterface ImageProps {\r\n    imageId: string | undefined;\r\n}\r\n\r\nconst CImage: React.FC<ImageProps> = ({ imageId }) => {\r\n    if(imageId === \"none\") return null;\r\n    const path = imageMap[imageId || ''];\r\n    if (!path) {\r\n        console.error(`No image found for imageId: ${imageId}`);\r\n        return null;\r\n    }\r\n    return (\r\n        <img src={path} alt=\"Icon\" className=\"cimage\" />\r\n    );\r\n}\r\n\r\nexport default CImage","\r\n\r\nexport const COLORS = {\r\n    STATE: {\r\n      MAIN_MENU: '#FF0000',\r\n      CAMPAIGN_SETUP: '#00FF00',\r\n      PLAYER_RECRUITMENT: '#0000FF',\r\n      CHARACTER_CREATION: '#FFFF00',\r\n      SESSION_PREP: '#00FFFF',\r\n      SESSION: '#123abc',\r\n      SCORE: '#0F0F0F'\r\n    },\r\n    STATE_CHANGE_DURATION: 1000,\r\n  }\r\n  \r\n  export enum PLACE_TYPE {\r\n    VILLAGE = 'village',\r\n    TOWN = 'town',\r\n    CITY = 'city',\r\n    ABBEY = 'abbey',\r\n    CASTLE = 'castle',\r\n    FORTRESS = 'fortress',\r\n    TEMPLE = 'temple',\r\n    SHRINE = 'shrine',\r\n    TOWER = 'tower',\r\n  }\r\n\r\n  export enum RACE {\r\n    HUMAN = 'human',\r\n    ELF = 'elf',\r\n    DWARF = 'dwarf',\r\n    HALFLING = 'halfling',\r\n    HALF_ORC = 'half-orc',\r\n    HALF_ELF = \"HALF_ELF\",\r\n    NPC = 'npc'\r\n  }\r\n\r\n  export enum CHARACTER_CLASS {\r\n  \r\n    CLERIC = 'cleric',\r\n    DRUID = 'druid',\r\n    FIGHTER = 'fighter',\r\n    PALADIN = 'paladin',\r\n    ROGUE = 'rogue',\r\n    WIZARD = 'wizard',\r\n    NPC = 'npc'\r\n  }\r\n\r\n  export enum ABILITIES {\r\n    FIGHTING = 'fighting',\r\n    MAGIC = 'magic',\r\n    STEALTH = 'stealth',\r\n    HEALING = 'healing',\r\n    SPEAKING = 'speaking',\r\n  }\r\n\r\nexport const AVAILABILITY_RANGE = {\r\n  GOOD: 65,\r\n  BAD: 30\r\n}\r\n\r\nexport const THEME_FILLED_REQ = 3;\r\n  export const MAX_CHARS_PER_PLAYER = 1;\r\n\r\n  export enum ENCOUNTER_EVENT_TYPE  {\r\n    COMBAT='combat',\r\n    ROLEPLAY='roleplay',\r\n    PUZZLE='puzzle',\r\n    PERCEPTION='perception',\r\n    TOWN='town',\r\n    TRAVEL='travel',\r\n    CHALLENGE='challenge',\r\n    TRAP='trap',\r\n    CHARACTER_BACKSTORY='character backstory',\r\n    STORY='story',\r\n    EXPLORATION='exploration',\r\n    EXPOSITION='exposition',\r\n    FINALE='finale',\r\n    DUNGEON='dungeon',\r\n  }\r\n\r\n  export enum LEVELUP_OPTION {\r\n    REFRESH = 'refresh',\r\n    CHARACTER = 'character',\r\n    MAX_HAPPINESS = 'max_happiness',\r\n    MAX_ATTENTION = 'max_attention',\r\n    STRESS_BUFFER = 'stress_buffer',\r\n    PLAYER_TRAIT = 'player_trait',\r\n  }\r\n\r\n  export const PLAYER_EXP_LEVEL = [6, 6, 10, 10, 10, 20];","import { AVAILABILITY_RANGE } from '../consts/general';\nimport './playerRecruitment.scss';\n\n\n\ninterface ScheduleProps {\n    dayData: number[];\n    legend?: boolean;\n}\n\nconst daysOfWeek = [\n    { abbreviation: 'M', fullName: 'Monday' },\n    { abbreviation: 'T', fullName: 'Tuesday' },\n    { abbreviation: 'W', fullName: 'Wednesday' },\n    { abbreviation: 'R', fullName: 'Thursday' },\n    { abbreviation: 'F', fullName: 'Friday' },\n    { abbreviation: 'St', fullName: 'Saturday' },\n    { abbreviation: 'Sn', fullName: 'Sunday' },\n  ];\n\n  const availabiltyLegend = [\n    { name: 'Yes', percentage: AVAILABILITY_RANGE.GOOD + 1},\n    { name: 'Maybe', percentage: AVAILABILITY_RANGE.GOOD - 1},\n    { name: 'No', percentage: AVAILABILITY_RANGE.BAD - 1},\n  ]\n  \n  const getDayPercentage = (dayData: number[], dayIndex: number): number => {\n    return dayData[dayIndex]\n  };\n  \n  const getColorFromPercentage = (percentage: number): string => {\n    const red = Math.min(255, Math.floor((100 - percentage) * 2.55));\n    const green = Math.min(255, Math.floor(percentage * 2.55));\n    return `rgba(${red}, ${green}, 0, 0)`;\n    //return `rgb(${red}, ${green}, 0)`;\n  };\n\nconst getSymbolForPercentage = (percentage: number): string => {\n    if (percentage <= AVAILABILITY_RANGE.BAD) {\n        return 'X';\n    }\n    if (percentage > AVAILABILITY_RANGE.GOOD) {\n        return '✔';\n    }\n  \n    return '';\n}\n\nconst Schedule: React.FC<ScheduleProps> = ({dayData, legend = false}) => {\n    return (\n            <div className=\"week-display-days\">\n                {!legend && daysOfWeek.map((day, index) => {\n                    const percentage = getDayPercentage(dayData, index);\n                    const color = getColorFromPercentage(percentage);\n                    return (\n                    <div key={index} className=\"day-square\" style={{ backgroundColor: color }}>\n                        <div className=\"day-abbreviation\">{day.abbreviation}</div>\n                        <div className=\"day-symbol\">{getSymbolForPercentage(percentage)}</div>\n                        <div className=\"day-percentage\">{percentage}%</div>\n                    </div>\n                    );\n                })}\n                {legend && availabiltyLegend.map((legendEntry, index) => {\n                    const percentage =legendEntry.percentage;\n                    const color = getColorFromPercentage(percentage);\n                    return (\n                    <div key={index} className=\"day-square\" style={{ backgroundColor: color }}>\n                        <div className=\"day-abbreviation\">{legendEntry.name}</div>\n                        <div className=\"day-symbol\">{getSymbolForPercentage(percentage)}</div>\n                    </div>\n                    );\n                })}\n             </div>\n    )\n}\n\nexport default Schedule;","\nimport React from 'react';\nimport './globalUi.scss';\n\n\ninterface MoreInfoProps {\n   callback: () => void;\n   classname?: string;\n}\n\nconst MoreInfo: React.FC<MoreInfoProps> = ({ callback, classname='' }) => {\n    return (\n        <div className={`more-info ${classname}`} onClick={callback}>\n            <div className='more-info-text'>\n                ?\n            </div>\n        </div>\n    );\n};\n\nexport default MoreInfo;","import React, { createContext, useContext } from 'react';\nimport CharacterManager from '../managers/characterManager';\nimport AppManager from '../managers/appManager';\nimport CampaignManager from '../managers/campaignManager';\nimport PartyManager from '../managers/partyManager';\nimport UiManager from '../managers/uiManager';\nimport DataManager from '../managers/dataManager';\nimport SessionManager from '../managers/sessionManager';\nimport PlayerManager from '../managers/playerManager';\n\n\nconst AppManagerContext = createContext<AppManager | undefined>(undefined);\nconst DataManagerContext = createContext<DataManager | undefined>(undefined);\nconst CampaignManagerContext = createContext<CampaignManager | undefined>(undefined);\nconst SessionManagerContext = createContext<SessionManager | undefined>(undefined);\nconst PartyManagerContext = createContext<PartyManager | undefined>(undefined);\nconst UiManagerContext = createContext<UiManager | undefined>(undefined);\nconst CharacterManagerContext = createContext<CharacterManager | undefined>(undefined);\nconst PlayerManagerContext = createContext<PlayerManager | undefined>(undefined);\n\nexport const CharacterManagerProvider: React.FC<{ manager: CharacterManager, children: React.ReactNode }> = ({ manager, children }) => {\n  return (\n    <CharacterManagerContext.Provider value={manager}>\n      {children}\n    </CharacterManagerContext.Provider>\n  );\n};\n\nexport const PlayerManagerProvider: React.FC<{ manager: PlayerManager, children: React.ReactNode }> = ({ manager, children }) => {\n    return (\n    <PlayerManagerContext.Provider value={manager}>\n      {children}\n    </PlayerManagerContext.Provider>\n  );\n};\n\nexport const AppManagerProvider: React.FC<{ manager: AppManager, children: React.ReactNode }> = ({ manager, children }) => {\n  return (\n    <AppManagerContext.Provider value={manager}>\n      {children}\n    </AppManagerContext.Provider>\n  );\n};\n\nexport const DataManagerProvider: React.FC<{ manager: DataManager, children: React.ReactNode }> = ({ manager, children }) => {\n  return (\n    <DataManagerContext.Provider value={manager}>\n      {children}\n    </DataManagerContext.Provider>\n  );\n};\n\nexport const CampaignManagerProvider: React.FC<{ manager: CampaignManager, children: React.ReactNode }> = ({ manager, children }) => {\n  return (\n    <CampaignManagerContext.Provider value={manager}>\n      {children}\n    </CampaignManagerContext.Provider>\n  );\n};\n\nexport const SessionManagerProvider: React.FC<{ manager: SessionManager, children: React.ReactNode }> = ({ manager, children }) => {\n  return (\n    <SessionManagerContext.Provider value={manager}>\n      {children}\n    </SessionManagerContext.Provider>\n  );\n};\n\nexport const PartyManagerProvider: React.FC<{ manager: PartyManager, children: React.ReactNode }> = ({ manager, children }) => {\n  return (\n    <PartyManagerContext.Provider value={manager}>\n      {children}\n    </PartyManagerContext.Provider>\n  );\n};\n\nexport const UiManagerProvider: React.FC<{ manager: UiManager, children: React.ReactNode }> = ({ manager, children }) => {\n  return (\n    <UiManagerContext.Provider value={manager}>\n      {children}\n    </UiManagerContext.Provider>\n  );\n};\n\nexport const useCharacterManager = () => {\n  const context = useContext(CharacterManagerContext);\n  if (context === undefined) {\n    throw new Error('useCharacterManager must be used within a CharacterManagerProvider');\n  }\n  return context;\n};\n\nexport const usePlayerManager = () => {\n  const context = useContext(PlayerManagerContext);\n  if (context === undefined) {\n    throw new Error('usePlayerManager must be used within a PlayerManagerProvider');\n  }\n  return context;\n};\n\nexport const useAppManager = () => {\n    const context = useContext(AppManagerContext);\n    if (context === undefined) {\n        throw new Error('useAppManager must be used within a AppManagerProvider');\n    }\n    return context;\n    };\n\nexport const useDataManager = () => {\n    const context = useContext(DataManagerContext);\n    if (context === undefined) {\n        throw new Error('useDataManager must be used within a DataManagerProvider');\n    }\n    return context;\n    }\n\nexport const useCampaignManager = () => {\n    const context = useContext(CampaignManagerContext);\n    if (context === undefined) {\n        throw new Error('useCampaignManager must be used within a CampaignManagerProvider');\n    }\n    return context;\n    }\n\nexport const useSessionManager = () => {\n    const context = useContext(SessionManagerContext);\n    if (context === undefined) {\n        throw new Error('useSessionManager must be used within a SessionManagerProvider');\n    }\n    return context;\n    }\n\nexport const usePartyManager = () => {\n    const context = useContext(PartyManagerContext);\n    if (context === undefined) {\n        throw new Error('usePartyManager must be used within a PartyManagerProvider');\n    }\n    return context;\n    }\n\nexport const useUiManager = () => {\n    const context = useContext(UiManagerContext);\n    if (context === undefined) {\n        throw new Error('useUiManager must be used within a UiManagerProvider');\n    }\n    return context;\n    }\n    ","\nexport enum APP_STATE {\n    MAIN_MENU = 'main-menu',\n    CAMPAIGN_SETUP = 'campaign-setup',\n    PLAYER_RECRUITMENT = 'player-recruitment',\n    CHARACTER_CREATION = 'character-creation',\n    SESSION_OVERVIEW = 'session-setup',\n    SESSION = 'session',\n    SCORE = 'score',\n  }\n\n\nexport const DEFAULT_STATE_CONFIG = {\n    nextState: APP_STATE.MAIN_MENU,\n    ui: {\n        showCharacterBar: false,\n    },\n    background_image_id: 'default_bg',\n    bg_transition_mode: 'none',\n    secondary_bg_image_id: 'none',\n    secondary_image_pos: 'none',\n}\n\nexport const STATE_CONFIG = {\n    [APP_STATE.MAIN_MENU]: {\n        nextState: APP_STATE.CAMPAIGN_SETUP,\n        ui: {\n            showCharacterBar: false,\n        },\n        background_image_id: 'main_menu',\n    },\n    [APP_STATE.CAMPAIGN_SETUP]: {\n        nextState: APP_STATE.PLAYER_RECRUITMENT,\n        ui: {\n            showCharacterBar: false,\n        },\n        background_image_id: 'main_menu',\n        bg_transition_mode: 'slide-down',\n        secondary_bg_image_id: 'campaign_bg',\n        secondary_image_pos: 'bottom',\n    },\n    [APP_STATE.PLAYER_RECRUITMENT]: {\n        nextState: APP_STATE.CHARACTER_CREATION,\n        ui: {\n            showCharacterBar: false,\n        },\n        background_image_id: 'main_menu',\n        bg_transition_mode: 'slide-right',\n    },\n    [APP_STATE.CHARACTER_CREATION]: {\n        nextState: APP_STATE.SESSION_OVERVIEW,\n        ui: {\n            showCharacterBar: false,\n        },\n        background_image_id: 'main_menu',\n        bg_transition_mode: 'slide-left',\n    },\n    [APP_STATE.SESSION_OVERVIEW]: {\n        nextState: APP_STATE.SESSION,\n        ui: {\n            showCharacterBar: false,\n        },\n        background_image_id: 'none',\n        bg_transition_mode: 'none',\n        secondary_bg_image_id: 'none',\n    },\n    [APP_STATE.SESSION]: {\n        nextState: APP_STATE.SCORE,\n        ui: {\n            showCharacterBar: false,\n        },\n        background_image_id: 'none',\n        secondary_bg_image_id: 'none',\n\n    },\n    [APP_STATE.SCORE]: {\n        nextState: APP_STATE.MAIN_MENU,\n        ui: {\n            showCharacterBar: false,\n        }\n    },\n}","import { Attribute, ATTRIBUTE_TYPE, Character, Gear } from \"../models\"\r\nimport { CHARACTER_CLASS, RACE } from \"./general\";\r\n\r\n// Character level-up readiness constants\r\nexport const CHARACTER_READINESS_THRESHOLDS = {\r\n  VERY_UNREADY: 20,\r\n  UNREADY: 50,\r\n  READY_START: 50,\r\n  READY_END: 64,\r\n  PERFECT_START: 65,\r\n  PERFECT_END: 74,\r\n  READY_SECOND_START: 75,\r\n  READY_SECOND_END: 90,\r\n  OVERREADY: 91\r\n} as const;\r\n\r\nexport enum CHARACTER_READINESS_LEVEL {\r\n  VERY_UNREADY = 'very-unready',\r\n  UNREADY = 'unready',\r\n  READY = 'ready',\r\n  PERFECT = 'perfect',\r\n  OVERREADY = 'overready'\r\n}\r\n\r\n// Helper function to get character readiness level from experience\r\nexport function getCharacterReadinessLevel(experience: number): CHARACTER_READINESS_LEVEL {\r\n  if (experience < CHARACTER_READINESS_THRESHOLDS.VERY_UNREADY) {\r\n    return CHARACTER_READINESS_LEVEL.VERY_UNREADY;\r\n  }\r\n  if (experience < CHARACTER_READINESS_THRESHOLDS.UNREADY) {\r\n    return CHARACTER_READINESS_LEVEL.UNREADY;\r\n  }\r\n  if (experience < CHARACTER_READINESS_THRESHOLDS.PERFECT_START) {\r\n    return CHARACTER_READINESS_LEVEL.READY;\r\n  }\r\n  if (experience < CHARACTER_READINESS_THRESHOLDS.READY_SECOND_START) {\r\n    return CHARACTER_READINESS_LEVEL.PERFECT;\r\n  }\r\n  if (experience <= CHARACTER_READINESS_THRESHOLDS.READY_SECOND_END) {\r\n    return CHARACTER_READINESS_LEVEL.READY;\r\n  }\r\n  return CHARACTER_READINESS_LEVEL.OVERREADY;\r\n}\r\n\r\n// Helper function to get readiness symbol for UI display\r\nexport function getCharacterReadinessSymbol(experience: number): string {\r\n  const level = getCharacterReadinessLevel(experience);\r\n  switch (level) {\r\n    case CHARACTER_READINESS_LEVEL.VERY_UNREADY:\r\n    case CHARACTER_READINESS_LEVEL.UNREADY:\r\n      return '✗';\r\n    case CHARACTER_READINESS_LEVEL.READY:\r\n      return '✓';\r\n    case CHARACTER_READINESS_LEVEL.PERFECT:\r\n      return '!';\r\n    case CHARACTER_READINESS_LEVEL.OVERREADY:\r\n      return '!';\r\n    default:\r\n      return '?';\r\n  }\r\n}\r\n\r\n// Helper function to get happiness modifier for level up\r\nexport function getCharacterLevelUpHappinessModifier(experience: number): number {\r\n  const level = getCharacterReadinessLevel(experience);\r\n  switch (level) {\r\n    case CHARACTER_READINESS_LEVEL.VERY_UNREADY:\r\n      return -2; // All other players lose happiness\r\n    case CHARACTER_READINESS_LEVEL.UNREADY:\r\n      return -1; // All other players lose happiness\r\n    case CHARACTER_READINESS_LEVEL.READY:\r\n      return 1;\r\n    case CHARACTER_READINESS_LEVEL.PERFECT:\r\n      return 2;\r\n    case CHARACTER_READINESS_LEVEL.OVERREADY:\r\n      return 0;\r\n    default:\r\n      return 0;\r\n  }\r\n}\r\n\r\n// Helper function to get CSS class name for readiness level\r\nexport function getCharacterReadinessClass(experience: number): string {\r\n  return getCharacterReadinessLevel(experience);\r\n}\r\n\r\n// Helper function to get readiness description for tooltips\r\nexport function getCharacterReadinessDescription(experience: number): string {\r\n  const level = getCharacterReadinessLevel(experience);\r\n  switch (level) {\r\n    case CHARACTER_READINESS_LEVEL.VERY_UNREADY:\r\n      return 'Very Unready: All other players -2 happiness';\r\n    case CHARACTER_READINESS_LEVEL.UNREADY:\r\n      return 'Unready: All other players -1 happiness';\r\n    case CHARACTER_READINESS_LEVEL.READY:\r\n      return 'Ready: +1 Happiness';\r\n    case CHARACTER_READINESS_LEVEL.PERFECT:\r\n      return 'Perfect: +2 Happiness';\r\n    case CHARACTER_READINESS_LEVEL.OVERREADY:\r\n      return 'Overready: +0 Happiness (-1 Happiness when OTHER Player\\'s Characters level up)';\r\n    default:\r\n      return 'Unknown readiness level';\r\n  }\r\n}\r\n\r\n\r\nexport const GEAR: Record<string, Gear> = {\r\n    SWORD_1: {\r\n        name: \"Plus 1 Sword\",\r\n        attributes: {\r\n            [ATTRIBUTE_TYPE.COMBAT]: 1\r\n        }\r\n    },\r\n    MIRROR_SHIELD: {\r\n      name: \"Mirror Shield\",\r\n      attributes: {\r\n          [ATTRIBUTE_TYPE.COMBAT]: 2,\r\n          [ATTRIBUTE_TYPE.TOOLS]: 2\r\n      }\r\n    },\r\n    WAND_5: {\r\n        name: \"Spellring\",\r\n        attributes: {\r\n            [ATTRIBUTE_TYPE.MAGIC]: 2\r\n        }\r\n    },\r\n    HELPFUL_IMP: {\r\n        name: \"Helpful Imp\",\r\n        attributes: \r\n        {\r\n            [ATTRIBUTE_TYPE.COMBAT]: 1,\r\n            [ATTRIBUTE_TYPE.TOOLS]: 1,\r\n            [ATTRIBUTE_TYPE.MAGIC]: 1,\r\n        }\r\n    },\r\n    STONECUTTER: {\r\n        name: \"Stonecutter\",\r\n        attributes: {\r\n            [ATTRIBUTE_TYPE.TOOLS]: 5\r\n        }\r\n    },\r\n    CLOAK_OF_LEVITATION: {\r\n      name: \"Cloak of Levitation\",\r\n      attributes: {\r\n          [ATTRIBUTE_TYPE.MAGIC]: 1,\r\n          [ATTRIBUTE_TYPE.TOOLS]: 1\r\n      }\r\n    },\r\n    WAND_OF_MISSILES: {\r\n      name: \"Wand of Missiles\",\r\n      attributes: {\r\n          [ATTRIBUTE_TYPE.MAGIC]: 2,\r\n          [ATTRIBUTE_TYPE.COMBAT]: 1\r\n      }\r\n    },\r\n    GLOVES_OF_THE_SPIDER: {\r\n    name: \"Gloves of the Spider\",\r\n    attributes: {\r\n        [ATTRIBUTE_TYPE.TOOLS]: 3\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport function getRaceAttributes(character: Character) {\r\n    switch(character.race) {\r\n      case RACE.DWARF:\r\n        return { [ATTRIBUTE_TYPE.COMBAT]: 2, \r\n                 [ATTRIBUTE_TYPE.MAGIC]: 0,\r\n                 [ATTRIBUTE_TYPE.TOOLS]: 1\r\n                };\r\n      case RACE.ELF: \r\n        return { [ATTRIBUTE_TYPE.COMBAT]: 1, \r\n                 [ATTRIBUTE_TYPE.MAGIC]: 3,\r\n                 [ATTRIBUTE_TYPE.TOOLS]: 0\r\n              };\r\n      case RACE.HUMAN: \r\n        return { [ATTRIBUTE_TYPE.COMBAT]: 1, \r\n                 [ATTRIBUTE_TYPE.MAGIC]: 1,\r\n                 [ATTRIBUTE_TYPE.TOOLS]: 1\r\n            };\r\n      case RACE.HALFLING:\r\n        return { [ATTRIBUTE_TYPE.COMBAT]: 1, \r\n                 [ATTRIBUTE_TYPE.MAGIC]: 0,\r\n                 [ATTRIBUTE_TYPE.TOOLS]: 3\r\n              };\r\n      case RACE.HALF_ORC: \r\n        return { [ATTRIBUTE_TYPE.COMBAT]: 3, \r\n                 [ATTRIBUTE_TYPE.MAGIC]: 0,\r\n                 [ATTRIBUTE_TYPE.TOOLS]: 0\r\n              };\r\n      case RACE.HALF_ELF:\r\n        return { [ATTRIBUTE_TYPE.COMBAT]: 1, \r\n                 [ATTRIBUTE_TYPE.MAGIC]: 2,\r\n                 [ATTRIBUTE_TYPE.TOOLS]: 0\r\n              };\r\n      case RACE.NPC:\r\n        return { [ATTRIBUTE_TYPE.COMBAT]: 0, \r\n                  [ATTRIBUTE_TYPE.MAGIC]: 0,\r\n                  [ATTRIBUTE_TYPE.TOOLS]: 0\r\n              };\r\n    }\r\n  }\r\n\r\n\r\nexport function getGearAttributes(character: Character) {\r\n  const gearAttributes = {\r\n    [ATTRIBUTE_TYPE.COMBAT]: 0,\r\n    [ATTRIBUTE_TYPE.MAGIC]: 0,\r\n    [ATTRIBUTE_TYPE.TOOLS]: 0,\r\n  };\r\n  \r\n  character.gear.forEach(gear => {  \r\n    gearAttributes[ATTRIBUTE_TYPE.COMBAT] += gear.attributes[ATTRIBUTE_TYPE.COMBAT] ?? 0;\r\n    gearAttributes[ATTRIBUTE_TYPE.MAGIC] += gear.attributes[ATTRIBUTE_TYPE.MAGIC] ?? 0;\r\n    gearAttributes[ATTRIBUTE_TYPE.TOOLS] += gear.attributes[ATTRIBUTE_TYPE.TOOLS] ?? 0;\r\n    });\r\n    return gearAttributes;\r\n}\r\n\r\nexport function getCombinedAttributes(character: Character | undefined, includeHeroState = false) {\r\n\r\n  if(!character) {\r\n    return { [ATTRIBUTE_TYPE.COMBAT]: 0, [ATTRIBUTE_TYPE.MAGIC]: 0, [ATTRIBUTE_TYPE.TOOLS]: 0 };\r\n  }\r\n\r\n  const raceAttributes = getRaceAttributes(character);\r\n  const gearAttributes = getGearAttributes(character);\r\n  const classAttributes = getCombinedClassAttributes(character);\r\n\r\n  const combinedAttributes: { [key in ATTRIBUTE_TYPE]: number } = {\r\n    [ATTRIBUTE_TYPE.COMBAT]: 0 +\r\n      raceAttributes[ATTRIBUTE_TYPE.COMBAT] + \r\n      classAttributes[ATTRIBUTE_TYPE.COMBAT] + \r\n      gearAttributes[ATTRIBUTE_TYPE.COMBAT],\r\n    [ATTRIBUTE_TYPE.MAGIC]: 0 +\r\n      raceAttributes[ATTRIBUTE_TYPE.MAGIC] + \r\n      classAttributes[ATTRIBUTE_TYPE.MAGIC] + \r\n      gearAttributes[ATTRIBUTE_TYPE.MAGIC],\r\n    [ATTRIBUTE_TYPE.TOOLS]: 0 +\r\n      raceAttributes[ATTRIBUTE_TYPE.TOOLS] + \r\n      classAttributes[ATTRIBUTE_TYPE.TOOLS] + \r\n      gearAttributes[ATTRIBUTE_TYPE.TOOLS]\r\n  };\r\n\r\n\r\n  if(includeHeroState) {\r\n    if (character.attributeLoss) {\r\n      combinedAttributes[ATTRIBUTE_TYPE.COMBAT] -= character.attributeLoss[ATTRIBUTE_TYPE.COMBAT] ?? 0;\r\n      combinedAttributes[ATTRIBUTE_TYPE.MAGIC] -= character.attributeLoss[ATTRIBUTE_TYPE.MAGIC] ?? 0;\r\n      combinedAttributes[ATTRIBUTE_TYPE.TOOLS] -= character.attributeLoss[ATTRIBUTE_TYPE.TOOLS] ?? 0;\r\n    }\r\n  }\r\n\r\n  return combinedAttributes;\r\n}\r\n\r\n\r\nexport function getCombinedClassAttributes(character: Character) {\r\n    const baseAttribute = {\r\n        [ATTRIBUTE_TYPE.COMBAT]: 0,\r\n        [ATTRIBUTE_TYPE.MAGIC]: 0,\r\n        [ATTRIBUTE_TYPE.TOOLS]: 0\r\n    }\r\n    for(let l=0; l< character.level; l++){\r\n        let level = l+1;\r\n        baseAttribute[ATTRIBUTE_TYPE.COMBAT] += getClassAttributes(character.character_class, level)[ATTRIBUTE_TYPE.COMBAT];\r\n        baseAttribute[ATTRIBUTE_TYPE.MAGIC] += getClassAttributes(character.character_class, level)[ATTRIBUTE_TYPE.MAGIC];\r\n        baseAttribute[ATTRIBUTE_TYPE.TOOLS] += getClassAttributes(character.character_class, level)[ATTRIBUTE_TYPE.TOOLS];\r\n    }\r\n    return baseAttribute;\r\n\r\n}\r\n\r\n  // This is NOT a total for all levels. It is how much a char gains for a SPECIFIC level. \r\nexport function getClassAttributes(characterClass: CHARACTER_CLASS, level: number) {\r\n  \r\n    const oddLevel = level % 2;\r\n    const evenLevel = (level +1) % 2;\r\n    switch(characterClass) {\r\n      case CHARACTER_CLASS.CLERIC: //4\r\n        return { [ATTRIBUTE_TYPE.COMBAT]: 1 + oddLevel, \r\n                 [ATTRIBUTE_TYPE.MAGIC]: 2,\r\n                 [ATTRIBUTE_TYPE.TOOLS]: evenLevel\r\n            }\r\n        case CHARACTER_CLASS.DRUID: //4.5\r\n            return { [ATTRIBUTE_TYPE.COMBAT]: 1 + evenLevel, \r\n                     [ATTRIBUTE_TYPE.MAGIC]: 1 + oddLevel,\r\n                     [ATTRIBUTE_TYPE.TOOLS]: 1 + oddLevel \r\n                };\r\n        case CHARACTER_CLASS.FIGHTER: //4\r\n            return { [ATTRIBUTE_TYPE.COMBAT]: 3, \r\n                     [ATTRIBUTE_TYPE.MAGIC]: 0,\r\n                     [ATTRIBUTE_TYPE.TOOLS]: 1\r\n                };\r\n        case CHARACTER_CLASS.PALADIN: //4\r\n            return { [ATTRIBUTE_TYPE.COMBAT]: 2 + evenLevel , \r\n                     [ATTRIBUTE_TYPE.MAGIC]: 1 ,\r\n                     [ATTRIBUTE_TYPE.TOOLS]: oddLevel\r\n                };\r\n       \r\n        case CHARACTER_CLASS.ROGUE: //4.5\r\n            return { [ATTRIBUTE_TYPE.COMBAT]: 1, \r\n                     [ATTRIBUTE_TYPE.MAGIC]: 0,\r\n                     [ATTRIBUTE_TYPE.TOOLS]: 3 + oddLevel\r\n                };\r\n    \r\n        case CHARACTER_CLASS.WIZARD: //4.5\r\n            return { [ATTRIBUTE_TYPE.COMBAT]: evenLevel, \r\n                     [ATTRIBUTE_TYPE.MAGIC]: 3,\r\n                     [ATTRIBUTE_TYPE.TOOLS]: 1\r\n                };\r\n    }\r\n    return { [ATTRIBUTE_TYPE.COMBAT]: 0,\r\n                [ATTRIBUTE_TYPE.MAGIC]: 0,\r\n                [ATTRIBUTE_TYPE.TOOLS]: 0\r\n    }\r\n}","import React from \"react\";\r\nimport {\r\n\tAttribute,\r\n\tATTRIBUTE_CONTRIBUTOR,\r\n\tATTRIBUTE_TYPE,\r\n\tCharacter,\r\n\tHeroCombatant,\r\n} from \"../../models\";\r\nimport {\r\n\tuseAppManager,\r\n\tuseCharacterManager,\r\n} from \"../managerContexts\";\r\nimport {\r\n\tgetRaceAttributes,\r\n\tgetClassAttributes,\r\n\tgetCombinedAttributes,\r\n} from \"../../consts/characterConsts\";\r\n\r\n// Generic attribute display props - can work with raw attributes\r\ninterface GenericAttributeDisplayProps {\r\n\tattributes: Attribute;\r\n\tlostAttributes?: Attribute;\r\n\tcollapsed?: boolean;\r\n\tshowAttributeLoss?: boolean;\r\n}\r\n\r\n// Character-specific attribute display props\r\ninterface CharacterAttributeDisplayProps {\r\n\thero: HeroCombatant | Character;\r\n\tcategory: ATTRIBUTE_CONTRIBUTOR;\r\n\tcollapsed?: boolean;\r\n\tshowAttributeLoss?: boolean;\r\n\toverviewDisplay?: boolean;\r\n}\r\n\r\nconst isHeroCombatant = (\r\n\thero: HeroCombatant | Character\r\n): hero is HeroCombatant => {\r\n\treturn \"character\" in hero || \"npcTag\" in hero;\r\n};\r\n\r\n// Generic component for displaying raw attributes\r\nconst AttributeDisplay: React.FC<GenericAttributeDisplayProps> = ({\r\n\tattributes,\r\n\tlostAttributes,\r\n\tcollapsed = false,\r\n\tshowAttributeLoss = false,\r\n}) => {\r\n\tconst characterManager = useCharacterManager();\r\n\r\n\tconst generateIcons = (attributeType: ATTRIBUTE_TYPE, value: number) => {\r\n\t\tconst icons = [];\r\n\t\tconst symbol = characterManager.getUFAttributeSymbol(attributeType);\r\n\t\tfor (let i = 0; i < value; i++) {\r\n\t\t\ticons.push(\r\n\t\t\t\t<span\r\n\t\t\t\t\tkey={`${attributeType}-${i}`}\r\n\t\t\t\t\tclassName={`attribute-icon ${attributeType}`}\r\n\t\t\t\t>\r\n\t\t\t\t\t{symbol}\r\n\t\t\t\t</span>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn icons;\r\n\t};\r\n\r\n\tif (collapsed) {\r\n\t\tconst allIcons = Object.keys(attributes).flatMap((key) =>\r\n\t\t\tgenerateIcons(\r\n\t\t\t\tkey as ATTRIBUTE_TYPE,\r\n\t\t\t\tattributes[key as keyof Attribute] || 0\r\n\t\t\t)\r\n\t\t);\r\n\t\treturn <div className=\"collapsed-attributes\">{allIcons}</div>;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"attribute-display-container\">\r\n\t\t\t{Object.keys(attributes).map((key) => (\r\n\t\t\t\t<div key={key} className=\"attribute-display\">\r\n\t\t\t\t\t<div className=\"attribute-title\">\r\n\t\t\t\t\t\t<b>{characterManager.getUFAttributeName(key as ATTRIBUTE_TYPE)}</b>:\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{lostAttributes && showAttributeLoss ? (\r\n\t\t\t\t\t\t<div className=\"attribute-container\">\r\n\t\t\t\t\t\t\t<div className=\"attributes-retained\">\r\n\t\t\t\t\t\t\t\t{generateIcons(\r\n\t\t\t\t\t\t\t\t\tkey as keyof Attribute,\r\n\t\t\t\t\t\t\t\t\tattributes[key as keyof Attribute] || 0\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"attributes-lost\">\r\n\t\t\t\t\t\t\t\t{generateIcons(\r\n\t\t\t\t\t\t\t\t\tkey as keyof Attribute,\r\n\t\t\t\t\t\t\t\t\tlostAttributes[key as keyof Attribute] || 0\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<div className=\"attribute-container\">\r\n\t\t\t\t\t\t\t{generateIcons(\r\n\t\t\t\t\t\t\t\tkey as keyof Attribute,\r\n\t\t\t\t\t\t\t\tattributes[key as keyof Attribute] || 0\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\n// Character-specific component with all the complex logic\r\nconst CharacterAttributeDisplay: React.FC<CharacterAttributeDisplayProps> = ({\r\n\thero,\r\n\tcategory,\r\n\tcollapsed,\r\n\tshowAttributeLoss,\r\n\toverviewDisplay = false,\r\n}) => {\r\n\tconst characterManager = useCharacterManager();\r\n\tconst appManager = useAppManager();\r\n\tconst combatManager = appManager.getCombatManager();\r\n\r\n\tlet npcAttributes = {\r\n\t\t[ATTRIBUTE_TYPE.COMBAT]: 0,\r\n\t\t[ATTRIBUTE_TYPE.MAGIC]: 0,\r\n\t\t[ATTRIBUTE_TYPE.TOOLS]: 0,\r\n\t};\r\n\tlet character;\r\n\r\n\tif (isHeroCombatant(hero) && hero.npcTag) {\r\n\t\tnpcAttributes = combatManager.getNPCAttributes(hero.npcTag);\r\n\t\thero.character = characterManager.generateNPC(hero.npcTag);\r\n\r\n\t\tcategory = ATTRIBUTE_CONTRIBUTOR.NPC;\r\n\t}\r\n\r\n\tcharacter = isHeroCombatant(hero) ? (hero.character as Character) : hero;\r\n\r\n\tconst raceAttributes = getRaceAttributes(character);\r\n\tconst combinedattributesWithLoss = getCombinedAttributes(character, true);\r\n\tconst lostAttributes = character.attributeLoss || {\r\n\t\t[ATTRIBUTE_TYPE.COMBAT]: 0,\r\n\t\t[ATTRIBUTE_TYPE.MAGIC]: 0,\r\n\t\t[ATTRIBUTE_TYPE.TOOLS]: 0,\r\n\t};\r\n\tconst combinedAttributes = getCombinedAttributes(character);\r\n\r\n\tconst generateIcons = (attributeType: ATTRIBUTE_TYPE, value: number) => {\r\n\t\tconst icons = [];\r\n\t\tconst symbol = characterManager.getUFAttributeSymbol(attributeType);\r\n\t\tfor (let i = 0; i < value; i++) {\r\n\t\t\ticons.push(\r\n\t\t\t\t<span\r\n\t\t\t\t\tkey={`${attributeType}-${i}`}\r\n\t\t\t\t\tclassName={`attribute-icon ${attributeType}`}\r\n\t\t\t\t>\r\n\t\t\t\t\t{symbol}\r\n\t\t\t\t</span>\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn icons;\r\n\t};\r\n\r\n\tconst getGenericAttributesDisplay = (\r\n\t\tattributes: Attribute,\r\n\t\tlostAttributes?: Attribute\r\n\t) => {\r\n\t\tif (collapsed) {\r\n\t\t\tconst allIcons = Object.keys(attributes).flatMap((key) =>\r\n\t\t\t\tgenerateIcons(\r\n\t\t\t\t\tkey as ATTRIBUTE_TYPE,\r\n\t\t\t\t\tattributes[key as keyof Attribute] || 0\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t\treturn <div className=\"collapsed-attributes\">{allIcons}</div>;\r\n\t\t} else {\r\n\t\t\treturn Object.keys(attributes).map((key) => (\r\n\t\t\t\t<div key={key} className=\"attribute-display\">\r\n\t\t\t\t\t<div className=\"attribute-title\">\r\n\t\t\t\t\t\t<b>{characterManager.getUFAttributeName(key as ATTRIBUTE_TYPE)}</b>:\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{lostAttributes && showAttributeLoss ? (\r\n\t\t\t\t\t\t<div className=\"attribute-container\">\r\n\t\t\t\t\t\t\t<div className=\"attributes-retained\">\r\n\t\t\t\t\t\t\t\t{generateIcons(\r\n\t\t\t\t\t\t\t\t\tkey as keyof Attribute,\r\n\t\t\t\t\t\t\t\t\tattributes[key as keyof Attribute] || 0\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"attributes-lost\">\r\n\t\t\t\t\t\t\t\t{generateIcons(\r\n\t\t\t\t\t\t\t\t\tkey as keyof Attribute,\r\n\t\t\t\t\t\t\t\t\tlostAttributes[key as keyof Attribute] || 0\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<div className=\"attribute-container\">\r\n\t\t\t\t\t\t\t{generateIcons(\r\n\t\t\t\t\t\t\t\tkey as keyof Attribute,\r\n\t\t\t\t\t\t\t\tattributes[key as keyof Attribute] || 0\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t));\r\n\t\t}\r\n\t};\r\n\r\n\tconst getGearAttributesDisplay = () => {\r\n\t\tif (character.gear.length === 0) {\r\n\t\t\treturn <div></div>;\r\n\t\t}\r\n\r\n\t\treturn character.gear.map((gear) => {\r\n\t\t\treturn (\r\n\t\t\t\t<div key={gear.name} className=\"gear-attributes\">\r\n\t\t\t\t\t<div className=\"gear-title\">\r\n\t\t\t\t\t\t<b>{gear.name}: </b>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{getGenericAttributesDisplay(gear.attributes)}\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t});\r\n\t};\r\n\r\n\tconst getBackstoryElement = () => {\r\n\t\tconst backstory = character.backstory;\r\n\t\tconst nbCompleted = character.backstory.filter((bs) => bs.completed).length;\r\n\t\tconst placeholdersNeeded = 4 - backstory.length;\r\n\t\treturn (\r\n\t\t\t<div className=\"backstory-element\">\r\n\t\t\t\t<div className=\"backstory-title\">\r\n\t\t\t\t\t<b>Backstory : </b>\r\n\t\t\t\t\t{nbCompleted} / 4\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"backstory-tags\">\r\n\t\t\t\t\t{backstory.map((bs, index) => (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tkey={`backstory-${index}`}\r\n\t\t\t\t\t\t\tclassName={`tag-pill backstory-item ${\r\n\t\t\t\t\t\t\t\tbs.completed ? \"type-backstory\" : \"expected\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{bs.tag.name}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\t\t\t\t\t{[...Array(placeholdersNeeded)].map((_, index) => (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tkey={`placeholder-${index}`}\r\n\t\t\t\t\t\t\tclassName=\"tag-pill backstory-item expected\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t?\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tconst getClassAttributesDisplay = () => {\r\n\t\tconst levels = Array.from({ length: character.level }, (_, i) => i + 1);\r\n\r\n\t\treturn levels.map((level) => {\r\n\t\t\tconst classAttributes = getClassAttributes(\r\n\t\t\t\tcharacter.character_class,\r\n\t\t\t\tlevel\r\n\t\t\t);\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<div key={level} className=\"level-attributes\">\r\n\t\t\t\t\t<div className=\"level-title\">\r\n\t\t\t\t\t\t<b>Level {level}:</b>{\" \"}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{getGenericAttributesDisplay(classAttributes)}\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t});\r\n\t};\r\n\r\n\tconst getAttributesDisplay = () => {\r\n\t\tswitch (category) {\r\n\t\t\tcase ATTRIBUTE_CONTRIBUTOR.CHARACTER_CLASS:\r\n\t\t\t\treturn getClassAttributesDisplay();\r\n\t\t\tcase ATTRIBUTE_CONTRIBUTOR.GEAR:\r\n\t\t\t\treturn getGearAttributesDisplay();\r\n\t\t\tcase ATTRIBUTE_CONTRIBUTOR.RACE:\r\n\t\t\t\treturn getGenericAttributesDisplay(raceAttributes);\r\n\t\t\tcase ATTRIBUTE_CONTRIBUTOR.ALL:\r\n\t\t\t\tif (showAttributeLoss) {\r\n\t\t\t\t\treturn getGenericAttributesDisplay(\r\n\t\t\t\t\t\tcombinedattributesWithLoss,\r\n\t\t\t\t\t\tlostAttributes\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t\treturn getGenericAttributesDisplay(combinedAttributes);\r\n\t\t\tcase ATTRIBUTE_CONTRIBUTOR.NPC:\r\n\t\t\t\treturn getGenericAttributesDisplay(npcAttributes);\r\n\t\t\tdefault:\r\n\t\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"attribute-display-container\">\r\n\t\t\t{getAttributesDisplay()}\r\n\t\t\t{overviewDisplay && getGearAttributesDisplay()}\r\n\t\t\t{overviewDisplay && getBackstoryElement()}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\n// Export both components - keep CharacterAttributeDisplay as default for backwards compatibility\r\nexport default CharacterAttributeDisplay;\r\nexport { AttributeDisplay };\r\n","import React from 'react';\nimport { ATTRIBUTE_CONTRIBUTOR, Character, NOTEBOOK_CATEGORY } from '../models';\nimport Cimage from './UI/cimage';\nimport './characterCard.scss';\nimport MoreInfo from './UI/moreInfoButton';\nimport { useAppManager, useCharacterManager, useUiManager } from './managerContexts';\nimport { APP_STATE } from '../consts/states';\nimport AttributeDisplay from './UI/attributeDisplay';\n\n\ninterface CharacterCardProps {\n  character: Character;\n  isSelected: boolean;\n  onSelect: () => void;\n  showAbilities: boolean;\n  collapsed?: boolean;\n  isAssigned?: boolean;\n  isAssignedToOther?: boolean;\n}\n\nconst CharacterCard: React.FC<CharacterCardProps> = ({ character, isSelected, onSelect, showAbilities, collapsed, isAssigned, isAssignedToOther }) => {\n\n  const uiManager = useUiManager();\n  const characterManager = useCharacterManager();\n  const appManager = useAppManager();\n\n\n\n  const clickedMoreInfo = () => {\n    uiManager.showBasicNotebook(NOTEBOOK_CATEGORY.CHARACTER, character)\n  }\n\n  const showInfoOnClick = appManager.state !== APP_STATE.CHARACTER_CREATION;;\n\n  return (\n   \n    collapsed ? (\n      <div className=\"character-card collapsed\" onClick={onSelect}>\n        <div className=\"character-icon\">\n          <Cimage imageId={character.icon} />\n            <div className=\"character-initials\">{characterManager.getUFInitials(character)}</div>\n        </div>\n        <div className='character-collapsed-overlay'>\n        {showInfoOnClick ? \n          <MoreInfo \n            callback={clickedMoreInfo}\n          /> : \n          <div className=\"character-collapsed-unassign\">X</div>\n        }\n        </div>\n\n    </div>\n    ) : (\n    <div className={`character-card ${isSelected ? 'selected' : ''} ${isAssignedToOther ? 'assigned-to-other' : ''}`} onClick={onSelect}>\n      <div className={`character-card-container ${isAssigned ? 'assigned' : ''} `}>\n        <div className=\"character-card-header\">\n          <div className=\"character-info\">\n            <div className=\"character-name\">{character.name}</div>\n            <div className=\"character-details\">\n              <div className=\"character-race\">{characterManager.getUFRace(character.race)} {characterManager.getUFClass(character.character_class)}</div>\n            </div>\n            <AttributeDisplay hero={character} category={ATTRIBUTE_CONTRIBUTOR.ALL} collapsed={false} />\n          </div>\n          <div className=\"character-icon\">\n            <Cimage imageId={character.icon} />\n            <div className=\"character-level\">Level {character.level}</div>\n          </div>\n        </div>\n        {showAbilities && (\n          <div className=\"character-card-body\">\n            <div className=\"abilities-list\">\n              <ul>\n                {character.abilities.map((ability, index) => (\n                  <li key={index}>\n                    <strong>{ability}</strong>\n                  </li>\n                ))}\n              </ul>\n            </div>\n          </div>\n        )}\n      </div>\n      <MoreInfo\n        callback={clickedMoreInfo}\n      />\n      {isAssigned && <div className=\"character-assigned\">Assigned</div>}\n    </div>\n    )\n\n  );\n};\n\nexport default CharacterCard;","import React, { useRef, useEffect, useState } from 'react';\r\n\r\ninterface FillBarProps {\r\n    totalSegments: number;\r\n    filledSegments: number;\r\n    theme?: string;\r\n    label?: string;\r\n    buttonWhenFilled?: boolean;\r\n    onClickFilled?: () => void;\r\n    filledLabel?: string;\r\n    labelStyle?: 'over' | 'normal';\r\n}\r\n\r\nconst FillBar: React.FC<FillBarProps> = ({ totalSegments, filledSegments, theme = '', label, buttonWhenFilled = false, onClickFilled, filledLabel, labelStyle = 'normal' }) => {\r\n    \r\n    const previousFilledRef = useRef(filledSegments);\r\n    const [animatingSegments, setAnimatingSegments] = useState<number[]>([]);\r\n\r\n    // Track changes in filled segments and trigger animation\r\n    useEffect(() => {\r\n        const previousFilled = previousFilledRef.current;\r\n        if (filledSegments > previousFilled) {\r\n            // New segments were filled, animate the new ones\r\n            const newSegments = [];\r\n            for (let i = previousFilled; i < filledSegments; i++) {\r\n                newSegments.push(i);\r\n            }\r\n            setAnimatingSegments(newSegments);\r\n            \r\n            // Clear animation after 500ms\r\n            const timer = setTimeout(() => {\r\n                setAnimatingSegments([]);\r\n            }, 500);\r\n\r\n            // Update the ref for next comparison\r\n            previousFilledRef.current = filledSegments;\r\n\r\n            return () => clearTimeout(timer);\r\n        } else {\r\n            // Update ref even if no animation needed\r\n            previousFilledRef.current = filledSegments;\r\n        }\r\n    }, [filledSegments]);\r\n\r\n    const segments = Array.from({ length: totalSegments }, (_, index) => {\r\n        const isFilled = index < filledSegments;\r\n        const isAnimating = animatingSegments.includes(index);\r\n        \r\n        return (\r\n            <div\r\n                key={index}\r\n                className={`fill-bar-segment bg-theme-${theme} ${isFilled ? 'filled' : ''} ${isAnimating ? 'fill-glow-animation' : ''}`}\r\n            />\r\n        );\r\n    });\r\n      \r\n    const filled = filledSegments >= totalSegments;\r\n    const themeClass = 'theme-' + theme;\r\n    if(labelStyle !== 'over') {\r\n        return ( \r\n            <div className={`fill-bar`}>\r\n                {label && <div className={`fill-bar-label text-theme-${theme || ''}`}>{label}</div>}\r\n                <div className={`fill-bar-container ${filled ? 'filled' : ''} ${themeClass}`}>\r\n                    {filled && buttonWhenFilled ? (\r\n                        <div className={`fill-bar-filled-button ${themeClass}`} onClick={onClickFilled}>{filledLabel}</div>\r\n                     ) : (\r\n                     segments\r\n                    )\r\n                    }\r\n                </div>\r\n            </div>\r\n            )\r\n    }\r\n\r\n\r\n \r\n    return (\r\n        <div className={`fill-bar`}>\r\n          <div className={`fill-bar-container ${filled ? themeClass : ''}`}>\r\n            {label && labelStyle === 'over' && (\r\n              <div className={`fill-bar-label-over text-theme-${theme || ''}`}>\r\n                {label}\r\n              </div>\r\n            )}\r\n            {filled && buttonWhenFilled ? (\r\n              <div className={`fill-bar-filled-button ${themeClass}`} onClick={onClickFilled}>\r\n                {filledLabel}\r\n              </div>\r\n            ) : (\r\n              segments\r\n            )}\r\n          </div>\r\n        </div>\r\n      );\r\n};\r\n    \r\nexport default FillBar;\r\n","import React, { useEffect, useState } from 'react';\r\nimport './playerCard.scss';\r\nimport { Character, NOTEBOOK_CATEGORY, Player, PlayerStats } from '../models';\r\nimport Cimage from './UI/cimage';\r\nimport Schedule from './schedule';\r\nimport CharacterCard from './characterCard';\r\nimport { useAppManager, useCharacterManager, usePlayerManager, useUiManager } from './managerContexts';\r\nimport MoreInfo from './UI/moreInfoButton';\r\nimport { APP_STATE } from '../consts/states';\r\nimport FillBar from './UI/fillBar';\r\n\r\ninterface PlayerCardProps {\r\n  player: Player;\r\n  isSelected: boolean;\r\n  showSchedule?: boolean;\r\n  showCharacters?: boolean;\r\n  showPreferences?: boolean;\r\n  onSelect: () => void;\r\n  overlayStyle?: 'assign' | 'unassign' | 'none';\r\n  parentUpdate?: () => void;\r\n  showStats?: boolean;\r\n \r\n}\r\n\r\nconst delightColors = ['#CC0000', '#CC6600', '#CCCC00', '#66CC00', '#00CC00'];\r\nconst delightBorderColors = ['#990000', '#994C00', '#999900', '#4C9900', '#009900'];\r\n\r\nconst delightColors2 = ['#FFCCCC', '#FFDDCC', '#FFFFCC', '#DDFFCC', '#CCFFCC'];\r\nconst delightBorderColors2 = ['#660000', '#663300', '#666600', '#336600', '#006600'];\r\n\r\nconst PlayerCard: React.FC<PlayerCardProps> = ({ player, parentUpdate, isSelected, onSelect, showCharacters, showSchedule, showPreferences, overlayStyle, showStats }) => {\r\n  const uiManager = useUiManager();\r\n  const appManager = useAppManager();\r\n  const [update, setUpdate] = useState(false);\r\n  const [showTooltipLikes, setShowTooltipLikes] = useState(false);\r\n  const [showTooltipHates, setShowTooltipHates] = useState(false);\r\n  const [showTooltipTraits, setShowTooltipTraits] = useState(false);\r\n  const [prevEnjoyment, setPrevEnjoyment] = useState(player.playerStats.enjoyment);\r\n  const [isFlashing, setIsFlashing] = useState(false);\r\n\r\n\r\n  const mainLike = player.preferences.reduce((prev, current) => (current[1] > prev[1] ? current : prev), player.preferences[0]);\r\n  const mainHate = player.preferences.reduce((prev, current) => (current[1] < prev[1] ? current : prev), player.preferences[0]);\r\n\r\n  const handleMouseEnterLikes = () => setShowTooltipLikes(true);\r\n  const handleMouseLeaveLikes = () => setShowTooltipLikes(false);\r\n\r\n  \r\n  const handleMouseEnterHates = () => setShowTooltipHates(true);\r\n  const handleMouseLeaveHates = () => setShowTooltipHates(false);\r\n\r\n  const handleMouseEnterTraits = () => setShowTooltipTraits(true);\r\n  const handleMouseLeaveTraits = () => setShowTooltipTraits(false);\r\n\r\n\r\n  const allLikes = player.preferences.filter(pref => pref[1] > 0);\r\n  const allHates = player.preferences.filter(pref => pref[1] < 0);\r\n \r\n\r\n  const text = overlayStyle === 'assign' ? 'Assign' : 'Remove';\r\n  const overlay = overlayStyle === 'none' ? '' : \r\n    <div className={`overlay ${overlayStyle}`}>\r\n      <div className=\"overlay-text\">\r\n        {text}  \r\n      </div>\r\n    </div>;\r\n  const characterManager = useCharacterManager();\r\n  const playerManager = usePlayerManager();\r\n\r\n  const assignedCharClicked = (character: Character) => {\r\n    if(appManager.state === APP_STATE.CHARACTER_CREATION) {\r\n      unassignCharacter(character);\r\n    }else {\r\n      \r\n      uiManager.showBasicNotebook(NOTEBOOK_CATEGORY.CHARACTER, character);\r\n    }\r\n  }\r\n\r\n  const unassignCharacter = (character: Character) => {\r\n      playerManager.toggleSinglePlayerForCharacter(player, character);\r\n      setUpdate(!update);\r\n      if(parentUpdate){\r\n        parentUpdate();\r\n      }\r\n    }\r\n\r\n    useEffect(() => {\r\n      if (prevEnjoyment !== player.playerStats.enjoyment) {\r\n        setIsFlashing(true);\r\n        setTimeout(() => setIsFlashing(false), 500);\r\n        setPrevEnjoyment(player.playerStats.enjoyment);\r\n      }\r\n    }, [player.playerStats.enjoyment]);\r\n    \r\n  // useEffect(() => {\r\n  //   const forceUpdate = () => {\r\n  //     setUpdate(!update);\r\n  //   }\r\n  //   uiManager.on('playerUpdate', forceUpdate);\r\n  //   return () => {\r\n  //     uiManager.off('playerUpdate', forceUpdate);\r\n  //   };\r\n\r\n  // }, [uiManager, update]);\r\n  \r\n  \r\n  const showNotebookForPlayer = () => {\r\n    uiManager.showBasicNotebook(NOTEBOOK_CATEGORY.PLAYER, player)\r\n  }\r\n\r\n  const renderPlayerStats = () => {\r\n    if (!showStats) return null;\r\n    \r\n    return (\r\n      <div className=\"player-stats\">\r\n      \r\n        <div className=\"stat-item enjoyment\">\r\n            <div className=\"stat-item-emoji\">😞</div>\r\n           \r\n            {Array.from({ length: 5 }).map((_, index) => {\r\n              const isFilled = index <= player.playerStats.enjoyment;\r\n         \r\n              \r\n              return (\r\n                <span\r\n                  key={index}\r\n                  className={`delight-circle ${isFilled ? 'filled' : ''} ${isFlashing ? 'flash' : ''}`}\r\n                  style={isFilled ? {\r\n                    backgroundColor: delightColors[player.playerStats.enjoyment] || '',\r\n                    borderColor: delightBorderColors[player.playerStats.enjoyment] || '',\r\n                    boxShadow: `0 0 10px ${delightColors[player.playerStats.enjoyment] || ''}`\r\n                  } : {}}\r\n                ></span>\r\n              );\r\n            })}\r\n          <div className=\"stat-item-emoji\">😊</div>\r\n        </div>\r\n        <div className=\"stat-item engagement\">\r\n          <FillBar totalSegments={5} filledSegments={player.playerStats.involvement} theme=\"engagement\" label=\"ATTENTION\" />\r\n        </div>\r\n        {/* <div className=\"stat-item stress\">\r\n          <FillBar totalSegments={3} filledSegments={player.playerStats.stress} theme=\"engagement\" label=\"STRESS\" />\r\n        </div> */}\r\n      </div>\r\n    );\r\n  };\r\n\r\n\r\n\r\n  return (\r\n    <div \r\n      className={`player-card ${isSelected ? 'selected' : ''}`} \r\n      onClick={onSelect}\r\n      style={{\r\n        backgroundColor: delightColors2[player.playerStats.enjoyment] || '',\r\n        borderColor: delightBorderColors2[player.playerStats.enjoyment] || '',\r\n     //   boxShadow: `0 0 10px ${delightColors2[player.playerStats.enjoyment] || ''}`\r\n      }}\r\n      \r\n      \r\n      >\r\n      <MoreInfo callback={showNotebookForPlayer} />\r\n      <div className=\"player-card-header\">\r\n        <div className=\"player-icon\">\r\n          <Cimage imageId={player.icon} />\r\n        </div>\r\n        <div className=\"player-upper-info\">\r\n          <div className=\"player-name\">\r\n            {player.name}\r\n          </div>\r\n          {showSchedule && (\r\n            <div className=\"player-schedule-container\">\r\n              <Schedule dayData={player.schedule} />\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n      {showPreferences && (\r\n        <div className=\"player-preferences-section\">\r\n           {player.traits.length > 0 && (\r\n            <div className=\"preferences-column\">\r\n                <div className=\"preferences-title\">\r\n                  Traits\r\n                </div>\r\n                <div className=\"preferences-traits \" onMouseEnter={handleMouseEnterTraits} onMouseLeave={handleMouseLeaveTraits}>\r\n                  {player.traits.map((trait, idx) => (\r\n                    <div key={idx} className=\"trait-item text-pill trait\">\r\n                      {trait.name}\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n            \r\n              {showTooltipTraits && (\r\n              <div className=\"tooltip traits\">\r\n                <div className=\"tooltip-content-single\">\r\n                  {player.traits.map((trait, idx) => (\r\n                  <div key={idx} className=\"tooltip-trait-item\">\r\n                    <b>{trait.name}</b>: {trait.description}\r\n                  </div>\r\n                ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n            </div>\r\n           )}\r\n          <div className=\"preferences-column\">\r\n            <div className=\"preferences-title\">Likes</div>\r\n            <div className=\"preferences-main\">{mainLike[0].name}</div>\r\n            <div className=\"preferences-dots\"  onMouseEnter={handleMouseEnterLikes} onMouseLeave={handleMouseLeaveLikes}>\r\n              {allLikes.map((like, idx) => (\r\n                <div key={idx} className=\"preference-dot like\" title={like[0].name} />\r\n              ))}\r\n            </div>\r\n            {showTooltipLikes && (\r\n              <div className=\"tooltip like\">\r\n                <div className=\"tooltip-content\">\r\n                  {player.preferences.filter(pref => pref[1] > 0).map((pref, idx) => (\r\n                    <div key={idx} className=\"tooltip-pill\">{pref[0].name}</div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n          <div className=\"preferences-column\" >\r\n            <div className=\"preferences-title\">Hates</div>\r\n            <div className=\"preferences-main\">{mainHate[0].name}</div>\r\n            <div className=\"preferences-dots\" onMouseEnter={handleMouseEnterHates} onMouseLeave={handleMouseLeaveHates}>\r\n              {allHates.map((hate, idx) => (\r\n                <div key={idx} className=\"preference-dot hate\" title={hate[0].name} />\r\n              ))}\r\n            </div>\r\n            {showTooltipHates && (\r\n              <div className=\"tooltip hate\">\r\n                <div className=\"tooltip-content\">\r\n                  {player.preferences.filter(pref => pref[1] < 0).map((pref, idx) => (\r\n                    <div key={idx} className=\"tooltip-pill\">{pref[0].name}</div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        \r\n        </div>\r\n      )}\r\n      {renderPlayerStats()}\r\n      {showCharacters && (\r\n        <div className=\"character-row-container\">\r\n          <div className=\"character-row-display\">\r\n            {player.characters.map((character) => {\r\n              \r\n              return (\r\n                <CharacterCard\r\n                  key={character.id}\r\n                  character={character}\r\n                  isSelected={false}\r\n                  onSelect={() => { assignedCharClicked(character) }}\r\n                  showAbilities={false}\r\n                  collapsed={true}\r\n                />\r\n              );\r\n            })}\r\n          \r\n          </div>\r\n          </div>\r\n      )}\r\n      {overlayStyle && overlay}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PlayerCard;","import { on } from \"events\";\r\n\r\ninterface CboxProps {\r\n  title: string;\r\n  theme?: string;\r\n  children?: React.ReactNode;\r\n  onClick?: () => void;\r\n}\r\nconst Cbox: React.FC<CboxProps> = ({ title, theme, children, onClick }) => {\r\n  return (\r\n    <div className={`cbox ${theme}`} onClick={() => {onClick && onClick()}}>\r\n      <div className={`cbox-text ${theme}`}>\r\n        {title}\r\n      </div>\r\n      <div className=\"cbox-children\">\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Cbox;","import React, { useState, useEffect, useRef } from \"react\";\r\nimport {\r\n\tTag,\r\n\tEncounterFlavorTag,\r\n\tRPEncounterFlavorTag,\r\n\tFlavorTagSource,\r\n\tFlavorTagTheme,\r\n} from \"../../models\";\r\nimport {\r\n\tuseAppManager,\r\n\tuseCampaignManager,\r\n\tuseUiManager,\r\n} from \"../managerContexts\";\r\nimport CImage from \"./cimage\";\r\nimport \"./TagPill.scss\";\r\nimport AppManager from \"../../managers/appManager\";\r\n\r\nexport interface TagPillProps {\r\n\ttag: EncounterFlavorTag | RPEncounterFlavorTag;\r\n\tdisabled?: boolean;\r\n\thighlighted?: boolean;\r\n\ttheme?: string;\r\n\tonClick?: (flavorTag: EncounterFlavorTag) => void;\r\n\tclassName?: string;\r\n\tshowTooltip?: boolean;\r\n\ttooltipText?: string;\r\n\ttooltipClassName?: string; // For custom tooltip styling\r\n\toff?: boolean;\r\n\tstyle?: React.CSSProperties;\r\n}\r\n\r\nconst FlavorTagPill: React.FC<TagPillProps> = ({\r\n\ttag,\r\n\tdisabled = false,\r\n\thighlighted = false,\r\n\ttheme,\r\n\tonClick,\r\n\tclassName = \"\",\r\n\tshowTooltip = true,\r\n\ttooltipText,\r\n\ttooltipClassName = \"\",\r\n\toff,\r\n\tstyle, // <-- style prop is already here\r\n\t...props\r\n}) => {\r\n\tconst [tooltipVisible, setTooltipVisible] = useState(false);\r\n\tconst tagRef = useRef<HTMLDivElement>(null);\r\n\tconst campaignManager = useCampaignManager();\r\n\tconst uiManager = useUiManager();\r\n\tconst appManager = useAppManager();\r\n\tconst tagManager = appManager.getTagManager();\r\n\r\n\t// Determine if this is a flavor tag or regular tag\r\n\tconst isRPFlavorTag = \"character\" in tag;\r\n\r\n\t// Get the actual Tag object regardless of input type\r\n\tconst flavorTag = isRPFlavorTag\r\n\t\t? (tag as RPEncounterFlavorTag).tag\r\n\t\t: (tag as EncounterFlavorTag);\r\n\r\n\t// Handle tooltip positioning relative to viewport edges\r\n\tuseEffect(() => {\r\n\t\tif (tooltipVisible && tagRef.current) {\r\n\t\t\tconst tooltip = tagRef.current.querySelector(\".tooltip\") as HTMLElement;\r\n\t\t\r\n\t\t\tif (tooltip) {\r\n\t\t\t\tif (tooltipClassName) {\r\n\t\t\t\t\ttooltip.classList.add(tooltipClassName);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst tagRect = tagRef.current.getBoundingClientRect();\r\n\t\t\t\tconst tooltipRect = tooltip.getBoundingClientRect();\r\n\r\n\t\t\t\t// Adjust if tooltip extends beyond the viewport\r\n\t\t\t\tif (tooltipRect.right > window.innerWidth) {\r\n\t\t\t\t\ttooltip.style.left = \"auto\";\r\n\t\t\t\t\ttooltip.style.right = \"0\";\r\n\t\t\t\t\ttooltip.style.transform = \"translateX(0)\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (tooltipRect.left < 0) {\r\n\t\t\t\t\ttooltip.style.left = \"0\";\r\n\t\t\t\t\ttooltip.style.right = \"auto\";\r\n\t\t\t\t\ttooltip.style.transform = \"translateX(0)\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}, [tooltipVisible]);\r\n\r\n\t// Generate tooltip content\r\n\tconst getTooltipContent = (): string => {\r\n\t\tif (tooltipText) return tooltipText;\r\n\r\n\t\tlet content = \"\";\r\n\r\n\t\t// Get campaign tooltip if available\r\n\t\tconst campaignTooltip = tagManager.getTooltipText({\r\n\t\t\ttag: flavorTag,\r\n\t\t\ttype: \"tag\",\r\n\t\t});\r\n\t\tif (campaignTooltip) return campaignTooltip;\r\n\r\n\t\t// I think we should never get here!\r\n\t\t//return \"HOW DID YOU GET HERE?!?! \" + flavorTag?.tag.name || 'Unknown tag';\r\n\r\n\t\t// Otherwise build based on source\r\n\t\tswitch (flavorTag?.source || \"\") {\r\n\t\t\r\n\t\t\tcase FlavorTagSource.LOCATION:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t\"HOW DID YOU GET HERE?!?! \" + flavorTag?.tag.name || \"Unknown tag\"\r\n\t\t\t\t);\r\n\t\t\tcase FlavorTagSource.PLOT:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t\"HOW DID YOU GET HERE?!?! \" + flavorTag?.tag.name || \"Unknown tag\"\r\n\t\t\t\t);\r\n\t\t\tcase FlavorTagSource.PLAYERS:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t\"HOW DID YOU GET HERE?!?! \" + flavorTag?.tag.name || \"Unknown tag\"\r\n\t\t\t\t);\r\n\t\t\tcase FlavorTagSource.BACKSTORY:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t\"HOW DID YOU GET HERE?!?! \" + flavorTag?.tag.name || \"Unknown tag\"\r\n\t\t\t\t);\r\n\t\t\tcase FlavorTagSource.FORESHADOWING:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t\"HOW DID YOU GET HERE?!?! \" + flavorTag?.tag.name || \"Unknown tag\"\r\n\t\t\t\t);\r\n\r\n\t\t\tdefault:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t\"HOW DID YOU GET HERE?!?! \" + flavorTag?.tag.name || \"Unknown tag\"\r\n\t\t\t\t);\r\n\t\t}\r\n\r\n\t\t// // Add theme postfix if it exists\r\n\t\t// if (flavorTag && flavorTag.theme && flavorTag.theme !== FlavorTagTheme.NONE) {\r\n\t\t//   content += ` (${flavorTag.theme})`;\r\n\t\t// }\r\n\r\n\t\treturn content;\r\n\t};\r\n\r\n\t// Determine CSS classes\r\n\tconst getTagClasses = (): string => {\r\n\t\tlet classes = \"tag-pill text-pill\";\r\n\r\n\t\t// Handle tag type classes\r\n\t\tif (flavorTag) {\r\n\t\t\tif (flavorTag.source) {\r\n\t\t\t\tclasses += ` type-${flavorTag.source.toLowerCase()}`;\r\n\t\t\t}\r\n\t\t\tif (flavorTag.theme && flavorTag.theme !== FlavorTagTheme.NONE) {\r\n\t\t\t\tclasses += ` theme-${flavorTag.theme.toLowerCase()}`;\r\n\t\t\t}\r\n\t\t\t// Apply player attitude styles\r\n\t\t\tconst playerAttitudeStyle = uiManager.getPlayerAttitudesStyle(\r\n\t\t\t\tflavorTag.tag\r\n\t\t\t);\r\n\t\t\tif (playerAttitudeStyle) classes += ` ${playerAttitudeStyle}`;\r\n\t\t}\r\n\r\n\t\t// Add conditional classes\r\n\t\tif (disabled) classes += \" disabled\";\r\n\t\tif (highlighted) classes += \" highlighted\";\r\n\t\tif (theme) classes += ` theme-${theme}`;\r\n\t\tif (className) classes += ` ${className}`;\r\n\r\n\t\tif (off) classes += \" off\";\r\n\r\n\t\treturn classes;\r\n\t};\r\n\r\n\tconst handleClick = () => {\r\n\t\tif (!disabled && onClick && flavorTag) {\r\n\t\t\tonClick(flavorTag);\r\n\t\t}\r\n\t};\r\n\t// This is just a stylized round background\r\n\tconst renderEncounterMedallion = () => {\r\n\t\tconst expected = flavorTag?.source === FlavorTagSource.ENCOUNTER_EXPECTED;\r\n\t\treturn (\r\n\t\t\t<div className={`encounter-medallion-outer tag-pill text-pill ${expected ? 'expected' : ''} ${off ? 'off' : ''}`} \r\n\t\t\t\tstyle={style}\r\n\t\t\t\tonClick={handleClick}\r\n\t\t\t\tonMouseEnter={() => setTooltipVisible(true)}\r\n\t\t\t\tonMouseLeave={() => setTooltipVisible(false)}\r\n\t\t\t>\r\n\t\t\t\t{renderTag({ pointerEvents: 'none' }, false)}\r\n\t\t\t\t{!disabled && showTooltip && tooltipVisible && (\r\n\t\t\t\t\t<div className=\"tooltip medallion-tooltip\">\r\n\t\t\t\t\t\t<div className=\"tooltip-content\">{getTooltipContent()}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\tconst renderTag = (style?: React.CSSProperties, mainChild = true) => (\r\n\t\t<div\r\n\t\t\tref={tagRef}\r\n\t\t\tclassName={getTagClasses()}\r\n\t\t\tstyle={style}\r\n\t\t\tonClick={handleClick}\r\n\t\t\tonMouseEnter={ () => setTooltipVisible(true)}\r\n\t\t\tonMouseLeave={ () => setTooltipVisible(false)}\r\n\t\t>\r\n\t\t\t{flavorTag?.source === FlavorTagSource.TREASURE ? (\r\n\t\t\t\t<div className=\"treasure-icon-container\">\r\n\t\t\t\t\t<CImage imageId=\"icon_treasure1\" />\r\n\t\t\t\t</div>\r\n\t\t\t) : flavorTag?.source === FlavorTagSource.DM_POINT ? (\r\n\t\t\t\t<div className=\"dmpoint-icon-container\">\r\n\t\t\t\t\t<CImage imageId=\"number_die_20\" />\r\n\t\t\t\t</div>\r\n\t\t\t) : (\r\n\t\t\t\tflavorTag?.tag.name +\r\n\t\t\t\t(flavorTag?.source &&\r\n\t\t\t\tflavorTag.source === FlavorTagSource.FORESHADOWING_RANDOM\r\n\t\t\t\t\t? `?`\r\n\t\t\t\t\t: \"\")\r\n\t\t\t)}\r\n\r\n\t\t\t{!disabled && showTooltip && tooltipVisible && mainChild && (\r\n\t\t\t\t<div className=\"tooltip\">\r\n\t\t\t\t\t<div className=\"tooltip-content\">{getTooltipContent()}</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n\r\n\r\n\tif(flavorTag?.source === FlavorTagSource.ENCOUNTER || flavorTag?.source === FlavorTagSource.ENCOUNTER_EXPECTED) {\r\n\t\treturn renderEncounterMedallion();\r\n\t}\r\n\r\n\treturn renderTag(style)\r\n\t\r\n};\r\n\r\nexport default FlavorTagPill;\r\n","import React from 'react';\r\nimport { Tag, EncounterFlavorTag, FlavorTagSource, FlavorTagTheme } from '../../models';\r\nimport FlavorTagPill from './FlavorTagPill';\r\n\r\ninterface TagPillProps {\r\n  tag: Tag;\r\n  source?: FlavorTagSource;\r\n  theme?: FlavorTagTheme;\r\n  className?: string;\r\n  disabled?: boolean;\r\n  highlighted?: boolean;\r\n  onClick?: (tag: EncounterFlavorTag) => void;\r\n  showTooltip?: boolean;\r\n  tooltipText?: string;\r\n  off?: boolean;\r\n  tooltipClassName?: string;\r\n}\r\n\r\nconst TagPill: React.FC<TagPillProps> = ({\r\n  tag,\r\n  source = FlavorTagSource.NONE,\r\n  theme = FlavorTagTheme.NONE,\r\n  className,\r\n  disabled,\r\n  highlighted,\r\n  onClick,\r\n  showTooltip,\r\n  tooltipText,\r\n  tooltipClassName,\r\n  off,\r\n}) => {\r\n  const flavorTag: EncounterFlavorTag = {\r\n    tag,\r\n    source,\r\n    theme,\r\n  };\r\n\r\n  return (\r\n    <FlavorTagPill\r\n      tag={flavorTag}\r\n      className={className}\r\n      disabled={disabled}\r\n      highlighted={highlighted}\r\n      onClick={onClick ? () => onClick(flavorTag) : undefined}\r\n      showTooltip={showTooltip}\r\n      tooltipText={tooltipText}\r\n      tooltipClassName={tooltipClassName}\r\n      off={off}\r\n    />\r\n  );\r\n};\r\n\r\nexport default TagPill;\r\n","import React from \"react\";\r\nimport \"./notebook.scss\";\r\nimport { EncounterNotebookEntry } from \"../../models\";\r\nimport CImage from \"./cimage\";\r\nimport { useAppManager, useCampaignManager } from \"../managerContexts\";\r\nimport Cbox from \"./cbox\";\r\nimport TagPill from \"./TagPill\";\r\n\r\ninterface NoteBookEncounterProps {\r\n  encounterInfo: EncounterNotebookEntry;\r\n}\r\n\r\nconst NotebookEncounter: React.FC<NoteBookEncounterProps> = ({\r\n  encounterInfo,\r\n}) => {\r\n  const campaignManager = useCampaignManager();\r\n  const encounter = encounterInfo.encounter;\r\n  const appManager = useAppManager();\r\n  const tagManager = appManager.getTagManager();\r\n  const combinedTags = tagManager.encounterTagsExpected[encounter.name] || [];\r\n  const encounterBranches = encounterInfo.encounter.branches;\r\n\r\n  return (\r\n    <div className=\"notebook-encounter-container\">\r\n      <div className=\"notebook-encounter-contents left\">\r\n        <Cbox title={encounter.name} theme=\"encounter-info\">\r\n          <div className=\"notebook-icon-container\">\r\n            <CImage imageId={encounter.icon} />\r\n          </div>\r\n        </Cbox>\r\n       \r\n      </div>\r\n      <Cbox title=\"DETAILS\" theme=\"details\">\r\n        <Cbox title=\"LOCATION\" theme=\"location\">\r\n          <div className=\"encounter-location\">{encounter.location.name}</div>\r\n        </Cbox>\r\n        <Cbox title=\"DESCRIPTION\" theme=\"description\">\r\n          {\" \"}\r\n          <div className=\"notebook-text encounter-description\">\r\n            {encounter.description}\r\n          </div>\r\n        </Cbox>\r\n        <Cbox title=\"TOPICS AND THEMES\" theme=\"elements\">\r\n          <div className=\"elements-features-list-container\">\r\n            {combinedTags.map((tag, index) => {\r\n              return (\r\n                <TagPill\r\n                  tag={tag}\r\n                  key={index}\r\n                  showTooltip={false}\r\n                  className=\"notebook-text elements-features-list text-pill type-encounter\"\r\n                />\r\n                 \r\n              );\r\n            })}\r\n          </div>\r\n        </Cbox>\r\n      </Cbox>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotebookEncounter;\r\n","import React, { useState, useRef, useEffect, ReactNode } from \"react\";\r\nimport \"./TooltipWrapper.scss\";\r\n\r\nexport interface TooltipWrapperProps {\r\n  content: string | ReactNode;\r\n  position?: \"top\" | \"bottom\" | \"left\" | \"right\";\r\n  delay?: number;\r\n  className?: string;\r\n  maxWidth?: number | string;\r\n  visible?: boolean | (() => boolean);\r\n  trigger?: \"hover\" | \"click\" | \"both\";\r\n  preservePositioning?: boolean; // Add this prop for absolute positioned elements\r\n  showHelpIcon?: boolean; // Option to show/hide the help icon\r\n  children: ReactNode;\r\n  translate?: [number, number]; // Optional translation for the tooltip\r\n}\r\n\r\nconst TooltipWrapper: React.FC<TooltipWrapperProps> = ({\r\n  content,\r\n  position = \"top\",\r\n  delay = 200,\r\n  className = \"\",\r\n  maxWidth = 250,\r\n  visible,\r\n  trigger = \"hover\",\r\n  preservePositioning = false,\r\n  showHelpIcon = true,\r\n  children,\r\n  translate = [0, 0]\r\n}) => {\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [coordinates, setCoordinates] = useState({ x: 0, y: 0 });\r\n  const tooltipRef = useRef<HTMLDivElement>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const timeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  // Compute visibility state\r\n  const shouldShow = visible !== undefined \r\n    ? (typeof visible === \"function\" ? visible() : visible) \r\n    : isVisible;  // Position the tooltip\r\n  useEffect(() => {\r\n    if (shouldShow && containerRef.current && tooltipRef.current) {\r\n      // Check if the tooltip container is actually visible\r\n      const containerStyle = window.getComputedStyle(containerRef.current);\r\n      if (containerStyle.display === 'none' || containerStyle.visibility === 'hidden') {\r\n        return; // Don't position the tooltip if the container is not visible\r\n      }\r\n\r\n      const containerRect = containerRef.current.getBoundingClientRect();\r\n      const tooltipRect = tooltipRef.current.getBoundingClientRect();\r\n      \r\n      let x = 0;\r\n      let y = 0;\r\n\r\n      // Handle positioning differently if we're in preserve-positioning mode\r\n      // This helps with absolutely positioned elements\r\n      if (preservePositioning) {\r\n        // For preservePositioning, we need to be more careful about the tooltip placement\r\n        // and avoid overlapping with other elements\r\n        switch (position) {\r\n          case \"top\":\r\n            x = window.scrollX + containerRect.left + (containerRect.width / 2) - (tooltipRect.width / 2);\r\n            y = window.scrollY + containerRect.top - tooltipRect.height - 12;\r\n            break;\r\n          case \"bottom\":\r\n            x = window.scrollX + containerRect.left + (containerRect.width / 2) - (tooltipRect.width / 2);\r\n            y = window.scrollY + containerRect.bottom + 12;\r\n            break;\r\n          case \"left\":\r\n            x = window.scrollX + containerRect.left - tooltipRect.width - 12;\r\n            y = window.scrollY + containerRect.top + (containerRect.height / 2) - (tooltipRect.height / 2);\r\n            break;\r\n          case \"right\":\r\n            x = window.scrollX + containerRect.right + 12;\r\n            y = window.scrollY + containerRect.top + (containerRect.height / 2) - (tooltipRect.height / 2);\r\n            break;\r\n        }\r\n      } else {\r\n        // Original positioning for regular elements\r\n        switch (position) {\r\n          case \"top\":\r\n            x = containerRect.left + containerRect.width / 2 - tooltipRect.width / 2;\r\n            y = containerRect.top - tooltipRect.height - 8;\r\n            break;\r\n          case \"bottom\":\r\n            x = containerRect.left + containerRect.width / 2 - tooltipRect.width / 2;\r\n            y = containerRect.bottom + 8;\r\n            break;\r\n          case \"left\":\r\n            x = containerRect.left - tooltipRect.width - 8;\r\n            y = containerRect.top + containerRect.height / 2 - tooltipRect.height / 2;\r\n            break;\r\n          case \"right\":\r\n            x = containerRect.right + 8;\r\n            y = containerRect.top + containerRect.height / 2 - tooltipRect.height / 2;\r\n            break;\r\n        }\r\n      }\r\n\r\n      // Boundary detection to keep tooltip on screen\r\n      const windowWidth = window.innerWidth;\r\n      const windowHeight = window.innerHeight;\r\n\r\n      if (x < 10) x = 10;\r\n      if (x + tooltipRect.width > windowWidth - 10) x = windowWidth - tooltipRect.width - 10;\r\n      if (y < 10) y = 10;\r\n      if (y + tooltipRect.height > windowHeight - 10) y = windowHeight - tooltipRect.height - 10;\r\n\r\n      setCoordinates({ x, y });\r\n    }\r\n  }, [shouldShow, position, preservePositioning]);\r\n  const showTooltip = () => {\r\n    if (timeoutRef.current) clearTimeout(timeoutRef.current);\r\n    timeoutRef.current = setTimeout(() => setIsVisible(true), delay);\r\n  };\r\n\r\n  const hideTooltip = () => {\r\n    if (timeoutRef.current) clearTimeout(timeoutRef.current);\r\n    setIsVisible(false);\r\n  };\r\n  \r\n  // Clean up timeout on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const toggleTooltip = () => {\r\n    setIsVisible(!isVisible);\r\n  };\r\n\r\n  const getEventHandlers = () => {\r\n    if (trigger === \"hover\" || trigger === \"both\") {\r\n      return {\r\n        onMouseEnter: showTooltip,\r\n        onMouseLeave: hideTooltip,\r\n        onFocus: showTooltip,\r\n        onBlur: hideTooltip,\r\n        onClick: trigger === \"both\" ? toggleTooltip : undefined\r\n      };\r\n    }\r\n    if (trigger === \"click\") {\r\n      return {\r\n        onClick: toggleTooltip\r\n      };\r\n    }\r\n    return {};\r\n  };\r\n  return (\r\n    <div \r\n      className={`tooltip-wrapper-container ${preservePositioning ? 'preserve-positioning' : ''} ${className}`} \r\n      ref={containerRef}\r\n      {...getEventHandlers()}\r\n    >\r\n      {children}\r\n\r\n      {shouldShow && (        <div \r\n          className={`tooltip-wrapper tooltip-${position}`}\r\n          ref={tooltipRef}\r\n          style={{ \r\n            left: coordinates.x, \r\n            top: coordinates.y,\r\n            maxWidth: typeof maxWidth === 'number' ? `${maxWidth}px` : maxWidth,\r\n            zIndex: 10000, // Ensure the tooltip is above everything\r\n            transform: `translate(${translate[0]}px, ${translate[1]}px)`,\r\n          }}\r\n        >          <div className=\"tooltip-content\">{content}</div>\r\n          {showHelpIcon && (\r\n            <div className=\"tooltip-help-icon\">\r\n              <span className=\"tooltip-help-icon-text\">i</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TooltipWrapper;\r\n","import React from 'react';\r\nimport TooltipWrapper from './TooltipWrapper';\r\n\r\ninterface RangeConfig {\r\n  start: number;\r\n  end: number;\r\n  backgroundColor: string;\r\n  fillColor: string;\r\n  label: string;\r\n}\r\n\r\ninterface RangedFillBarProps {\r\n  totalSegments: number;\r\n  filledSegments: number;\r\n  ranges: RangeConfig[];\r\n  theme?: string;\r\n  label?: string;\r\n  onHover?: (rangeLabel: string) => void;\r\n  onLeave?: () => void;\r\n  showTooltips?: boolean;\r\n}\r\n\r\nconst RangedFillBar: React.FC<RangedFillBarProps> = ({ \r\n  totalSegments, \r\n  filledSegments, \r\n  ranges, \r\n  theme = '', \r\n  label,\r\n  onHover,\r\n  onLeave,\r\n  showTooltips = false\r\n}) => {\r\n  \r\n  const handleSegmentHover = (segmentIndex: number) => {\r\n    if (onHover) {\r\n      const range = ranges.find(r => segmentIndex >= r.start && segmentIndex <= r.end);\r\n      if (range) {\r\n        onHover(range.label);\r\n      }\r\n    }\r\n  };\r\n\r\n  const getSegmentStyle = (segmentIndex: number) => {\r\n    const range = ranges.find(r => segmentIndex >= r.start && segmentIndex <= r.end);\r\n    const isFilled = segmentIndex < filledSegments;\r\n    \r\n    if (range) {\r\n      return {\r\n        backgroundColor: isFilled ? range.fillColor : range.backgroundColor,\r\n      };\r\n    }\r\n    \r\n    return {\r\n      backgroundColor: isFilled ? '#4CAF50' : '#e0e0e0',\r\n    };\r\n  };\r\n\r\n  const getTooltipContent = (segmentIndex: number) => {\r\n    if (!showTooltips) return '';\r\n    \r\n    const baseText = \"Level Up: Full Attention\\n\";\r\n    \r\n    if (segmentIndex < 20) {\r\n      return baseText + \"Very Unready: All other players -2 happiness\";\r\n    } else if (segmentIndex < 50) {\r\n      return baseText + \"Unready: All other players -1 happiness\";\r\n    } else if (segmentIndex < 65 || (segmentIndex >= 75 && segmentIndex <= 90)) {\r\n      return baseText + \"Ready: +1 Happiness\";\r\n    } else if (segmentIndex >= 65 && segmentIndex < 75) {\r\n      return baseText + \"Perfect: +2 Happiness\";\r\n    } else if (segmentIndex > 90) {\r\n      return baseText + \"Overready: +0 Happiness (-1 Happiness when OTHER Player's Characters level up)\";\r\n    }\r\n    return baseText;\r\n  };\r\n\r\n  const segments = Array.from({ length: totalSegments }, (_, index) => {\r\n    const segment = (\r\n      <div\r\n        key={index}\r\n        className={`fill-bar-segment ranged ${index < filledSegments ? 'filled' : ''}`}\r\n        style={getSegmentStyle(index)}\r\n        onMouseEnter={() => handleSegmentHover(index)}\r\n        onMouseLeave={onLeave}\r\n      />\r\n    );\r\n\r\n    if (showTooltips) {\r\n      return (\r\n        <TooltipWrapper\r\n          key={index}\r\n          content={getTooltipContent(index)}\r\n          position=\"top\"\r\n          showHelpIcon={false}\r\n        >\r\n          {segment}\r\n        </TooltipWrapper>\r\n      );\r\n    }\r\n\r\n    return segment;\r\n  });\r\n\r\n  return (\r\n    <div className={`fill-bar ranged-fill-bar`}>\r\n      {label && <div className={`fill-bar-label text-theme-${theme || ''}`}>{label}</div>}\r\n      <div className={`fill-bar-container ranged`}>\r\n        {segments}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RangedFillBar;\r\n","import React from \"react\";\r\nimport \"./notebook.scss\";\r\nimport { ATTRIBUTE_CONTRIBUTOR, CharacterNotebookEntry } from \"../../models\";\r\nimport { useCharacterManager, usePlayerManager } from \"../managerContexts\";\r\nimport CImage from \"./cimage\";\r\nimport AttributeDisplay from \"./attributeDisplay\";\r\nimport FillBar from \"./fillBar\";\r\nimport RangedFillBar from \"./RangedFillBar\";\r\nimport Cbox from \"./cbox\";\r\nimport {\r\n\tCHARACTER_READINESS_THRESHOLDS,\r\n\tgetCharacterReadinessLevel,\r\n\tCHARACTER_READINESS_LEVEL,\r\n} from \"../../consts/characterConsts\";\r\n\r\nconst NotebookCharacter: React.FC<{\r\n\tcharacterInfo: CharacterNotebookEntry;\r\n}> = ({ characterInfo }) => {\r\n\tconst characterManager = useCharacterManager();\r\n\tconst playerManager = usePlayerManager();\r\n\r\n    const clickChar = () => {\r\n        characterInfo.character.experience += 10; // Example increment, adjust as needed\r\n    }\r\n\r\n\tconst getPlayer = () => {\r\n\t\tconst player = playerManager.getPlayerAssignedCharacter(\r\n\t\t\tcharacterInfo.character\r\n\t\t);\r\n\t\treturn player ? `Assigned to ${player.name}` : \"Not assigned to any player\";\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"notebook-character\">\r\n\t\t\t<div className=\"notebook-character-left\">\r\n\t\t\t\t<Cbox title={characterInfo.character.name} theme=\"character-info\">\r\n\t\t\t\t\t<div className=\"notebook-left-top-container\">\r\n\t\t\t\t\t\t<div className=\"notebook-character-icon-container\" onClick={clickChar}>\r\n\t\t\t\t\t\t\t<CImage imageId={characterInfo.character.icon} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"notebook-character-stats\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<b>Race:</b>{\" \"}\r\n\t\t\t\t\t\t\t\t{characterManager.getUFRace(characterInfo.character.race)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<b>Class:</b>{\" \"}\r\n\t\t\t\t\t\t\t\t{characterManager.getUFClass(\r\n\t\t\t\t\t\t\t\t\tcharacterInfo.character.character_class\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<div>{getPlayer()}</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<Cbox\r\n\t\t\t\t\t\t\ttitle=\"STATUS\"\r\n\t\t\t\t\t\t\ttheme={`health ${characterInfo.character.injury}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName={`health-status ${characterInfo.character.injury}`}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{characterInfo.character.injury?.toUpperCase() ?? \"HEALTHY\"}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Cbox>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Cbox>\r\n\t\t\t\t<Cbox title={`LEVEL ${characterInfo.character.level}`} theme=\"stats\">\r\n\t\t\t\t\t<div className=\"character-level\">\r\n\t\t\t\t\t\t<FillBar\r\n\t\t\t\t\t\t\tfilledSegments={Math.min(\r\n\t\t\t\t\t\t\t\tcharacterInfo.character.experience,\r\n\t\t\t\t\t\t\t\tCHARACTER_READINESS_THRESHOLDS.READY_START\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\ttotalSegments={CHARACTER_READINESS_THRESHOLDS.READY_START}\r\n\t\t\t\t\t\t\ttheme=\"character-level\"\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{characterInfo.character.experience >=\r\n\t\t\t\t\t\tCHARACTER_READINESS_THRESHOLDS.READY_START && (\r\n\t\t\t\t\t\t<div className=\"character-level-up-readiness\">\r\n\t\t\t\t\t\t\t<RangedFillBar\r\n\t\t\t\t\t\t\t\tfilledSegments={characterInfo.character.experience}\r\n\t\t\t\t\t\t\t\ttotalSegments={100}\r\n\t\t\t\t\t\t\t\tranges={[\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tstart: CHARACTER_READINESS_THRESHOLDS.READY_START,\r\n\t\t\t\t\t\t\t\t\t\tend: CHARACTER_READINESS_THRESHOLDS.READY_END,\r\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: \"#c8e6c9\",\r\n\t\t\t\t\t\t\t\t\t\tfillColor: \"#81c784\",\r\n\t\t\t\t\t\t\t\t\t\tlabel: \"Ready\",\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tstart: CHARACTER_READINESS_THRESHOLDS.PERFECT_START,\r\n\t\t\t\t\t\t\t\t\t\tend: CHARACTER_READINESS_THRESHOLDS.PERFECT_END,\r\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: \"#a5d6a7\",\r\n\t\t\t\t\t\t\t\t\t\tfillColor: \"#4caf50\",\r\n\t\t\t\t\t\t\t\t\t\tlabel: \"Perfect\",\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tstart: CHARACTER_READINESS_THRESHOLDS.READY_SECOND_START,\r\n\t\t\t\t\t\t\t\t\t\tend: CHARACTER_READINESS_THRESHOLDS.READY_SECOND_END,\r\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: \"#c8e6c9\",\r\n\t\t\t\t\t\t\t\t\t\tfillColor: \"#81c784\",\r\n\t\t\t\t\t\t\t\t\t\tlabel: \"Ready\",\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tstart: CHARACTER_READINESS_THRESHOLDS.OVERREADY,\r\n\t\t\t\t\t\t\t\t\t\tend: 100,\r\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: \"#ffab91\",\r\n\t\t\t\t\t\t\t\t\t\tfillColor: \"#d84315\",\r\n\t\t\t\t\t\t\t\t\t\tlabel: \"Overready\",\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t\t\ttheme=\"level-up-readiness\"\r\n\t\t\t\t\t\t\t\tlabel={`Level up: ${\r\n\t\t\t\t\t\t\t\t\tgetCharacterReadinessLevel(\r\n\t\t\t\t\t\t\t\t\t\tcharacterInfo.character.experience\r\n\t\t\t\t\t\t\t\t\t) === CHARACTER_READINESS_LEVEL.READY\r\n\t\t\t\t\t\t\t\t\t\t? \"Ready\"\r\n\t\t\t\t\t\t\t\t\t\t: getCharacterReadinessLevel(\r\n\t\t\t\t\t\t\t\t\t\t\t\tcharacterInfo.character.experience\r\n\t\t\t\t\t\t\t\t\t\t  ) === CHARACTER_READINESS_LEVEL.PERFECT\r\n\t\t\t\t\t\t\t\t\t\t? \"Perfect\"\r\n\t\t\t\t\t\t\t\t\t\t: \"Overready\"\r\n\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\tshowTooltips={true}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Cbox>\r\n\r\n\t\t\t\t\r\n\r\n\t\t\t\t<Cbox title=\"BACKSTORY\" theme=\"backstory\">\r\n\t\t\t\t\t<FillBar\r\n\t\t\t\t\t\ttotalSegments={Math.max(\r\n\t\t\t\t\t\t\tcharacterInfo.character.backstory.length,\r\n\t\t\t\t\t\t\t3\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\tfilledSegments={\r\n\t\t\t\t\t\t\tcharacterInfo.character.backstory.filter((bs) => bs.completed)\r\n\t\t\t\t\t\t\t\t.length\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttheme=\"backstory\"\r\n\t\t\t\t\t\tlabel=\"Backstory Elements\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div className=\"notebook-backstory-tags\">\r\n\t\t\t\t\t\t{characterInfo.character.backstory.length > 0 ? (\r\n\t\t\t\t\t\t\t<div>SEEKING:</div>\r\n\t\t\t\t\t\t) : \r\n\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t<div>No backstory yet...</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t{characterInfo.character.backstory\r\n\t\t\t\t\t\t\t.filter((bs) => !bs.completed)\r\n\t\t\t\t\t\t\t.map((story, idx) => (\r\n\t\t\t\t\t\t\t\t<div key={idx} className=\"text-pill expected\">\r\n\t\t\t\t\t\t\t\t\t{story.tag.name}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"notebook-backstory-tags\">\r\n\t\t\t\t\t\t{characterInfo.character.backstory.filter((bs) => bs.completed)\r\n\t\t\t\t\t\t\t.length > 0 && <div>COMPLETED:</div>}\r\n\t\t\t\t\t\t{characterInfo.character.backstory\r\n\t\t\t\t\t\t\t.filter((bs) => bs.completed)\r\n\t\t\t\t\t\t\t.map((story, idx) => (\r\n\t\t\t\t\t\t\t\t<div key={idx} className=\"text-pill completed\">\r\n\t\t\t\t\t\t\t\t\t{story.tag.name}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Cbox>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"notebook-character-right\">\r\n\t\t\t\t<Cbox title=\"ABILITIES\" theme=\"abilities\">\r\n\t\t\t\t\t<AttributeDisplay\r\n\t\t\t\t\t\thero={characterInfo.character}\r\n\t\t\t\t\t\tcategory={ATTRIBUTE_CONTRIBUTOR.ALL}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Cbox>\r\n\t\t\t\t<Cbox title=\"ABILITY DETAILS\" theme=\"ability-details\">\r\n\t\t\t\t\t<Cbox\r\n\t\t\t\t\t\ttitle={`${characterManager.getUFRace(\r\n\t\t\t\t\t\t\tcharacterInfo.character.race\r\n\t\t\t\t\t\t)} Abilities`}\r\n\t\t\t\t\t\ttheme=\"race-abilities\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<AttributeDisplay\r\n\t\t\t\t\t\t\thero={characterInfo.character}\r\n\t\t\t\t\t\t\tcategory={ATTRIBUTE_CONTRIBUTOR.RACE}\r\n\t\t\t\t\t\t\tcollapsed={true}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Cbox>\r\n\r\n\t\t\t\t\t<Cbox\r\n\t\t\t\t\t\ttitle={`${characterManager.getUFClass(\r\n\t\t\t\t\t\t\tcharacterInfo.character.character_class\r\n\t\t\t\t\t\t)} Abilities`}\r\n\t\t\t\t\t\ttheme=\"class-abilities\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<AttributeDisplay\r\n\t\t\t\t\t\t\thero={characterInfo.character}\r\n\t\t\t\t\t\t\tcategory={ATTRIBUTE_CONTRIBUTOR.CHARACTER_CLASS}\r\n\t\t\t\t\t\t\tcollapsed={true}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Cbox>\r\n\r\n\t\t\t\t\t{characterInfo.character.gear.length > 0 && (\r\n\t\t\t\t\t\t<Cbox title=\"Equipment Bonuses\" theme=\"gear-abilities\">\r\n\t\t\t\t\t\t\t<AttributeDisplay\r\n\t\t\t\t\t\t\t\thero={characterInfo.character}\r\n\t\t\t\t\t\t\t\tcategory={ATTRIBUTE_CONTRIBUTOR.GEAR}\r\n\t\t\t\t\t\t\t\tcollapsed={true}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Cbox>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Cbox>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default NotebookCharacter;\r\n","import React from \"react\";\r\nimport \"./notebook.scss\";\r\nimport { LocationNotebookEntry } from \"../../models\";\r\nimport CImage from \"./cimage\";\r\nimport Cbox from \"./cbox\";\r\nimport TagPill from \"./TagPill\";\r\n\r\ninterface NoteBookLocationProps {\r\n  locationInfo: LocationNotebookEntry;\r\n}\r\n\r\nconst NotebookLocation: React.FC<NoteBookLocationProps> = ({\r\n  locationInfo,\r\n}) => {\r\n  const location = locationInfo.location;\r\n\r\n  return (\r\n    <div className=\"notebook-location-container\">\r\n      <div className=\"notebook-location-contents left\">\r\n        <Cbox title={location.name} theme=\"location-info\">\r\n          <div className=\"notebook-icon-container\">\r\n            <CImage imageId={location.icon} />\r\n          </div>\r\n        </Cbox>\r\n      </div>\r\n\r\n      <div className=\"notebook-location-contents right\">\r\n        <Cbox title=\"DETAILS\" theme=\"location-details\">\r\n          <Cbox title=\"DESCRIPTION\" theme=\"description\">\r\n            <div className=\"notebook-text location-description\">\r\n              {location.description}\r\n            </div>\r\n          </Cbox>\r\n          <Cbox title=\"FEATURES\" theme=\"location-features\">\r\n            <div className=\"elements-features-list-container\">\r\n              {location.tags.map((tag, index) => (\r\n               <TagPill\r\n                  tag={tag}\r\n                  key={index}\r\n                  showTooltip={false}\r\n                  className=\"notebook-text elements-features-list text-pill type-location\"\r\n                />\r\n              ))}\r\n            </div>\r\n          </Cbox>\r\n        </Cbox>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotebookLocation;\r\n","import React from \"react\";\r\nimport \"./notebook.scss\";\r\nimport { PlayerNotebookEntry } from \"../../models\";\r\nimport UiManager from \"../../managers/uiManager\";\r\nimport Schedule from \"../schedule\";\r\nimport CImage from \"./cimage\";\r\nimport { useCharacterManager } from \"../managerContexts\";\r\nimport FillBar from \"./fillBar\";\r\nimport { click } from \"@testing-library/user-event/dist/click\";\r\nimport Cbox from \"./cbox\";\r\nimport { PLAYER_EXP_LEVEL } from \"../../consts/general\";\r\n\r\ninterface NoteBookPlayerProps {\r\n  playerInfo: PlayerNotebookEntry;\r\n  clickChar?: (idx: number) => void;\r\n  singleColumn?: boolean;\r\n}\r\n\r\nconst NotebookPlayer: React.FC<NoteBookPlayerProps> = ({\r\n  playerInfo,\r\n  singleColumn,\r\n  clickChar = () => {},\r\n}) => {\r\n  const characterManager = useCharacterManager();\r\n\r\n  const likesList = playerInfo.player.preferences.filter(\r\n    (preference) => preference[1] > 0\r\n  );\r\n  const hatesList = playerInfo.player.preferences.filter(\r\n    (preference) => preference[1] < 0\r\n  );\r\n\r\n  const getLikesList = () => {\r\n    return likesList.map((preference, idx) => {\r\n      return (\r\n        <div key={idx} className=\"text-pill like\">\r\n          <div className=\"player-preference\">- {preference[0].name}</div>\r\n        </div>\r\n      );\r\n    });\r\n  };\r\n\r\n  const getHatesList = () => {\r\n    return hatesList.map((preference, idx) => {\r\n      return (\r\n        <div key={idx} className=\"text-pill hate\">\r\n          <div className=\"player-preference\">- {preference[0].name}</div>\r\n        </div>\r\n      );\r\n    });\r\n  };\r\n\r\n  const getTraitsList = () => {\r\n    return playerInfo.player.traits.map((trait, idx) => (\r\n      <div key={idx}>\r\n        <Cbox\r\n          title={trait.name}\r\n            theme=\"trait\"\r\n        >\r\n        <div className=\"trait-description\">{trait.description}</div>\r\n        </Cbox>\r\n      </div>\r\n     \r\n    ));\r\n  };\r\n\r\n  const clickCharacter = (idx: number) => {\r\n    clickChar(idx);\r\n  }\r\n\r\n\r\n  return (\r\n    <div className=\"notebook-player-container\">\r\n\r\n<div className=\"player-notebook-upper\">\r\n\r\n      {!singleColumn && (\r\n        <div className=\"player-notebook-left-content\">\r\n          <div className=\"notebook-player-topbar\">\r\n            <div className=\"notebook-player-icon\">\r\n              <CImage imageId={playerInfo.player.icon} />\r\n            </div>\r\n            <div className=\"notebook-player-name\">{playerInfo.player.name}</div>\r\n          </div>\r\n\r\n          <div className=\"player-notebook-mid-content\">\r\n            <div className=\"player-notebook-mid-left\">\r\n            <Cbox\r\n                    title=\"STATS\"\r\n                        theme=\"stats\"\r\n                        >\r\n                    <div className=\"character-level\">\r\n                        <FillBar\r\n                        filledSegments={playerInfo.player.playerStats.experience}\r\n                        totalSegments={PLAYER_EXP_LEVEL[playerInfo.player.playerStats.level]}\r\n                        theme=\"player-level\"\r\n                        label={`LEVEL ${playerInfo.player.playerStats.level}`}\r\n                        />\r\n                    </div>\r\n                    <div className=\"character-attitude\">\r\n                        <FillBar\r\n                        filledSegments={playerInfo.player.playerStats.enjoyment}\r\n                        totalSegments={playerInfo.player.playerStats.maxEnjoyment}\r\n                        theme=\"player-level\"\r\n                        label={`ATTITUDE ${playerInfo.player.playerStats.enjoyment}/${playerInfo.player.playerStats.maxEnjoyment}`}\r\n                        />\r\n                    </div>\r\n                    <div className=\"character-attention\">\r\n                        <FillBar\r\n                        filledSegments={playerInfo.player.playerStats.involvement}\r\n                        totalSegments={playerInfo.player.playerStats.maxInvolvement}\r\n                        theme=\"player-level\"\r\n                        label={`ATTENTION ${playerInfo.player.playerStats.involvement}/${playerInfo.player.playerStats.maxInvolvement}`}\r\n                        />\r\n                    </div>\r\n                    <Cbox\r\n                        title=\"STRESS\"\r\n                        theme=\"stress\"\r\n                        >\r\n                        <div className=\"character-stress\">\r\n                            CURRENT STRESS{\" \"}\r\n                            {Math.max(\r\n                            0,\r\n                            playerInfo.player.playerStats.stress -\r\n                                playerInfo.player.playerStats.stressBuffer\r\n                            )}\r\n                            %\r\n                        </div>\r\n                        <div className=\"character-stress\">\r\n                            RESILIENCE{\" \"}\r\n                            {Math.min(\r\n                            playerInfo.player.playerStats.stressBuffer,\r\n                            playerInfo.player.playerStats.stress\r\n                            )}\r\n                            /{playerInfo.player.playerStats.stressBuffer}\r\n                        </div>\r\n                    </Cbox>\r\n\r\n</Cbox>\r\n\r\n                </div>\r\n\r\n                \r\n\r\n\r\n            <div className=\"player-notebook-mid-right\">\r\n            <Cbox\r\n                    title=\"PREFERENCES\"\r\n                    theme=\"preferences\"\r\n                >\r\n           \r\n            <Cbox\r\n                \r\n                    title=\"LIKES\"\r\n                    theme=\"likes\"\r\n                    >\r\n              <div className=\"player-preferences likes\">\r\n                {getLikesList()}\r\n              </div>\r\n            </Cbox>\r\n             <Cbox\r\n                    title=\"HATES\"\r\n                    theme=\"hates\"\r\n                >\r\n              <div className=\"player-preferences hates\">\r\n               \r\n                {getHatesList()}\r\n              </div>\r\n            \r\n            </Cbox>\r\n            </Cbox>\r\n            </div>\r\n\r\n            \r\n          </div>\r\n\r\n         \r\n\r\n\r\n        </div>\r\n      )}\r\n      <div className=\"player-notebook-right-content\">\r\n        {!singleColumn && playerInfo.player.characters.length > 0 && (\r\n          <Cbox \r\n            title=\"CHARACTERS\"\r\n            theme=\"characters\"\r\n          >\r\n            {playerInfo.player.characters.map((char, idx) => {\r\n              //const char = characterManager.getCharacterById(character);\r\n              return (\r\n                <div key={idx} className=\"player-character-container\" onClick={() => clickCharacter(idx)}>\r\n                  <div className={`player-character-hero-image`}>\r\n                    <div className=\"challenge-character-icon\">\r\n                      <CImage imageId={char.icon} />\r\n                    </div>\r\n                    {char.injury === \"injured\" && (\r\n                      <div className=\"player-character-hero-injury\"></div>\r\n                    )}\r\n                    {char.injury === \"dead\" && (\r\n                      <div className=\"player-character-hero-injury dead\"></div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"player-character-text-container\">\r\n                    <div className=\"player-character-name-container\">\r\n                      <div className=\"player-character-name\">{char.name}</div>\r\n                    </div>\r\n                    <div className=\"player-character-info\">\r\n                      {char.race} {char.character_class}\r\n                    </div>\r\n\r\n                    <div className=\"player-character-info\">\r\n                      Level {char.level}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </Cbox>\r\n        )}\r\n      </div>\r\n\r\n</div>\r\n\r\n      <div className=\"player-notebook-bottom\">\r\n            <Cbox \r\n             title=\"PLAYER TRAITS\"\r\n            theme=\"traits\"\r\n            >\r\n                {playerInfo.player.traits.length === 0 ? (\r\n                    <div className=\"no-traits\">\r\n                        level up to unlock traits\r\n                        </div>\r\n                        ) : (\r\n\r\n                <div className=\"player-notebook-traits\">{getTraitsList()}</div>\r\n                    \r\n                    )}\r\n            </Cbox>\r\n          </div>\r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotebookPlayer;\r\n","import React, { useEffect, useState } from 'react';\nimport './notebook.scss'; \n\nimport { useCharacterManager, usePlayerManager } from '../managerContexts';\nimport { GroupNotebookEntry, Player } from '../../models';\nimport Schedule from '../schedule';\n\n\ninterface NoteBookGroupProps {\n    groupInfo:GroupNotebookEntry;\n}\n\nconst NotebookGroup: React.FC<NoteBookGroupProps> = ({ groupInfo }) => {\n\n    const [playerGroup, setPlayerGroup] = useState<Player[]>(groupInfo.players);\n    const playerManager = usePlayerManager();\n    const [groupAttitudes, setGroupAttitudes] = useState(playerManager.getGroupAttitudes());\n    const [dayData, setDayData] = useState(playerManager.aggregateSchedule());\n\n\n    useEffect(() => {\n        const updateGroupAttitudes = () => {\n            setGroupAttitudes(playerManager.getGroupAttitudes());\n          };\n        updateGroupAttitudes();\n        setPlayerGroup(groupInfo.players);\n        setDayData(playerManager.aggregateSchedule());\n    }, [groupInfo, playerManager]);\n\n    return (\n    <div className=\"notebook-group-container\">\n       <div className = \"notebook-group-top-content\">\n            <div className=\"notebook-group-players notebook-text large\">\n                <u>Players</u>\n                <div className = \"notebook-group-players-list\">\n                    {playerGroup.length !== 0 &&  playerGroup.map((player, idx) => (\n                                <div key={idx} className=\"notebook-text player-name\">\n                                {player.name}\n                                </div>\n                            ))}\n                </div>\n            </div>\n        </div>\n\n        <div className=\"player-attitude\">\n                <div className=\"attitude-column\">\n                  <div className=\"attitude-title notebook-text large\"><u>Group Likes</u></div>\n                  {groupAttitudes.likes.map((like, index) => (\n                    <div key={index} className=\"attitude-item like\">\n                        <div className=\"attitude-item-text\">\n                      {like}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n                {groupAttitudes.conflicted.length > 0 && (\n              <div className=\"attitude-column\">\n                  <div className=\"attitude-title notebook-text large\"><u>Conflicted</u></div>\n                  {groupAttitudes.conflicted.map((conflicted, index) => (\n                    <div key={index} className=\"attitude-item conflicted\">\n                       <div className=\"attitude-item-text\">\n                      {conflicted}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n                <div className=\"attitude-column\">\n                  <div className=\"attitude-title notebook-text large\"><u>Group Hates</u></div>\n                  {groupAttitudes.hates.map((hate, index) => (\n                    <div key={index} className=\"attitude-item hate\">\n                         <div className=\"attitude-item-text\">\n                      {hate}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n               \n              </div>\n             \n\n           \n           \n    </div>\n    );\n};\n\nexport default NotebookGroup;\n\n\n\n\n","import React from 'react';\nimport './groupSchedule.scss';\nimport { usePlayerManager } from '../managerContexts';\nimport Schedule from '../schedule';\n\nconst GroupSchedule: React.FC = () => {\n    const playerManager = usePlayerManager();\n    const dayData = playerManager.aggregateSchedule();\n\n    const dayDataToSymbol = (percentage: number) => {\n        if(percentage === 0) {\n            return '-';\n        } else \n        if (percentage < 33) {\n            return 'X';\n        } else if (percentage < 65) {\n            return ' ';\n        } else {\n            return '✔';\n        }\n    }\n\n\n\n    return (\n        <div className=\"group-schedule-container\">\n            <div className=\"group-schedule-tab\">Scheduling</div>\n            <div className=\"week-display-days\">\n                {dayData.map((percentage, index) => (\n                    <div key={index} className=\"day-box\">\n                        <div className=\"day-abbreviation\">{['M', 'T', 'W', 'R', 'F', 'St', 'Sn'][index]}</div>\n                        <div className=\"day-percentage\">{dayDataToSymbol(percentage)}</div>\n                    </div>\n                ))}\n            </div>\n        </div>\n    );\n};\n\nexport default GroupSchedule;","import React from 'react';\nimport './notebook.scss';\nimport './tutorial.scss';\nimport { TutorialNotebookEntry } from '../../models';\nimport CImage from './cimage';\nimport { useAppManager, useUiManager } from '../managerContexts';\n\ninterface NoteBookTutorialProps {\n    tutorialInfo: TutorialNotebookEntry;\n}\n\nconst NotebookTutorial: React.FC<NoteBookTutorialProps> = ({ tutorialInfo }) => {\n    const message = tutorialInfo.message;\n    const icon = tutorialInfo.icon;\n    const nextIndex = tutorialInfo.showNext;\n    const prevIndex = tutorialInfo.showPrev;\n\n    const uiManager = useUiManager();\n    const appManager = useAppManager();\n    const tutorialManager = appManager.getTutorialManager();\n\n    const prevClicked = () => {\n    if(prevIndex !== undefined && prevIndex >= 0)\n         uiManager.showTutorialPage(prevIndex);\n    }\n\n    const nextClicked = () => {\n        if(nextIndex !== undefined && nextIndex >= 0) {\n            uiManager.showTutorialPage(nextIndex);\n        }\n        else {\n            uiManager.closeTutorial();\n        }\n    }\n\n    const clickedDisable = () => {\n        uiManager.closeTutorial();\n        tutorialManager.disableTutorial();\n    }\n\n    const nextOrClose = !nextIndex ? 'Close' : 'Next';\n\n    return (\n        <div className=\"notebook-tutorial-container\">\n            <div className=\"notebook-tutorial-contents left\">\n                <div className=\"tutorial-title-container\">\n                    <div className=\"tutorial-title\">\n                        {tutorialInfo.title}\n                    </div>\n                </div>\n                <div className=\"notebook-icon-container\"> \n                    <CImage imageId={icon} />\n                </div>\n                <div className=\"pill-button remove\"> \n                    <div className=\"pill-button-disable\" onClick={() => clickedDisable()}>DISABLE TUTORIAL</div>\n                </div>\n            </div>\n            <div className=\"notebook-tutorial-contents right\">\n                <div className=\"tutorial-message-container\">\n                    <div className=\"tutorial-message\" dangerouslySetInnerHTML={{ __html: message }}/>\n                </div>\n                \n            \n                <div className=\"notebook-tutorial-buttons\">\n                    {(prevIndex !== undefined && prevIndex >= 0) && <div className=\"nav-button prev\" onClick={prevClicked}>Previous</div>}\n                    <div className=\"nav-button next\" onClick={nextClicked}>{nextOrClose}</div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\n\n\nexport default NotebookTutorial;","import React, { useEffect } from 'react';\r\nimport './notebook.scss';\r\nimport { Encounter, NOTEBOOK_CATEGORY } from '../../models';\r\nimport { useUiManager } from '../managerContexts';\r\nimport NotebookEncounter from './notebookEncounter';\r\nimport NotebookCharacter from './notebookCharacter';\r\nimport NotebookLocation from './notebookLocation';\r\nimport NotebookPlayer from './notebookPlayer';\r\nimport NotebookGroup from './notebookGroup';\r\nimport GroupSchedule from './groupSchedule';\r\nimport NotebookTutorial from './notebookTutorial';\r\n\r\n\r\ninterface NoteBookProps {\r\n    notebookPages: Record<string, any>[];\r\n    singleColumn?: boolean;\r\n    pageIndex?: number;\r\n\r\n}\r\n\r\nconst Notebook: React.FC<NoteBookProps> = ({ notebookPages, singleColumn, pageIndex }) => {\r\n    const uiManager = useUiManager();\r\n    const [notebookIndex, setNotebookIndex] = React.useState(pageIndex || 0);\r\n\r\n\r\n    const closeNotebook = () => {\r\n        uiManager.closeNotebook();\r\n    }\r\n\r\n\r\n    useEffect(() => {\r\n        setNotebookIndex(pageIndex || 0);\r\n    }, [pageIndex]);\r\n\r\n    const currentNotebookPage = notebookPages[notebookIndex];\r\n\r\n    const removePlayerButton = () => {\r\n        setNotebookIndex(0);\r\n        uiManager.removePlayer(currentNotebookPage.content.player);\r\n    }\r\n\r\n    const getNotebookHeaderContent = () => {\r\n\r\n        if (!currentNotebookPage) {\r\n            return (\r\n                <div className={`notebook-header `} />\r\n            )\r\n        }\r\n\r\n        if (currentNotebookPage.category === NOTEBOOK_CATEGORY.ENCOUNTER || currentNotebookPage.category === NOTEBOOK_CATEGORY.LOCATION) {\r\n            return (\r\n                <div className={`notebook-header ${currentNotebookPage.category} `}>\r\n                    <button className=\"pill-button\" onClick={closeNotebook}>X</button>\r\n                    <div className=\"notebook-header-title\">{currentNotebookPage.category.toUpperCase()}</div>\r\n                    {/* <div className=\"title-bar\">\r\n                        <div className=\"title-text\">\r\n                            {currentNotebookPage.title}\r\n                        </div>\r\n                        <div className=\"features-text\">\r\n                            FEATURES\r\n                        </div>\r\n                    </div> */}\r\n                </div>\r\n            )\r\n        }\r\n\r\n        if (currentNotebookPage.category === NOTEBOOK_CATEGORY.PLAYER) {\r\n            return (\r\n                <div className={`notebook-header player `}>\r\n                    {singleColumn ? (\r\n                        <button className=\"pill-button remove\" onClick={removePlayerButton}>REMOVE\r\n\r\n                        </button>\r\n                    ) : (\r\n                        <button className=\"pill-button\" onClick={closeNotebook}>X</button>\r\n                    )}\r\n                    <div className=\"notebook-header-title\">{currentNotebookPage.category.toUpperCase()}</div>\r\n                    {/* <div className={`notebook-header-container`}>\r\n                        <div className=\"title-text\">\r\n                            {currentNotebookPage.title}\r\n                        </div>\r\n                        <div className=\"player-preferences-container\">\r\n                            <div className=\"title-text player-preferences likes small\">\r\n                                Likes\r\n                            </div>\r\n                            <div className=\"title-text player-preferences hates small\">\r\n                                Hates\r\n                            </div>\r\n                        </div>\r\n                    </div> */}\r\n                </div>\r\n            )\r\n        }\r\n\r\n        if (currentNotebookPage.category === NOTEBOOK_CATEGORY.CHARACTER) {\r\n            return (\r\n                <div className={`notebook-header character `}>\r\n\r\n                    <button className=\"pill-button\" onClick={closeNotebook}>X</button>\r\n                    <div className=\"notebook-header-title\">{currentNotebookPage.category.toUpperCase()}</div>\r\n                    <div className={`notebook-header-container`}>\r\n                        {/* <div className=\"title-text\">\r\n                            {currentNotebookPage.title}\r\n                        </div> */}\r\n\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n        if (currentNotebookPage.category === NOTEBOOK_CATEGORY.GROUP || currentNotebookPage.category === NOTEBOOK_CATEGORY.CHARACTER) {\r\n            return (\r\n                <div className={`notebook-header player ${currentNotebookPage.category}  `}>\r\n\r\n                    <div className=\"notebook-header-title\">{currentNotebookPage.category.toUpperCase()}</div>\r\n                    <div className={`notebook-header-container`}>\r\n\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n\r\n\r\n        return (\r\n            <div className={`notebook-header  ${currentNotebookPage.category} `}>\r\n\r\n                <button className=\"pill-button\" onClick={closeNotebook}>X</button>\r\n                <div className=\"title-bar\">\r\n                    <div className=\"title-text\">\r\n                        {currentNotebookPage.title}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n    // reach out to todd\r\n\r\n    const notebookTabs = notebookPages.map((page, index) => {\r\n\r\n        return (\r\n            <div className={`notebook-tab ${page.category} ${index === notebookIndex ? 'current' : ''}`} key={index} onClick={() => setNotebookIndex(index)}>\r\n                <div className=\"notebook-tab-title\">\r\n                    {page.title}\r\n                </div>\r\n            </div>\r\n        )\r\n    })\r\n\r\n    const getNotebookContent = () => {\r\n\r\n        if (!currentNotebookPage) {\r\n            return (\r\n                <div className=\"notebook-body\" />\r\n            )\r\n        }\r\n\r\n\r\n        switch (currentNotebookPage.category) {\r\n            case NOTEBOOK_CATEGORY.ENCOUNTER:\r\n                return (\r\n                    <NotebookEncounter\r\n                        encounterInfo={currentNotebookPage.content}\r\n                    />\r\n                )\r\n\r\n            case NOTEBOOK_CATEGORY.CHARACTER:\r\n                return (\r\n                    <NotebookCharacter\r\n                        characterInfo={currentNotebookPage.content}\r\n                    />\r\n                )\r\n\r\n\r\n            case NOTEBOOK_CATEGORY.LOCATION:\r\n                return (\r\n                    <NotebookLocation\r\n                        locationInfo={currentNotebookPage.content}\r\n                    />\r\n                )\r\n\r\n            case NOTEBOOK_CATEGORY.PLAYER:\r\n                return (\r\n                    <NotebookPlayer\r\n                        playerInfo={currentNotebookPage.content}\r\n                        singleColumn={singleColumn}\r\n                        clickChar={(idx: number) => {\r\n                            setNotebookIndex(idx+1)\r\n                         }}\r\n                    />\r\n                )\r\n\r\n            case NOTEBOOK_CATEGORY.MESSAGE:\r\n                return (\r\n                    <div className=\"notebook-category-message\">\r\n                        <div className=\"notebook-message-text\">\r\n                            {currentNotebookPage.content.message}\r\n                        </div>\r\n                    </div>\r\n                )\r\n            case NOTEBOOK_CATEGORY.TOC:\r\n                return (\r\n                    // <NotebookTOC\r\n                    //     playerInfo = {currentNotebookPage.content}\r\n                    // />\r\n                    <div />\r\n                )\r\n            case NOTEBOOK_CATEGORY.GROUP:\r\n                return (\r\n                    <NotebookGroup\r\n                        groupInfo={currentNotebookPage.content}\r\n                    />\r\n                )\r\n            case NOTEBOOK_CATEGORY.TUTORIAL:\r\n                return (\r\n                    <NotebookTutorial\r\n                        tutorialInfo={currentNotebookPage.content}\r\n                    />\r\n                )\r\n        }\r\n    }\r\n\r\n    if (!currentNotebookPage) {\r\n        return (\r\n            <div className=\"notebook-modal\" />\r\n        );\r\n    }\r\n    return (\r\n\r\n        <div className={`notebook-modal ${singleColumn ? 'single-column' : ''} ${currentNotebookPage.category === NOTEBOOK_CATEGORY.TUTORIAL ? 'tutorial' : ''}` }\r\n        >\r\n            {/* <div className=\"notebook-content o1\">\r\n                <div className=\"notebook-header\" />\r\n            </div>\r\n            <div className=\"notebook-content o2\" onClick={(e) => e.stopPropagation()}>\r\n                <div className=\"notebook-tabs\">\r\n                    {notebookTabs}\r\n                </div>\r\n                <div className=\"notebook-header\" />\r\n            </div>\r\n            <div className=\"notebook-content o3\">\r\n          \r\n                <div className=\"notebook-header\" />\r\n            </div> */}\r\n        {currentNotebookPage.category === NOTEBOOK_CATEGORY.TUTORIAL ? (\r\n            <NotebookTutorial\r\n            tutorialInfo={currentNotebookPage.content}\r\n            />\r\n            ) : (\r\n            <div className=\"notebook-container\">\r\n                 <div className=\"notebook-tabs\">\r\n                        {notebookTabs}\r\n                    </div>\r\n                <div className={`notebook-content ${currentNotebookPage.category}`} onClick={(e) => e.stopPropagation()}>\r\n                     \r\n                        {getNotebookHeaderContent()}\r\n                    <div className=\"notebook-body\">\r\n                        {getNotebookContent()}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            )}\r\n\r\n            {singleColumn && (\r\n                <div className=\"group-schedule-holder\">\r\n                    <GroupSchedule />\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Notebook;","import React from 'react';\nimport { NAV_ENTRY } from '../../models';\nimport { useAppManager } from '../managerContexts';\nimport { APP_STATE } from '../../consts/states';\n\ninterface NavBarProps {\n   buttonList: string[];\n   highlight?: string;\n}\n\nconst NavBar: React.FC<NavBarProps> = ({buttonList, highlight}) => {\n    const appManager = useAppManager();\n\n    const navClicked = (navEntry: string) => {\n        switch (navEntry) {\n          case NAV_ENTRY.PLAYER_RECRUITMENT:\n            \n            appManager.state = APP_STATE.PLAYER_RECRUITMENT;\n            break;\n          case NAV_ENTRY.CHARACTER_ASSIGNMENT:\n            appManager.state = APP_STATE.CHARACTER_CREATION;\n            break;\n          case NAV_ENTRY.CAMPAIGN:\n            appManager.state = APP_STATE.CAMPAIGN_SETUP;\n            break;\n          default:\n            console.log('No entry');\n        }\n      }\n\n\n\n    const renderButton = (buttonName: string) => {\n\n      let highlightClass = buttonName === highlight ? 'highlight' : '';\n        switch (buttonName) {\n          case NAV_ENTRY.PLAYER_RECRUITMENT:\n            return <button className={`nav-button player ${highlightClass}`} key={buttonName} onClick={() => navClicked(buttonName)} >Player Recruitment</button>;\n          case NAV_ENTRY.CHARACTER_ASSIGNMENT:\n            return <button className={`nav-button character ${highlightClass}`} key={buttonName}onClick={() => navClicked(buttonName)}>Character Assignment</button>;\n          case NAV_ENTRY.CAMPAIGN:\n            return <button className={`nav-button campaign ${highlightClass}`} key={buttonName}onClick={() => navClicked(buttonName)}>Campaign Select</button>;\n          default:\n            return null;\n        }\n      };\n    \n      return (\n        <div className=\"nav-bar-container\">\n          {buttonList.map(buttonName => renderButton(buttonName))}\n        </div>\n      );\n};\n\nexport default NavBar;\n","import React, { useEffect, useState } from 'react';\nimport './playerRecruitment.scss';\nimport AppManager from '../managers/appManager';\nimport PlayerManager from '../managers/playerManager';\nimport { NAV_ENTRY, NOTEBOOK_CATEGORY, NotebookState, Player } from '../models';\nimport PlayerCard from './playerCard';\nimport Schedule from './schedule';\n\nimport { useUiManager } from './managerContexts';\nimport NotebookGroup from './UI/notebookGroup';\nimport Notebook from './UI/notebook';\nimport NavBar from './UI/navBar';\n\ninterface PlayerRecruitmentProps {\n  appManager: AppManager; \n  playerManager: PlayerManager;\n}\n\n\nconst PlayerRecruitmentComponent: React.FC<PlayerRecruitmentProps> = ({appManager, playerManager}) => {\n  const [selectedPlayers, setSelectedPlayers] = useState<number[]>(playerManager.getSelectedPlayerIds());\n  const [groupNotebookContent, setGroupNotebookContent] = useState<NotebookState[]>([]);\n  const recruitablePlayers : Player[] = playerManager?.getRecruitablePlayers() || [];\n  const uiManager = useUiManager();\n\n  const toggleSelectPlayer = (playerId: number) => {\n    setSelectedPlayers((prevSelectedPlayers) => {\n      const newSelectedPlayers = Array.from(prevSelectedPlayers);\n\n      const index = newSelectedPlayers.indexOf(playerId);\n      if (index > -1) {\n        newSelectedPlayers.splice(index, 1);\n      } else {\n        newSelectedPlayers.push(playerId);\n      }\n      playerManager.setSelectedPlayers(newSelectedPlayers);\n\n      return newSelectedPlayers;\n    });\n    \n    const playerToShow = playerManager.getRecruitablePlayers()[playerId];\n  };\n\n  const numberOfSelectedPlayers = selectedPlayers.length;\n  const dayData = playerManager.aggregateSchedule();\n\n useEffect(() => {\n  const makeGroupNotebookContent = (players: number[]) => {\n\n    let content;\n    let notebookTitle ='';\n\n    \n    let secondaryEntries: { category: string; content: { player: Player; }; title: string; }[] = []\n    content = {players: players.map((player) => playerManager.getRecruitablePlayers()[player])};\n    notebookTitle = \"Group Info\";\n    content.players.forEach((player) => {\n      secondaryEntries.push({\n        category: NOTEBOOK_CATEGORY.PLAYER,\n        content: {player: player},\n        title: player.name.split(' ').map((n) => n[0]).join('')\n      })\n    });\n\n    const notebookState: NotebookState = {\n      category: NOTEBOOK_CATEGORY.GROUP,\n      content: content,\n      title: notebookTitle,\n    } \n\n    return [notebookState, ...secondaryEntries];\n  // return [notebookState];\n  }\n  // set selected players when the component mounts\n  playerManager.setSelectedPlayers(selectedPlayers);\n    setGroupNotebookContent(makeGroupNotebookContent(selectedPlayers));\n  }, [playerManager, selectedPlayers]);\n\n\n  useEffect(() => {\n    \n    const handleRemovePlayer = (player: Player) => {\n      setSelectedPlayers((prevSelectedPlayers) => {\n        const newSelectedPlayers = Array.from(prevSelectedPlayers);\n        const index = newSelectedPlayers.indexOf(player.id);\n        if (index > -1) {\n          newSelectedPlayers.splice(index, 1);\n        }\n        playerManager.setSelectedPlayers(newSelectedPlayers);\n        return newSelectedPlayers;\n    });\n  }\n\n    uiManager.on('removePlayer', handleRemovePlayer)\n    return () => {\n     uiManager.off('removePlayer', handleRemovePlayer);\n    } \n  \n  }, []);\n\n\n\n  return (\n\n    <div className=\"player-recruitment-mode\">\n      <div className=\"player-status-container\">\n        <div className=\"player-recruitment-left-container\">\n          <Notebook\n              notebookPages={groupNotebookContent}\n              singleColumn\n            />\n      \n        </div>\n        <NavBar buttonList={[NAV_ENTRY.CAMPAIGN, NAV_ENTRY.CHARACTER_ASSIGNMENT]} highlight={NAV_ENTRY.CHARACTER_ASSIGNMENT}/>\n      </div>\n      <div className=\"player-grid-container\">\n        <div className=\"player-recruitment-status\">\n          {numberOfSelectedPlayers === 0 ? 'Select players to recruit' : 'Click \"Accept Group\" to continue'}\n        </div>\n        <div className=\"player-grid\">\n          {recruitablePlayers.map((player) => (\n            <PlayerCard\n              key={player.id}\n              player={player}\n              isSelected={selectedPlayers.includes(player.id)}\n              onSelect={() => toggleSelectPlayer(player.id)}\n              showSchedule={true}\n              showPreferences={true}\n            />\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default PlayerRecruitmentComponent;\n","import React, { useEffect, useState } from 'react';\nimport './characterCreation.scss';\nimport PlayerCard from './playerCard'; // Adjust the import path as needed\nimport CharacterCard from './characterCard'; // Adjust the import path as needed\nimport { useAppManager, useCharacterManager, usePlayerManager } from './managerContexts';\nimport { Character, NAV_ENTRY, Player } from '../models';\nimport { APP_STATE } from '../consts/states';\nimport NavBar from './UI/navBar';\n\ninterface CharacterCreationProps { \n\n}\n\nconst CharacterCreation: React.FC<CharacterCreationProps> = ({}) => {\n\n  const playerManager = usePlayerManager()\n  const characterManager = useCharacterManager();\n  const appManager = useAppManager();\n\n  const [selectedPlayer, setSelectedPlayer] = useState<Player | null>(null);\n  const [players, setPlayers] = useState<Player[]>(playerManager.getPlayers());\n  const [characters, setCharacters] = useState<Character[]>(characterManager.getCharacterReferences());\n const [update, setUpdate] = useState(false);\n\n  const assignOrUnassignCharacter = (character: Character) => {\n    if(isAssignedToOtherPlayer(character)) {\n      return;\n    }\n\n    if (selectedPlayer) {\n      if (selectedPlayer.characters.includes(character)) {\n        // Unassign character\n        playerManager.removeCharacterFromPlayer(selectedPlayer, character);\n      } else if (selectedPlayer.characters.length < 4) {\n        // Assign character\n        playerManager.assignCharactersToPlayer(selectedPlayer, [character]);\n      }\n      setPlayers([...playerManager.getPlayers()]); // Update state to reflect changes\n    }\n  };\n\n\n  // Select first player on mount: \n  useEffect(() => {\n    if (!selectedPlayer && players.length) {\n      setSelectedPlayer(players[0]);\n    }\n  }, [players]);\n\n\n  const handlePlayerSelect = (player: Player) => {\n    setSelectedPlayer(player);\n  };\n\n\n  const forceRender = () => {\n    setUpdate(!update);\n  }\n  const isAssignedToOtherPlayer = (character: Character) => {\n    return players.some(player => player.id !== selectedPlayer?.id && player.characters.includes(character));\n  };\n\nreturn (\n    <div className=\"character-creation-container\">\n      <div className=\"character-creation-left-container\">\n      <NavBar buttonList={[NAV_ENTRY.PLAYER_RECRUITMENT, NAV_ENTRY.CAMPAIGN] } highlight={NAV_ENTRY.CAMPAIGN} />\n      <div className=\"player-list-container\">\n     \n\n        <div className=\"player-list\">\n          {players.map((player) => (\n            <PlayerCard \n              key={player.id}\n              player={player}\n              isSelected={selectedPlayer?.id === player.id}\n              onSelect={() => handlePlayerSelect(player)}\n              showSchedule={false}\n              showCharacters={true}\n              parentUpdate={forceRender}\n            >\n            </PlayerCard>\n          ))}\n        </div>\n      </div>\n    </div>\n      <div className=\"character-creation-right-container\">\n        <div className=\"character-grid\">\n          {characters.map((character) => (\n            <CharacterCard\n              key={character.id}\n              character={character}\n              isSelected={selectedPlayer?.characters.includes(character) ?? false}\n              onSelect={() => assignOrUnassignCharacter(character)}\n              showAbilities={true}\n              isAssigned={selectedPlayer?.characters.includes(character)}\n              isAssignedToOther={isAssignedToOtherPlayer(character)}\n\n            />\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CharacterCreation;\n","\nimport React from 'react';\nimport './encounter-display.css';\nimport { Encounter, NOTEBOOK_CATEGORY } from '../models';\nimport { useUiManager } from './managerContexts';\nimport CImage from './UI/cimage';\n\ninterface EncounterDisplayProps {\n    encounter:Encounter;\n}\n\nconst EncounterDisplay: React.FC<EncounterDisplayProps> = ({ encounter }) => {\n    const uiManager = useUiManager()\n    const handleClicked = () => {\n    uiManager.showBasicNotebook(NOTEBOOK_CATEGORY.ENCOUNTER, encounter)\n}\n\n    return (\n        <div className={`encounter-display ${encounter.location.themes[0]}`} onClick={handleClicked}>\n           <div className=\"encounter-name\">\n                {encounter.name}\n            </div> \n            <div className = \"encounter-event-icons\">\n                {encounter.events.map((event, index) => (\n                    <div key={index} className=\"encounter-event-icon\">\n                        <CImage imageId={uiManager.getEventIcon(event.type)} />\n                    </div>\n                ))}\n            </div>\n            {/* <MoreInfo\n                callback={handleClickedMoreInfo}\n            /> */}\n        </div>\n    );\n};\n\nexport default EncounterDisplay;","import React from 'react';\nimport './campaign-display-body.css';\nimport EncounterDisplay from './encounter-display';\nimport { Encounter } from '../models';\n\ninterface CampaignDisplayBodyProps {\n    processedEncounters: Encounter[][];\n}\n\nconst CampaignDisplayBody: React.FC<CampaignDisplayBodyProps> = ({ processedEncounters }) => {\n    \n    if(!processedEncounters){\n        return <div>No encounters!</div>\n    }\n    return (\n        <div className=\"campaign-display-body\">\n            {processedEncounters.map((encounterRow, rowIndex) => (\n                <div key={rowIndex} className=\"encounter-row\">\n                    {encounterRow.map((encounter, encounterIndex) => (\n                       <EncounterDisplay \n                        key={encounterIndex}\n                        encounter={encounter} />\n                    ))}\n                </div>\n            ))}\n        </div>\n    );\n};\n\nexport default CampaignDisplayBody;\n\n\n","import React from 'react';\nimport './campaign-display-body.css';\nimport { Campaign } from '../models';\nimport Cimage from './UI/cimage';\n\ninterface CampaignDisplayHeaderProps {\n    campaign: Campaign;\n}\n\nconst CampaignDisplayBody: React.FC<CampaignDisplayHeaderProps> = ({ campaign }) => {\n    \n    return (\n        <div className='campaign-display-header'>\n        <div className=\"campaign-icon\">\n          <Cimage imageId={campaign.icon} />\n        </div>\n        <div className=\"campaign-info\">\n          <div className=\"campaign-name\"><strong>{campaign.name}</strong></div>\n          <div className=\"campaign-description\">{campaign.description}</div>\n        </div>\n        <div className=\"campaign-extra\">\n          <div>{campaign.nbCharacters[0]} - {campaign.nbCharacters[1]} characters</div>\n          <div>{campaign.nbSessions[0]} - {campaign.nbSessions[1]} sessions</div>\n        </div>\n      </div>\n    );\n};\n\nexport default CampaignDisplayBody;","import React from 'react';\nimport { Campaign } from '../models';\nimport './campaignDisplay.scss';\nimport CampaignDisplayBody from './campaign-display-body';\nimport CampaignDisplayHeader from './campaign-display-header';\nimport Cimage from './UI/cimage';\n\n\n\ninterface CampaignDisplayProps {\n  campaign: Campaign;\n  onSelect?: () => void;\n  collapsed?: boolean;\n  iconOnly?: boolean;\n  onAccept?: () => void; \n  onCancel?: () => void;\n  acceptText?: string;\n}\n\nconst CampaignDisplay: React.FC<CampaignDisplayProps> = ({ campaign, onSelect, collapsed, iconOnly, onAccept, onCancel, acceptText = 'ACCEPT' }) => {\n\n  \n  return (\n    <>\n      {iconOnly ? (\n        <div className={`campaign-display ${campaign.theme || ''} icon-only`} onClick={onSelect}>\n          <div className=\"campaign-name\">{campaign.name}</div>\n          <div className=\"campaign-icon solo\">\n            <Cimage imageId={campaign.icon} />\n          </div>\n        </div>\n      ) : collapsed ? (\n        <div className={`campaign-display ${campaign.theme || ''} collapsed pill-shaped`} onClick={onSelect}>\n          <CampaignDisplayHeader campaign={campaign} />\n        </div>\n      ) : (\n        <div className={`campaign-display ${campaign.theme || ''} full`}>\n          <CampaignDisplayHeader campaign={campaign} />\n          <CampaignDisplayBody processedEncounters={campaign.processedEncounters} />\n          <div className='campaign-display-footer'>\n            <div className=\"ui-actions\">\n              <button className={`campaign-button cancel ${onCancel ? '' : ' hidden' }`} onClick={onCancel}>Cancel</button>\n              <button className=\"campaign-button accept\" onClick={onAccept}>{acceptText}</button>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  )\n};\n\nexport default CampaignDisplay;","import React, { useEffect, useState } from 'react';\nimport './campaignSetup.scss';\nimport { APP_STATE } from '../consts/states';\nimport { Player, Campaign, NAV_ENTRY } from '../models';\nimport { usePlayerManager, useAppManager, useCampaignManager } from './managerContexts';\nimport PlayerCard from './playerCard';\nimport CampaignDisplay from './campaignDisplay';\nimport NavBar from './UI/navBar';\n\ninterface CampaignSetupProps {\n  openCampaign?: number;\n}\n\nconst CampaignSetupComponent: React.FC<CampaignSetupProps> = ({openCampaign}) => {\n\n  const playerManager = usePlayerManager()\n  const appManager = useAppManager();\n  const campaignManager = useCampaignManager();\n\n\n  const [availableCampaigns] = useState<Campaign[]>(campaignManager.getAvailableCampaigns());\n  const [selectedCampaign, setSelectedCampaign] = useState<number | undefined>(openCampaign);\n\n  const [players] = useState<Player[]>(playerManager.getPlayers());\n\nconst unsetSelectedCampaign = () => {\n  setSelectedCampaign(undefined);\n}\n\nconst setMySelectedCampaign = (index: number) => {\n  \n  setSelectedCampaign(index);\n}\n\n  const handleAcceptCampaign = (campaignId: number) => {\n    campaignManager.startCampaign(campaignId);\n    if(playerManager.readyForGame()){\n      appManager.state = APP_STATE.SESSION;\n    }\n  }\n\n\n  useEffect(() => {\n    \n  }, [selectedCampaign]);\n\n  return (\n    <div className=\"campaign-setup-container\">\n      <div className=\"player-list-container\">\n      <NavBar buttonList={[NAV_ENTRY.PLAYER_RECRUITMENT, NAV_ENTRY.CHARACTER_ASSIGNMENT]} />\n\n        <div className=\"player-list\">\n          {players.map((player) => (\n            <PlayerCard \n              key={player.id}\n              player={player}\n              isSelected={false}\n              onSelect={() => {}}\n              showCharacters={true}\n              showSchedule={false}\n            >\n            </PlayerCard>\n          ))}\n        </div>\n      </div>\n      <div className=\"campaign-display-container\">\n        <div className=\"campaign-list-container\"> \n            <div className=\"campaign-list\">\n              {availableCampaigns.map((campaign, index) => (\n                <CampaignDisplay\n                  key={index} \n                  collapsed={selectedCampaign !== index}\n                  campaign={campaign}\n                  onSelect={() => setMySelectedCampaign(index)}\n                  onAccept={() => handleAcceptCampaign(index)}\n                  onCancel={() => unsetSelectedCampaign()}\n                />\n              ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default CampaignSetupComponent;\n","export const THEME = {\n    TOWN: \"town\",\n    TAVERN: \"tavern\",\n    BUILDING: \"building\",\n    DUNGEON: \"dungeon\",\n    WATER: \"water\",\n    FOREST: \"forest\",\n    MOUNTAIN: \"mountain\",\n    HEROIC: \"heroic\",\n    DARK: \"dark\",\n    EPIC: \"epic\",\n    ADVENTURE: \"adventure\",\n    MYSTERY: \"mystery\",\n    CAVE: \"cave\",\n    FIELD: \"field\",\n    CASTLE: \"castle\",\n    PLAINS: \"plains\",\n    PARK: \"park\",\n    VILLAGE: \"village\",\n    RUINS: \"ruins\",\n}","import { EncounterEvent } from \"../../models\";\r\nimport { ENCOUNTER_EVENT_TYPE } from \"../general\";\r\n\r\nexport const GENERIC_ENCOUNTER_EVENTS: Record<string, EncounterEvent> = {\r\n    COMBAT: {\r\n        name: 'Combat',\r\n        type: ENCOUNTER_EVENT_TYPE.COMBAT\r\n    },\r\n    ROLEPLAY: {\r\n        name: 'Roleplay',\r\n        type: ENCOUNTER_EVENT_TYPE.ROLEPLAY\r\n    },\r\n    EXPLORATION: {\r\n        name: 'Exploration',\r\n        type: ENCOUNTER_EVENT_TYPE.EXPLORATION\r\n    },\r\n    PUZZLE: {\r\n        name: 'Puzzle',\r\n        type: ENCOUNTER_EVENT_TYPE.PUZZLE\r\n    },\r\n    PERCEPTION: {\r\n        name: 'Perception Check',\r\n        type: ENCOUNTER_EVENT_TYPE.PERCEPTION\r\n    },\r\n    TOWN: {\r\n        name: 'Town',\r\n        type: ENCOUNTER_EVENT_TYPE.TOWN\r\n    },\r\n    TRAVEL: {\r\n        name: 'Travel',\r\n        type: ENCOUNTER_EVENT_TYPE.TRAVEL\r\n    },\r\n    CHALLENGE: {\r\n        name: 'Challenge',\r\n        type: ENCOUNTER_EVENT_TYPE.CHALLENGE\r\n    },\r\n    TRAP: {\r\n        name: 'Trap',\r\n        type: ENCOUNTER_EVENT_TYPE.TRAP\r\n    },\r\n    CHARACTER_BACKSTORY: {\r\n        name: 'Character Backstory',\r\n        type: ENCOUNTER_EVENT_TYPE.CHARACTER_BACKSTORY\r\n    },\r\n    STORY: {\r\n        name: 'Story',\r\n        type: ENCOUNTER_EVENT_TYPE.STORY\r\n    }  ,\r\n    EXPOSITION: {\r\n        name: 'Exposition',\r\n        type: ENCOUNTER_EVENT_TYPE.EXPOSITION\r\n    },\r\n    DUNGEON: {\r\n        name: 'Dungeon',\r\n        type: ENCOUNTER_EVENT_TYPE.DUNGEON\r\n    },\r\n}","import { Building, BUILDING_EFFECT_TYPE, BUILDING_TYPE, Campaign, CHAT_TYPE, Encounter, Location, Tag } from \"../../models\";\r\nimport { BUILDINGS } from \"../buildings\";\r\nimport { ENCOUNTER_EVENT_TYPE } from \"../general\";\r\nimport { TAG } from \"../tags\";\r\nimport { THEME } from \"../themes\";\r\nimport { GENERIC_ENCOUNTER_EVENTS } from \"./generticEncounterEvents\";\r\n\r\nconst CAMPAIGN_TAG: Record<string, Tag> = {\r\n    BREWER_KEVIN: {\r\n        name: 'Kevin the Brewer',\r\n    },\r\n    KIDNAPPING: {\r\n        name: 'Kidnapping',\r\n    },\r\n    OLD_LAKE: {\r\n        name: 'Old Lake',\r\n    },\r\n    // GOBLIN_SHAMAN:\r\n    // {\r\n    //     name: 'Goblin Shaman',\r\n    // },\r\n    CULT_LEADER: {\r\n        name: 'Cult Leader',\r\n    }\r\n}\r\n\r\nexport const CAMPAIGN_BUILDINGS: Record<string,Building> = {\r\n    \"TEMPLE\": {\r\n        name: \"Sagewood Temple\",\r\n        type: BUILDING_TYPE.TEMPLE,\r\n        description: \"Heal wounds, or resurrect fallen heroes.\",\r\n        tags: [CAMPAIGN_TAG.CULT_LEADER, TAG.RELIGION],\r\n        nbTags: 1,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.HEAL, value: 99}, {type: BUILDING_EFFECT_TYPE.RESURRECT, value: 1}]\r\n    },\r\n    \"SHOP\": {\r\n        name: \"Ricky's Shop\",\r\n        type: BUILDING_TYPE.SHOP,\r\n        description: \"Magic items, goods, and an attitude...\",\r\n        tags: [TAG.ARMOR, TAG.WEAPONS],\r\n        allowMagicItems: true,\r\n        nbTags:3,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.REPLENISH_TOOLS, value: 1}, {type: BUILDING_EFFECT_TYPE.ADD_TENSION, value: 5}]\r\n    },\r\n    \"MARKETPLACE\": {\r\n        name: \"Marketplace\",\r\n        type: BUILDING_TYPE.SHOP,\r\n        description: \"Replenish tools and talk with townsfolk.\",\r\n        tags: [TAG.TOOLS],\r\n        addFriendlyTags: true,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.REPLENISH_TOOLS, value: 99}]\r\n       // allowMagicItems: true,\r\n       \r\n    },\r\n    \"TAVERN\": {\r\n        name: \"Tavern\",\r\n        type: BUILDING_TYPE.TAVERN,\r\n        description: \"Gossip, rumors, and conversation.\",\r\n        tags: [TAG.DRINKS, TAG.BARRELS, TAG.HUMANS, TAG.HALFLINGS],\r\n        addFriendlyTags: true,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.ADD_ENJOYMENT, value: 1}]\r\n    },\r\n    \r\n    \"GUILD_HALL\": {\r\n        name: \"Adventurer's Guild\",\r\n        type: BUILDING_TYPE.GUILD_HALL,\r\n        description: \"Replenish Magic, Level Up, and find magic items.\",\r\n        tags: [TAG.LEVEL_UP],\r\n        allowMagicItems: true,\r\n        nbTags: 3,\r\n        addFriendlyTags: true,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.REPLENISH_MAGIC, value: 99}]\r\n    },\r\n    \"CONFRONTATION\":{\r\n        name: \"Tense Standoff\",\r\n        type: BUILDING_TYPE.CONFRONTATION,\r\n        description: \"Hostile strangers walk the streets of Sagewood... \",\r\n        tags: [TAG.CULTISTS, CAMPAIGN_TAG.CULT_LEADER],\r\n        nbTags: 1,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.ADD_TENSION, value: 10}]\r\n    },\r\n    \"CONFRONTATION2\":{\r\n        name: \"Slums\",\r\n        type: BUILDING_TYPE.CONFRONTATION,\r\n        description: \"The heroes stumble into a bad part of town... \",\r\n        tags: [],\r\n        nbTags: 0,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.ADD_TENSION, value: 10}]\r\n    }\r\n}\r\n\r\nconst LOCATIONS: Record<string, Location> = {\r\n    SAGEWOOD_TAVERN: {\r\n        name: 'Sagewood Tavern',\r\n        description: 'A cozy tavern in the heart of Sagewood. Two halfling barmids serve drinks to a variety of customers. Locals gossip and are usually up for a friendly game of dice or a dance with outsiders. A fire crackles on the hearth.',\r\n        icon: 'cd_l_sagewoodtavern',\r\n        tags: [TAG.BARRELS, TAG.FIRE, TAG.HUMANS, TAG.HALFLINGS, TAG.DRINKS],\r\n        themes: [THEME.TOWN, THEME.TAVERN],\r\n    },\r\n    UNDER_THE_WELL: {\r\n        name: 'Under the Well',\r\n        description: 'A huge underground cavern with a deep pool in the center. The opening to the town well looms above.',\r\n        icon: 'cd_l_underthewell',\r\n        tags: [TAG.DUNGEON],\r\n        themes: [THEME.DUNGEON,THEME.WATER]\r\n    }, \r\n    LAKESIDE_BREWERY: {\r\n        name: 'Lakeside Brewery',\r\n        description: 'A small brewery on the edge of the lake. Something sinister has happened here.',\r\n        icon: 'cd_l_sagewoodbrewery',\r\n        tags: [TAG.BEER, TAG.WATER, TAG.BARRELS],\r\n        themes: [THEME.TOWN]\r\n    },\r\n  \r\n    LAKESIDE: {\r\n        name: 'Lakeside',\r\n        description: 'A forested area along a quiet lake. The water is dark and still.',\r\n        icon: 'cd_l_lakeside',\r\n        tags: [TAG.WILDERNESS, TAG.WATER, TAG.FOLIAGE],\r\n        themes: [THEME.FOREST]\r\n    },\r\n    LAKESIDE_CLIFFS: {\r\n        name: 'Lakeside Cliffs',\r\n        description: 'A series of cliffs overlooking the lake. Signs of Goblins are about.',\r\n        icon: 'cd_l_lakesidecliffs',\r\n        tags: [TAG.CAVES, TAG.GOBLINS, TAG.WATER, TAG.FOLIAGE],\r\n        themes: [THEME.MOUNTAIN, THEME.FOREST]\r\n    },\r\n}\r\n\r\nconst ENCOUNTERS: Record<string, Encounter> = {\r\n    SAGEWOOD: {\r\n        id: 1,\r\n        name: 'Cultist Conspiracy', \r\n        description: 'The party arrives at a tavern on the ouskirts of Sagewood just as the sun sets. They each have their own reasons for being there, but for this evening they all have one thing in common... they are the only strangers in the tavern. Some locals seem friendly, while others gather in small clusters around the smoky common room and glare at the party. The barmaids offer the party drinks and food. The party may overhear gossip about Kevin the Brewer, or notice strange tattoos on some of the locals. They may uncover clues to a mysterious goblin treasure by the old lake, or discover that several townspeople have gone missing recently. The party may take part in a dance competition with the locals if they like. A group of the locals with odd tattoos will use any excuse to start a fight with the party. ',\r\n        icon: 'cd_e_sagewoodtavern',\r\n        location: LOCATIONS.SAGEWOOD_TAVERN,\r\n        tags: [TAG.MYSTERIES, TAG.CULTISTS, CAMPAIGN_TAG.BREWER_KEVIN, CAMPAIGN_TAG.KIDNAPPING],\r\n        branches: [],\r\n        events: \r\n            [{\r\n                name: 'Gossip and Rumors',\r\n                type: ENCOUNTER_EVENT_TYPE.ROLEPLAY,\r\n                flavorText: 'The party chats with locals in the tavern. They may hear interesting rumors.',\r\n            },\r\n            \r\n             {\r\n                name: 'Dance Competition',\r\n                type: ENCOUNTER_EVENT_TYPE.CHALLENGE,\r\n                flavorText: 'The party is challenged to a danceoff. Maybe they\\'ll notice something strange about the locals...',\r\n                tags: [TAG.HALFLINGS, TAG.HUMANS]\r\n             },\r\n             { \r\n                name: 'Tavern Brawl',\r\n                type: ENCOUNTER_EVENT_TYPE.COMBAT,\r\n                flavorText: 'The party is ambushed in the tavern.',\r\n                \r\n            },\r\n           \r\n            GENERIC_ENCOUNTER_EVENTS.PERCEPTION,\r\n            {\r\n                name: 'Sagewood',\r\n                type: ENCOUNTER_EVENT_TYPE.TOWN,\r\n                flavorText: 'Shop, rest, and gather information in the town of Sagewood.',\r\n            }\r\n        ],\r\n        combat: [\r\n            {\r\n                name: 'Bar Brawl',\r\n                description: 'Things get out of hand in the Sagewood Tavern.',\r\n                enemy: TAG.CULTISTS,\r\n                nbEnemies: 2,\r\n            }\r\n        ],\r\n        challenge: [\r\n            {\r\n                name: 'Dance-off in the Tavern',\r\n                description: 'The party is challenged to a dance-off by some of the locals. The winner gets a free drink.',\r\n            }\r\n        ],\r\n        town: [\r\n            {\r\n                buildings: [CAMPAIGN_BUILDINGS.TAVERN, CAMPAIGN_BUILDINGS.SHOP, CAMPAIGN_BUILDINGS.GUILD_HALL, CAMPAIGN_BUILDINGS.MARKETPLACE, CAMPAIGN_BUILDINGS.TEMPLE, CAMPAIGN_BUILDINGS.CONFRONTATION, CAMPAIGN_BUILDINGS.CONFRONTATION2],\r\n                nbBuildings: [5, 6]\r\n            }\r\n        ]\r\n    },\r\n    UNDER_THE_WELL: {\r\n        id: 2,\r\n        name: 'Fishy Finale!',\r\n        description: 'The heroes stumble into the Cultists Lair. They were set up under the old well in the center of town all along. Their fish-based magic will be put to the test during this long combat-based finale!.',\r\n        icon: 'cd_e_underthewell',\r\n        location: LOCATIONS.UNDER_THE_WELL,\r\n        tags: [TAG.FIGHTING, TAG.CULTISTS, TAG.MONSTERS],\r\n        branches: [],\r\n        events: []\r\n    },\r\n    BREWERY_FIGHT: {\r\n        id: 3,\r\n        name: 'Brewery Battle',\r\n        description: 'The party investigates a local brewery. The Brewer, Kevin, hasn\\'t been seen in town recently and barrel deliveries to the local tavern have been ...off. The party may be aware of a cult hiding in the brewery, so be sure to adjust the difficulty if the party takes the time to examine thier surroundings to see how best to approach. In any case, the Cult Leaders will attack when they notice the party. While in the brewery, characters may notice a tunnel leading underground towards the old lake and they might even discover signs that indicate some of the kidnapped townspeople had been taken that direction. ',\r\n        icon: 'cd_e_sagewoodbrewery',\r\n        location: LOCATIONS.LAKESIDE_BREWERY,\r\n        tags: [TAG.FIGHTING, CAMPAIGN_TAG.CULT_LEADER, TAG.BEER], \r\n        branches: [],\r\n        events: \r\n        [{\r\n            name: 'Interrogation',\r\n            type: ENCOUNTER_EVENT_TYPE.ROLEPLAY,\r\n            flavorText: 'The party corners a scared cultist and demands some information....',\r\n        },\r\n        \r\n         {\r\n            name: 'Drinking Competition',\r\n            type: ENCOUNTER_EVENT_TYPE.CHALLENGE,\r\n            flavorText: 'While we are here...',\r\n            tags: [TAG.BEER]\r\n         },\r\n         { \r\n            name: 'Cult, Culter, Cultist',\r\n            type: ENCOUNTER_EVENT_TYPE.COMBAT,\r\n            flavorText: 'The party confronts the Cult Leader and his followers.',\r\n            \r\n        },\r\n        GENERIC_ENCOUNTER_EVENTS.PERCEPTION,\r\n        GENERIC_ENCOUNTER_EVENTS.EXPOSITION\r\n    ],\r\n    combat: [\r\n        {\r\n            name: 'Bar Brawl',\r\n            description: 'Things get out of hand in the Sagewood Tavern.',\r\n            enemy: TAG.CULTISTS,\r\n            nbEnemies: 2,\r\n        }\r\n    ],\r\n    challenge: [\r\n        {\r\n            name: 'Dance-off in the Tavern',\r\n            description: 'The party is challenged to a dance-off by some of the locals. The winner gets a free drink.',\r\n        }\r\n    ]\r\n    }, \r\n    BREWERY_EXPLORATION: {\r\n        id: 4,\r\n        name: 'Brewery Exploration',\r\n        description: 'The party investigates the Lakeside Brewery and finds evidence of the cult’s activities.',\r\n        icon: 'cd_e_breweryexploration',\r\n        location: LOCATIONS.LAKESIDE_BREWERY,\r\n        tags: [TAG.EXPLORATION, TAG.MYSTERIES], \r\n        branches: [],\r\n        events: []\r\n    },\r\n    BY_THE_LAKE: {\r\n        id: 5,\r\n        name: 'By the Lake',\r\n        description: 'The party discovers signs of goblins by the lake.',\r\n        icon: 'cd_e_bythelake',\r\n        location: LOCATIONS.LAKESIDE,\r\n        tags: [TAG.TREASURE, TAG.GOBLINS, TAG.RELIGION], \r\n        branches: [],\r\n        events: \r\n        [{\r\n            name: 'Explore the Forest',\r\n            type: ENCOUNTER_EVENT_TYPE.PERCEPTION,\r\n            flavorText: 'The party checks in the forest near the lake...',\r\n        },\r\n        {\r\n            name: 'Explore the Lakeshore',\r\n            type: ENCOUNTER_EVENT_TYPE.PERCEPTION,\r\n            flavorText: 'The party checks the lakeshore...',\r\n        },\r\n         {\r\n            name: 'What\\'s in that tree?!',\r\n            type: ENCOUNTER_EVENT_TYPE.CHALLENGE,\r\n            flavorText: 'A creepy totem hangs in a clearing. The players attempt to cut it down.',\r\n         },\r\n         {\r\n            name: 'Now where is that treasure?!',\r\n            type: ENCOUNTER_EVENT_TYPE.CHALLENGE,\r\n            flavorText: 'The party search for the hidden treasure.',\r\n         },\r\n         { \r\n            name: 'Goblin Ambush',\r\n            type: ENCOUNTER_EVENT_TYPE.COMBAT,\r\n            flavorText: 'Goblins rush from the forest and attack!',\r\n            \r\n        }],\r\n        combat: [\r\n            {\r\n                name: 'Goblin Ambush',\r\n                description: 'Goblins rush from the trees!',\r\n                enemy: TAG.GOBLINS,\r\n                nbEnemies: 2,\r\n            }\r\n        ],\r\n        challenge: [\r\n            {\r\n                name: 'Cut down creepy totem',\r\n                description: 'An ominous, and magial feeling eminates from a totem hanging from a tree. It will take some thought and some care to cut it down.',\r\n            }\r\n        ]\r\n    \r\n    },\r\n    LAKESIDE_CLIFFS: {\r\n        id: 6,\r\n        name: 'Cliff Catastrophe',\r\n        description: 'The party encounters a crazy goblin shaman in the Lakeside Cliffs.',\r\n        icon: 'cd_e_lakesidecliffs',\r\n        location: LOCATIONS.LAKESIDE_CLIFFS,\r\n        tags: [TAG.FIGHTING, TAG.GOBLINS], \r\n        branches: [],\r\n        events: []\r\n    },\r\n}\r\n\r\n\r\n\r\nENCOUNTERS.SAGEWOOD.branches.push(ENCOUNTERS.BREWERY_FIGHT);\r\nENCOUNTERS.SAGEWOOD.branches.push(ENCOUNTERS.BY_THE_LAKE);\r\n\r\nENCOUNTERS.BREWERY_FIGHT.branches.push(ENCOUNTERS.BREWERY_EXPLORATION);\r\nENCOUNTERS.BREWERY_FIGHT.branches.push(ENCOUNTERS.BY_THE_LAKE);\r\n\r\nENCOUNTERS.BY_THE_LAKE.branches.push(ENCOUNTERS.LAKESIDE_CLIFFS);\r\n\r\nENCOUNTERS.LAKESIDE_CLIFFS.branches.push(ENCOUNTERS.UNDER_THE_WELL);\r\n\r\nconst processedEncounters =  \r\n    [\r\n        [ENCOUNTERS.SAGEWOOD],\r\n        [ENCOUNTERS.BREWERY_FIGHT, ENCOUNTERS.BY_THE_LAKE],\r\n        [ENCOUNTERS.BREWERY_EXPLORATION, ENCOUNTERS.LAKESIDE_CLIFFS],\r\n        [ENCOUNTERS.UNDER_THE_WELL]\r\n    ];\r\n\r\n    \r\n\r\n\r\nexport const cultOfTheDeep: Campaign = {\r\n    name: 'Cult of the Deep',\r\n    id: 0,\r\n    description: 'Townsfolk are acting strange. Something is moving in the lake. The Cult of the Deep is rising.',\r\n    icon: 'cult_of_the_deep_1',\r\n    startingEncounter: ENCOUNTERS.SAGEWOOD,\r\n    finaleEncounter: ENCOUNTERS.UNDER_THE_WELL,\r\n    theme: 'dark',\r\n    nbCharacters: [2, 4],\r\n    nbSessions: [2, 3],\r\n    encounters: Object.values(ENCOUNTERS),\r\n    processedEncounters: processedEncounters,\r\n    plotHooks: [\r\n        'The party finds fish 1',\r\n        'The party figures out the cultists and goblins are connected',\r\n        'The party discovers the cultists are kidnapping people',\r\n        'The party learns of a crab-monster eating people',\r\n    ],\r\n    tooltipTags: {\r\n        [ENCOUNTERS.SAGEWOOD.name]: {\r\n            [TAG.CULTISTS.name]: \"mention the group of weirdos in the corner\",\r\n            [TAG.MYSTERIES.name]: 'hint at an overheard secret',\r\n            [TAG.GOBLINS.name]: 'mention goblins by the lake',\r\n            [CAMPAIGN_TAG.BREWER_KEVIN.name]: 'there\\'s a rumor about Kevin',\r\n            [CAMPAIGN_TAG.KIDNAPPING.name]: 'someone mentions a recent kidnapping',\r\n            [TAG.DRINKS.name]: 'describe the beer',\r\n            [CAMPAIGN_TAG.OLD_LAKE.name]: 'A rumor about a nearby lake',\r\n            [TAG.FIRE.name]: 'The fireplace comes up',\r\n            [TAG.BARRELS.name]: 'a player notices an ale barrel',\r\n            [TAG.HALFLINGS.name]: 'mention the halfling barmaids',\r\n            [TAG.HUMANS.name]: 'describe the human patrons',\r\n            [TAG.BEER.name]: 'converse about beer',\r\n            [TAG.TREASURE.name]: 'mention the treasure',\r\n            [TAG.RELIGION.name]: 'mention the goblins religion',\r\n            [TAG.FIGHTING.name]: 'make sure they realize there will be combat at the brewery',\r\n        }\r\n    },\r\n\r\n    chatTriggers: {\r\n        [ENCOUNTERS.SAGEWOOD.name]: {\r\n            [TAG.CULTISTS.name]: 'You notice a group of humans in red robes and with a strange octopus tattoo. They seem to be eyeing you suspiciously.',\r\n            [TAG.MYSTERIES.name]: 'You overhear someone speak about a goblin treasure. Someone else interrupts and claims that they saw a goblin camp near the old lake.',\r\n            [TAG.GOBLINS.name]: 'A table of townspeople loudly argue nearby. They seem to be discussing goblins, but quiet down when they notice you listening.',\r\n            [CAMPAIGN_TAG.BREWER_KEVIN.name]: 'The bartender mentions that Kevin the Brewer hasn\\'t been seen in days and that strange people have been delivering the beer.',\r\n            [CAMPAIGN_TAG.KIDNAPPING.name]: 'A man says he doesn\\'t recognize you and cautions you to be careful. He goes on to explain that several people have gone missing recently.',\r\n            [CAMPAIGN_TAG.CULT_LEADER.name]: {\r\n                message: 'With all these cultists, I bet there\\'s a cult LEADER around... maybe at the brewery!',\r\n                speaker: {\r\n                    type: CHAT_TYPE.PLAYER,\r\n                    id: 1\r\n                }\r\n            },\r\n            [TAG.DRINKS.name]:'The beer is supposed to be the best in the region, but it tastes awful. When you ask the barmaid about it she says you should complain to Kevin at the Brewery',\r\n            [CAMPAIGN_TAG.OLD_LAKE.name]: 'A young couple loudly complain to some friends, they are trying to find a place to picnic but they indicate that the old lake is now teeming with goblins.',\r\n            [TAG.BARRELS.name]: {\r\n                message: 'Hey look at this ale-barrel! It\\'s got an octopus symbol on it. Octobrew..?',\r\n                speaker: {\r\n                    type: CHAT_TYPE.CHARACTER,\r\n                    id: 1\r\n                },\r\n            },\r\n            [TAG.FIRE.name]: {\r\n                message: 'I walk to the fire and warm my frigid digits. Fridgits.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.CHARACTER,\r\n                    id: 0\r\n                }\r\n            },\r\n            [TAG.HALFLINGS.name]: {\r\n                message: 'I want to chat with the halfling barmaids. See if they know what\\'s good to eat here.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.CHARACTER,\r\n                    id: 2\r\n                }\r\n            },\r\n            [TAG.HUMANS.name]: 'Most of the locals are humans. Some seem friendly but others are clearly hostile.',\r\n            [TAG.BEER.name]: 'Some of the locals say that if you want decent beer you should go to the brewery by the lake.',\r\n            [TAG.TREASURE.name]: 'The bartender says some adventurers came through recently and said he overheard them talking about a treasure they had buried out by the old lake.',\r\n            [TAG.RELIGION.name]: 'The party asks a priest about the local religious customs. He describes normal enough things, but says a goblin religion seems to have become popular in town...they worship a strange fish god in the nearby lake.',\r\n            [TAG.FIGHTING.name]: {\r\n                message: 'Hey guys, I can see the DM notes that say \"Brewery Battle\". I think we can expect combat if we go there...I\\'m just getting that vibe.', \r\n                speaker: {\r\n                    type: CHAT_TYPE.PLAYER,\r\n                    id: 0\r\n                }\r\n            }\r\n          \r\n        }\r\n    }\r\n}\r\n  \r\n","import { Campaign, Encounter, Location } from \"../../models\";\nimport { TAG } from \"../tags\";\nimport { THEME } from \"../themes\";\n\n\nconst LOCATIONS: Record<string, Location> = {\n    OLD_MILL: {\n        name: 'The Old Mill',\n        description: 'An old family-owned mill on the edge of town.',\n        icon: 'mm_l_oldMill',\n        tags: [TAG.STARTING_LOCATION, TAG.TOWN],\n        themes: [THEME.TOWN],\n    },\n    QUARRY: {\n        name: 'The Quarry',\n        description: 'A large quarry where stone is mined.',\n        icon: 'mm_l_quarry',\n        tags: [TAG.WILDERNESS],\n        themes: [THEME.MOUNTAIN],\n    },\n    ROAD: {\n        name: 'Road',\n        description: 'A long wide road',\n        icon: 'mm_l_road',\n        tags: [TAG.ROADS],\n        themes: [THEME.TOWN]\n    },\n    UNDER_THE_MOUNTAIN: {\n        name: 'Under the Mountain',\n        description: 'A hidden entrance leads into the gnomish mines.',\n        icon: 'mm_l_entrance',\n        tags: [TAG.CAVES],\n        themes: [THEME.MOUNTAIN],\n    },\n    TUNNELS: {\n        name: 'Gnome Tunnels',\n        description: 'Cramped tunnels deep underground.',\n        icon: 'mm_l_tunnel',\n        tags: [TAG.CAVES],\n        themes: [THEME.MOUNTAIN],\n    },\n    BRIDGE: {\n        name: 'The Old Bridge',\n        description: 'A rickety old bridge over a deep chasm.',\n        icon: 'mm_l_bridge',\n        tags: [TAG.WILDERNESS],\n        themes: [THEME.FOREST],\n    },\n    BEACH: {\n        name: 'The Beach',\n        description: 'A long stretch of beach.',\n        icon: 'mm_l_beach',\n        tags: [TAG.BEACHES],\n        themes: [THEME.WATER],\n    },\n    TOWNVILLE: {\n        name: 'TOWNVILLE',\n        description: 'A mid-sized village.',\n        icon: 'mm_l_townville',\n        tags: [TAG.TOWN, TAG.STARTING_LOCATION, TAG.FINALE_LOCATION, TAG.HUMANS],\n        themes: [THEME.TOWN]\n    }\n}\n\n\n// What if during the game, tags came up and these could come from the locations linked, or the current place or something and \n// you could choose what to DO with those tags, like assign them to locations - which might cause the players to want to GO there or AVOID there. But \n// we should keep track of any tags assigned to a place that the players choose because then you have to HOPE one of those tags shows up! \n// maybe there are some wild-tags that could be used to cover up some unwanted tags.... \n\n// maybe TAGS have a lot of smaller taglike things? (so a big one would be 'ELVES' but then little ones would be elf-related? hmm sounds corny and\n// a lot of work coming up with related shit. Maybe the tags have a strength and need to be satisfied by X amounts when assigned or for other reasons\n// but those strengths will also affect the amount that players like or hate them.\n\n// maybe after every session players adjust their LIKES and HATES in accordance with the game they just played!!\n\n\nconst ENCOUNTERS: Record<string, Encounter> = {\n    INTRO_IN_TOWN: {\n        id: 0,\n        name: 'Intro in Townville',\n        description: \"It's a peaceful day in Townville. The Heroes can spend some time buying Gear or Roleplaying. Suddenly the alarm sounds! The Miller has run all the way from the old mill shouting about thieves!\",\n        icon: 'mm_e_townville',\n        location: LOCATIONS.TOWNVILLE,\n        tags: [TAG.HUMANS, TAG.MYSTERIES, TAG.SOCIAL],\n        branches: [],\n        events: []\n    },\n    INTRO_AT_MILL: {\n        id: 1,\n        name: 'Missing Millstone',\n        description: 'The Millstone is missing. The Miller hires the Heroes to travel to the old quarry and transport a new one. There are also some clues around the Old Mill which may reveal more about what happened. This could be the sarting Encounter if you want to shorten the campaign, or to avoid Town.',\n        icon: 'mm_e_millstone',\n        location: LOCATIONS.OLD_MILL,\n        tags: [TAG.HUMANS, TAG.MYSTERIES, TAG.SOCIAL],\n        branches: [],\n        events: []\n\n    },\n    ROAD_TO_QUARRY: {\n        id: 2,\n        name: 'Road to Quarry',\n        description: 'A long boring trek to the Quarry.',\n        icon: 'mm_e_road',\n        location: LOCATIONS.ROAD,\n        tags: [TAG.BORING],\n        branches: [],\n        events: []\n    },\n    QUARRY_INVESTIGATION: {\n        id: 2,\n        name: 'Quarry',\n        description: 'A large quarry where stone is mined. The millstone might be here.',\n        icon: 'mm_e_quarry',\n        location: LOCATIONS.QUARRY,\n        tags: [TAG.HUMANS, TAG.SOCIAL, TAG.GNOMES],\n        branches: [],\n        events: []\n      \n    },\n    MOUNTAIN_ENTRANCE: {\n        id: 3,\n        name: 'Cave Entrance',\n        description: 'A hidden entrance in the wall of the quarry leads into the gnomish mines.',\n        icon: 'mm_e_cave',\n        location: LOCATIONS.UNDER_THE_MOUNTAIN,\n        tags: [TAG.GNOMES, TAG.COMBAT, TAG.EXPLORATION],\n        branches: [],\n        events: []\n    },\n    EXPLORING_THE_TUNNELS: {\n        id: 4,\n        name: 'Gnomish Tunnel Exploration',\n        description: 'Tunnels leading to the South. Towards townville?',\n        icon: 'mm_e_tunnels',\n        tags: [TAG.GNOMES],\n        location: LOCATIONS.TUNNELS,\n        branches: [],\n        events: []\n    },\n    BANDITS_ON_THE_BRIDGE: {\n        id: 5,\n        name: 'Bridge Bandits',\n        description: 'Bandits guard the far end. They demand payment!',\n        icon: 'mm_e_bandits',\n        tags: [TAG.HUMANS, TAG.COMBAT, TAG.ROLEPLAY],\n        location: LOCATIONS.BRIDGE,\n        branches: [],\n        events: []\n    },\n    BEACH_TRAVEL: {\n        id: 6,\n        name: 'Beach Travel',\n        description: 'Traveling along the beach',\n        icon: 'mm_e_beach',\n        tags: [TAG.COMBAT],\n        location: LOCATIONS.BEACH,\n        branches: [],\n        events: []\n    },\n    EXPLORE_SHIPWRECK: {\n        id: 7,\n        name: 'SHIPWRECK',\n        description: 'A ship. Has wrecked! Someone is looting it!',\n        icon: 'mm_e_shipwreck',\n        tags: [TAG.HUMANS, TAG.COMBAT, TAG.EXPLORATION],\n        location: LOCATIONS.BEACH,\n        branches: [],\n        events: []\n    },\n    TOWNVILLE_FIRE: {\n        id: 8,\n        name: 'Townville Fire',\n        description: 'The town of townville is on fire!',\n        icon: 'mm_e_fire',\n        tags: [TAG.HUMANS, TAG.DISASTERS, TAG.FIRE],\n        location: LOCATIONS.TOWNVILLE,\n        branches: [],\n        events: []\n    }\n}\n\nENCOUNTERS.INTRO_IN_TOWN.branches.push(ENCOUNTERS.INTRO_AT_MILL);\nENCOUNTERS.INTRO_AT_MILL.branches.push(ENCOUNTERS.ROAD_TO_QUARRY);\n\nENCOUNTERS.ROAD_TO_QUARRY.branches.push(ENCOUNTERS.QUARRY_INVESTIGATION);\n\nENCOUNTERS.QUARRY_INVESTIGATION.branches.push(ENCOUNTERS.MOUNTAIN_ENTRANCE);\nENCOUNTERS.QUARRY_INVESTIGATION.branches.push(ENCOUNTERS.BEACH_TRAVEL);\nENCOUNTERS.QUARRY_INVESTIGATION.branches.push(ENCOUNTERS.BANDITS_ON_THE_BRIDGE);\n\nENCOUNTERS.MOUNTAIN_ENTRANCE.branches.push(ENCOUNTERS.EXPLORING_THE_TUNNELS);\n\nENCOUNTERS.EXPLORING_THE_TUNNELS.branches.push(ENCOUNTERS.TOWNVILLE_FIRE);\n\nENCOUNTERS.BEACH_TRAVEL.branches.push(ENCOUNTERS.EXPLORE_SHIPWRECK);\n\nENCOUNTERS.EXPLORE_SHIPWRECK.branches.push(ENCOUNTERS.TOWNVILLE_FIRE);\n\nENCOUNTERS.BANDITS_ON_THE_BRIDGE.branches.push(ENCOUNTERS.TOWNVILLE_FIRE);\n\n//ENCOUNTERS.TOWNVILLE_FIRE.branches.push(ENCOUNTERS.TOWNVILLE_FIRE); // This is the end of the line! \n\n\n//MAXIM - HEre is where we differentiate campaignNodes and encounters! \n// CAmpaign nodes should/could also have details like \"The party decided to follow the gnomes under the mountain\"\n// which can be part of the linking here, like: NODES.OLD_MILL.pathNodes.push([NODES.UNDER_THE_MOUNTAIN, \"The party decided to....\"])!!!\nconst processedEncounters =  [\n    [ENCOUNTERS.INTRO_IN_TOWN],\n    [ENCOUNTERS.INTRO_AT_MILL],\n    [ENCOUNTERS.ROAD_TO_QUARRY],\n    [ENCOUNTERS.QUARRY_INVESTIGATION],\n    [ENCOUNTERS.MOUNTAIN_ENTRANCE, ENCOUNTERS.BEACH_TRAVEL, ENCOUNTERS.BANDITS_ON_THE_BRIDGE],\n    [ENCOUNTERS.EXPLORING_THE_TUNNELS, ENCOUNTERS.EXPLORE_SHIPWRECK],\n    [ENCOUNTERS.TOWNVILLE_FIRE]\n];\n\n\nexport const millstoneMystery: Campaign = {\n    name: 'Millstone Mystery',\n    id: 0,\n    description: 'The Millstone has mysteriously gone missing! While investigating what happened, the heroes may be delving into gnomish caves, or fighting scavengers along the beach.',\n    icon: 'millstone_mystery_1',\n    theme: 'adventure',\n    nbCharacters:[2,4],\n    nbSessions:[4,6],\n    startingEncounter: ENCOUNTERS.INTRO_IN_TOWN,\n    finaleEncounter: ENCOUNTERS.TOWNVILLE_FIRE,\n    encounters: Object.values(ENCOUNTERS),\n    processedEncounters: processedEncounters\n};","\r\nimport { Building, BUILDING_EFFECT_TYPE, BUILDING_TYPE, Campaign, CHAT_TYPE, Encounter, Location, Tag } from \"../../models\";\r\nimport { BUILDINGS } from \"../buildings\";\r\nimport { GEAR } from \"../characterConsts\";\r\nimport { ENCOUNTER_EVENT_TYPE } from \"../general\";\r\nimport { TAG } from \"../tags\";\r\nimport { THEME } from \"../themes\";\r\nimport { GENERIC_ENCOUNTER_EVENTS } from \"./generticEncounterEvents\";\r\n\r\nconst CAMPAIGN_TAG: Record<string, Tag> = {\r\n    VILLAGE_ELDER: {\r\n        name: 'Elder',\r\n    },\r\n    DANCING: {\r\n        name: 'Dancing',\r\n    },\r\n  ELVEN_PRIEST: {\r\n        name: 'Elven Priest',\r\n    },\r\n}\r\n\r\nexport const CAMPAIGN_BUILDINGS: Record<string,Building> = {\r\n    \"ELDERS_HOME\": {\r\n        name: \"Elder Rose's Hut\",\r\n        type: BUILDING_TYPE.TEMPLE,\r\n        description: \"Heal wounds, or resurrect fallen heroes.\",\r\n        tags: [CAMPAIGN_TAG.VILLAGE_ELDER],\r\n        nbTags: 1,\r\n        required: true,\r\n        maxCapacity:1,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.HEAL, value: 99}, {type: BUILDING_EFFECT_TYPE.RESURRECT, value: 1}]\r\n    },\r\n    \"SHOP\": {\r\n        name: \"Vilage Goods\",\r\n        type: BUILDING_TYPE.SHOP,\r\n        description: \"Basic goods and supplies.\",\r\n        tags: [TAG.TOOLS],\r\n        addFriendlyTags: true,\r\n        nbTags:3,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.REPLENISH_TOOLS, value: 99}]\r\n    },\r\n    \"SPECIAL_SHOP\": {\r\n        name: \"Adventuring Goods\",\r\n        type: BUILDING_TYPE.SHOP,\r\n        description: \"Replenish tools and talk with townsfolk.\",\r\n        tags: [TAG.ARMOR, TAG.WEAPONS],\r\n        effects: [{type: BUILDING_EFFECT_TYPE.REPLENISH_TOOLS, value: 99}],\r\n        allowMagicItems: true,\r\n       \r\n    },\r\n    \"TAVERN\": {\r\n        name: \"Tavern\",\r\n        type: BUILDING_TYPE.TAVERN,\r\n        description: \"Drinks, food, and gossip.\",\r\n        tags: [TAG.FOG, TAG.HUMANS, TAG.HALFLINGS, TAG.BEER],\r\n        addFriendlyTags: true,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.ADD_ENJOYMENT, value: 1}]\r\n    },\r\n    \r\n    \"CONFRONTATION\":{\r\n        name: \"Fog Peril\",\r\n        type: BUILDING_TYPE.CONFRONTATION,\r\n        description: \"Tendrils of fog seem to follow the hero...they are unsettling \",\r\n        tags: [TAG.FOG],\r\n        nbTags: 1,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.ADD_TENSION, value: 10}]\r\n    },\r\n    \"CONFRONTATION2\":{\r\n        name: \"Haggle\",\r\n        type: BUILDING_TYPE.CONFRONTATION,\r\n        description: \"The heroes waste time trying to get a better price...cmon! \",\r\n        tags: [],\r\n        nbTags: 0,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.ADD_TENSION, value: -10}]\r\n    },\r\n    // -- ELVEN TOWN\r\n    \"ELVEN_TEMPLE\": {\r\n        name: \"Grand Temple\",\r\n        type: BUILDING_TYPE.TEMPLE,\r\n        description: \"Heal wounds, or resurrect fallen heroes.\",\r\n        tags: [CAMPAIGN_TAG.ELVEN_PRIEST],\r\n        nbTags: 2,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.HEAL, value: 99}, {type: BUILDING_EFFECT_TYPE.RESURRECT, value: 1}]\r\n    },\r\n    \"ELVEN_SHOP\": {\r\n        name: \"Elven Goods\",\r\n        type: BUILDING_TYPE.SHOP,\r\n        description: \"Normal goods, but pointier.\",\r\n        tags: [TAG.TOOLS],\r\n        addFriendlyTags: true,\r\n        nbTags:3,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.REPLENISH_TOOLS, value: 99}],\r\n        allowMagicItems: true,\r\n    },\r\n    \"MASSAGE\": {\r\n        name: \"Treetop Spa\",\r\n        type: BUILDING_TYPE.TAVERN,\r\n        description: \"Massage, healing, and luxury.\",\r\n        tags: [],\r\n        addFriendlyTags: true,\r\n        nbTags:2,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.REPLENISH_MAGIC, value: 99}, {type: BUILDING_EFFECT_TYPE.ADD_ENJOYMENT, value: 1}, {type: BUILDING_EFFECT_TYPE.HEAL, value: 1}],\r\n       \r\n    },\r\n    \"GATHERING_AREA\": {\r\n        name: \"Suspended Plaza\",\r\n        type: BUILDING_TYPE.MARKETPLACE,\r\n        description: \"Shaded outdoor lounge with magic vendors.\",\r\n        tags: [],\r\n        addFriendlyTags: true,\r\n        allowMagicItems: true,\r\n        nbTags:2,\r\n        effects: [],\r\n       \r\n    },\r\n    \"NASTY_FALL\": {\r\n        name: \"Nasty Fall\",\r\n        type: BUILDING_TYPE.CONFRONTATION,\r\n        description: \"The treetop bridges are narrow and falls are always a danger...\",\r\n        tags: [TAG.TREES],\r\n        nbTags: 1,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.INJURE, value: 1}]\r\n    },\r\n    \"SLUMS\": {\r\n        name: \"Elven Slums\",\r\n        type: BUILDING_TYPE.CONFRONTATION,\r\n        description: \"The heroes wander into a bad tree...\",\r\n        tags: [TAG.ELVES],\r\n        nbTags: 1,\r\n        effects: [{type: BUILDING_EFFECT_TYPE.ADD_TENSION, value: 10}]\r\n    }\r\n}\r\n\r\nconst LOCATIONS: Record<string, Location> = {\r\n    FAIRLIGHT: {\r\n        name: 'Fairlight Village',\r\n        description: 'A cozy village nestled at the base of the Windy Mountains. Known for it\\'s annual Fairlight Festival and nothing else, this village is mainly just a hangout for peasants, chickens, cows, and the occasional adventurer setting out on a quest into the mountains.',\r\n        icon: 'mm_l_fairlight',\r\n        tags: [TAG.HUMANS, TAG.HALFLINGS, TAG.CHICKENS, TAG.BUILDINGS, TAG.FOG],\r\n        themes: [THEME.TOWN],\r\n    },\r\n    WINDY_MOUNTAIN_PATH: {\r\n        name: 'Up the Windy Mountain',\r\n        description: 'A long and widing path up the Windy Mountains. Beginning in the small village of Fairlight, the path leads up the Windy Mountains through dense forest and is known to be dangerous, but also mysterious.',\r\n        icon: 'mm_l_mountain_camp',\r\n        tags: [TAG.TREES, TAG.BOULDERS, TAG.HUNTERS, TAG.ROADS, TAG.FOG],\r\n        themes: [THEME.MOUNTAIN]\r\n    }, \r\n    ELVEN_VILLAGE: {\r\n        name: 'Elven Tree-Village',\r\n        description: 'A beautiful village in and amongst the trees. Rope-bridges share the canopy with the vines and birds as Elves go about their daily business. The only part of the village that stands out is the Temple, a huge tree with ornate doors and windows growing directly from the bark.',\r\n        icon: 'mm_l_elven_town',\r\n        tags: [TAG.TREES, TAG.ELVES, TAG.BUILDINGS, TAG.FOG],\r\n        themes: [THEME.FOREST]\r\n    },\r\n  \r\n    WITCH_CABIN: {\r\n        name: 'Witch\\'s Cabin',\r\n        description: 'A small stone cabin on the side of the mountain in the midst of a dense forest. The cabin is spewing out thick, almost-purple smoke. Inside, a couldron bubbles over a smoky fire, an imp in a cage chatters, and a pentagram inscribed on the floor glows eerily.',\r\n        icon: 'mm_e_cabin',\r\n        tags: [TAG.FOG, TAG.CABIN, TAG.COULDRON, TAG.BOOKS, TAG.MAGIC, TAG.SMOKE],\r\n        themes: [THEME.BUILDING]\r\n    },\r\n\r\n    DWARVEN_TUNNEL: {\r\n        name: 'Tunnel 23',\r\n        description: 'An unassuming door in the side of the mountain leads to a small, but well-constructed corridor which feeds into an impressively huge tunnel with a wide paved road and lined by shops and homes.',\r\n        icon: 'mm_l_tunnel',\r\n        tags: [TAG.FOG, TAG.RUNES, TAG.DWARVES],\r\n        themes: [THEME.DUNGEON]\r\n    },\r\n    SMOKEY_CAVE: {\r\n        name: 'Smokey Cave',\r\n        description: 'A dark and smokey cave. The fog clings to the walls and reaches out with evil tenticles. The ground is littered with bones of recently slain dwarves, and a clicking sound can be heard throught.',\r\n        icon: 'cd_l_underthewell',\r\n        tags: [TAG.FOG, TAG.DWARVES],\r\n        themes: [THEME.CAVE]\r\n    },\r\n}\r\n\r\nconst ENCOUNTERS: Record<string, Encounter> = {\r\n    FAIRLIGHT_FESTIVAL: {\r\n        id: 1,\r\n        name: 'Fairlight Festival', \r\n        description: 'The annual Fairlight Festival in the village of Fairlight is a week-long celebration of the harvest. The Mourning Mountain seems to loom above the town, and some hunters from the mountain have come to take part in the festivities. There are dancing competitions, archery contests, and plenty of drinking. All is not perfect, however, as recently an evil, poisonous fog has been spreading down from the mountain and is now even coming close to the town! The Village Elder, Rose will ask the heroes to assist.',\r\n        icon: 'mm_l_fairlight',\r\n        location: LOCATIONS.FAIRLIGHT,\r\n        tags: [TAG.FESTIVALS, TAG.CURSE, CAMPAIGN_TAG.VILLAGE_ELDER, TAG.GOSSIP],\r\n        branches: [],\r\n        events: \r\n            [ {\r\n                name: 'Farm Country Travel',\r\n                type: ENCOUNTER_EVENT_TYPE.TRAVEL,\r\n                flavorText: 'Chickens? Check. Horses? Check. Corn? Check. Wheat? Chex.',\r\n             }, {\r\n                name: 'Fairlight',\r\n                type: ENCOUNTER_EVENT_TYPE.TOWN,\r\n                flavorText: 'Shop, rest, and gather information in the village of Fairlight .',\r\n            },\r\n          \r\n             {\r\n                name: 'Festival Games',\r\n                type: ENCOUNTER_EVENT_TYPE.CHALLENGE,\r\n                flavorText: 'The festival games are open to all, the heroes can try any number of games.',\r\n                tags: [CAMPAIGN_TAG.DANCING],\r\n                \r\n             },\r\n             {\r\n                name: 'Gossip and Rumors',\r\n                type: ENCOUNTER_EVENT_TYPE.ROLEPLAY,\r\n                flavorText: 'The party can mingle with the townfolk, listen to gossip, and take part in some games.',\r\n            },\r\n            //  GENERIC_ENCOUNTER_EVENTS.PERCEPTION,\r\n           \r\n\r\n          \r\n            {\r\n                name: 'Hidden Treasure',\r\n                type: ENCOUNTER_EVENT_TYPE.PUZZLE,\r\n                flavorText: 'Farmer Neb left behind some clues to a treasure he hid around here...',\r\n                tags: [GEAR.STONECUTTER]\r\n            },\r\n        ],\r\n       \r\n        town: [\r\n            {\r\n                buildings: [CAMPAIGN_BUILDINGS.ELDERS_HOME, CAMPAIGN_BUILDINGS.SHOP, CAMPAIGN_BUILDINGS.SPECIAL_SHOP, CAMPAIGN_BUILDINGS.TAVERN, CAMPAIGN_BUILDINGS.CONFRONTATION, CAMPAIGN_BUILDINGS.CONFRONTATION2],\r\n                nbBuildings: [4, 5]\r\n            }\r\n        ],\r\n        challenge: [\r\n            {\r\n                name: 'Fairlight Light Feet',\r\n                description: 'The players take part in a dancing competition.',\r\n                successText: 'The players win the dancing competition!',\r\n                skillThresholds: { combat: 5, magic: 7, gear: 7 },\r\n                revealTag: TAG.FESTIVALS,\r\n                generateRandomAssistTags: false,\r\n                assistTags: [TAG.HALFLINGS, TAG.HUMANS, TAG.BEER, TAG.WINE, TAG.TABLES],\r\n            }\r\n        ],\r\n      \r\n    },\r\n    UP_THE_MOUNTAIN: {\r\n        id: 2,\r\n        name: 'Mountain Path',\r\n        description: 'blah blah, fog. hunters',\r\n        icon: 'mm_e_up_the_mountain',\r\n        location: LOCATIONS.WINDY_MOUNTAIN_PATH,\r\n        tags: [TAG.CAMP, TAG.DEER, TAG.BEARS],\r\n        branches: [],\r\n        events: [\r\n            {\r\n                name: 'Hunter Chatterers',\r\n                type: ENCOUNTER_EVENT_TYPE.ROLEPLAY,\r\n                flavorText: 'The party chats with some hunters and share a meal at their camp.',\r\n             },\r\n           \r\n\r\n            GENERIC_ENCOUNTER_EVENTS.PERCEPTION,\r\n            {\r\n                name: 'Deerfight',\r\n                type: ENCOUNTER_EVENT_TYPE.COMBAT,\r\n                flavorText: 'Some deer step out of the fog...but they seem somehow evil. They attack the party!',\r\n            },\r\n            {\r\n                name: 'Bearfight',\r\n                type: ENCOUNTER_EVENT_TYPE.COMBAT,\r\n                flavorText: 'A huge ugly bear with fog streaming from it\\'s head rears up!',\r\n            },\r\n            {\r\n                name: 'Up up up the road',\r\n                type: ENCOUNTER_EVENT_TYPE.TRAVEL,\r\n                flavorText: 'The way up the road is long.',\r\n            }\r\n        ],\r\n        combat: [\r\n            {\r\n                name: 'Deerfighter',\r\n                description: 'Deerscription',\r\n                enemy: TAG.DEER,\r\n                nbEnemies: 2,\r\n            }, {\r\n                name: 'Bearfighter',\r\n                description: 'Bearrrrrscription',\r\n                enemy: TAG.BEAR,\r\n                nbEnemies: 1,\r\n            },\r\n        \r\n        \r\n        ]\r\n    },\r\n    POINTED_CONVERSATIONS: {\r\n        id: 3,\r\n        name: 'Pointed Conversations',\r\n        description: 'blah blah, fog. elves',\r\n        icon: 'mm_e_pointed',\r\n        location: LOCATIONS.ELVEN_VILLAGE,\r\n        tags: [TAG.TOWER, CAMPAIGN_TAG.ELVEN_PRIEST, TAG.WINE], \r\n        branches: [],\r\n        events: \r\n        [{\r\n            name: 'Treetop Town',\r\n            type: ENCOUNTER_EVENT_TYPE.TOWN,\r\n            flavorText: 'The party corners a scared cultist and demands some information....',\r\n        },\r\n        \r\n         {\r\n            name: 'Wine Competition',\r\n            type: ENCOUNTER_EVENT_TYPE.CHALLENGE,\r\n            flavorText: 'Elven wine is some of the winey-est wine. The party can try to win a wine competition.',\r\n            tags: [TAG.WINE, TAG.ELVES]\r\n         },\r\n         { \r\n            name: 'Priest Chat',\r\n            type: ENCOUNTER_EVENT_TYPE.ROLEPLAY,\r\n            flavorText: 'The party has a conversation with the Elven Priest.',\r\n            \r\n        },\r\n        GENERIC_ENCOUNTER_EVENTS.PERCEPTION,\r\n    ],\r\n        town: [\r\n            {\r\n                buildings: [CAMPAIGN_BUILDINGS.ELVEN_TEMPLE, CAMPAIGN_BUILDINGS.ELVEN_SHOP, CAMPAIGN_BUILDINGS.MASSAGE, CAMPAIGN_BUILDINGS.GATHERING_AREA, CAMPAIGN_BUILDINGS.NASTY_FALL, CAMPAIGN_BUILDINGS.SLUMS],\r\n                nbBuildings: [4, 5]\r\n            }\r\n    ],\r\n\r\n},\r\n    BELL_SMOKE: {\r\n        id: 4,\r\n        name: 'Bells and Smoke',\r\n        description: 'As the players approach the Witch\\'s Cabin, they will notice that the fog appears to avoid a species of tree growing near the cabin. The owner of the cabin, Fred Witch, is a friendly and relaxed gnome with a traditional red hat and a green thumb. He is proud of his garden and is happy to chat about the fog. He will lead the party to the Dwarven Tunnel if they ask. There is a bell inside the cabin which he seems completely unaware of but which is making a regular deep ringing. Each time it tolls, the characters will become confused. Kevin may ask the party to help with a _____ PUZZLE OF SOME KIND.',\r\n        icon: 'mm_l_witch',\r\n        location: LOCATIONS.WITCH_CABIN,\r\n        tags: [TAG.TREES, TAG.BELL, TAG.SMOKE], \r\n        branches: [],\r\n        events: \r\n        [\r\n         {\r\n            name: 'Approach the Bell',\r\n            type: ENCOUNTER_EVENT_TYPE.CHALLENGE,\r\n            flavorText: 'Disable, or silence the bell to clear your head.',\r\n            tags: [TAG.MAGIC, TAG.BELL, TAG.ROPE]\r\n         },\r\n         { \r\n            name: 'Kevin Witch',\r\n            type: ENCOUNTER_EVENT_TYPE.ROLEPLAY,\r\n            flavorText: '\"The Witch\" is Kevin Witch, a gardener-gnome',\r\n        },\r\n        { \r\n            name: 'Cabin Snares',\r\n            type: ENCOUNTER_EVENT_TYPE.TRAP,\r\n            flavorText: 'The area around the cabin is full of traps.',\r\n            \r\n        },\r\n        { \r\n            name: 'Witch book is witch?',\r\n            type: ENCOUNTER_EVENT_TYPE.PUZZLE,\r\n            flavorText: 'Kevin asks for a hand with something...',\r\n            \r\n        },\r\n        GENERIC_ENCOUNTER_EVENTS.PERCEPTION,\r\n    ],\r\n },\r\n TUNNEL_23: {\r\n    id: 5,\r\n    name: 'Dwarven Tunnel',\r\n    description: 'The entrance to the Dwarven Tunnel lies along a path up the mountain into a cleft in the rock and then deep into the mountain itself. The entrance is lined with statues and traps. It appears to be recently abandoned and no signs of life can be seen. The fog appears to billow out from deep within the mountain. This clearly leads to it\\'s source.',\r\n    icon: 'mm_e_dwarves',\r\n    location: LOCATIONS.DWARVEN_TUNNEL,\r\n    tags: [TAG.TRAPS, TAG.STATUES, TAG.MYSTERY], \r\n    branches: [],\r\n    events: \r\n    [\r\n    \r\n     {\r\n        name: 'Trap1',\r\n        type: ENCOUNTER_EVENT_TYPE.TRAP,\r\n        flavorText: 'trap1.',\r\n     },\r\n     {\r\n        name: 'Trap2',\r\n        type: ENCOUNTER_EVENT_TYPE.TRAP,\r\n        flavorText: 'trap2.',\r\n     },\r\n      GENERIC_ENCOUNTER_EVENTS.PERCEPTION,\r\n      {\r\n        name: 'Skill Challenge',\r\n        type: ENCOUNTER_EVENT_TYPE.CHALLENGE,\r\n        flavorText: '',\r\n       // tags: [TAG.MAGIC, TAG.BOOKS]\r\n     },\r\n],\r\n\r\n},\r\nSMOKEY: {\r\n    id: 6,\r\n    name: 'Source of Evil',\r\n    description: 'blah blah, fog. Crabs',\r\n    icon: 'cd_l_underthewell',\r\n    location: LOCATIONS.SMOKEY_CAVE,\r\n    tags: [TAG.MONSTERS, TAG.CLICKING, TAG.EVIL], \r\n    branches: [],\r\n    events: \r\n    [\r\n    \r\n     {\r\n        name: 'Finale',\r\n        type: ENCOUNTER_EVENT_TYPE.FINALE,\r\n        flavorText: 'Finale.',\r\n     },\r\n    \r\n],\r\n\r\n}\r\n};\r\n\r\n\r\n// TOWN\r\nENCOUNTERS.FAIRLIGHT_FESTIVAL.branches.push(ENCOUNTERS.UP_THE_MOUNTAIN);\r\n//MOUNTAIN\r\nENCOUNTERS.UP_THE_MOUNTAIN.branches.push(ENCOUNTERS.POINTED_CONVERSATIONS);\r\nENCOUNTERS.UP_THE_MOUNTAIN.branches.push(ENCOUNTERS.BELL_SMOKE);\r\n// ELF TOWN\r\nENCOUNTERS.POINTED_CONVERSATIONS.branches.push(ENCOUNTERS.TUNNEL_23); \r\nENCOUNTERS.BELL_SMOKE.branches.push(ENCOUNTERS.TUNNEL_23); \r\n//WITCH CABIN\r\nENCOUNTERS.TUNNEL_23.branches.push(ENCOUNTERS.SMOKEY); \r\n\r\n\r\n\r\n\r\nconst processedEncounters =  \r\n    [\r\n        [ENCOUNTERS.FAIRLIGHT_FESTIVAL],\r\n        [ENCOUNTERS.UP_THE_MOUNTAIN],\r\n        [ENCOUNTERS.POINTED_CONVERSATIONS, ENCOUNTERS.BELL_SMOKE],\r\n        [ENCOUNTERS.TUNNEL_23],\r\n        [ENCOUNTERS.SMOKEY]\r\n ];\r\n\r\nexport const mountainMystery: Campaign = {\r\n    name: 'Dragonsbreath Quest',\r\n    id: 623,\r\n    description: 'blah blah fog',\r\n    icon: 'missing_icon',\r\n    startingEncounter: ENCOUNTERS.FAIRLIGHT_FESTIVAL,\r\n    finaleEncounter: ENCOUNTERS.BELL_SMOKE,\r\n    theme: 'dark',\r\n    nbCharacters: [2, 4],\r\n    nbSessions: [2, 3],\r\n    encounters: Object.values(ENCOUNTERS),\r\n    processedEncounters: processedEncounters,\r\n    plotHooks: [\r\n        'PLOT HOOK FLAVOR TEXT 1',\r\n        'PLOT HOOK FLAVOR TEXT 2',\r\n        'PLOT HOOK FLAVOR TEXT 3',\r\n        'PLOT HOOK FLAVOR TEXT 4',\r\n    ],\r\n    tooltipTags: {\r\n        [ENCOUNTERS.FAIRLIGHT_FESTIVAL.name]: {\r\n            [CAMPAIGN_TAG.VILLAGE_ELDER.name]: \"the village elder appears to be waiting to speak with the party\",\r\n            [TAG.HUMANS.name]: 'describe the humans in the village',\r\n            [TAG.HALFLINGS.name]: 'mention the halflings',\r\n            [TAG.FOG.name]: 'Talk about the fog!',\r\n            [TAG.CHICKENS.name]: 'go into great detail about some chichens',\r\n            [TAG.BUILDINGS.name]: 'describe the village huts',\r\n            [TAG.FESTIVALS.name]: 'Bring up the festival',\r\n            [TAG.DEER.name]: 'bring up the deer in the forest',\r\n            [TAG.BEARS.name]: 'bring up the story about the bear...',\r\n            [TAG.CAMP.name]: 'mention the hunter\\'s camp',\r\n            [TAG.HUNTERS.name]: 'Bring up the hunters',\r\n            [TAG.CURSE.name]: 'mention the curse...',\r\n            [TAG.GOSSIP.name]: 'the party wants to listen in on some gossip',\r\n\r\n        },\r\n        [ENCOUNTERS.UP_THE_MOUNTAIN.name]: {\r\n         \r\n            [TAG.HUNTERS.name]: 'See what the hunters have to say...',\r\n            [TAG.FOG.name]: 'Maybe the players are curious about the fog?\"',\r\n          \r\n            \r\n            [TAG.DEER.name]: 'Describe the creepy weirdo horrible deer',\r\n            [TAG.BEARS.name]: 'The players ask about the Bear that might be on the mountain...',\r\n            [TAG.CAMP.name]: 'Bring up the hunters camp...',\r\n            [TAG.HUNTERS.name]: 'Focus on one specific hunter...',\r\n      \r\n            [TAG.BOULDERS.name]: 'Talk about the boulders',\r\n            [TAG.ROADS.name]: 'Describe the road...',\r\n            [TAG.TREES.name]: 'It\\'s a forest after all....but there is something to be mentioned about the trees...',\r\n\r\n            [TAG.TOWER.name]: 'Talk about the tower in the distance...',\r\n            [CAMPAIGN_TAG.ELVEN_PRIEST.name]: 'Reference the priest that was recently in the area...',\r\n            [TAG.WINE.name]: 'everyone loves chatting about wine',\r\n\r\n            [TAG.BELL.name]: 'Describe the bell which keeps ringing in the distance...',\r\n            [TAG.SMOKE.name]: 'there is a lot of smoke that appears distinct from the fog...',\r\n      \r\n            },\r\n        [ENCOUNTERS.BELL_SMOKE.name]: {\r\n            [TAG.FOG.name]: '...of course we need to bring up the fog...',\r\n            [TAG.BELL.name]: 'Describe the Bell',\r\n            [TAG.SMOKE.name]: 'Talk about the smoke',\r\n            [TAG.CABIN.name]: 'Give details about the cabin',\r\n            [TAG.COULDRON.name]:'Bring up the couldron',\r\n            [TAG.BOOKS.name]:'Describe the bookshelf',\r\n            [TAG.MAGIC.name]: 'Magic is evident everywhere...',\r\n            [TAG.TREES.name]: 'The trees are different here...',\r\n        },\r\n        [ENCOUNTERS.POINTED_CONVERSATIONS.name]: {\r\n            [TAG.TOWER.name]: \"Describe the Elven Temple's Spire\",\r\n            [CAMPAIGN_TAG.ELVEN_PRIEST.name]: \"Remind the Players about the Elven Priest...\",\r\n            [TAG.WINE.name]: \"perhaps the players are cusrious about the wine?\",\r\n            [TAG.TREES.name]: \"talk about the trees\",\r\n            [TAG.ELVES.name]: \"describe some basic elves in the village\",\r\n            [TAG.BUILDINGS.name]: \"bring up how the buildings are trees\",\r\n            [TAG.FOG.name]: \"continue to remind about the whole fog sitch\",\r\n        },\r\n        // NO ROLEPLAY EVENT - THIS MAY NOT BE NEEDED UNLESS SOMETHING ELSE WANTS TOOLTIPS....\r\n        // [ENCOUNTERS.TUNNEL_23.name]: {\r\n        //     [TAG.TRAPS.name]: \"\",\r\n        //     [TAG.DWARVES.name]: \"\",\r\n        //     [TAG.MYSTERY.name]: \"\",\r\n        //     [TAG.FOG.name]: \"\",\r\n        //     [TAG.STATUES.name]: \"\",\r\n            \r\n        // },\r\n        [ENCOUNTERS.SMOKEY.name]: {\r\n            [TAG.MONSTERS.name]: \"\",\r\n            [TAG.CLICKING.name]: \"\",\r\n            [TAG.EVIL.name]: \"\",\r\n            [TAG.FOG.name]: \"\",\r\n            [TAG.DWARVES.name]: \"\",\r\n            [TAG.FOG.name]: \"\",\r\n            [TAG.DWARVES.name]: \"\",\r\n        },\r\n\r\n\r\n    },\r\n\r\n    chatTriggers: {\r\n        [ENCOUNTERS.FAIRLIGHT_FESTIVAL.name]: {\r\n            [CAMPAIGN_TAG.VILLAGE_ELDER.name]: [{\r\n                message: 'The Village Elder is waiting to speak with the party...',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: 'Let\\'s not keep her waiting!',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 0\r\n                }},\r\n                {\r\n                    message: 'She asks the party to investigate the fog and its source in the mountains. It will require journeying up the mountain...',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }\r\n                }, {\r\n                    message: 'Sounds like we have an adventure on our hands!',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 1\r\n                }},\r\n            ],\r\n            [TAG.FESTIVALS.name]: [{\r\n                message: 'The Fairlight Festival is a day-long celebration of the village\\'s harvest season.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: 'Isn\\'t this place being attacked by demon fog or someting? Are they really celebrating still?',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 0\r\n                }},\r\n                {\r\n                    message: 'Despite the fog, the Village Elder - Elder Rose, has decided to go ahead with the festival. You hear she wants to speak with the party.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }\r\n                }\r\n            ],\r\n\r\n            [TAG.CHICKENS.name]: [{\r\n                message: 'You watch as a chicken scratches around in the dirt. Nearby a tentacle of fog stretches out and almost touches it.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: 'Noooo! Chicky!',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.CHARACTER,\r\n                        id: 0\r\n                }},\r\n                {\r\n                    message: 'The chicken is startled by your yell and notices the fog. It runs away',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }\r\n                }\r\n            ],\r\n\r\n            \r\n\r\n\r\n            // this should be a conversations! \r\n             [TAG.CURSE.name]: [{\r\n                message: 'Its just after dark, the party is considering their next move when they are approached by three triplet halfling children walking in lockstep.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},{\r\n                message: 'As one they stop and stare. \"Lift\" \"The\" \"Curse\" They say in turn: \"Set Them Free\" they say in unison.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: 'NOPE.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.CHARACTER,\r\n                        id: 1\r\n                    }\r\n                },{\r\n                    message: '\"Don\\'t mind them!\" you hear an older halfling trots up out of breath and puts his hand on one the girl\\'s shoulders. ',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                }},\r\n                {\r\n                    message: 'Listen here, you halfling freakmonger - they mentioned something about a curse. What\\'s going on?',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.CHARACTER,\r\n                        id: 0\r\n                }},\r\n                {\r\n                    message: '\"Sorry\" The man says, though he looks a but hurt. \"Well...There IS a curse on the vilage. Some spirits are trapped on top of the mountain or something...we dont know all the details.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }\r\n                }\r\n            ],\r\n// Maxim maxke this a conversation\r\n\r\n\r\n\r\n              [TAG.GOSSIP.name]: [{\r\n                message: 'You overhear some farmers gossiping about some elves up the mountain.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},{\r\n                message: 'Elves, hmmm? Interesting.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.CHARACTER,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: 'Not a minute later you hear another piece of mountain-related gossip. This time some halflings mention a witch that lives in a cabin up the mountain.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 1\r\n                    }\r\n                },{\r\n                    message: 'A witch? I KNEW it.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.CHARACTER,\r\n                        id: 1\r\n                }},\r\n                {\r\n                    message: '...',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                }},\r\n                {\r\n                    message: 'Yeah, so elves and witches. Up the ol\\' mountain. Mount Elfwitch.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 2\r\n                    }\r\n                },\r\n                {\r\n                    message: '...',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 2\r\n                    }\r\n                }\r\n            ],\r\n            [TAG.HUMANS.name]: 'The townfolk are mainly humans, but a few halflings live here as well.',\r\n            [TAG.HALFLINGS.name]: 'Making up about a quarter of the town\\'s population, the halflings are well-represented at the festival, particularly the dancing contest.',\r\n            \r\n        \r\n            [TAG.BUILDINGS.name]: 'The village has a few buildings, most prominently the tavern and the bakery. ',\r\n            \r\n            [TAG.DEER.name]: 'Some villagers mention that they saw evil-looking deer up the mountain path.',\r\n            [TAG.BEARS.name]: 'A huge bear has been seen up the mountain. It appears to be hiding in the fog.',\r\n            [TAG.CAMP.name]: 'The party learns of a Hunters Camp up the mountain. It may be a good place to rest and get information about the mountain.',\r\n            [TAG.HUNTERS.name]: 'A hunter is in town for the festival. He invites the party to the camp up the mountain. ',\r\n\r\n            [TAG.ARCHERY.name]: 'Archery is a pretty popular sport in town, so its no surprise that there is an archery ompetition at the fair.',\r\n            [TAG.CRAFTING.name]: 'Basket Weaving, Pottery, and Carving competitions are all part of the festival. ',\r\n            [CAMPAIGN_TAG.DANCING.name]:  'You aren\\'t sure how these things are judged, but it\\'s fun to dance with some of the locals anyways. ',\r\n            [TAG.FOG.name]:  [{\r\n                message: 'The festival is going well. People are laughing, and enjoying the games. Suddenly the games, laughter, and chatter stop as an ear-splitting scream stills the crowd.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: '\"What\\'s happened?!\" I\\'ll shout heorically and run towards the source of the scream and pull my weapon. \"Out of the way, you filthy peasants!\"',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.CHARACTER,\r\n                        id: 0\r\n                }},\r\n                {\r\n                    message: 'The crowd parts for you, though you get some odd looks for your rudeness. Ahead a woman is pulling an unconsious child from a bank of low-hanging fog.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }\r\n                },\r\n                {\r\n                    message: 'As a pair of halflings help the woman take her child away, some of the townsfolk explain that a poisonous fog has recently been seen in the town. Sometimes it almost seems alive.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }\r\n                }\r\n            ]\r\n\r\n        },\r\n        [ENCOUNTERS.UP_THE_MOUNTAIN.name]: {\r\n                //Location\r\n            [TAG.FOG.name]: 'The fog appears to be thicker as you climb the mountain. The tendrils seem more and more dangerous and feel thicker and more substantial. You sometimes see shapes moving in the fog...',\r\n    \r\n            //Encounter\r\n            [TAG.DEER.name]: 'The deer dart in and out out of the fog and even appear to be playing in it. Occasionally though, you see one glaring at you with evil intent...it\\'s only a matter of time before they attack!',\r\n            [TAG.BEARS.name]: 'In the fog you see an enormous shape lumbering towards you. A huge head resolves out of the fog and the bear exhales a long clous of mist. It looks angry...',\r\n            [TAG.CAMP.name]: 'The hunters camp is a well-established mountain base. There are some servicable tents, a firepit, and a few hunters. They are willing to chat but seem to be on edge due to the fog.',\r\n        \r\n            [TAG.HUNTERS.name]: 'You talk with some hunters on the mountain near the camp. They say the Fog has been getting worse and worse. They think it is coming from the mountain itself!',\r\n      \r\n            [TAG.BOULDERS.name]: 'The area is littered with large boulders',\r\n            [TAG.ROADS.name]: 'The mountain road is a well-beaten path but occasionally dwindwles to a narrow trail. You doubt a cart could make it up here.',\r\n            [TAG.TREES.name]: 'The trees and foliage here is thick and green, but some darker...almost \"stickier\" looking species of shrub can be found. The forest to the east appears to contain more and more of these. The hunters say they were planted by \"some Witch\"',\r\n\r\n            [TAG.TOWER.name]: 'A tower can be seen above the trees. The local hunters say it is the spire of a temple from an Elven Village farther up the mountain. They say the village is friendly and a Priest there is known to be wise. Perhaps they will know about this fog',\r\n            [CAMPAIGN_TAG.ELVEN_PRIEST.name]:'The hunters say that there is an Elven Village up the mountain. Some of the fog is coming from that direction...there is a prominane Elven Priest there...perhpas he will have some answers.',\r\n            [TAG.WINE.name]: 'Hunters along the trail share some amazing wine. They say they got it from the Elven Village farther along the path.',\r\n\r\n            [TAG.BELL.name]: 'There has been a bell ringing in the distance for a while now. The party finally determines that the direction is coming from the same direction as a Witch\\'s Cabin that the hunters mentioned...',\r\n            [TAG.SMOKE.name]: 'Mixed with the fog is a thick, almost purple smoke. It appears to have similar poperties to the fog and its curling tenticles seem to beckon the party in a certain direction...',\r\n\r\n        },\r\n\r\n        // WITCH CABIN -------------------------------------------------------------------------------------\r\n\r\n        [ENCOUNTERS.BELL_SMOKE.name]: {\r\n          \r\n            [TAG.FOG.name]: 'The fog appears to be much thinner as you approach the cabin. However, instead of the fog, the air here is thick with smoke coming from the cabin..',\r\n            [TAG.BELL.name]:\r\n\r\n            [{\r\n                message:  'There is a large bell hanging from a thick purple rope. It\\'s ringing regularly and makes you feel odd for a moment each time it tolls.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: 'What is causing it to ring?',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 6\r\n                }},\r\n                {\r\n                    message: 'And what do you mean \"odd\"?',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 1\r\n                    }\r\n                },\r\n                {\r\n                    message: 'It\\'s not clear what is causing the bell to ring, it is likely magical. Every time it rings it makes your head foggy for a moment. The effect gets worse the closer you get.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                }},\r\n                {\r\n                    message: 'Dungggggg... Dunggggg... Dungggggg...',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.CHARACTER,\r\n                        id: 2\r\n                    }},\r\n            ],\r\n\r\n\r\n            [TAG.SMOKE.name]: 'As you approach the cabin it is impossible to miss the smoke. It is pouring from the chimney of the cabin, but insteads of rising into the air it seems to spill out of the chimney and cascades to the ground where it sits in smoky clumps',\r\n            [TAG.CABIN.name]: 'The cabin is made of stone and sits on the side of the mountain. Thick purplish smoke pours from the chimney. It\\'s not clearly occupied...',\r\n            [TAG.COULDRON.name]:'A bubbling couldron sits in the center of the cabin. A large bell-like hood covers it and seems to direct the smoke to the chinmey stack.',\r\n            [TAG.BOOKS.name]:'An ornate bookshelf sits on one wall, a glass door covers the shelves. A strange locking mechanism is evident on the door.',\r\n            [TAG.MAGIC.name]: 'Everything about this area has at least a subtle hint of magic. Some things more than others...',\r\n            [TAG.TREES.name]:   [{\r\n                message: 'The trees around the cabin nestled here in the mountain give way to what appear to be cultivated shrubs. They give off a slight not-unpleasant odor - and the fog appears to avoid them.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: '...I\\'ll collect a few of them. They may come in handy later.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.CHARACTER,\r\n                        id: 0\r\n                }}\r\n            ]\r\n        \r\n          \r\n        \r\n        },\r\n\r\n        // POINTED CONVERSATIONS ------------------------------------------------------------------------\r\n\r\n        [ ENCOUNTERS.POINTED_CONVERSATIONS.name]: {\r\n            [CAMPAIGN_TAG.ELVEN_PRIEST.name]: [{\r\n                message: 'You speak with the Elven Priest. He says that the fog arrived at the same time that he began to sense a great evil presense deep within the mountain. ',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: 'Is he about to blame the dwarves? I bet he is. That seems a little...',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.CHARACTER,\r\n                        id: 0\r\n                }},\r\n                {\r\n                    message: 'cliche?',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 1\r\n                    }\r\n                },\r\n                {\r\n                    message: '..racist',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.CHARACTER,\r\n                        id: 0\r\n                }},\r\n                {\r\n                    message: 'The elven priest ignores your rudeness and continues to explain that while the Dwarves are probably not personally involved, they have a tunnel nearby that may lead the heroes to the source of this evil and fog.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }},\r\n            ],\r\n            [TAG.TOWER.name]: 'The Grand Temple\\'s Tower is a glittering spire rising high above the trees. The Elven Priest has been informed of the party\\'s arrival, and has asked to chat. He has a stern demeanor, and an odd lisp which makes him hard to understand.',\r\n            [TAG.WINE.name]:'You have arrived just at the time of year for the Elven Wine Festival. They invite you to partake and maybe even help judge the competition?',\r\n            [TAG.TREES.name]: 'The trees in this part of the mountain grow tall and wide along a deep ravine. The trees act as vertical homes and temples for the Elves, with winding rope bridges leading high up into the boughs.',\r\n            [TAG.ELVES.name]: 'The Elves rarely see outsiders and they are firendly - if perhaps over-curious about the party. Elves of all ages and persuasions can be seen among the trees, doing Elvish stuff.',\r\n            [TAG.BUILDINGS.name]:  [{\r\n                message: 'The Elves use the trees as their \"buildings\" and mostly live high above the forest floor.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: 'Notable structures include the Grand Temple, and a beautiful plaza suspended high in the trees that looks ideal for a rest...',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }},\r\n                {\r\n                    message: '...what do they use for bathrooms up there? Do they have \"treetop treepotties\"? ',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 0\r\n                }},{\r\n                    message: '...',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }}],\r\n            [TAG.FOG.name]: 'Even in the Elven Village the fog is present, but lies close to the ground and so the Elves don\\'t seem much bothered by it. Those who venture onto the ground seem to have holy-charms which ward it off...',\r\n            [TAG.MYSTERY.name]: [{\r\n                message: '',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 1\r\n                }},\r\n                {\r\n                    message: 'Well too bad. There aren\\'t any Dwarves here in this Dwarven tunnel.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }},\r\n                {\r\n                    message: 'Haha. Oh you are serious. No Dwarves? Well... why not?! What happened to the Dwarves?',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 0\r\n                }},{\r\n                    message: 'It\\'s not clear. The homes lining the tunnel appear to be abandoned, but valuables and goods are clearly visible in shops and forges.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }}],\r\n        },\r\n        [ENCOUNTERS.TUNNEL_23.name]: {\r\n            [TAG.TRAPS.name]: \"The road leading into the tunnel is paved with large stones and lined with statues. As one of you steps forward, a stone depresses slightly and a large axe swings from the wall. Runes on statues glow menacingly. It is clear there are traps around...\",\r\n            [TAG.DWARVES.name]: \"Though the tunnel is lined with shops, forges, and Dwarf-Sized homes, there are no Dwarves to be seen. The tunnel appears to be abandoned.\",\r\n            [TAG.MYSTERY.name]: [{\r\n                message: 'I\\'m looking forward to talking with some Dwarves.',\r\n                speaker: {\r\n                    type: CHAT_TYPE.CHARACTER,\r\n                    id: 1\r\n                }},\r\n                {\r\n                    message: 'Well too bad. There aren\\'t any Dwarves here in this Dwarven tunnel.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }},\r\n                {\r\n                    message: 'Haha. Oh you are serious. No Dwarves? Well... why not?! What happened to the Dwarves?',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 0\r\n                }},{\r\n                    message: 'It\\'s not clear. The homes lining the tunnel appear to be abandoned, but valuables and goods are clearly visible in shops and forges.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                    }}],\r\n            [TAG.FOG.name]: \"The fog trails in a clear stream from farther along the tunnel. It's clearly coming from inside the mountain via whatever is deeper along the tunnel. You must cover your mouths to keep from breathing it in.\",\r\n            [TAG.STATUES.name]: \"The boulevard, tunnel, road...whatever you want to call it is lined with tall statues of Dwarven Heroes. Indecipherable Runes can be seen on the base of each statue, although something tells you that you shouldn't get too close...\",\r\n            [TAG.RUNES.name]: [{\r\n                message: 'The runes on the statues glow faintly as you approach. They a-',\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: 'I poke one with a stick!',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 2\r\n                }},\r\n                {\r\n                    message: 'Stop it! No we dont do anything...',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 1\r\n                    }},\r\n                    {\r\n                        message: 'Ok fine. I cautiously approach it...holding a stick still but ready to poke',\r\n                        speaker: {\r\n                            type: CHAT_TYPE.PLAYER,\r\n                            id: 2\r\n                    }},\r\n                    {\r\n                        message: 'The runes glow as you approach. If you had to guess, they list the names and titles of the Dwarves on the statues. However, as you lean in to examine one closer there is a mechanical click and the statues axe swings down swiftly. You narrowly avoid being split in twain!',\r\n                        speaker: {\r\n                            type: CHAT_TYPE.DM,\r\n                            id: 0\r\n                        }}\r\n                ],\r\n            [TAG.EVIL.name]: \r\n            [{\r\n                message: \"The door to a large meeting-hall is open and you can see a large map on the wall inside...\",\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: 'Let\\'s go in. I\\'m going in.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 2\r\n                }},\r\n                {\r\n                    message: 'In Character please...',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                }},\r\n                {\r\n                    message: 'What have we here then? Some sort of ye-olde mappe? Let us hither to better espy it-',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.CHARACTER,\r\n                        id: 2\r\n                }},\r\n                {\r\n                    message: 'Better. You enter the hall cautiously, but it is clearly not occupied or trapped. The map on the wall appears to be a map of the tunnels just ahead in the mountain. One branch near the entrance has a large black X and a word newly-scribbled in coal: EVIL! ',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                }}\r\n            ],\r\n            [TAG.CLICKING.name]: \"There's a moment in when the wind in the tunnel dies down and there is a period of relative silence. Thats when you hear it. From somewhere deep ahead in the dark tunnel...a rhythmic clicking sound! Click! Cli-Click!\",\r\n            [TAG.MONSTERS.name]:  [{\r\n                message: \"You see a dead dwarf lying slumped with his back to a fountain...\",// ,\",\r\n                speaker: {\r\n                    type: CHAT_TYPE.DM,\r\n                    id: 0\r\n                }},\r\n                {\r\n                    message: 'Ew',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.PLAYER,\r\n                        id: 0\r\n                }},\r\n                {\r\n                    message: '...as you approach-',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0,\r\n                       \r\n                },      \r\n                },\r\n                {\r\n                    message: 'WHY WOULD WE APPROACH?! ... Ok sorry. We approach him. Go on. Sorry.',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.CHARACTER,\r\n                        id: 2\r\n                }},\r\n                {\r\n                    message: 'As you approach, you realize that he is still alive - but barely. He weakly lifts his head when you approach and beckons you over with a nod. With a shaky hand he points down the tunnel and whispers... \"MONSTERS!\"',\r\n                    speaker: {\r\n                        type: CHAT_TYPE.DM,\r\n                        id: 0\r\n                }}\r\n            ],\r\n            \r\n            \r\n            \r\n            \r\n           \r\n        },\r\n        [ENCOUNTERS.SMOKEY.name]: {\r\n            [TAG.MONSTERS.name]: \"\",\r\n            [TAG.CLICKING.name]: \"\",\r\n            [TAG.EVIL.name]: \"\",\r\n            [TAG.FOG.name]: \"\",\r\n            [TAG.DWARVES.name]: \"\",\r\n         \r\n        },\r\n    },\r\n//    campaignRewards: [CAMPAIGN_REWARD.QUEST,CAMPAIGN_REWARD.QUEST,CAMPAIGN_REWARD.QUEST,CAMPAIGN_REWARD.QUEST,CAMPAIGN_REWARD.QUEST,CAMPAIGN_REWARD.QUEST,CAMPAIGN_REWARD.QUEST,CAMPAIGN_REWARD.QUEST,CAMPAIGN_REWARD.QUEST,CAMPAIGN_REWARD.QUEST,CAMPAIGN_REWARD.QUEST,CAMPAIGN_REWARD.QUEST]\r\n}\r\n  \r\n//  [CAMPAIGN_TAG.ELVEN_PRIEST.name]: 'The Elven Priest is waiting to speak with the party...',","import { Campaign } from \"../models\";\r\nimport { cultOfTheDeep } from \"./campaigns/cultOfTheDeep\";\r\nimport { millstoneMystery } from \"./campaigns/millstoneMystery\";\r\nimport { mountainMystery } from \"./campaigns/mountainMystery\";\r\n\r\nexport const CAMPAIGNS: Campaign[] = [\r\n    mountainMystery,\r\n    cultOfTheDeep,\r\n    millstoneMystery,\r\n  \r\n]; \r\n\r\nexport const NB_EXPECTED_ENCOUNTER_TAGS = 4;","import React from 'react';\r\nimport './DiceScore.scss';\r\nimport CImage from './cimage';\r\n\r\ninterface DiceScoreProps {\r\n  score: number;\r\n  direction?: 'row' | 'column';\r\n  className?: string;\r\n}\r\n\r\ninterface DiceRepresentation {\r\n  type: 'd4' | 'd6' | 'd20';\r\n  count?: number; // For d20s, this represents the multiplier shown in the center\r\n}\r\n\r\nconst DiceScore: React.FC<DiceScoreProps> = ({ \r\n  score, \r\n  direction = 'row',\r\n  className = '' \r\n}) => {\r\n  \r\n  const calculateDiceRepresentation = (totalScore: number): DiceRepresentation[] => {\r\n    if (totalScore <= 0) return [];\r\n    \r\n    const dice: DiceRepresentation[] = [];\r\n    let remaining = totalScore;\r\n    \r\n    // Handle d20s first (scores of 24+)\r\n    if (remaining >= 24) {\r\n      const d20Count = Math.floor(remaining / 24);\r\n      dice.push({ type: 'd20', count: d20Count });\r\n      remaining = remaining % 24;\r\n    }\r\n    \r\n    // Handle d6s (scores of 4-23, or remaining after d20s)\r\n    if (remaining >= 4) {\r\n      const d6Count = Math.floor(remaining / 4);\r\n      for (let i = 0; i < d6Count; i++) {\r\n        dice.push({ type: 'd6' });\r\n      }\r\n      remaining = remaining % 4;\r\n    }\r\n    \r\n    // Handle d4s (scores of 1-3, or remaining after d6s)\r\n    if (remaining > 0) {\r\n      for (let i = 0; i < remaining; i++) {\r\n        dice.push({ type: 'd4' });\r\n      }\r\n    }\r\n    \r\n    return dice;\r\n  };\r\n\r\n  const renderDie = (die: DiceRepresentation, index: number) => {\r\n    const baseClass = `dice-icon dice-${die.type}`;\r\n    \r\n    return (\r\n      <div \r\n        key={`${die.type}-${index}`} \r\n        className={baseClass}\r\n        style={{\r\n          zIndex: die.type === 'd20' ? 10 : 5 - index // d20s on top, then reverse order for overlap\r\n        }}\r\n      >\r\n        {/* Placeholder icons - these would be replaced with actual SVG icons */}\r\n        {die.type === 'd4' && (\r\n          <CImage imageId=\"die_d4\"/>\r\n        )}\r\n        {die.type === 'd6' && (\r\n           <CImage imageId=\"die_d6\"/>\r\n        )}        {die.type === 'd20' && (\r\n          <div className=\"d20-container\">\r\n            <CImage imageId=\"die_d20\"/>\r\n            {die.count && die.count > 1 && (\r\n              <span className=\"d20-number\">{die.count}</span>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const dice = calculateDiceRepresentation(score);\r\n  \r\n  if (dice.length === 0) {\r\n    return <div className={`dice-score empty ${className}`}>-</div>;\r\n  }\r\n\r\n  return (\r\n    <div className={`dice-score ${direction} ${className}`}>\r\n      {dice.map((die, index) => renderDie(die, index))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DiceScore;\r\n","import React from \"react\";\r\nimport { useCampaignManager } from \"../managerContexts\";\r\nimport CImage from \"./cimage\";\r\nimport DiceScore from \"./DiceScore\";\r\n\r\ninterface CampaignHeaderProps {\r\n  encounterScore: number;\r\n  campaignScore: number;\r\n  onClick?: () => void;\r\n  className?: string;\r\n}\r\n\r\nconst CampaignHeader: React.FC<CampaignHeaderProps> = ({\r\n  encounterScore,\r\n  campaignScore,\r\n  onClick,\r\n  className = \"\"\r\n}) => {\r\n  const campaignManager = useCampaignManager();\r\n\r\n  return (\r\n    <div className={`campaign-header ${className}`} >\r\n      <div className=\"campaign-header-dm-points\">\r\n        <div className=\"campaign-header-dm-points-label\">POTENTIAL SCORE</div>\r\n        <div className=\"campaign-header-dm-point\">\r\n          <DiceScore\r\n            key={encounterScore} // Add a key prop that changes with the score\r\n            score={encounterScore}\r\n          />\r\n        </div>\r\n      </div>\r\n      <div className=\"campaign-header-center-container\" onClick={onClick}>\r\n        <div\r\n          className={`campaign-display ${\r\n            campaignManager.getCurrentCampaign().theme\r\n          } icon-only`}\r\n        >\r\n          <div className={\"campaign-info left\"}>\r\n            <div className=\"campaign-info title\">\r\n              {campaignManager.getCurrentCampaign().name}\r\n            </div>\r\n            <div className=\"campaign-info hooks\">PLOT HOOKS</div>\r\n            <div className=\"circle-display\">\r\n              {Array.from({ length: 4 }, (_, index) => (\r\n                <div\r\n                  key={index}\r\n                  className={`circle ${\r\n                    index < campaignManager.getCampaignProgress()\r\n                      ? \"filled\"\r\n                      : \"\"\r\n                  }`}\r\n                />\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"campaign-icon solo\">\r\n            <CImage imageId={campaignManager.getCurrentCampaign().icon} />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"campaign-header-dm-points\">\r\n        <div className=\"campaign-header-dm-points-label\">CAMPAIGN TOTAL</div>\r\n        <div className=\"campaign-header-dm-point\">\r\n          <DiceScore\r\n            key={campaignScore} // Add a key prop that changes with the score\r\n            score={campaignScore}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CampaignHeader;\r\n","import React, { useEffect, useMemo, useState } from \"react\";\r\nimport \"./notebook.scss\";\r\nimport CImage from \"./cimage\";\r\nimport {\r\n\tuseAppManager,\r\n\tuseCampaignManager,\r\n\tuseUiManager,\r\n} from \"../managerContexts\";\r\nimport FillBar from \"./fillBar\";\r\nimport { CAMPAIGNS, NB_EXPECTED_ENCOUNTER_TAGS } from \"../../consts/campaigns\";\r\nimport UiManager from \"../../managers/uiManager\";\r\nimport MoreInfo from \"./moreInfoButton\";\r\nimport {\r\n\tEncounterEvent,\r\n\tNOTEBOOK_CATEGORY,\r\n\tTag,\r\n\tFlavorTagSource,\r\n\tFlavorTagTheme,\r\n} from \"../../models\";\r\nimport { EventType } from \"@testing-library/react\";\r\nimport { ENCOUNTER_EVENT_TYPE } from \"../../consts/general\";\r\nimport CampaignDisplay from \"../campaignDisplay\";\r\nimport TagPill from \"./TagPill\";\r\nimport FlavorTagPill from \"./FlavorTagPill\";\r\nimport DiceScore from \"./DiceScore\";\r\nimport CampaignHeader from \"./CampaignHeader\";\r\nimport Tooltip from \"./tooltip\";\r\nimport TooltipWrapper from \"./TooltipWrapper\";\r\nimport Cbox from \"./cbox\";\r\n\r\nconst EncounterOverview: React.FC = () => {\r\n\tconst campaignManager = useCampaignManager();\r\n\tconst uiManager = useUiManager();\r\n\tconst appManager = useAppManager();\r\n\tconst tagManager = appManager.getTagManager();\r\n\tconst [encounter, setEncounter] = useState(\r\n\t\tcampaignManager.getCurrentEncounter()\r\n\t);\r\n\tconst [expectedEncounterTags, setExpectedEncounterTags] = useState(\r\n\t\ttagManager.getOutstandingEncounterTags()\r\n\t);\r\n\tconst [establishedEncounterTags, setEstablishedEncounterTags] = useState(\r\n\t\ttagManager.encounterTagsCollected[encounter?.name || \"\"] || []\r\n\t);\r\n\tconst [locationTagsEstablished, setLocationTagsEstablished] = useState(\r\n\t\ttagManager.locationTagsCollected\r\n\t);\r\n\tconst [locationTags, setLocationTags] = useState(\r\n\t\tcampaignManager.getEncounterLocationTags()\r\n\t);\r\n\tconst [completedEvents, setCompletedEvents] = useState(\r\n\t\tcampaignManager.getCompletedEvents()\r\n\t);\r\n\tconst [campaignModalVisible, setCampaignModalVisible] = useState(false);\r\n\r\n\tconst [campaignScore, setCampaignScore] = useState(\r\n\t\tcampaignManager.getCampaignScore()\r\n\t);\r\n\tconst [encounterScore, setEncounterScore] = useState(\r\n\t\tcampaignManager.getEncounterPoints()\r\n\t);\r\n\tconst [remainingSnacks, setRemainingSnacks] = useState(\r\n\t\tcampaignManager.getRemainingSnacks()\r\n\t);\r\n\tconst [remainingBreaks, setRemainingBreaks] = useState(\r\n\t\tcampaignManager.getRemainingBreaks()\r\n\t);\r\n\r\n\tconst setSceneTags = useMemo(\r\n\t\t() => encounter?.location.tags.sort() || [],\r\n\t\t[encounter?.location.tags]\r\n\t);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst updateEncounterState = () => {\r\n\t\t\tsetCompletedEvents(campaignManager.getCompletedEvents());\r\n\t\t\tsetExpectedEncounterTags(campaignManager.getExpectedEncounterTags());\r\n\t\t\tsetEstablishedEncounterTags(\r\n\t\t\t\ttagManager.encounterTagsCollected[encounter?.name || \"\"] || []\r\n\t\t\t);\r\n\t\t\tsetLocationTags(campaignManager.getEncounterLocationTags());\r\n\t\t\tsetLocationTagsEstablished(tagManager.locationTagsCollected);\r\n\t\t\tsetEncounter(campaignManager.getCurrentEncounter());\r\n\t\t\tsetEncounterScore(campaignManager.getEncounterPoints());\r\n\t\t\tsetCampaignScore(campaignManager.getCampaignScore());\r\n\t\t\tsetRemainingSnacks(campaignManager.getRemainingSnacks());\r\n\t\t\tsetRemainingBreaks(campaignManager.getRemainingBreaks());\r\n\t\t};\r\n\r\n\t\tcampaignManager.on(\"encounterUpdated\", updateEncounterState);\r\n\r\n\t\treturn () => {\r\n\t\t\tcampaignManager.off(\"updateEncounterState\", updateEncounterState);\r\n\t\t};\r\n\t}, [encounter, campaignManager, tagManager]);\r\n\r\n\t// Quest event listeners\r\n\tuseEffect(() => {\r\n\t\tconst handleShowQuestTerminal = (data: { quest: any; node: any }) => {\r\n\t\t\tuiManager.showQuestTerminalModal(data.quest, data.node);\r\n\t\t};\r\n\r\n\t\tcampaignManager.on(\"showQuestTerminal\", handleShowQuestTerminal);\r\n\r\n\t\treturn () => {\r\n\t\t\tcampaignManager.off(\"showQuestTerminal\", handleShowQuestTerminal);\r\n\t\t};\r\n\t}, [campaignManager, uiManager]);\r\n\r\n\t// DM Abilities event listeners\r\n\tuseEffect(() => {\r\n\t\tconst updateDMAbilities = () => {\r\n\t\t\tsetRemainingSnacks(campaignManager.getRemainingSnacks());\r\n\t\t\tsetRemainingBreaks(campaignManager.getRemainingBreaks());\r\n\t\t};\r\n\r\n\t\tcampaignManager.on(\"dmAbilitiesUpdated\", updateDMAbilities);\r\n\r\n\t\treturn () => {\r\n\t\t\tcampaignManager.off(\"dmAbilitiesUpdated\", updateDMAbilities);\r\n\t\t};\r\n\t}, [campaignManager]);\r\n\r\n\tconst sortedSetSceneTags = useMemo(() => {\r\n\t\treturn [...setSceneTags].sort((a, b) => a.name.localeCompare(b.name));\r\n\t}, [setSceneTags]);\r\n\r\n\tif (!encounter) {\r\n\t\treturn <div className=\"encounter-overview-container\">No Encounter</div>;\r\n\t}\r\n\tconst uniqueEventTypes = Array.from(\r\n\t\tnew Set(encounter.events.map((event) => event.type))\r\n\t);\r\n\tconst currentLocationTheme = encounter.location.themes[0];\r\n\r\n\t// Get the preferred event index (first unactivated event)\r\n\tconst getPreferredEventIndex = (): number => {\r\n\t\tfor (let i = 0; i < encounter.events.length; i++) {\r\n\t\t\tif (!completedEvents.includes(i)) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1; // All events completed\r\n\t};\r\n\r\n\tconst preferredEventIndex = getPreferredEventIndex();\r\n\r\n\t// const combinedTags = campaignManager.getTagsForEncounter(encounter);\r\n\t//const encounterBranches = encounter.branches;\r\n\r\n\tconst clickEvent = (index: number, isPreferred: boolean) => {\r\n\t\tcampaignManager.encounterEventSelected(index);\r\n\t\tcompletedEvents.push(index);\r\n\t\tif (isPreferred) {\r\n\t\t\tcampaignManager.addEncounterPoints(1);\r\n\t\t}\r\n\t\tsetCompletedEvents([...completedEvents]);\r\n\t};\r\n\r\n\tconst getEventDescription = (eventType: ENCOUNTER_EVENT_TYPE) => {\r\n\t\tswitch (eventType) {\r\n\t\t\tcase ENCOUNTER_EVENT_TYPE.COMBAT:\r\n\t\t\t\treturn \"Combat\";\r\n\r\n\t\t\tcase ENCOUNTER_EVENT_TYPE.ROLEPLAY:\r\n\t\t\t\treturn \"Roleplaying\";\r\n\r\n\t\t\tcase ENCOUNTER_EVENT_TYPE.PUZZLE:\r\n\t\t\t\treturn \"Puzzle\";\r\n\t\t\tcase ENCOUNTER_EVENT_TYPE.DUNGEON:\r\n\t\t\t\treturn \"Dungeon Crawl\";\r\n\r\n\t\t\tcase ENCOUNTER_EVENT_TYPE.PERCEPTION:\r\n\t\t\t\treturn \"Perception Check\";\r\n\r\n\t\t\tcase ENCOUNTER_EVENT_TYPE.TOWN:\r\n\t\t\t\treturn \"Town Stuff\";\r\n\r\n\t\t\tcase ENCOUNTER_EVENT_TYPE.TRAVEL:\r\n\t\t\t\treturn \"Travel\";\r\n\r\n\t\t\tcase ENCOUNTER_EVENT_TYPE.CHALLENGE:\r\n\t\t\t\treturn \"Skill Challenge\";\r\n\r\n\t\t\tcase ENCOUNTER_EVENT_TYPE.TRAP:\r\n\t\t\t\treturn \"Trap\";\r\n\r\n\t\t\tcase ENCOUNTER_EVENT_TYPE.CHARACTER_BACKSTORY:\r\n\t\t\t\treturn \"Backstory\";\r\n\r\n\t\t\tcase ENCOUNTER_EVENT_TYPE.STORY:\r\n\t\t\t\treturn \"Story\";\r\n\r\n\t\t\tcase ENCOUNTER_EVENT_TYPE.EXPLORATION:\r\n\t\t\t\treturn \"Exploration\";\r\n\t\t}\r\n\t};\r\n\r\n\tconst eventsList = () => {\r\n\t\tif (encounter.events.length === 0) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t<div className=\"encounter-eventlist\">\r\n\t\t\t\t{encounter.events.map((event, index) => (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\tclassName={`event-entry ${event.type} ${\r\n\t\t\t\t\t\t\tcompletedEvents.includes(index) ? \"completed\" : \"\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\tonClick={() => clickEvent(index, index === preferredEventIndex)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"event-icon\">\r\n\t\t\t\t\t\t\t<CImage imageId={uiManager.getEventIcon(event.type)} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{index === preferredEventIndex && (\r\n\t\t\t\t\t\t\t<div className=\"preferred-event-score\">\r\n\t\t\t\t\t\t\t\t<TooltipWrapper\r\n\t\t\t\t\t\t\t\t\tcontent=\"Gain a bonus point for choosing this event next.\"\r\n\t\t\t\t\t\t\t\t\tpreservePositioning={true}\r\n\t\t\t\t\t\t\t\t\ttranslate={[270, -120]}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<DiceScore score={1} />\r\n\t\t\t\t\t\t\t\t</TooltipWrapper>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<div className=\"event-name\">{event.name}</div>\r\n\t\t\t\t\t\t{/* <div className=\"event-description\">{getEventDescription(event)}</div> */}\r\n\r\n\t\t\t\t\t\t{event.flavorText && (\r\n\t\t\t\t\t\t\t<div className=\"event-flavor-text\">{event.flavorText}</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tconst campaignDisplay = () => {\r\n\t\treturn (\r\n\t\t\t<div className=\"session-control-campaign\">\r\n\t\t\t\t<CampaignHeader\r\n\t\t\t\t\tencounterScore={encounterScore}\r\n\t\t\t\t\tcampaignScore={campaignScore}\r\n\t\t\t\t\tonClick={() => setCampaignModalVisible(true)}\r\n\t\t\t\t\tclassName=\"header overview\"\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tconst getReadiness = (nbExpectedTags: number) => {\r\n\t\tif (nbExpectedTags === NB_EXPECTED_ENCOUNTER_TAGS) {\r\n\t\t\treturn \"WELL PREPARED\";\r\n\t\t} else if (nbExpectedTags === NB_EXPECTED_ENCOUNTER_TAGS - 1) {\r\n\t\t\treturn \"READY\";\r\n\t\t} else if (nbExpectedTags === NB_EXPECTED_ENCOUNTER_TAGS - 2) {\r\n\t\t\treturn \"INFORMED\";\r\n\t\t}\r\n\r\n\t\treturn \"NOT READY\";\r\n\t};\r\n\tconst hackToBranch = (branch: any) => {\r\n\t\t// Show results and advance to branch\r\n\t\ttagManager.showNextEncounterModal();\r\n\t};\r\n\r\n\tconst advanceEncounter = () => {\r\n\t\t// Show the next encounter selection modal instead of directly advancing\r\n\t\ttagManager.showNextEncounterModal();\r\n\t};\r\n\r\n\tconst encounterTagSatisfied = (tag: Tag) =>\r\n\t\t!tagManager.getOutstandingEncounterTags().includes(tag);\r\n\tconst nbEncounterTagsSatisfied = (encounter?.tags || []).filter((encTag) =>\r\n\t\tencounterTagSatisfied(encTag)\r\n\t).length;\r\n\r\n\treturn (\r\n\t\t<div className=\"encounter-overview-container\">\r\n\t\t\t<div className=\"encounter-icon-container\">\r\n\t\t\t\t<CImage imageId={encounter.icon} />\r\n\t\t\t</div>\r\n\t\t\t{!campaignModalVisible && (\r\n\t\t\t\t<div className={`encounter-overview-nonmodal `}>\r\n\t\t\t\t\t{/* <div\r\n\t\t\t\t\t\tclassName={`encounter-overview-exposition-button`}\r\n\t\t\t\t\t\tonClick={() => campaignManager.handleExpositionClicked()}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"encounter-overview-exposition-label\">\r\n\t\t\t\t\t\t\tEXPOSITION\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"encounter-overview-exposition-effect\">\r\n\t\t\t\t\t\t\t{campaignManager.getEncounterExpositionText()}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div> */}\r\n\t\t\t\t\t<div className=\"encounter-overview-abilities-row\">\r\n\r\n\t\t\t\t\t\t<Cbox\r\n\t\t\t\t\t\t\ttitle=\"Offer Snacks\"\r\n\t\t\t\t\t\t\ttheme=\"snacks\"\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tif (remainingSnacks > 0) {\r\n\t\t\t\t\t\t\t\t\tcampaignManager.useSnacks();\r\n\t\t\t\t\t\t\t\t\t// Update state directly for immediate UI feedback\r\n\t\t\t\t\t\t\t\t\tsetRemainingSnacks(remainingSnacks - 1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n<div className=\"ability-container\">\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"ability-info\">\r\n\t\t\t\t\t\t\t\t\t\t\tIncrease Attitude \r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t{campaignManager.hasHostingAbility(0) ? (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"ability-amount-label-container\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"ability-amount-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{remainingSnacks}/\r\n\t\t\t\t\t\t\t\t\t\t\t\t{campaignManager.getMaxSnacks()}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"lock-icon-container\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"lock-icon\">🔒</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</Cbox>\t\t\t\t\t\t<Cbox\r\n\t\t\t\t\t\t\ttitle=\"Take a Break\"\r\n\t\t\t\t\t\t\ttheme=\"breaks\"\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tif (remainingBreaks > 0) {\r\n\t\t\t\t\t\t\t\t\tcampaignManager.useBreak();\r\n\t\t\t\t\t\t\t\t\t// Update state directly for immediate UI feedback\r\n\t\t\t\t\t\t\t\t\tsetRemainingBreaks(remainingBreaks - 1);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div className=\"ability-container\">\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t<div className=\"ability-info\">\r\n\t\t\t\t\t\t\t\t\tReduce Exhaustion, Tension, Attention, Stress\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{campaignManager.hasHostingAbility(1) ? (\r\n\t\t\t\t\t\t\t\t<div className=\"ability-amount-label-container\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"ability-amount-label\">\r\n\t\t\t\t\t\t\t\t\t\t{remainingBreaks}/\r\n\t\t\t\t\t\t\t\t\t\t{campaignManager.getMaxBreaks()}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<div className=\"lock-icon-container\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"lock-icon\">🔒</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Cbox>\r\n\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{/* Quest Debug Button */}\r\n\t\t\t\t\t{/* <div\r\n\t\t\t\t\t\tclassName=\"encounter-ability-button quest-debug\"\r\n\t\t\t\t\t\tonClick={() => uiManager.showSelectQuestModal()}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"ability-container\">\r\n\t\t\t\t\t\t\t<div className=\"ability-label\">Debug Quests</div>\r\n\t\t\t\t\t\t\t<div className=\"ability-info\">Launch & manage quests</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"quest-icon-container\">\r\n\t\t\t\t\t\t\t<div className=\"quest-icon\">🗡️</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div> */}\r\n\r\n\t\t\t\t\t{campaignDisplay()}\r\n\t\t\t\t\t<div className=\"encounter-overview-contents\">\r\n\t\t\t\t\t\t<div className=\"encounter-overview-info-column\">\r\n\t\t\t\t\t\t\t<div className=\"encounter-overview-encounter-info\">\r\n\t\t\t\t\t\t\t\t<div className=\"encounter-header\">\r\n\t\t\t\t\t\t\t\t\t<MoreInfo\r\n\t\t\t\t\t\t\t\t\t\tcallback={() =>\r\n\t\t\t\t\t\t\t\t\t\t\tuiManager.showBasicNotebook(\r\n\t\t\t\t\t\t\t\t\t\t\t\tNOTEBOOK_CATEGORY.ENCOUNTER,\r\n\t\t\t\t\t\t\t\t\t\t\t\tencounter\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tclassname=\"encounter\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t{encounter.name}\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div className=\"encounter-overview-subtitle small\">\r\n\t\t\t\t\t\t\t\t\tENCOUNTER TOPICS\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"encounter-overview-encounter-info-tags-row\">\r\n\t\t\t\t\t\t\t\t\t{establishedEncounterTags.map((tag, index) => (\r\n\t\t\t\t\t\t\t\t\t\t<TagPill\r\n\t\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\ttag={tag}\r\n\t\t\t\t\t\t\t\t\t\t\tsource={FlavorTagSource.ENCOUNTER}\r\n\t\t\t\t\t\t\t\t\t\t\ttheme={currentLocationTheme as FlavorTagTheme}\r\n\t\t\t\t\t\t\t\t\t\t\ttooltipClassName={\"info-tooltip\"}\r\n\t\t\t\t\t\t\t\t\t\t\ttooltipText=\"Expectation fulfilled\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t{expectedEncounterTags.map((tag, index) => (\r\n\t\t\t\t\t\t\t\t\t\t<TagPill\r\n\t\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\ttag={tag}\r\n\t\t\t\t\t\t\t\t\t\t\tsource={FlavorTagSource.ENCOUNTER_EXPECTED}\r\n\t\t\t\t\t\t\t\t\t\t\ttheme={currentLocationTheme as FlavorTagTheme}\r\n\t\t\t\t\t\t\t\t\t\t\ttooltipClassName={\"info-tooltip\"}\r\n\t\t\t\t\t\t\t\t\t\t\ttooltipText=\"Players still expect to encounter this\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"encounter-overview-info-column\">\r\n\t\t\t\t\t\t\t<div className=\"encounter-overview-encounter-info\">\r\n\t\t\t\t\t\t\t\t<div className=\"encounter-header\">\r\n\t\t\t\t\t\t\t\t\t<MoreInfo\r\n\t\t\t\t\t\t\t\t\t\tcallback={() =>\r\n\t\t\t\t\t\t\t\t\t\t\tuiManager.showBasicNotebook(\r\n\t\t\t\t\t\t\t\t\t\t\t\tNOTEBOOK_CATEGORY.ENCOUNTER,\r\n\t\t\t\t\t\t\t\t\t\t\t\tencounter\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tclassname=\"location\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t{encounter.location.name}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"encounter-overview-encounter-info\">\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t<FillBar\r\n\t\t\t\t\t\t\t\t\t\t\ttotalSegments={locationTags.length}\r\n\t\t\t\t\t\t\t\t\t\t\tfilledSegments={locationTagsEstablished.length}\r\n\t\t\t\t\t\t\t\t\t\t\ttheme={currentLocationTheme}\r\n\t\t\t\t\t\t\t\t\t\t\tlabel={`LOCATION ELEMENTS`}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t<div className=\"encounter-overview-encounter-info-tags-row\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"encounter-overview-encounter-info-tags\">\r\n\t\t\t\t\t\t\t\t\t\t\t{sortedSetSceneTags.map((tag, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t// <div\r\n\t\t\t\t\t\t\t\t\t\t\t\t// \tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\t\t// \tclassName={`text-pill  ${\r\n\t\t\t\t\t\t\t\t\t\t\t\t// \t\ttagManager.locationTagsCollected.includes(tag)\r\n\t\t\t\t\t\t\t\t\t\t\t\t// \t\t\t? \"type-location\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t// \t\t\t: \"\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t// \t}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t// >\r\n\t\t\t\t\t\t\t\t\t\t\t\t// \t{tag.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t// </div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<TagPill\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttag={tag}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsource={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttagManager.locationTagsCollected.includes(tag)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? FlavorTagSource.LOCATION\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: FlavorTagSource.NONE\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttheme={currentLocationTheme as FlavorTagTheme}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipText={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttagManager.locationTagsCollected.includes(tag)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"This has been discussed and established\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"This part of the location has not yet been described\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"encounter-overview-events-container\">\r\n\t\t\t\t\t\t<div className=\"encounter-overview-event-header\">\r\n\t\t\t\t\t\t\tENCOUNTER EVENTS\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"encounter-overview-events-row\">\r\n\t\t\t\t\t\t\t<div className=\"encounter-overview-legend\">\r\n\t\t\t\t\t\t\t\t{uniqueEventTypes.map((event, index) => (\r\n\t\t\t\t\t\t\t\t\t<div key={index} className=\"event-legend-entry\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"event-icon\">\r\n\t\t\t\t\t\t\t\t\t\t\t<CImage imageId={uiManager.getEventIcon(event)} />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"event-name\">\r\n\t\t\t\t\t\t\t\t\t\t\t{getEventDescription(event)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t{/* <div className=\"event-description\">{getEventDescription(event)}</div> */}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t))}\r\n\r\n\t\t\t\t\t\t\t\t<div className=\"event-legend-entry\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"preferred-event-score\">\r\n\t\t\t\t\t\t\t\t\t\t<DiceScore score={1} />\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"event-name\">Maxim's Choice</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{eventsList()}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{encounter.branches && encounter.branches.length > 0 && (\r\n\t\t\t\t\t\t<div className=\"encounter-overview-bottom-container\">\r\n\t\t\t\t\t\t\t<div className=\"encounter-overview-upcoming-branches-container\">\r\n\t\t\t\t\t\t\t\t<div className={`encounter-overview-upcoming-branches-header`}>\r\n\t\t\t\t\t\t\t\t\tUPCOMING ENCOUNTERS\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"encounter-overview-upcoming-upcoming-branches\">\r\n\t\t\t\t\t\t\t\t\t{encounter.branches.map((branch, index) => (\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={`encounter-overview-upcoming-branch text-theme-${branch.location.themes[0]}`}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"encounter-overview-upcoming-branch-header\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"encounter-overview-upcoming-travel-header-text encounter\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => hackToBranch(branch)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{branch.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"encounter-overview-upcoming-travel-header-text\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{branch.location.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<FillBar\r\n\t\t\t\t\t\t\t\t\t\t\t\ttotalSegments={4}\r\n\t\t\t\t\t\t\t\t\t\t\t\tfilledSegments={Math.min(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t4,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttagManager.encounterTagsCollected[branch.name].length\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttheme={branch.location.themes[0]}\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel={branch.name}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"encounter-overview-upcoming-branch-tags\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst expectedTags =\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttagManager.encounterTagsExpected[branch.name];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst collectedTags =\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttagManager.encounterTagsCollected[branch.name] ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t[];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//    const authoredTags = tagManager.encounterTagsExpected(branch.name).filter((tag) => !expectedTags.includes(tag));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst totalSlots =\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tNB_EXPECTED_ENCOUNTER_TAGS - expectedTags.length;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst fillerTags = Array(totalSlots).fill({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: \"?\",\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn [\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//     ...authoredTags.map((tag, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//     <TagPill\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//       key={`authored-${index}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//       tag={tag}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//       source={FlavorTagSource.FORESHADOWING_EXPECTED}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//       theme={branch.location.themes[0] as FlavorTagTheme}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//       tooltipClassName={\"info-tooltip\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//       tooltipText=\"This topic can still be exposed to the players to inform them of the upcoming encounter\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//     />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//   )),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...collectedTags.map((tag, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<TagPill\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={`collected-${index}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttag={tag}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsource={FlavorTagSource.FORESHADOWING}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttheme={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbranch.location.themes[0] as FlavorTagTheme\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipClassName={\"info-tooltip\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipText=\"Players have been led to expect this if/when they get to this encounter.\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...expectedTags\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.filter(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(tag) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!collectedTags.some(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(collected) => collected.name === tag.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.map((tag, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<TagPill\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={`expected-tag-${index}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttag={tag}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsource={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tFlavorTagSource.FORESHADOWING_EXPECTED\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttheme={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbranch.location.themes[0] as FlavorTagTheme\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipClassName={\"info-tooltip\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipText=\"This topic can still be exposed to the players to inform them of the upcoming encounter\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...fillerTags.map((tag, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<TagPill\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={`filler-${index}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttag={tag}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsource={FlavorTagSource.NONE}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttheme={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbranch.location.themes[0] as FlavorTagTheme\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipClassName={\"info-tooltip\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipText=\"This topic is yet to be determined. Opportunities to choose a topic may arise.\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t\t\t\t\t\t})()}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"encounter-overview-upcoming-footer\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"encounter-overview-upcoming-travel-footer-text\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{getReadiness(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttagManager.encounterTagsCollected[branch.name]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.length\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"encounter-overview-advance-container\">\r\n\t\t\t\t\t\t\t\t<div className=\"encounter-overview-advance-text\">\r\n\t\t\t\t\t\t\t\t\tADVANCE ENCOUNTER\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclassName=\"encounter-overview-advance-button\"\r\n\t\t\t\t\t\t\t\t\tonClick={advanceEncounter}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<div className=\"encounter-overview-advance-button-text\">\r\n\t\t\t\t\t\t\t\t\t\tPLAYERS CHOOSE\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"encounter-overview-advance-info\">\r\n\t\t\t\t\t\t\t\t\t\t{campaignManager.getEncounterAdvanceReadinessText()}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{campaignModalVisible && (\r\n\t\t\t\t<CampaignDisplay\r\n\t\t\t\t\tcampaign={campaignManager.getCurrentCampaign()}\r\n\t\t\t\t\tcollapsed={false}\r\n\t\t\t\t\tonAccept={() => setCampaignModalVisible(false)}\r\n\t\t\t\t\tacceptText=\"Close\"\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default EncounterOverview;\r\n","import { EncounterEvent } from \"../../models\";\n\n// Create new EncounterEvent component\ninterface EncounterEventDisplayProps {\n  event: EncounterEvent;\n  \n}\n\nconst EncounterEventDisplay: React.FC<EncounterEventDisplayProps> = ({\n  event,\n}) => {\n  return (\n    <div className={`encounter-event`}>\n      <div className=\"event-content\">\n        {event.name}\n      </div>\n    </div>\n  );\n};\n\nexport default EncounterEventDisplay;","import { useEffect, useState } from \"react\";\nimport { Encounter, EncounterEvent } from \"../../models\";\nimport { useCampaignManager, useUiManager } from \"../managerContexts\";\nimport EncounterEventDisplay from \"./encounterEventDisplay\";\n\n\ninterface GameEncounterOverviewProps {\n    encounter: Encounter;\n}\n\n\nconst GameEncounterOverview: React.FC<GameEncounterOverviewProps> = ({encounter}) => {\n\n  const [events, setEvents] = useState<EncounterEvent[]>(encounter.events);\n  const [update, setUpdate] = useState(false);\n  const campaignManager = useCampaignManager();\n  const uiManager = useUiManager();\n\n\n \n\n  const renderEventColumn = () => {\n\n    return events.map((event, eventIndex) => (\n          <EncounterEventDisplay\n            key={`${eventIndex}`}\n            event={event}\n          />\n        ))}\n      \n\n  return (\n        <div className='table-encounter-divisions'>\n          <div className=\"event-column open\">\n            {renderEventColumn()}\n            <div className=\"event-column-label\">\n               \n            </div>\n          </div>\n         \n        </div>\n  );\n};\n\nexport default GameEncounterOverview;","import { FlavorTagTheme } from \"../../models\";\n\ninterface RangeCardProps {\n    min: number;\n    max: number;\n    totalSegments: number;\n    isGrim?: boolean;\n  }\n  \n  const RangeCard: React.FC<RangeCardProps> = ({ min, max, totalSegments, isGrim }) => {\n    \n    max++;\n    const leftPosition = ((min / totalSegments) * 100) -1;\n    const width = (((max - min) / totalSegments) * 100) +1.5;\n  \n    return (\n     \n      <div \n        className={`range-card`} \n        style={{\n          left: `${leftPosition}%`,\n          width: `${width}%`\n        }}\n      >\n         <div className=\"combat-bar-label peril\">PERIL</div>\n         <div className=\"combat-bar-label stress\">TENSION</div>\n         <div className=\"combat-bar-label engagement\">{isGrim ? 'GRIM ' : ' '}SCORE</div>\n      </div>\n    );\n  };\n\n  export default RangeCard;","import React from 'react';\r\nimport CImage from './cimage';\r\n\r\ninterface NumberDieProps {\r\n    baseDie: number;\r\n    displayNumber: number | string;\r\n    onClick?: () => void;\r\n}\r\n\r\nconst NumberDie: React.FC<NumberDieProps> = ({baseDie, displayNumber, onClick}) => {\r\n    \r\n\r\n    const imageId = `number_die_${baseDie}`;\r\n   \r\n    \r\n    return ( \r\n        <div className=\"number-die\" onClick={ onClick }>\r\n            <CImage imageId={imageId} />\r\n            <div className = \"number-die-text\">\r\n                {displayNumber}\r\n            </div>\r\n      </div>\r\n    )\r\n};\r\n    \r\nexport default NumberDie;\r\n","import React, { useState } from 'react';\r\nimport CombatBar from './combatBar';\r\nimport NumberDie from '../UI/numderDie';\r\nimport { useAppManager, useCampaignManager } from '../managerContexts';\r\nimport { CombatState, Tag } from '../../models';\r\n\r\n\r\ninterface CombatModifiersProps {\r\n  modifierCallback: (modifier: number, side: 'heroes' | 'enemies', flavor :Tag, index: number) => void;\r\n    side:'heroes' | 'enemies';\r\n    combatState: CombatState;\r\n    disabled?: boolean;\r\n  }\r\n  \r\n  const CombatModifiers: React.FC<CombatModifiersProps> = ({ modifierCallback, side, combatState, disabled }) => {\r\n    \r\n    const campaignManager = useCampaignManager();\r\n    const appManager = useAppManager();\r\n    const combatManager = appManager.getCombatManager();\r\n    const [locationTags, setLocationTags] = useState(appManager.getTagManager().locationTagsCollected);\r\n    // usedTags should ONLY keep track of the used-tags for THIS component, because it determines if THIS component activated it. \r\n  \r\n   \r\n    \r\n    const dmDie = () => {\r\n      campaignManager.spendDMPoints(1);\r\n      modifierCallback(1, side, {name: 'DM'}, 0);\r\n    }\r\n\r\n    const onTagClick = (index: number) => {\r\n      if(!combatState.usedTags) {\r\n        combatState.usedTags = locationTags.map(() => false);\r\n      }\r\n      const tagSet = !combatState.usedTags[index];\r\n      modifierCallback(tagSet ? 1 : -1, side, locationTags[index], index);\r\n    }\r\n\r\n    const getLocationTags = () => {\r\n\r\n      return (\r\n        <div className={`location-tags ${side}`}>\r\n         {locationTags.map((tag, index) => {\r\n          return (\r\n            <div key={index} className={`text-pill type-location ${combatState.usedTags[index] ? 'expected' : ''}`} onClick={()=>onTagClick(index)}>\r\n              {tag.name}\r\n            </div>\r\n          )})}\r\n        </div>\r\n      )\r\n\r\n    }\r\n\r\n\r\n\r\n    return (\r\n      <div className={`combat-modifiers ${side}`}>\r\n        <div className=\"combat-modifiers-label\">\r\n          Assist {side === 'heroes' ? 'Heroes' : 'Enemies'} \r\n        </div>\r\n        <div className = \"combat-modifier-row\">\r\n          <div className=\"combat-modifiers-tags\">\r\n            {getLocationTags()}\r\n          </div>\r\n          <div className = {`combat-modifiers-die ${disabled ? 'disabled' : ''}`}>\r\n            <NumberDie \r\n              baseDie={20}\r\n              displayNumber={'1'}\r\n              onClick={() => dmDie()}/>\r\n          </div>\r\n        </div>\r\n       \r\n      </div>\r\n    )\r\n  };\r\n\r\n  export default CombatModifiers;","import React, { useState } from 'react';\nimport NumberDie from '../UI/numderDie';\nimport { CombatState, Tag } from '../../models';\n\n\ninterface AddCombatantsProps {\n    combatantCallback: (side: string, combatant :Tag, index: number) => void;\n    side:'heroes' | 'enemies';\n    combatState: CombatState;\n  }\n  \n  const AddCombatants: React.FC<AddCombatantsProps> = ({ combatantCallback, side, combatState }) => {\n    \n    const onFriendlyTagClick = (index: number) => {\n      combatantCallback(side, combatState.friendlyTags[index], index);\n    }\n\n    const onHostileTagClick = (index: number) => {\n      combatantCallback(side, combatState.hostileTags[index], index);\n    }\n\n    const getCombatantTags = () => {\n\n\n     if(side === 'heroes' && combatState.friendlyTags.length <= 0) {\n      return (\n        <div className=\"combatant-tags\">\n          <div className=\"none-available\">No valid established NPC Races available.</div>\n        </div>\n      )\n     } else if(side === 'enemies' &&  combatState.friendlyTags.length <= 0 && combatState.hostileTags.length <= 0) {\n      return (\n        <div className=\"combatant-tags\">\n          <div className=\"none-available\">No valid established Enemy Races available.</div>\n        </div>\n      )\n    }\n\n\n\n      return (\n        <div className={`combatant-tags ${side}`}>\n         {combatState.friendlyTags.map((tag, index) => {\n          return (\n            <div key={index} className={`text-pill combatant ${side}`} onClick={()=>onFriendlyTagClick(index)}>\n              {tag.name}\n            </div>\n          )})}\n           {side === \"enemies\" && combatState.hostileTags.map((tag, index) => {\n          return (\n            <div key={index} className={`text-pill combatant ${side}`} onClick={()=>onHostileTagClick(index)}>\n              {tag.name}\n            </div>\n          )})}\n        </div>\n      )\n    }\n\n    return (\n      <div className={`combat-combatants ${side}`}>\n        <div className=\"combat-combatants-label\">\n          {side === 'heroes' ? 'Add allied Combatants' : 'Swap Enemies'} \n        </div>\n        <div className = \"combat-combatants-row\">\n          <div className=\"combat-combatants-tags\">\n            {getCombatantTags()}\n          </div>\n        </div>\n       \n      </div>\n    )\n  };\n\n  export default AddCombatants;","import { useEffect, useRef, useState } from \"react\";\r\nimport { useAppManager } from \"../managerContexts\";\r\nimport { CombatState, Tag } from \"../../models\";\r\nimport RangeCard from \"./rangeCard\";\r\nimport CombatModifiers from \"./combatModifiers\";\r\nimport ModeContainer from \"../modecontainer\";\r\nimport AddCombatants from \"./addCombatants\";\r\nimport { THEME_FILLED_REQ } from \"../../consts/general\";\r\n\r\n\r\ninterface CombatBarProps {\r\n    combatState: CombatState;\r\n}\r\n\r\n\r\nconst dangerLabels_default = [ 0, 0, 5, 10, 15, 25, 50, 75, 100];\r\nconst stressLabels_default = [ 0, 0, 1, 5, 5, 5, 10, 10, 20];  \r\nconst engagementBase = [-10, -1, +5, +10, +20, +10, +5, -1, -5];\r\n\r\nconst CombatBar: React.FC<CombatBarProps> = ({combatState}) => {\r\n\r\n\r\n   \r\n    const combatBarArrayLength = engagementBase.length;\r\n    const appManager = useAppManager();\r\n    const combatManager = appManager.getCombatManager();\r\n    const partyManager = appManager.getPartyManager();\r\n    const chatManager = appManager.getChatManager();\r\n\r\n    const campaignManager = appManager.getCampaignManager();\r\n    \r\n    const getRange = (combatState: CombatState) => {\r\n        const riskCenter = combatState.riskCenter;\r\n        const range = [Math.max(riskCenter - combatState.nbEnemies, 0), Math.min(riskCenter + combatState.nbEnemies, combatBarArrayLength-1)];\r\n        return range;\r\n    }\r\n    \r\n    const themes = campaignManager.getCollectedTones();\r\n\r\n    const [stressLabels, setStressLabels] = useState(stressLabels_default);\r\n    const [dangerLabels, setDangerLabels] = useState(dangerLabels_default);\r\n    const [engagementLabels, setEngagementLabels] = useState<number[]>([]);\r\n  //  const [enemy, setEnemy] = useState(ENEMIES[combatState.enemyType.name]);\r\n    const [range, setRange] = useState(getRange(combatState));\r\n\r\n    const [highlightedSegment, setHighlightedSegment] = useState<number | null>(null);\r\n    const [isAnimating, setIsAnimating] = useState(false);\r\n    const [combatResultIndex, setCombatResultIndex] = useState<number | null>(null);\r\n    const [randomResult, setRandomResult] = useState<number | null>(null);\r\n\r\n    const applyGrimEffect = !!(themes.grim && themes.grim === THEME_FILLED_REQ);\r\n\r\n    const labelsRef = useRef({\r\n        danger: dangerLabels,\r\n        stress: stressLabels,\r\n        engagement: engagementLabels\r\n      });\r\n      \r\n      useEffect(() => {\r\n        labelsRef.current = {\r\n          danger: dangerLabels,\r\n          stress: stressLabels,\r\n          engagement: engagementLabels\r\n        };\r\n      }, [dangerLabels, stressLabels, engagementLabels]);\r\n    useEffect(() => {\r\n        combatManager.setCombatBarAnimating(isAnimating);\r\n        if(!isAnimating) {\r\n           console.log(\"DONE ANIMATING\" + combatResultIndex + \" : \" + combatState.round.phase);\r\n           switch(combatState.round.phase) {\r\n                case 'balance':\r\n                    const newRange = getRange(combatState)\r\n                    console.log(\"NEW RANGE: \" + newRange);\r\n                    setRange(newRange);\r\n                    break\r\n                case 'setup':\r\n                    if(randomResult !== null) {\r\n                        combatManager.modifyCombatRangeCenter(randomResult);\r\n                        setCombatResultIndex(null);\r\n                    }\r\n                break;\r\n                case 'heroes_attack':\r\n                    break;\r\n                case 'heroes_resolve':\r\n                  \r\n                    break;\r\n                case 'enemies_attack':\r\n                    // apply score and tension now\r\n                    \r\n                    break;\r\n               \r\n              \r\n                case 'enemy_resolve_damage':\r\n                     \r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    }, [isAnimating]);\r\n\r\n\r\n    useEffect(() => {\r\n        const handleCombatStateChange = (newCombatState: CombatState) => {\r\n          if(combatManager) {\r\n            setPeril(combatState);\r\n           \r\n            setEngagement(combatState);\r\n            const newRange = getRange(combatState)\r\n            setRange(newRange);\r\n          }\r\n        };\r\n    let blah = false; \r\n    const handleCombatPhaseChange = (newCombatState: CombatState) => {\r\n        console.log(\"Phase change ! \" + newCombatState.round.phase);\r\n        switch(newCombatState.round.phase) {\r\n            case 'setup':   \r\n            if(!isAnimating) { \r\n               \r\n                console.log(\"WHATSUUUUP \"+ blah)\r\n                 blah = true; \r\n                setRandomResult(pickRandomInRange([0, combatBarArrayLength - 1]));\r\n                setHighlightedSegment(null);\r\n            }\r\n                break;\r\n            case 'heroes_attack':\r\n              \r\n                break;\r\n         case 'heroes_resolve':\r\n             \r\n                break;\r\n            case 'enemies_attack':\r\n                setRandomResult( pickRandomInRange(getRange(newCombatState)));\r\n             \r\n                break;\r\n           \r\n        \r\n            case 'enemy_resolve_damage':\r\n           \r\n                break;\r\n            default:\r\n                break;\r\n            }\r\n        };\r\n        setEngagement(combatState);\r\n        setPeril(combatState);\r\n        combatManager.on('combatStateChange', handleCombatStateChange);\r\n        combatManager.on('combatPhaseChange', handleCombatPhaseChange);\r\n       \r\n        \r\n        return () => {\r\n          combatManager.removeAllListeners('combatStateChange');\r\n          combatManager.removeAllListeners('combatPhaseChange');\r\n        };\r\n      }, [combatManager]);\r\n    \r\n    const setPeril = (combatState: CombatState) => {\r\n        // Determine how strong the enemy is versus the party\r\n        const enemyStrength = combatState.enemyStats.attack[0];\r\n        const partyStrength = partyManager.getPartyStrength();\r\n\r\n        const riskArray = [0,1,5,10,25,50,75,80,90,100]\r\n        const dangerCoefficient = (enemyStrength*enemyStrength) / (partyStrength*partyStrength);\r\n\r\n        const perilLabels = riskArray.map((risk, index) => {\r\n            let calcRisk = Math.ceil(risk * dangerCoefficient);\r\n            \r\n            if(combatState.nbEnemies === 1) {\r\n                calcRisk *= .8;    \r\n            } else if(combatState.nbEnemies === 3) {\r\n                calcRisk *= 1.6;\r\n            }\r\n            \r\n            if(index === 9) {\r\n                calcRisk *= 2;\r\n            }  \r\n            if(index === 8) {\r\n                calcRisk *= 1.5;\r\n            }\r\n\r\n            // round up to nearest 5\r\n            calcRisk = Math.ceil(calcRisk/5)*5;\r\n\r\n            //Max 100\r\n            calcRisk = Math.min(calcRisk, 100);\r\n            return calcRisk;\r\n        });\r\n        \r\n        setDangerLabels(perilLabels);\r\n        setStress(perilLabels)\r\n        \r\n    }\r\n\r\n    const setPerilResult = (result: number) => {\r\n        combatManager.setPerilResult([\r\n          result, \r\n          labelsRef.current.danger[result], \r\n          labelsRef.current.stress[result], \r\n          labelsRef.current.engagement[result]\r\n        ]);\r\n      };\r\n\r\n    const setStress = (perilLabels: number[]) => {\r\n        const stressArray: number[] = [];\r\n        perilLabels.forEach((label, index) => {\r\n            const stress = getStressForPeril(label);\r\n            stressArray.push(stress);\r\n        });\r\n        setStressLabels(stressArray);\r\n    }\r\n\r\n    const getStressForPeril = (peril: number) => {\r\n        let stress = 0;\r\n        if(peril <= 10) {\r\n            stress = 1;\r\n        } else if(peril <= 25) {\r\n            stress = 5;\r\n        } else if(peril <= 40) {\r\n            stress = 10;\r\n        } else if(peril <= 50) {\r\n            stress = 15;\r\n        } else if(peril <= 80) {\r\n            stress = 20;\r\n        } else if(peril <= 90) {\r\n            stress = 25;\r\n        } else {\r\n            stress = 30;\r\n        }\r\n        return stress;\r\n    }\r\n\r\n    const setEngagement = (combatState: CombatState) => {\r\n        const engagementArray:number[] = [];\r\n        let maxEngagement = 0;\r\n        engagementBase.forEach((base, index) => {\r\n            const nbEnemenyCoefficient = .5 * combatState.nbEnemies;\r\n            const basicEngagement = base * nbEnemenyCoefficient\r\n            // round to lower int if negative or higher int if positive\r\n            let roundedEngagement = basicEngagement < 0 ? Math.floor(basicEngagement) : Math.ceil(basicEngagement);\r\n            if(roundedEngagement > maxEngagement) {\r\n                maxEngagement = roundedEngagement;\r\n               \r\n            }else if(applyGrimEffect) {\r\n                roundedEngagement = maxEngagement;\r\n            }\r\n            engagementArray.push(roundedEngagement);\r\n        });\r\n        setEngagementLabels(engagementArray);\r\n    }\r\n\r\n\r\n    const pickRandomInRange = (range:number[]) => {\r\n        const result = Math.floor(Math.random() * (range[1] - range[0] + 1)) + range[0];\r\n        animateRangePicker(range, result);\r\n        setCombatResultIndex(result);\r\n        setPerilResult(result);\r\n        return result;\r\n      }\r\n\r\n      \r\n      const generateColorsFromLabels = (numbers: number[], label: 'danger' | 'stress' | 'engagement'): string[] => {\r\n        const min = Math.min(...numbers);\r\n        const max = Math.max(...numbers);\r\n        return numbers.map(n => combatManager.generateColorFromValue(n, min, max, label));\r\n      };\r\n      \r\n      const dangerColors = generateColorsFromLabels(dangerLabels, 'danger');\r\n      const stressColors = generateColorsFromLabels(stressLabels, 'stress');\r\n      const engagementColors = generateColorsFromLabels(engagementLabels, 'engagement');\r\n\r\n    const getSegments = (label: 'danger' | 'stress' | 'engagement') => {\r\n        const segmentColors = label === 'danger' ? dangerColors : label === 'stress' ? stressColors : engagementColors;\r\n        const labels = label === 'danger' ? dangerLabels : label === 'stress' ? stressLabels : engagementLabels;\r\n        const initialSetup = combatState.round.phase === 'balance' || (combatState.round.phase === 'setup' && isAnimating);\r\n        const segments = Array.from({ length: combatBarArrayLength }, (_, index) => (\r\n            <div\r\n            key={index}\r\n            className={\r\n                `combat-bar-segment  \r\n                ${initialSetup || (index >= range[0] && index <= range[1]) ? 'in-range' : ''}\r\n                ${index === highlightedSegment ? 'highlighted' : ''}\r\n                ${isAnimating ? 'animating' : ''}\r\n                ${combatResultIndex === null ? '' : index === combatResultIndex ? 'positive-result' : 'negative-result'}\r\n            `}\r\n            style={{ \r\n                backgroundColor: segmentColors[index] || '',\r\n                color: (label === 'stress' && labels[index] > 10) ? '#777777ff' : ''\r\n            }}\r\n            >{(label!=='danger' &&  labels[index] > 0) ? '+' : ''}{labels[index]}{(label==='danger') ? '%':''}</div>\r\n        ));\r\n        return segments;\r\n    }\r\n\r\n    const HACKYHACKHACK = 8; // size of peril array\r\n    \r\nconst animateRangePicker = (range: number[], finalNumber: number) => {\r\n    //console.log(`Animating from ${range[0]} to ${range[1]} towards ${finalNumber}`);\r\n    setIsAnimating(true);\r\n    let direction = 1;\r\n    let currentIndex = range[0];\r\n    let delay = 50; // Start fast\r\n    \r\n    const animate = () => {\r\n      setHighlightedSegment(currentIndex);\r\n      if(combatManager.getCombatState()?.round.phase === 'setup') {\r\n\r\n        setRange([Math.max(0, currentIndex - combatState.nbEnemies),Math.min(HACKYHACKHACK, currentIndex + combatState.nbEnemies)]);\r\n    }\r\n      //console.log(`Animating to ${finalNumber} from ${currentIndex}`);\r\n      if (delay < 300) { // Still moving fast\r\n        currentIndex += direction;\r\n        \r\n        if (currentIndex >= range[1]) {\r\n          direction = -1;\r\n          currentIndex = range[1];\r\n        } else if (currentIndex <= range[0]) {\r\n          direction = 1;\r\n          currentIndex = range[0];\r\n        }\r\n        \r\n        delay *= 1.10; // Slow down gradually\r\n        setTimeout(animate, delay);\r\n      } else {\r\n        if(currentIndex !== finalNumber) {\r\n            currentIndex += direction;\r\n            if (currentIndex >= range[1]) {\r\n                direction = -1;\r\n                currentIndex = range[1];\r\n              } else if (currentIndex <= range[0]) {\r\n                direction = 1;\r\n                currentIndex = range[0];\r\n              }\r\n            setTimeout(animate, delay);\r\n        }else{\r\n        // Final movement to target number\r\n        setHighlightedSegment(finalNumber);\r\n        setIsAnimating(false);\r\n      }\r\n    }\r\n    };\r\n    \r\n    animate();\r\n  };\r\n\r\n    const combatModifiersCallback = (modifier: number, side: 'heroes' | 'enemies', flavor: Tag, index:number) => {\r\n        combatManager.combatModifiersCallback(modifier, side, flavor, index);\r\n    }\r\n\r\n    const combatantCallback = (side: string, combatant: Tag, index: number) => {\r\n        combatManager.combatantCallback(side, combatant, index);\r\n    }\r\n\r\n\r\n    return (\r\n        <div className=\"combat-peril-row\">\r\n            <div className={`combat-bar-modifiers left ${combatState.round.phase === 'setup' ? 'show-arrow' : ''} ` }>\r\n                {combatState.round.phase === 'balance' ? (\r\n                    <AddCombatants\r\n                        combatantCallback = {combatantCallback}\r\n                        side={\"heroes\"}\r\n                        combatState={combatState}\r\n                        />\r\n                    ) :\r\n                    combatState.round.phase === 'setup' ? (\r\n                    <CombatModifiers\r\n                        modifierCallback={combatModifiersCallback}\r\n                        side={\"heroes\"}\r\n                        combatState={combatState}\r\n                        disabled={isAnimating}\r\n                        />\r\n                    ) : null}\r\n            </div>\r\n            <div className=\"combat-bar-container\">\r\n            \r\n                <div className = \"combat-bar\">\r\n                    <div className=\"combat-bar-range-indicator\">\r\n                        <RangeCard min={range[0]} max={range[1]} totalSegments={combatBarArrayLength} isGrim={applyGrimEffect} />\r\n                </div>\r\n                    <div className=\"segment-container danger\">\r\n                        {getSegments('danger')}\r\n                    </div>\r\n                    <div className=\"segment-container stress\">\r\n                        {getSegments('stress')}\r\n                    </div>\r\n                    <div className=\"segment-container engagement\">\r\n                        {getSegments('engagement')}        \r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className={`combat-bar-modifiers right ${combatState.round.phase === 'setup' ? 'show-arrow' : ''} ` }>\r\n            {combatState.round.phase === 'balance' ? (\r\n                 <AddCombatants\r\n                        combatantCallback = {combatantCallback}\r\n                        side={\"enemies\"}\r\n                        combatState={combatState}\r\n                        />\r\n                    ) :\r\n                    combatState.round.phase === 'setup' ? (\r\n                <CombatModifiers\r\n                    modifierCallback={combatModifiersCallback}\r\n                    side={\"enemies\"}\r\n                    combatState={combatState}\r\n                    disabled={isAnimating}\r\n                    />\r\n            ) : null}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\nexport default CombatBar; ","import { EnemyAttribute } from '../models';\nimport { TAG } from './tags';\n\n\nexport const ENEMIES: Record<string, EnemyAttribute> = {\n    // GOBLINS\n    [TAG.GOBLINS.name] : {\n        defense: [2],\n        magic_defense: [0], \n        health: [5],\n        attack: [2],\n    },\n    // GNOMES\n    [TAG.GNOMES.name] : {\n        defense: [3],\n        magic_defense: [3], \n        health: [10],\n        attack: [3],\n    },\n    // DRAGONS\n    [TAG.DRAGONS.name] : {\n        defense: [10],\n        magic_defense: [10], \n        health: [100],\n        attack: [10],\n    },\n    // UNDEAD\n    [TAG.UNDEAD.name] : {\n        defense: [5],\n        magic_defense: [5], \n        health: [20],\n        attack: [5],\n    },\n    // BEASTS\n    [TAG.BEASTS.name] : {\n        defense: [5],\n        magic_defense: [0], \n        health: [20],\n        attack: [5],\n    },\n    // CULTISTS\n    [TAG.CULTISTS.name] : {\n        defense: [2],\n        magic_defense: [5], \n        health: [10],\n        attack: [3],\n    },\n    // BANDITS\n    [TAG.BANDITS.name] : {\n        defense: [3],\n        magic_defense: [0], \n        health: [10],\n        attack: [3],\n    },\n    // MONSTERS\n    [TAG.MONSTERS.name] : {\n        defense: [5],\n        magic_defense: [5], \n        health: [20],\n        attack: [5],\n    },\n    // HUMANS\n    [TAG.HUMANS.name] : {\n        defense: [5],\n        magic_defense: [5], \n        health: [20],\n        attack: [5],\n    },\n    // ELVES\n    [TAG.ELVES.name] : {\n        defense: [5],\n        magic_defense: [5], \n        health: [20],\n        attack: [5],\n    },\n    // DWARVES\n    [TAG.DWARVES.name] : {\n        defense: [5],\n        magic_defense: [5], \n        health: [20],\n        attack: [5],\n    },\n    // ORCS\n    [TAG.ORCS.name] : {\n        defense: [5],\n        magic_defense: [5], \n        health: [20],\n        attack: [5],\n    },\n    // HALFLINGS\n    [TAG.HALFLINGS.name] : {\n        defense: [5],\n        magic_defense: [5], \n        health: [20],\n        attack: [5],\n    },\n    // HALF-ORCS\n    // [TAG.HALF_ORCS.name] : {\n    //     defense: [5],\n    //     magic_defense: [5], \n    //     health: [20],\n    //     attack: [5],\n    // },\n    // HALF-ELVES\n    [TAG.HALF_ELVES.name] : {\n        defense: [5],\n        magic_defense: [5], \n        health: [20],\n        attack: [5],\n    },\n}","import EventEmitter from 'events';\r\nimport { ATTRIBUTE_TYPE, Character, CHAT_TYPE, CombatState, Encounter, EnemyAttribute, EnemyAttributeInstance, HeroCombatant, PERIL_INDEX, Tag } from '../models';\r\nimport AppManager from './appManager';\r\nimport CampaignManager from './campaignManager';\r\nimport CharacterManager from './characterManager';\r\nimport PlayerManager from './playerManager';\r\nimport UiManager from './uiManager';\r\nimport { ENEMIES } from '../consts/enemies';\r\nimport ChatManager from './chatManager';\r\nimport PartyManager from './partyManager';\r\nimport { getCombinedAttributes } from '../consts/characterConsts';\r\n\r\nconst defaultStats: EnemyAttribute = {\r\n  health: [1],\r\n  attack: [1],\r\n  defense: [1],\r\n  magic_defense: [1],\r\n}\r\n\r\n\r\nclass CombatManager extends EventEmitter {\r\n\r\n  \r\n  private appManager: AppManager | undefined;\r\n  private characterManager: CharacterManager | undefined;\r\n  private campaignManager: CampaignManager | undefined;\r\n  private playerManager: PlayerManager | undefined;\r\n  private uiManager: UiManager | undefined;\r\n  private chatManager: ChatManager | undefined;\r\n\r\n  private combatState: CombatState | undefined;\r\n  private partyManager: PartyManager | undefined;\r\n\r\n  constructor(appManager: AppManager) {\r\n    super();\r\n    setTimeout(() => {\r\n      this.appManager = appManager;\r\n      this.characterManager = appManager.getCharacterManager();\r\n      this.campaignManager = appManager.getCampaignManager();\r\n      this.playerManager = appManager.getPlayerManager();\r\n      this.uiManager = appManager.getUiManager();\r\n      this.chatManager = appManager.getChatManager();\r\n      this.partyManager = appManager.getPartyManager();\r\n    }, 0);\r\n\r\n   \r\n    \r\n  }\r\n\r\n  getCombatState() {\r\n    return this.combatState;\r\n  }\r\n\r\n  generateCombatRewards() {\r\n    \r\n    if(!this.combatState) {\r\n      return;\r\n    }\r\n    \r\n    switch(this.combatState.nbEnemies) {\r\n      case 1:\r\n        this.combatState.rewards = 1;\r\n        break;\r\n      case 2:\r\n        this.combatState.rewards =  3;\r\n        break;\r\n      case 3:\r\n        this.combatState.rewards =  5;\r\n        break;\r\n      default:\r\n        this.combatState.rewards =  1;\r\n        break;\r\n    }\r\n\r\n  }\r\n\r\n  \r\n getCombatMessage = () => {\r\n\tif(!this.combatState) return;\r\n\r\n  switch(this.combatState.round.phase) {\r\n    case 'balance':\r\n      return  'Balance the combat by changing the number or type of enemies and/or add NPCs.';\r\n    case 'setup':\r\n      if(this.combatState.barAnimating) {\r\n        return `The players and ${this.combatState.enemyType.name} ready themselves themselves and we see how dangerous this round will be... `;\r\n      }\r\n      return 'Balance the fight by using established elements of the environment to make the combat more or less dangerous. Or simply fudge the dice...';\r\n    case 'heroes_attack':\r\n     return 'done in component'\r\n    case 'heroes_resolve':\r\n      return 'Now the enemies will attack! This will determine the chance of injury to the party.';\r\n    case 'enemies_attack':\r\n      if(this.combatState.barAnimating) {\r\n        return `Determining the danger and excitement of this round...`;\r\n      }\r\n      return `There is a ${this.combatState.perilResult[PERIL_INDEX.DANGER]}% chance of a party injury.`;\r\n   \r\n    case 'enemy_resolve_damage':\r\n      return this.combatState.combatMessage;\r\n    \r\n    default:\r\n      return '';\r\n  }\r\n}\r\n\r\n\r\n  generateCombatState(encounter: Encounter, combatIndex: number): CombatState | undefined {\r\n    \r\n    if(!encounter.combat || !encounter.combat[combatIndex]){\r\n      return;\r\n    }\r\n\r\n    if(this.combatState) {\r\n      return this.combatState;\r\n    } \r\n\r\n    const combat = encounter.combat[combatIndex];\r\n    const enemies = combat.enemy;\r\n    const nbEnemies = combat.nbEnemies;\r\n\r\n    const newCombatState: CombatState = {\r\n      round: {\r\n       number: 0,\r\n       phase: 'balance'\r\n      },\r\n      attacker: \"heroes\",\r\n      currentCharacterIndex: 0,\r\n      currentEnemyIndex: 0,\r\n      nbEnemies: nbEnemies,\r\n      enemyType: enemies,\r\n      enemyStats: ENEMIES[enemies.name] || {...defaultStats},\r\n      riskCenter: 4,\r\n      usedTags: this.appManager?.getTagManager().locationTagsCollected.map(() => false) || [],\r\n      hostileTags:this.campaignManager?.getHostileCombatantTags(enemies.name) || [],\r\n      friendlyTags:this.campaignManager?.getFriendlyCombatantTags() || [],\r\n      npcs: [],\r\n      rewards: 1,\r\n      perilResult: [0,0,0,0],\r\n      heroAttacks: {},\r\n      enemyStatsInstance:  {\r\n        health: 1,\r\n        attack: 1,\r\n        defense: 1,\r\n        magic_defense: 1,\r\n      }\r\n     // usedFriendlyTags:Array(this.campaignManager?.getFriendlyCombatantTags().length).fill(false),\r\n     // usedHostileTags:Array(this.campaignManager?.getHostileCombatantTags().length).fill(false),\r\n    };\r\n   \r\n\r\n    this.updateCombatState(newCombatState);\r\n    this.generateCombatRewards();\r\n    return newCombatState;\r\n  }\r\n\r\n  static GetDefaultCombatState(): CombatState {\r\n    return {\r\n      round: {\r\n        number: 0,\r\n        phase: 'balance'\r\n      },\r\n      attacker: \"heroes\",\r\n      currentCharacterIndex: 0,\r\n      currentEnemyIndex: 0,\r\n      nbEnemies: 1,\r\n      enemyType: {name: 'none'},\r\n      enemyStats: {...defaultStats},\r\n      riskCenter: 5,\r\n      usedTags: [],\r\n      hostileTags:[],\r\n      friendlyTags:[],\r\n      npcs:[],\r\n      perilResult: [0,0,0,0],\r\n      heroAttacks: {},\r\n      rewards: 1,\r\n      enemyStatsInstance:  {\r\n        health: 1,\r\n        attack: 1,\r\n        defense: 1,\r\n        magic_defense: 1,\r\n      }\r\n     // usedFriendlyTags:[],\r\n     // usedHostileTags:[],\r\n    }\r\n  \r\n  }\r\n\r\n  modifyCombatRangeCenter(value: number) {\r\n    \r\n    if(!this.combatState) {\r\n      return;\r\n    }\r\n    this.combatState.riskCenter = value;\r\n    this.emit('combatStateChange', this.combatState);\r\n  }\r\n\r\n  updateCombatState(combatState: CombatState) {\r\n    this.combatState = combatState;\r\n    this.emit('combatStateChange', this.combatState);\r\n  }\r\n\r\n  applyPerilResultsToParty() {\r\n    \r\n    if(!this.combatState) {\r\n      return;\r\n    }\r\n    const stress = this.combatState.perilResult[PERIL_INDEX.STRESS];\r\n    //const engagement = this.combatState.perilResult[PERIL_INDEX.ENGAGEMENT];\r\n   // const score = this.combatState.perilResult[PERIL_INDEX.SCORE];\r\n    this.partyManager?.addPartyTension(stress);\r\n  //  this.partyManager?.addPartyScore(score);\r\n\r\n  \r\n  }\r\n\r\n  setCombatBarAnimating(isAnimating: boolean) {\r\n    if(!this.combatState) { \r\n      return;\r\n    }\r\n    this.combatState.barAnimating = isAnimating;\r\n    this.emit('combatStateChange',  this.combatState);\r\n  }\r\n\r\n   advanceRound() {\r\n    \r\n    if(!this.combatState) {\r\n      return;\r\n    }\r\n    switch(this.combatState.round.phase) {\r\n        case 'balance':\r\n          this.generateEnemyAttributeInstance();\r\n          this.combatState.round.phase = 'setup';\r\n          this.generateHeroAttacks();\r\n          this.chatManager?.combatIntroMessage(this.combatState.enemyType);\r\n          break;\r\n        case 'setup':\r\n          \r\n          this.combatState.round.phase = 'heroes_attack';\r\n          \r\n         // this.campaignManager?.exhaustParty(this.getAttackActionCost());\r\n          \r\n          \r\n          this.combatState.round.number++;\r\n\r\n          break;  \r\n        case 'heroes_attack':\r\n                    \r\n          if(this.combatState.enemyStatsInstance.health <= 0) {\r\n           // this.partyManager?.addPartyScore(this.combatState.perilResult[PERIL_INDEX.SCORE]);\r\n            this.uiManager?.showRewardModal(this.combatState.rewards || 0, true);\r\n          }else {\r\n            this.combatState.round.phase = 'heroes_resolve';\r\n          }\r\n          break;\r\n        case 'heroes_resolve':\r\n        \r\n          this.combatState.round.phase = 'enemies_attack';\r\n         \r\n          break;\r\n\r\n\t\t\t\tcase 'enemies_attack':\r\n        //  this.applyPerilResultsToParty();\r\n          this.perilCheck();\r\n          this.combatState.round.phase = 'enemy_resolve_damage';\r\n          this.applyPerilResultsToParty();\r\n          break;\r\n\r\n        case 'enemy_resolve_damage':\r\n          this.combatState.round.phase = 'setup';\r\n          this.generateHeroAttacks();\r\n          this.partyManager?.exhaustParty(this.getAttackActionCost());\r\n          break;\r\n\r\n\t\t\t\tdefault: \r\n          console.log(\"Unknown phase\");\r\n\t\t}\r\n\r\n    console.log(\"Changing phase to \"  + this.combatState.round.phase);\r\n    this.emit('combatPhaseChange', this.combatState);\r\n    this.emit('combatStateChange', this.combatState);\r\n   }\r\n\r\n\r\n   perilCheck() {\r\n    const chanceOfPeril = this.combatState?.perilResult;\r\n    if(!chanceOfPeril) return;\r\n    const randomRoll = Math.floor(Math.random() * 100);\r\n    if(randomRoll < chanceOfPeril[PERIL_INDEX.DANGER]) {\r\n      this.activatePeril();\r\n    } else{\r\n      this.chatManager?.dmMessage(`You guys are safe this round.`);\r\n    }\r\n\r\n    if(this.combatState)\r\n      this.combatState.combatMessage = `${chanceOfPeril[PERIL_INDEX.DANGER]}% chance of injury and rolled a ${randomRoll}.`;\r\n\r\n   }\r\n\r\n\r\n   activatePeril() {\r\n    if(this.combatState === undefined) {\r\n      return;\r\n    }\r\n    let combatants = this.partyManager?.generateHeroes(this.combatState.npcs || []);\r\n    if(combatants === undefined) {\r\n      return;\r\n    }\r\n    let injuredIndex = Math.floor(Math.random() * combatants.length);\r\n\r\n    if(injuredIndex < this.combatState.npcs.length) {\r\n      this.combatState.npcs.splice(injuredIndex, 1);\r\n      this.chatManager?.dmMessage(`The ${combatants[injuredIndex].name} were frigtened off!`);\r\n    } else {\r\n      let injury = ''\r\n      if(combatants[injuredIndex].character) {\r\n        injury = this.partyManager?.addInjury(combatants[injuredIndex].character) || 'unknown injury';\r\n      }\r\n\r\n      this.chatManager?.dmMessage(`Oh no! ${combatants[injuredIndex].name} is ${injury}`);\r\n    }\r\n   }\r\n\r\n\r\n\r\n    generateEnemyAttributeInstance() {\r\n      const attributeIndex = (this.getCombatState()?.nbEnemies || 1) - 1;\r\n      const nbEnemies = this.getCombatState()?.nbEnemies || 1;\r\n      const enemyStats = this.getCombatState()?.enemyStats || {...defaultStats};\r\n      const enemyAttributes: EnemyAttributeInstance = {\r\n              health: enemyStats.health[attributeIndex] || enemyStats.health[0] * nbEnemies,\r\n              attack: enemyStats.attack[attributeIndex] || enemyStats.attack[0] * nbEnemies,\r\n              defense: enemyStats.defense[attributeIndex] || enemyStats.defense[0] * nbEnemies,\r\n              magic_defense: enemyStats.magic_defense[attributeIndex] || enemyStats.magic_defense[0] * nbEnemies,\r\n            };\r\n      if(this.combatState) {\r\n        this.combatState.enemyStatsInstance = enemyAttributes;\r\n      }\r\n    }\r\n  \r\n    generateHeroAttacks() {\r\n      if(!this.combatState) {\r\n        return;\r\n      } \r\n      const heroes = this.partyManager?.generateHeroes(this.combatState?.npcs || []);\r\n      heroes?.forEach((hero) => {\r\n        if(!this.combatState) {\r\n          return;\r\n        } \r\n        this.combatState.heroAttacks[hero.name] = this.generateAttack(hero);\r\n      });\r\n  }\r\n\r\n  heroRethinkAttack(hero: HeroCombatant) { \r\n    if(!this.combatState) {\r\n      return;\r\n    }\r\n    this.campaignManager?.spendDMPoints(1); \r\n    let currentAttack = this.combatState.heroAttacks[hero.name];\r\n\r\n    let maxRetries = 10;\r\n    while(currentAttack === this.combatState.heroAttacks[hero.name] && maxRetries-- > 0) {\r\n      this.combatState.heroAttacks[hero.name] = this.generateAttack(hero);\r\n    }\r\n\r\n    let chatMessage = `${hero.name} should really think of a different tactic.`;\r\n    switch(Math.floor(Math.random() * 3)) {\r\n      case 0:\r\n       chatMessage = `Do you really want ${hero.name} to do that?`;\r\n        break;\r\n      case 1:\r\n        chatMessage = `That's stupid.`;\r\n        break;\r\n      case 2:\r\n        chatMessage = `You know ${hero.name} has better options, right?`;\r\n        break;\r\n    }\r\n\r\n    this.chatManager?.dmMessage(chatMessage);\r\n\r\n    this.emit('combatStateChange', this.combatState);\r\n  }\r\n\r\n  getHeroAttackDecisionText(hero: HeroCombatant) {\r\n    const attackType = this.combatState?.heroAttacks[hero.name];\r\n    if(!attackType) {\r\n      return 'vxvxcvx';\r\n    }\r\n    switch(attackType) {\r\n      case 'combat':\r\n        return `${hero.name} attacks with their weapon!`;\r\n      case 'tools':\r\n        return `${hero.name} uses their tools!`;\r\n      case 'magic':\r\n        return `${hero.name} casts a spell!`;\r\n      default:\r\n        return 'vxvxcvxvxvxc';\r\n    }\r\n  }\r\n\r\n  generateAttack(hero: HeroCombatant) {\r\n\r\n    let allAbilities: Record<string, number> = {};\r\n    if(hero.npcTag) {\r\n      hero.character = this.characterManager?.generateNPC(hero.npcTag);\r\n      allAbilities = this.getNPCAttributes(hero.npcTag);\r\n    } \r\n    else{\r\n      allAbilities = getCombinedAttributes(hero.character as Character, true);\r\n    } \r\n\r\n   \r\n        if(allAbilities[ATTRIBUTE_TYPE.MAGIC] && allAbilities[ATTRIBUTE_TYPE.MAGIC] > 0) {\r\n          if(Math.random() > .666) \r\n            return 'magic'\r\n        }\r\n        if(allAbilities[ATTRIBUTE_TYPE.TOOLS] && allAbilities[ATTRIBUTE_TYPE.TOOLS] > 0) {\r\n          if(Math.random() > .5) \r\n            return 'tools'\r\n        }\r\n        return 'combat';\r\n  }\r\n\r\n  getNPCAttributes(npcTag: Tag) {   \r\n    let enemyStats = ENEMIES[npcTag.name];\r\n    return { \r\n      [ATTRIBUTE_TYPE.COMBAT]: Math.max(1, enemyStats.attack[0]), \r\n      [ATTRIBUTE_TYPE.MAGIC]: enemyStats.magic_defense[0],\r\n      [ATTRIBUTE_TYPE.TOOLS]: enemyStats.defense[0]\r\n      }\r\n  }\r\n\r\n  heroAttack(hero: HeroCombatant) {\r\n    if(!this.combatState) {\r\n      return;\r\n    }\r\n  \r\n   \r\n   \r\n\r\n    let player;\r\n    if(hero.character) {\r\n      player = this.playerManager?.getPlayerAssignedCharacter(hero.character);\r\n      if(player){\r\n        this.partyManager?.playersTakeAction([player.name], false);\r\n        this.partyManager?.stressAction([player]);\r\n        this.chatManager?.playerMessage(this.getHeroAttackDecisionText(hero), player.id );\r\n      }\r\n    }\r\n    let abilities = getCombinedAttributes(hero.character as Character, true);\r\n\r\n    if(hero.npcTag){\r\n      abilities = this.getNPCAttributes(hero.npcTag);\r\n    }\r\n\r\n\r\n    const fullAbilities  = getCombinedAttributes(hero.character as Character);\r\n    let actualDamage = 0;\r\n    let damageType = 'combat';\r\n    let nbIcons = 0;\r\n    let target = '';\r\n    let crit = false;\r\n    switch(this.combatState.heroAttacks[hero.name]) {\r\n      case 'combat':\r\n        let damage = Math.floor(Math.random() * (abilities[ATTRIBUTE_TYPE.COMBAT] || 0)) + 1;\r\n        if(this.combatState.enemyStatsInstance.defense > 0){\r\n          target = 'Defense';\r\n          this.combatState.enemyStatsInstance.defense = Math.max(0, this.combatState.enemyStatsInstance.defense - damage);\r\n        } else if (this.combatState.enemyStatsInstance.magic_defense > 0) {\r\n          target = 'Magic Defense';\r\n          damage = 1;\r\n          this.combatState.enemyStatsInstance.magic_defense = Math.max(0, this.combatState.enemyStatsInstance.magic_defense - 1);\r\n        } else {\r\n          target = 'Health';\r\n          this.combatState.enemyStatsInstance.health = Math.max(0, this.combatState.enemyStatsInstance.health - damage);\r\n        }\r\n        nbIcons = damage;\r\n        actualDamage = damage;\r\n        damageType = 'combat';\r\n        break;\r\n      case 'tools':\r\n        let toolsDamage = 1;\r\n        if(Math.random() < .25) {\r\n          toolsDamage = fullAbilities[ATTRIBUTE_TYPE.TOOLS];\r\n          crit = true;\r\n        }\r\n        if(this.combatState.enemyStatsInstance.defense > 0){\r\n          target = 'Defense';\r\n          this.combatState.enemyStatsInstance.defense = Math.max(0, this.combatState.enemyStatsInstance.defense - toolsDamage);\r\n        } else if (this.combatState.enemyStatsInstance.magic_defense > 0) {\r\n          target = 'Magic Defense';\r\n          this.combatState.enemyStatsInstance.magic_defense = Math.max(0, this.combatState.enemyStatsInstance.magic_defense - toolsDamage);\r\n        } else {\r\n          target = 'Health';\r\n          this.combatState.enemyStatsInstance.health = Math.max(0, this.combatState.enemyStatsInstance.health - toolsDamage);\r\n        }\r\n        this.characterManager?.setAttributeUsed(hero.character as Character, ATTRIBUTE_TYPE.TOOLS, 1);\r\n        actualDamage = toolsDamage;\r\n        damageType = 'tools';\r\n        nbIcons = toolsDamage;\r\n        break;\r\n      case 'magic':\r\n        const nbSpells = Math.min(abilities[ATTRIBUTE_TYPE.MAGIC] || 1,  hero.character?.level || 1);\r\n        const spellDamage = nbSpells * (Math.floor(Math.random() * 3) + 2);\r\n       if (this.combatState.enemyStatsInstance.magic_defense > 0) {\r\n        target = 'Magic Defense';\r\n          this.combatState.enemyStatsInstance.magic_defense = Math.max(0, this.combatState.enemyStatsInstance.magic_defense - spellDamage);\r\n        } else  if(this.combatState.enemyStatsInstance.defense > 0){\r\n          target = 'Defense';\r\n          this.combatState.enemyStatsInstance.magic_defense = Math.max(0, this.combatState.enemyStatsInstance.defense - spellDamage);\r\n        } else {\r\n          target = 'Health';\r\n          this.combatState.enemyStatsInstance.health = Math.max(0, this.combatState.enemyStatsInstance.health - spellDamage);\r\n        }\r\n        this.characterManager?.setAttributeUsed(hero.character as Character, ATTRIBUTE_TYPE.MAGIC, nbSpells);\r\n        actualDamage = spellDamage;\r\n        damageType = 'magic';\r\n        nbIcons = nbSpells;\r\n        break;\r\n      \r\n      default:\r\n        console.log('Unknown attack type');\r\n    }\r\n\r\n    let icons ='';\r\n    switch(damageType) {\r\n      case 'combat':\r\n        icons = '⚔️'.repeat(nbIcons);\r\n        break;\r\n      case 'tools':\r\n        icons = '🔧'.repeat(nbIcons);\r\n        break;\r\n      case 'magic':\r\n        icons = '✨'.repeat(nbIcons);\r\n        break;\r\n    }\r\n    \r\n    let attackString = `${crit === true ? 'Crit! ' : ''}  ${icons} = ${actualDamage} damage ${target}.`;\r\n    this.emit('combatStateChange', this.combatState);\r\n    return attackString;\r\n  }\r\n\r\n  getAttackActionCost() {\r\n    if(!this.combatState)\r\n        return 0;\r\n    \r\n    return (this.combatState.round.number) * Object.keys(this.combatState.heroAttacks).length;\r\n  }\r\n\r\n  reduceEnemies() {\r\n    if(this.combatState) {\r\n      if(this.combatState.nbEnemies > 1) {\r\n        this.combatState.nbEnemies--;\r\n        this.campaignManager?.spendDMPoints(1);\r\n        this.generateCombatRewards();\r\n        this.emit('combatStateChange', this.combatState);\r\n      }\r\n    }\r\n  }\r\n\r\n  increaseEnemies() {\r\n    if(this.combatState) {\r\n      if(this.combatState.nbEnemies < 3) {\r\n        this.combatState.nbEnemies++;\r\n        this.campaignManager?.spendDMPoints(1);\r\n        this.generateCombatRewards();\r\n        this.emit('combatStateChange', this.combatState);\r\n      }\r\n    }\r\n  }\r\n\r\n  combatModifiersCallback (modifier: number, side: 'heroes' | 'enemies', flavor: Tag, index:number) {\r\n    if(!this.combatState) {\r\n      return;\r\n    }\r\n\r\n    if(side === 'heroes') {\r\n        this.combatState.riskCenter -= modifier;\r\n    } else {\r\n        this.combatState.riskCenter += modifier;\r\n    }\r\n    if(flavor.name !== 'DM') {\r\n        this.combatState.usedTags[index] = !this.combatState.usedTags[index];\r\n    }\r\n\r\n    this.emit('combatStateChange', this.combatState);\r\n\r\n    this.chatManager?.sayCombatModifiedMessage(side, flavor, this.combatState.enemyType, modifier);\r\n}\r\n\r\n    combatantCallback(side: string, clickedCombatant: Tag, index: number) {\r\n      \r\n      if(!this.combatState) {\r\n        return;\r\n      }\r\n\r\n      const isCombatantFriendly = clickedCombatant.friendly;  \r\n      // Remove clickedCombatant from available lists\r\n      if(isCombatantFriendly) {\r\n         this.combatState.friendlyTags.splice(index, 1);\r\n      } else {\r\n        this.combatState.hostileTags.splice(index, 1);\r\n      }\r\n      // add existing enemy back to available lists depending on friendly or not. \r\n      if(side === 'enemies') {\r\n        if(this.combatState.enemyType.friendly) {\r\n          this.combatState.friendlyTags.push(this.combatState.enemyType);\r\n        } else {\r\n          this.combatState.hostileTags.push(this.combatState.enemyType);\r\n        }\r\n        this.setEnemyType(clickedCombatant);\r\n      } else {\r\n        // Otherwise this is being added to the NPC list.\r\n        this.combatState.npcs.push(clickedCombatant); \r\n       \r\n      }\r\n      this.generateCombatRewards();\r\n      this.emit('combatStateChange', this.combatState);\r\n    }\r\n\r\n    setEnemyType(enemy: Tag) {\r\n      if(!this.combatState) {\r\n        return;\r\n      }\r\n      this.combatState.enemyType = enemy;\r\n      this.combatState.enemyStats = ENEMIES[enemy.name] || {...defaultStats};\r\n      this.emit('combatStateChange', this.combatState);\r\n    }\r\n\r\n\r\n    setPerilResult(result: number[]) {\r\n      \r\n      if(!this.combatState) {\r\n        return;\r\n      }\r\n      this.combatState.perilResult = result;\r\n      this.emit('combatStateChange', this.combatState);\r\n    }\r\n\r\n\r\n  // perceptionEventReveal(character: Character) {\r\n  //   // We need to bump the player's engagement, and decreae all other players engamgement\r\n  //   const players = this.playerManager?.getPlayers();\r\n  //   players?.forEach((player) => {\r\n  //     if(player.characters.includes(character.id)) {\r\n  //       player.playerStats.engagement += 1;\r\n  //     } else {\r\n  //       player.playerStats.engagement -= 1;\r\n  //     }\r\n  //   });\r\n  //   this.uiManager?.updateParty();\r\n  // }\r\n\r\n   generateColorFromValue(value: number, min: number, max: number, label: string ) {\r\n    // Normalize value to 0-1 range\r\n    const normalized = (value - min) / (max - min);\r\n    \r\n    // Define color stops\r\n    let colors =  {\r\n        negative: { r: 255, g: 61, b: 61 },  \r\n        neutral: { r: 255, g: 139, b: 105 }, \r\n        positive: { r: 255, g: 0, b: 0 }  \r\n    }\r\n    \r\n    switch(label) {\r\n        case 'danger':\r\n            colors = {\r\n                negative: { r: 255, g: 255, b: 255 }, \r\n                neutral: { r: 179, g: 139, b: 105 }, \r\n                positive: { r: 200, g: 25, b: 20 }   \r\n            }\r\n            break;\r\n        case 'stress':\r\n            colors = {\r\n                negative: { r: 255, g: 255, b: 255 },  \r\n                neutral: { r: 130, g: 130, b: 130 }, \r\n                positive: { r: 0, g: 0, b: 0 }   \r\n            }\r\n            break;\r\n        case 'engagement':\r\n            colors = {\r\n                negative: { r: 139, g: 61, b: 61 }, \r\n                neutral: { r: 179, g: 139, b: 105 }, \r\n                positive: { r: 92, g: 148, b: 87 }   \r\n            }\r\n            break\r\n            case 'reward':\r\n                colors = {\r\n                  negative: { r: 255, g: 255, b: 255 }, \r\n                  neutral: { r: 255, g: 255, b: 255 }, \r\n                  positive: { r: 255, g: 215, b: 0 }   // Gold color\r\n                }\r\n              break\r\n    \r\n    }\r\n    \r\n  \r\n    let result;\r\n    if (value < 0) {\r\n      // Interpolate between negative and neutral\r\n      const t = (value - min) / (0 - min);\r\n      result = {\r\n        r: Math.round(colors.negative.r + (colors.neutral.r - colors.negative.r) * t),\r\n        g: Math.round(colors.negative.g + (colors.neutral.g - colors.negative.g) * t),\r\n        b: Math.round(colors.negative.b + (colors.neutral.b - colors.negative.b) * t)\r\n      };\r\n    } else {\r\n      // Interpolate between neutral and positive\r\n      const t = value / max;\r\n      result = {\r\n        r: Math.round(colors.neutral.r + (colors.positive.r - colors.neutral.r) * t),\r\n        g: Math.round(colors.neutral.g + (colors.positive.g - colors.neutral.g) * t),\r\n        b: Math.round(colors.neutral.b + (colors.positive.b - colors.neutral.b) * t)\r\n      };\r\n    }\r\n    \r\n    return `#${result.r.toString(16).padStart(2,'0')}${result.g.toString(16).padStart(2,'0')}${result.b.toString(16).padStart(2,'0')}`;\r\n  };\r\n\r\n}\r\n\r\nexport default CombatManager;","import React from 'react';\nimport { withRandomTheme } from \"../withRandomTheme\";\nimport { useCampaignManager, usePartyManager } from '../managerContexts';\nimport { FlavorTagTheme } from '../../models';\n\ninterface BaseButtonProps {\n  onClick?: (arg0: string | null) => void;\n  className?: string;\n  children?: React.ReactNode;\n}\n\nconst BaseButton: React.FC<BaseButtonProps> = ({ onClick, className, children }) => {\n  const handleClick = () => {\n    // if (onClick) {\n    //   onClick(null);\n    // }\n  };\n  \n \n\n\n  return (\n    <div \n      className={`themed-button ${className || ''}`} \n      onClick={handleClick}\n     \n    >\n      {children}\n    </div>\n  );\n};\n\nexport const ThemedButton = withRandomTheme(BaseButton);","import React, { useEffect, useState } from 'react';\r\nimport { FlavorTagTheme } from '../models';\r\nimport { useCampaignManager } from './managerContexts';\r\n\r\nconst THEME_CHANCE = .25;// chance to apply a theme\r\n\r\ninterface WithRandomThemeProps {\r\n  onClick?:(theme: string | null) => void; // Add onClick to the interface\r\n  className?: string;\r\n  regenerateKey?: number; \r\n}\r\n\r\nexport const withRandomTheme = <P extends object>(\r\n  WrappedComponent: React.ComponentType<P>\r\n) => {\r\n\r\n  return (props: P & WithRandomThemeProps) => {\r\n      const campaignManager = useCampaignManager();\r\n    const [theme, setTheme] = useState<string | null>(null);\r\n\r\n    const handleClick = (e: React.MouseEvent) => {\r\n      if (props.onClick) {\r\n        props.onClick(theme);\r\n      }\r\n\r\n      if(theme) {\r\n          campaignManager.themedUiClicked(theme);\r\n      }\r\n      setTheme(null);\r\n\r\n    };\r\n\r\n    useEffect(() => {\r\n      if (Math.random() < THEME_CHANCE) {\r\n        const themes = Object.values(FlavorTagTheme) as string[];\r\n        const randomTheme = themes[Math.floor(Math.random() * themes.length-1)];\r\n        setTheme(randomTheme);\r\n      }\r\n    }, [props.regenerateKey]);\r\n\r\n \r\n\r\n    const combinedClassName = theme \r\n      ? `${props.className || ''} theme-${theme}`\r\n      : props.className;\r\n\r\n    return (\r\n      <div className=\"theme-wrapper\" onClick={handleClick}>\r\n        <WrappedComponent {...props} className={combinedClassName} />\r\n        {theme && (\r\n          <div className=\"tag-tooltip\">\r\n            {`This action will be done in a ${theme} way`}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n};","\n\nimport { useCallback, useEffect, useState } from 'react';\nimport { ATTRIBUTE_CONTRIBUTOR, CombatState, Encounter, EnemyAttribute, EnemyAttributeInstance, HeroCombatant, PERIL_INDEX, Tag } from '../../models';\nimport { useAppManager, useCampaignManager, useUiManager } from '../managerContexts';\nimport AttributeDisplay from '../UI/attributeDisplay';\nimport CImage from '../UI/cimage';\nimport CombatBar from './combatBar';\nimport './combat.scss';\nimport NumberDie from '../UI/numderDie';\nimport CombatManager from '../../managers/combatManager';\nimport { ThemedButton } from '../UI/themedButton';\n\n\ninterface GameEncounterCombatProps {\n\tencounter: Encounter;\n}\n\n  const GameEncounterCombat: React.FC<GameEncounterCombatProps> = ({encounter}) => {\n\n\tconst appManager = useAppManager();\n\tconst uiManager = useUiManager();\n\tconst combatManager = appManager.getCombatManager();\n\tconst characterManager = appManager.getCharacterManager();\n\n\tconst partyManager = appManager.getPartyManager();\n\n\tconst combatState = combatManager?.generateCombatState(encounter, 0) || CombatManager.GetDefaultCombatState();\n\n\tconst [swapVisible, setSwapVisible] = useState(false);\n\t\n\tconst [enemyAttributes, setEnemyAttributes] = useState<EnemyAttributeInstance>();\n\tconst [nbEnemies, setNbEnemies] = useState(combatState.nbEnemies);\n\tconst [enemyType, setEnemyType] = useState(combatState.enemyType);\n\tconst [perilResult, setPerilResult] = useState(combatState.perilResult);\n\tconst [combatBarAnimating, setCombatBarAnimating] = useState(false);\n\tconst [combatMessage, setCombatMessage] = useState<string>();\n\tconst [rewards, setRewards] = useState<number>(combatState.rewards || 1);\n\n\t\n\tconst [heroCombatants, setHeroCombatants] = useState<HeroCombatant[]>(partyManager.generateHeroes(combatState.npcs));\n\tconst [heroActed, setHeroActed] = useState(heroCombatants.map(() => 'false'));\n\n\tconst getEnemyAttributeInstance = (enemyStats: EnemyAttribute): EnemyAttributeInstance => {\n\t\t\tconst attributeIndex = (combatManager?.getCombatState()?.nbEnemies || 1) - 1;\n\t\t\tconst nbEnemies = combatManager?.getCombatState()?.nbEnemies || 1;\n\t\t\tconst enemyAttributes: EnemyAttributeInstance = {\n\t\t\t\thealth: enemyStats.health[attributeIndex] || enemyStats.health[0] * nbEnemies,\n\t\t\t\tattack: enemyStats.attack[attributeIndex] || enemyStats.attack[0] * nbEnemies,\n\t\t\t\tdefense: enemyStats.defense[attributeIndex] || enemyStats.defense[0] * nbEnemies,\n\t\t\t\tmagic_defense: enemyStats.magic_defense[attributeIndex] || enemyStats.magic_defense[0] * nbEnemies,\n\t\t\t};\n\t\t\treturn enemyAttributes;\n\t\t}\n\tuseEffect(() => {\n\t\t\n\t\tconst handleCombatStateChange = (newCombatState: CombatState) => {\n\t\t\tsetNbEnemies(newCombatState.nbEnemies);\n\t\t\tsetEnemyType(newCombatState.enemyType);\n\t\t\tsetHeroCombatants(partyManager.generateHeroes(newCombatState.npcs));\n\t\t\tsetPerilResult(newCombatState.perilResult);\n\t\t\tsetRewards(newCombatState.rewards || 1);\n\t\t\tif(newCombatState.round.phase === 'balance') {\n\t\t\t\tsetEnemyAttributes(getEnemyAttributeInstance(newCombatState.enemyStats))\n\t\t\t}else {\n\t\t\t\tsetEnemyAttributes(newCombatState.enemyStatsInstance);\n\t\t\t}\n\n\t\t\tif(newCombatState.round.phase === 'setup') {\n\t\t\t\t// reset acted\n\t\t\t\tsetHeroActed(Object.keys(newCombatState.heroAttacks).map(() => 'false'))\n\t\t\t\t\n\t\t\t}\n\t\t\tsetCombatMessage(newCombatState.combatMessage);\n\t\t\tsetCombatBarAnimating(newCombatState.barAnimating || false);\n\t\t\t//setCombatStatePhase(newCombatState);\n\t\t  \n\t\t};\n\t  \n\t\tcombatManager.on('combatStateChange', handleCombatStateChange);\n\t\tsetEnemyAttributes(getEnemyAttributeInstance(combatState.enemyStats))\n\t\t\n\t\treturn () => {\n\t\t  combatManager.removeAllListeners('combatStateChange');\n\t\t};\n\t  }, [combatManager, encounter]);\n\n\n\tconst enemyAttributesDisplay = () => {\n\t\treturn (\n\t\t\t<div className = \"combat-encounter-enemies-attributes-display\">\n\t\t\t\t<div className=\"combat-enemy-attribute defense\">\n\t\t\t\t\t<div className=\"combat-enemy-attribute-title\">Defense</div>\n\t\t\t\t\t<div className=\"combat-enemy-attribute-value\">{enemyAttributes?.defense}</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"combat-enemy-attribute magic-defense\">\n\t\t\t\t\t<div className=\"combat-enemy-attribute-title\">Magic Defense</div>\n\t\t\t\t\t<div className=\"combat-enemy-attribute-value\">{enemyAttributes?.magic_defense}</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"combat-enemy-attribute health\">\n\t\t\t\t\t<div className=\"combat-enemy-attribute-title\">Health</div>\n\t\t\t\t\t<div className=\"combat-enemy-attribute-value\">{enemyAttributes?.health}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t}\n\n\tconst generateEnemy = () => {\n\t\t  const icons = [];\n\t\t  //const symbol = uiManager.getShortenedName(enemy.name);\n\t\t  const nbIcons = [0,1,3,5,7];\n\t\t  \n\t\t  for (let i = 0; i < nbIcons[nbEnemies]; i++) {\n\t\t\ticons.push(\n\t\t\t\t<div key={`${i}`} className={`enemy-icon enemy-type-${enemyType.name}`}>\n\t\t\t\t\t<CImage imageId={`combat_${enemyType.name}`} />\n\t\t\t\t</div>\n\t\t\t\t);\n\t\t  }\n\t\t  return icons;\n\t\t};\n\n\tconst modifyEnemies = (nb: number) => {\n\t\tif(nb < 1) {\n\t\t\tcombatManager.reduceEnemies();\n\t\t}\n\t\telse {\n\t\t\tcombatManager.increaseEnemies();\n\t\t}\n\t}\n\t\n\n\n\n\tconst getRoundAdvanceLabel = () => {\n\t\tswitch(combatState.round.phase) {\n\t\t\tcase 'balance':\n\t\t\t\treturn 'Begin Fight'\n\t\t\tcase 'setup':\n\t\t\t\n\t\t\t\treturn `Heroes Attack`;\n\t\t\tcase 'heroes_attack':\n\t\t\t\tif(combatState.enemyStatsInstance.health <= 0) {\n\t\t\t\t\treturn 'End Combat'\n\t\t\t\t}\n\t\t\t\tif(heroCombatants.every((hero, index) => heroActed[index] !== 'false')) {\n\t\t\t\t\treturn 'Continue';\n\t\t\t\t}\n\t\t\t\treturn 'Skip Hero Attack';\n\t\t\tcase 'heroes_resolve':\n\t\t\t\t\treturn 'Enemies Attack';\n\t\t\tcase 'enemies_attack':\n\t\t\t\tif(combatState.barAnimating) {\n\t\t\t\t\treturn '...';\n\t\t\t\t}\n\t\t\t\treturn 'Resolve Peril';\n\t\t\t\n\t\t\tcase 'enemy_resolve_damage':\n\t\t\t\t\treturn 'End Round';\n\t\t\tcase 'end_combat':\n\t\t\t\t\treturn '';\n\t\t\tdefault: \t\n\t\t\treturn '';\n\t\t}\n\t}\n\t\n\n\tconst description = encounter.combat ? encounter.combat[0]?.description : '';\n\tconst getCombatMessage = () => {\n\n\t\tif(combatState.round.phase === 'heroes_attack') {\n\t\t\treturn (\n\t\t\t\t<div className = \"combat-message-container\">\n\t\t\t\t\t<div className = \"combat-message-legend\">\n\t\t\t\t\t\t<div className=\"combat-message-legend-item\">⚔️:  1-⚔️ to Health or Defense.</div>\n\t\t\t\t\t\t<div className=\"combat-message-legend-item\">⚔️:  1 to Magic Defense.</div>\n\t\t\t\t\t\t<div className=\"combat-message-legend-item\">🔧:  1 to anything</div>\n\t\t\t\t\t\t<div className=\"combat-message-legend-item\">🔧:  Chance to crit for 🔧</div>\n\t\t\t\t\t\t<div className=\"combat-message-legend-item\">✨:  2-4 Damage to anything.</div>\n\t\t\t\t\t\t<div className=\"combat-message-legend-item\">✨:  at higher levels</div>\n\t\t\t\t\t\t<br></br>\n\t\t\t\t\t\t<div className=\"combat-message-legend-item\">🔧 / ✨: limited uses</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)\n\t\t}\n\n\n\t\tlet combatMessage = combatManager.getCombatMessage();\n\t\treturn (\n\t\t\t<div className = \"combat-message-container\">\n\t\t\t\t<div className = \"combat-message\">\n\t\t\t\t\t{combatMessage}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t}\n\t\t\n\tconst heroAttackPressed = (hero: HeroCombatant, index: number) => {\n\t\tconst newHeroActed = [...heroActed];\n\t\tnewHeroActed[index] = combatManager?.heroAttack(hero) || 'false';\n\t\t\n\t\tsetHeroActed(newHeroActed);\n\t}\n\n\tconst rewardDisplay = () => {\n\t\tif(rewards) {\n\t\t\treturn (\n\t\t\t\t<div className=\"combat-encounter-rewards\">\n\t\t\t\t\t<div className=\"combat-encounter-rewards-title\">Players will expect</div>\n\t\t\t\t\t<div className=\"combat-encounter-rewards-list\">{rewards} rewards</div>\n\t\t\t\t</div>\n\t\t\t)\n\t\t}\n\t\treturn null;\n\t}\n\n\t  return (\n\t\t<div className=\"game-encounter-combat\">\n\t\t\t\n\t\t\t\n\t\t\t<div className=\"combat-encounter-upper-container\">\n\t\t\t\t<div className=\"combat-encounter-header\">\t\t\n\t\t\t\t\t<div className=\"combat-encounter-header-title\">Combat Event in {encounter.location.name}</div>\n\t\t\t\t\t<div className=\"combat-encounter-description\">{description}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\n\t\t    <div className=\"combat-encounter-body-container\">\n\t\t\t\t<CombatBar combatState = {combatState}/>\n\t\t\t\t<div className=\"combat-encounter-enemies-row\">\n\t\t\t\t\t{getCombatMessage()}\n\t\t\t\t\t\n\t\t\t\t\t<div className=\"combat-encounter-enemies\">\n\t\t\t\t\t\t<div className= \"combat-encounter-enemies-number\">\n\t\t\t\t\t\t\t{combatState.round.phase === 'balance' && (\n\t\t\t\t\t\t\t<div className=\"combat-enemies-ui\"  onClick={() => modifyEnemies(-1)}>\n\t\t\t\t\t\t\t\t<NumberDie baseDie={20} displayNumber={'1'}/>\n\t\t\t\t\t\t\t\tless\n\t\t\t\t\t\t\t</div>)}\n\t\t\t\t\t\t\t<div className=\"combat-encounter-enemies-list\">\n\t\t\t\t\t\t\t\t{generateEnemy()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{combatState.round.phase === 'balance' && (\n\t\t\t\t\t\t\t<div className=\"combat-enemies-ui\"  onClick={() => modifyEnemies(1)}>\n\t\t\t\t\t\t\t\t<NumberDie baseDie={20} displayNumber={'1'}/>\n\t\t\t\t\t\t\t\tmore\n\t\t\t\t\t\t\t</div>)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t<div className=\"combat-encounter-enemies-attributes\">\n\t\t\t\t\t\t\t{enemyAttributesDisplay()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"combat-encounter-enemies-header\">\n\t\t\t\t\t\t<div className='combat-encounter-enemy-name'>\n\t\t\t\t\t\t\t{enemyType.name}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\t\n\t\t\t\t</div>\n\n\t\t\t\t<div className = \"combat-advance-box\">\n\t\t\t\t\t<div className ={`combat-encounter-advance-button-container ${combatBarAnimating ? 'disabled' : ''} `} onClick={() => combatManager?.advanceRound()}>\n\t\t\t\t\t\t<div className=\"combat-encounter-advance-button\">{getRoundAdvanceLabel()}\n\t\t\t\t\t\t\t{combatState.round.phase === 'enemy_resolve_damage' && combatManager.getAttackActionCost() > 0 &&\n\t\t\t\t\t\t\t<div className=\"combat-button-exhaustion-label\">+{combatManager.getAttackActionCost()} Exhaustion</div>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t{combatState.round.phase === 'heroes_attack' && combatState.enemyStatsInstance.health <= 0 &&\n\t\t\t\t\t\t\t<div className=\"combat-button-exhaustion-label\">+{combatManager.getCombatState()?.perilResult[PERIL_INDEX.SCORE]} Score</div>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t{combatState.round.phase === 'enemies_attack' && !combatState.barAnimating && \n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<div className=\"combat-button-exhaustion-label\">+{combatManager.getCombatState()?.perilResult[PERIL_INDEX.STRESS]} Tension</div>\n\t\t\t\t\t\t\t\t\t<div className=\"combat-button-exhaustion-label\">+{combatManager.getCombatState()?.perilResult[PERIL_INDEX.SCORE]} Score</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t</div>\n\t\t\t{rewardDisplay()}\n\n\t\t\t<div className=\"combat-encounter-heroes\">\n\t\t\t\t{heroCombatants && heroCombatants.map((hero, index) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div key={hero.name} className=\"combat-encounter-hero-row\">\n\t\t\t\t\t\t\t{(hero.npcTag || \n\t\t\t\t\t\t\t(hero.character && hero.character.injury !== 'dead')) &&\n\t\t\t\t\t\t\tcombatState.round.phase === 'heroes_attack' &&\n\t\t\t\t\t\t\t<div className=\"combat-hero-attack-results-container\">\n\t\t\t\t\t\t\t\t<ThemedButton className={`combat-hero-button ${heroActed[index] !== 'false' ? 'acted' : ''}`} onClick={() => heroAttackPressed(hero, index)}>\n\t\t\t\t\t\t\t\t\t{heroActed[index] === 'false' ? combatManager.getHeroAttackDecisionText(hero) : heroActed[index]}\n\t\t\t\t\t\t\t\t</ThemedButton>\n\t\t\t\t\t\t\t\t<div className={`combat-hero-button ${heroActed[index] === 'false' ? '' : 'hide'} `} onClick={() => combatManager?.heroRethinkAttack(hero)}>\n\t\t\t\t\t\t\t\t\t<div className=\"combat-sure-text\">\n\t\t\t\t\t\t\t\t\t\t'Are you Sure?'\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<NumberDie baseDie={20} displayNumber={'1'} />\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<div className = \"combat-encounter-hero-container\">\n\t\t\t\t\t\t\t\t<div className=\"combat-encounter-hero\">\n\t\t\t\t\t\t\t\t\t<div className=\"combat-encounter-hero-name\">{uiManager.getHeroFirstName(hero.name)}</div>\n\t\t\t\t\t\t\t\t\t<div className=\"combat-character-icon\">\n\t\t\t\t\t\t\t\t\t\t<CImage imageId={hero.icon} />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{ hero.character && hero.character.injury === 'injured' && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"combat-encounter-hero-injury\"></div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t{ hero.character && hero.character.injury === 'dead' && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"combat-encounter-hero-injury dead\"></div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"combat-encounter-hero-attributes\">\n\t\t\t\t\t\t\t\t\t<AttributeDisplay hero={hero} category={ATTRIBUTE_CONTRIBUTOR.ALL} showAttributeLoss={true} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)})}\t\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t  );\n\t};\n\nexport default GameEncounterCombat;","\n\nimport { Encounter } from '../../models';\n\n\n\ninterface GameEncounterExplorationProps {\n\tencounter: Encounter;\n}\n\n  const GameEncounterExploration: React.FC<GameEncounterExplorationProps> = ({encounter}) => {\n\n\t\n\t  return (\n\t\t<div className=\"game-encounter-combat\">\n\t\t  <div className=\"encounter-type-title\">Exploration</div>\n\t\t</div>\n\t  );\n\t};\n\nexport default GameEncounterExploration;","import React, { ReactNode } from 'react';\r\nimport './encounterHeader.scss';\r\n\r\ninterface EncounterHeaderProps {\r\n  title: string;\r\n  description?: string;\r\n  leftContent?: ReactNode;\r\n  rightContent?: ReactNode;\r\n  centerContent?: ReactNode;\r\n  instructions?: boolean[];\r\n  childClass?: string;\r\n}\r\n\r\nconst EncounterHeader: React.FC<EncounterHeaderProps> = ({\r\n  title,\r\n  description,\r\n  leftContent,\r\n  rightContent,\r\n  centerContent,\r\n  instructions = [false,false],\r\n  childClass = '',\r\n}) => {\r\n  return (\r\n    <div className=\"encounter-header\">\r\n      <div className=\"encounter-header-content\">\r\n        {leftContent && (\r\n          <div className={`encounter-header-left ${instructions[0] ? 'with-instructions' : ''}  ${childClass ? childClass : '' }  `}>\r\n            {leftContent}\r\n          </div>\r\n        )}\r\n        \r\n        <div className=\"encounter-header-center\">\r\n          {centerContent ? (\r\n            centerContent\r\n          ) : (\r\n            <>\r\n              <div className=\"encounter-header-title\">{title}</div>\r\n              {description && (\r\n                <div className=\"encounter-header-description\">{description}</div>\r\n              )}\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {rightContent && (\r\n          <div className={`encounter-header-right ${instructions[1] ? 'with-instructions' : ''} ${childClass ? childClass : '' }`}>\r\n            {rightContent}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EncounterHeader;\r\n","import { Tag } from \"../../models\";\r\nimport TooltipWrapper from \"./TooltipWrapper\";\r\n\r\ninterface TooltipProps {\r\n  theme: string;\r\n  tag: Tag;\r\n  message: string;\r\n}\r\n\r\n// Conditional tooltip component that only shows the tooltip when visible is true\r\nexport const ConditionalTooltip: React.FC<{\r\n  tooltip: string;\r\n  visible: boolean;\r\n  preservePositioning?: boolean;\r\n  translate?: [number, number];\r\n  children: React.ReactNode;\r\n  // MAXIM: Note that we dont pass everything to the tooltip wrapper and just use the defaults, theres no reason not to if needed though\r\n}> = ({ tooltip, visible, preservePositioning, translate, children }) => {\r\n  if (visible) {\r\n    return (\r\n      <TooltipWrapper\r\n        content={tooltip}\r\n        preservePositioning={preservePositioning}\r\n        translate={translate}\r\n      >\r\n        {children}\r\n      </TooltipWrapper>\r\n    );\r\n  }\r\n  return <>{children}</>;\r\n};\r\n\r\n\r\nconst Tooltip: React.FC<TooltipProps> = ({ theme, tag, message }) => {\r\n  return (\r\n    <div className={`tooltip theme-${theme}`}>\r\n      <div className=\"tooltip-content\">\r\n        {message}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Tooltip;","\r\n\r\nimport { useState } from 'react';\r\nimport { Character, Encounter, EncounterFlavorTag, TAGS_TYPE, PerceptionTags, Tag } from '../../models';\r\nimport { useAppManager, useCampaignManager, useCharacterManager, usePlayerManager, useUiManager } from '../managerContexts';\r\nimport EncounterHeader from './encounterHeader';\r\nimport CImage from '../UI/cimage';\r\nimport NumberDie from '../UI/numderDie';\r\nimport { GEAR } from '../../consts/characterConsts';\r\nimport PartyManager from '../../managers/partyManager';\r\nimport Tooltip from '../UI/tooltip';\r\n\r\n\r\n\r\ninterface GameEncounterPerceptionProps {\r\n\tencounter: Encounter;\r\n}\r\n\r\nconst GameEncounterPerception: React.FC<GameEncounterPerceptionProps> = ({encounter}) => {\r\n   const playerManager = usePlayerManager();\r\n   const campaignManager = useCampaignManager();\r\n   const uiManager = useUiManager();\r\n   const appManager = useAppManager();\r\n   const chatManager = appManager.getChatManager();\r\n   const tagManager = appManager.getTagManager();\r\n\tconst partyManager = appManager.getPartyManager();\r\n   const allCharacters: Character[] = playerManager.getAllPlayerCharacters();\r\n  const [perceptionRevealed, setPerceptionRevealed] = useState<boolean[]>(allCharacters.map(() => false));\r\n  const [perceptionAccepted, setPerceptionAccepted] = useState<boolean[]>(allCharacters.map(() => false));\r\n\r\n  const [perceptionTags, setPerceptionTags] = useState<PerceptionTags[]>([]);\r\n  \r\n\r\n\r\n  const rerollCharacterPerception = (character: Character, index: number) => {\r\n\trevealOrRerollCharacterPerceptions(character, index);\r\n\tcampaignManager.spendDMPoints(1);\r\n\t\r\n  }\r\n\r\n  const revealOrRerollCharacterPerceptions = (character: Character, index: number) => {\r\n\tconst newPerceptionRevealed = [...perceptionRevealed];\r\n\tconst newPerceptionTags = [...perceptionTags];\r\n\r\n\tnewPerceptionTags[index] = campaignManager.getPerceptionTags(character) as PerceptionTags;\r\n\t\r\n\tif(!perceptionRevealed[index]) {\r\n\t\tif(perceptionRevealed.filter((p) => p).length !== 0) {\r\n\t\t   partyManager.perceptionEventReveal(character);\r\n\t\t}\r\n\t\tnewPerceptionRevealed[index] = true;\r\n\t}\r\n\t\r\n\r\n\tsetPerceptionRevealed(newPerceptionRevealed);\r\n\t\r\n\tsetPerceptionTags(newPerceptionTags);\r\n\t\r\n  };\r\n\r\n  const acceptCharacterPerception = (character: Character, index: number) => {\r\n\tconst newPerceptionAccepted = [...perceptionAccepted];\r\n\tnewPerceptionAccepted[index] = true;\r\n\tsetPerceptionAccepted(newPerceptionAccepted);\r\n\r\n\tcampaignManager.acceptPerceptionTags(perceptionTags[index], character);\r\n\r\n\tchatManager.perceptionEvent(character, perceptionTags[index]);\r\n\r\n}\r\n\r\n  const getPlayerAttitudesStyle = (tag: Tag) => {\r\n\treturn uiManager.getPlayerAttitudesStyle(tag);\r\n  }\r\n\r\n  const getTooltipMessage = (flavorTag: EncounterFlavorTag, perceptionTagsIndex: number, tagIndex: number) => {\r\n\t\tlet messageString = '';\r\n\r\n\r\n\t\tconst encounterTooltip = campaignManager.getCampaignTooltipForTag(flavorTag);\r\n\t\tif (encounterTooltip) {\r\n\t\t\treturn encounterTooltip;\r\n\t\t}\r\n\r\n\t\tswitch(perceptionTags[perceptionTagsIndex].type){\r\n\t\t\tcase TAGS_TYPE.CURRENT_LOCATION:\r\n\t\t\t\tmessageString = `The character carefully examines ${flavorTag.tag.name}.`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TAGS_TYPE.BRANCH_LOCATION:\r\n\t\t\t\tmessageString = `Reveal hints connecting ${flavorTag.tag.name} to an upcoming encounter.`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TAGS_TYPE.CHARACTER_BACKSTORY:\r\n\t\t\t\tmessageString = `Connect the player's backstory to this new topic.`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TAGS_TYPE.CHARACTER_BACKSTORY_PROGRESS:\r\n\t\t\t\tmessageString = `Reveal ${flavorTag.tag.name}, which relates to a character's backstory.`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase TAGS_TYPE.MAGIC_ITEM:\r\n\t\t\t\tmessageString = `Reveal a magic item.`;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\r\n\t switch(flavorTag.theme) {\r\n\t\t  case 'comedic':\r\n\t\t\tmessageString += \" The players find something funny about this.\"\r\n\t\t   break; \r\n\t\t  case 'grim':\r\n\t\t\tmessageString += \" this is discussed in a grim manner\"\r\n\t\t\t\r\n\t\t\tbreak; \r\n\t\t  case 'fantasy':\r\n\t\t\tmessageString += \" the discussion around this is fantastical\"\r\n\t\t   break; \r\n\t\t  case 'heroic':\r\n\t\t\tmessageString += \" this evokes a feeling of heroism\"\r\n\t\t\t\r\n\t\t   break; \r\n\t\t  case 'horror':\r\n\t\t\tmessageString += \" something about this is scary\"\r\n\t\t\t\r\n\t\t   break; \r\n\t\t  case 'romantic':\r\n\t\t\tmessageString += \" this is discussed with romantic undertones\"\r\n\t\t   break; \r\n\t\t  case 'serious':\r\n\t\t\tmessageString += \" the players take this very seriously\"\r\n\t\t   break; \r\n\t\t  case 'dramatic':\r\n\t\t\tmessageString += \" the table gets very dramatic about this\"\r\n\t\t\tbreak; \r\n\t\t}\r\n\r\n\t\treturn messageString;\r\n  }\r\n\r\n\r\n\r\nconst getPerceptionTagTypeDisplay = (index: number) => {\r\n\r\n\tswitch (perceptionTags[index].type) {\r\n\t\tcase TAGS_TYPE.CURRENT_LOCATION:\r\n\t\t\treturn (\r\n\t\t\t\t<div className=\"perception-display current-location\">\r\n\t\t\t\t\t<div className='perception-description'>\r\n\t\t\t\t\t\tNothing interesting found. Simply learned basic info about {perceptionTags[index].name}:\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"perception-tags\">\r\n\t\t\t\t\t\t{perceptionTags[index].tags.map((flavorTag, indexb) => (\r\n\t\t\t\t\t\t\t<div key={indexb} className={`perception-tag text-pill type-${flavorTag.source} ${getPlayerAttitudesStyle(flavorTag.tag)} theme-${flavorTag.theme}`}>\r\n\t\t\t\t\t\t\t\t{flavorTag.tag.name}\r\n\t\t\t\t\t\t\t\t{flavorTag.theme && <Tooltip theme={''} tag={flavorTag.tag} message={getTooltipMessage(flavorTag, index, indexb)} />}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)\r\n\t\tcase TAGS_TYPE.BRANCH_LOCATION:\r\n\t\t\treturn (\r\n\t\t\t\t<div className=\"perception-display branch-location\">\r\n\t\t\t\t\t<div className='perception-description'>\r\n\t\t\t\t\t\tLearned some things about an upcoming encounter called {perceptionTags[index].name} which may be interesting:\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"perception-tags\">\r\n\t\t\t\t\t\t{perceptionTags[index].tags.map((flavorTag, indexb) => (\r\n\t\t\t\t\t\t\t<div key={indexb} className={`perception-tag text-pill type-foreshadowing ${getPlayerAttitudesStyle(flavorTag.tag)} theme-${flavorTag.theme}`}>\r\n\t\t\t\t\t\t\t\t{flavorTag.tag.name}\r\n\t\t\t\t\t\t\t\t{flavorTag.theme && <Tooltip theme={''} tag={flavorTag.tag}  message={getTooltipMessage(flavorTag, index, indexb)} />}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)\r\n\t\tcase TAGS_TYPE.CHARACTER_BACKSTORY:\r\n\t\t\treturn (\r\n\t\t\t\t<div className=\"perception-display backstory\">\r\n\t\t\t\t\t<div className='perception-description'>\r\n\t\t\t\t\t\tShocking new information revealed about {perceptionTags[index].name}'s Backstory!\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"perception-tags\">\r\n\t\t\t\t\t\t{perceptionTags[index].tags.map((flavorTag, indexb) => (\r\n\t\t\t\t\t\t\t<div key={indexb} className={`perception-tag text-pill expected ${getPlayerAttitudesStyle(flavorTag.tag)} theme-${flavorTag.theme}`}>\r\n\t\t\t\t\t\t\t\t{flavorTag.tag.name}\r\n\t\t\t\t\t\t\t\t{flavorTag.theme && <Tooltip theme={''} tag={flavorTag.tag}  message={getTooltipMessage(flavorTag, index,indexb)} />}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)\r\n\t\t\tcase TAGS_TYPE.CHARACTER_BACKSTORY_PROGRESS:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"perception-display backstory\">\r\n\t\t\t\t\t\t<div className='perception-description'>\r\n\t\t\t\t\t\t\tConfirmation regarding {perceptionTags[index].name}'s Backstory:\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"perception-tags\">\r\n\t\t\t\t\t\t\t{perceptionTags[index].tags.map((flavorTag, indexb) => (\r\n\t\t\t\t\t\t\t\t<div key={indexb} className={`perception-tag text-pill expected ${getPlayerAttitudesStyle(flavorTag.tag)} theme-${flavorTag.theme}`}>\r\n\t\t\t\t\t\t\t\t\t{flavorTag.tag.name}\r\n\t\t\t\t\t\t\t\t\t{flavorTag.theme && <Tooltip theme={''} tag={flavorTag.tag} message={getTooltipMessage(flavorTag, index, indexb)} />}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)\r\n\t\tcase TAGS_TYPE.MAGIC_ITEM:\r\n\t\t\tlet expectsMagicItem = tagManager.magicItemRumors.includes(perceptionTags[index].tags[0].tag);\r\n\t\t\t// Make sure magic item isn't one that was accpeted already\r\n\t\t\tperceptionTags.forEach((perceptionTag, i) => {\r\n\t\t\t\tif(perceptionAccepted[i] && perceptionTag.type === TAGS_TYPE.MAGIC_ITEM) {\r\n\t\t\t\t\tperceptionTag.tags.forEach(flavorTag => {\r\n\t\t\t\t\t\tif(flavorTag.tag.name === perceptionTags[index].tags[0].tag.name) {\r\n\t\t\t\t\t\t\texpectsMagicItem = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<div className=\"perception-display magic-item\">\r\n\t\t\t\t\t<div className='perception-description'>\r\n\t\t\t\t\t\t{expectsMagicItem ? 'Discovered a Magic Item you have heard of!' : 'Learned about a nearby Magic Item.'}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"perception-tags\">\r\n\t\t\t\t\t\t{perceptionTags[index].tags.map((flavorTag, indexb) => (\r\n\t\t\t\t\t\t\t<div key={indexb} className={`perception-tag text-pill ${expectsMagicItem ? '' : 'expected'}  type-${flavorTag.source} ${getPlayerAttitudesStyle(flavorTag.tag)} theme-${flavorTag.theme}`}>\r\n\t\t\t\t\t\t\t\t{flavorTag.tag.name}\r\n\t\t\t\t\t\t\t\t{flavorTag.theme && <Tooltip theme={''} tag={flavorTag.tag} message={getTooltipMessage(flavorTag, index, indexb)} />}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)\r\n\t\tcase TAGS_TYPE.PLOT_HOOK:\r\n\t\t\treturn (\r\n\t\t\t\t<div className=\"perception-display-campaign-container\">\r\n\t\t\t\t\t<div className='perception-description'>\r\n\t\t\t\t\t\t\t{campaignManager.getCampaignName()} Progress:\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"perception-display plot-hook\">\r\n\t\t\t\t\t\t<div className=\"campaign-icon\">\r\n\t\t\t\t\t\t\t<CImage imageId={campaignManager.getCampaignIcon()}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"campaign-plot-hook\">\r\n\t\t\t\t\t\t\t<b>{perceptionTags[index].tags[0].tag.name}</b> {`${campaignManager.getNextPlotHookText()}`}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)\r\n\t}\r\n}\r\n\r\n\t  return (\r\n\t\t<div className=\"game-encounter-perception\">\r\n\t\t\t<EncounterHeader\r\n\t\t\t\ttitle={`Perception in ${encounter.location.name}`}\r\n\t\t\t\tdescription=\"Characters can search for clues and information\"\r\n\t\t\t\trightContent={\r\n\t\t\t\t\t<div className=\"perception-stats\">\r\n\t\t\t\t\t\tRevealed: {perceptionRevealed.filter(p => p).length}/{allCharacters.length}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t/>\r\n\t\t\t<div className=\"perception-container\">\r\n\t\t\t\t<div className='character-list'>\r\n\t\t\t\t\t{allCharacters.map((character, index) => (\r\n\t\t\t\t\t<div key={index} className=\"perception-row\">\r\n\t\t\t\t\t\t<div className=\"character-container\">\r\n\t\t\t\t\t\t\t<div className='character-display'>\t\r\n\t\t\t\t\t\t\t\t<div className='character-name'>{character.name.split(' ')[0]}</div>\r\n\t\t\t\t\t\t\t\t<div className='character-icon'>\r\n\t\t\t\t\t\t\t\t\t<CImage imageId={character.icon}/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{perceptionRevealed[index] ? (\r\n\t\t\t\t\t\t\t\t<div className='character-perception-tags-container'>\r\n\t\t\t\t\t\t\t\t\t{getPerceptionTagTypeDisplay(index)}\r\n\t\t\t\t\t\t\t\t\t{perceptionAccepted[index] ? \r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t<div className='character-perception-buttons'>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className='character-perception-accepted'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t✓\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t) : \r\n\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t<div className='character-perception-buttons'>\r\n\t\t\t\t\t\t\t\t\t\t<div className='character-perception-reroll-button' onClick={() => rerollCharacterPerception(character, index)}>\r\n\t\t\t\t\t\t\t\t\t\t\tREROLL\r\n\t\t\t\t\t\t\t\t\t\t\t<NumberDie baseDie={20} displayNumber={1}/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className='character-perception-accept-button' onClick={() => acceptCharacterPerception(character, index)}>\r\n\t\t\t\t\t\t\t\t\t\t\tACCEPT\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t) : \r\n\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t<div className='character-perception-reveal-button' onClick={() => revealOrRerollCharacterPerceptions(character, index)}>\r\n\t\t\t\t\t\t\t\t\t<div className='reveal-title'>\r\n\t\t\t\t\t\t\t\t\t\tPERCEPTION CHECK\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t  );\r\n\t};\r\n\r\nexport default GameEncounterPerception;","import React from 'react';\r\n\r\ninterface InstructionsPanelProps {\r\n  instructions: string[];\r\n}\r\n\r\nconst InstructionsPanel: React.FC<InstructionsPanelProps> = ({ instructions }) => {\r\n  return (\r\n    <div className=\"encounter-instructions\">\r\n      <div className=\"tooltip-help-icon\">\r\n        <span className=\"tooltip-help-icon-text\">i</span>\r\n      </div>\r\n      {instructions.map((instruction, index) => (\r\n        <div key={`instruction-${index}`} className=\"encounter-instructions-text\">\r\n          {instruction}\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InstructionsPanel;\r\n","import { useState, useRef, useEffect } from \"react\";\r\nimport {\r\n  Encounter,\r\n  RPEncounterFlavorTag,\r\n  FlavorTagSource,\r\n  FlavorTagTheme,\r\n  Tag,\r\n  ATTITUDE,\r\n} from \"../../models\";\r\nimport EncounterHeader from \"./encounterHeader\";\r\nimport InstructionsPanel from \"../UI/InstructionsPanel\";\r\nimport {\r\n  useAppManager,\r\n  useCampaignManager,\r\n  useCharacterManager,\r\n  usePlayerManager,\r\n  useUiManager,\r\n} from \"../managerContexts\";\r\nimport FillBar from \"../UI/fillBar\";\r\nimport PartyManager from \"../../managers/partyManager\";\r\nimport CImage from \"../UI/cimage\";\r\nimport CharacterManager from \"../../managers/characterManager\";\r\nimport PlayerManager from \"../../managers/playerManager\";\r\nimport FlavorTagPill from \"../UI/FlavorTagPill\";\r\nimport TooltipWrapper from \"../UI/TooltipWrapper\";\r\nimport DiceScore from \"../UI/DiceScore\";\r\n\r\ninterface GameEncounterRoleplayProps {\r\n  encounter: Encounter;\r\n}\r\n\r\nconst bandLabels = [\r\n  { text: \"Organic Conversation\", top: \"4%\", score: 2 },\r\n  { text: \"Guided Interactions\", top: \"39%\", score: 1 },\r\n  { text: \"Off Topic\", top: \"74%\", score: 0 },\r\n];\r\n\r\nconst GameEncounterRoleplay: React.FC<GameEncounterRoleplayProps> = ({\r\n  encounter,\r\n}) => {\r\n  const uiManager = useUiManager();\r\n  const campaignManager = useCampaignManager();\r\n  const appManager = useAppManager();\r\n  const chatManager = appManager.getChatManager();\r\n  const partyManager = appManager.getPartyManager();\r\n  const characterManager = useCharacterManager();\r\n  const playerManager = usePlayerManager();\r\n  const tagManager = appManager.getTagManager();\r\n  const [positions, setPositions] = useState<{ top: string; left: string }[]>(\r\n    []\r\n  );\r\n  const [flavorTags, setFlavorTags] = useState<RPEncounterFlavorTag[]>(() =>\r\n    campaignManager.generateRoleplayEventTags()\r\n  );\r\n  const [freeTags, setFreeTags] = useState<number>(5);\r\n\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    const newPositions: { top: string; left: string }[] = [];\r\n    const maxRetries = 100;\r\n    const bands = [\r\n      { min: 5, max: 20 }, // Top band\r\n      { min: 40, max: 55 }, // Middle band\r\n      { min: 77, max: 88 }, // Bottom band\r\n    //  { min: 0, max: 0 }, // Off-topic band\r\n    ];\r\n\r\n    const isOverlap = (\r\n      pos: { top: string; left: string },\r\n      top: string,\r\n      left: string\r\n    ) =>\r\n      Math.abs(parseFloat(pos.top) - parseFloat(top)) < 10 &&\r\n      Math.abs(parseFloat(pos.left) - parseFloat(left)) < 15;\r\n\r\n    flavorTags.forEach(() => {\r\n      let currentTry = 0;\r\n      let top: string, left: string;\r\n      let overlap;\r\n      do {\r\n        currentTry++;\r\n        const bandIndex = Math.floor(Math.random() * 3);\r\n        const band = bands[bandIndex];\r\n        top = `${band.min + Math.random() * (band.max - band.min)}%`;\r\n        left = `${Math.random() * 80}%`;\r\n        // eslint-disable-next-line no-loop-func\r\n        overlap = newPositions.some((pos) => isOverlap(pos, top, left));\r\n      } while (overlap && currentTry < maxRetries);\r\n      newPositions.push({ top, left });\r\n    });\r\n\r\n    setPositions(newPositions);\r\n  }, [flavorTags]);\r\n\r\n  useEffect(() => {\r\n    const adjustTooltips = () => {\r\n      const container = containerRef.current;\r\n      if (!container) return;\r\n\r\n      const containerRect = container.getBoundingClientRect();\r\n\r\n      // Handle both FlavorTagPill tooltips and direct tooltip elements\r\n      const allElements = container.querySelectorAll(\r\n        \"[data-tooltip], .encounter-rp-icon, .encounter-flavor-tag\"\r\n      );\r\n\r\n      allElements.forEach((element) => {\r\n        try {\r\n          // Find tooltip element - could be .tooltip-text or [role=\"tooltip\"]\r\n          const tooltipText = element.querySelector(\r\n            '.tooltip-text, [role=\"tooltip\"]'\r\n          ) as HTMLElement;\r\n          if (!tooltipText) return;\r\n\r\n          // Make tooltip temporarily visible for measurement\r\n          tooltipText.style.visibility = \"hidden\";\r\n          tooltipText.style.display = \"block\";\r\n          tooltipText.style.opacity = \"1\";\r\n\r\n          const tooltipRect = tooltipText.getBoundingClientRect();\r\n          const elementRect = element.getBoundingClientRect();\r\n\r\n          // Calculate available space in each direction\r\n          const spaceAbove = elementRect.top - containerRect.top;\r\n          const spaceBelow = containerRect.bottom - elementRect.bottom;\r\n          const spaceLeft = elementRect.left - containerRect.left;\r\n          const spaceRight = containerRect.right - elementRect.right;\r\n\r\n          // Position horizontally based on available space\r\n          if (tooltipRect.width > spaceRight && spaceLeft > spaceRight) {\r\n            // More space on left than right\r\n            tooltipText.style.left = \"auto\";\r\n            tooltipText.style.right = \"0\";\r\n            tooltipText.style.transform = \"translateX(0)\";\r\n          } else if (tooltipRect.width > spaceLeft && spaceRight > spaceLeft) {\r\n            // More space on right than left\r\n            tooltipText.style.left = \"0\";\r\n            tooltipText.style.right = \"auto\";\r\n            tooltipText.style.transform = \"translateX(0)\";\r\n          } else {\r\n            // Center if enough space\r\n            tooltipText.style.left = \"50%\";\r\n            tooltipText.style.right = \"auto\";\r\n            tooltipText.style.transform = \"translateX(-50%)\";\r\n          }\r\n\r\n          // Position vertically based on available space\r\n          if (tooltipRect.height > spaceBelow && spaceAbove > spaceBelow) {\r\n            // More space above than below\r\n            tooltipText.style.bottom = \"100%\";\r\n            tooltipText.style.top = \"auto\";\r\n          } else {\r\n            // Default to below\r\n            tooltipText.style.top = \"100%\";\r\n            tooltipText.style.bottom = \"auto\";\r\n          }\r\n\r\n          // Reset visibility\r\n          tooltipText.style.visibility = \"visible\";\r\n          tooltipText.style.display = \"\";\r\n          tooltipText.style.opacity = \"\";\r\n        } catch (error) {\r\n          // Ignore any getBoundingClientRect errors that might occur\r\n          console.debug(\"Tooltip positioning skipped:\", error);\r\n        }\r\n      });\r\n    };\r\n\r\n    // Initial adjustment after a short delay to ensure elements are rendered\r\n    const timeoutId = setTimeout(adjustTooltips, 100);\r\n\r\n    // Adjust on resize\r\n    window.addEventListener(\"resize\", adjustTooltips);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"resize\", adjustTooltips);\r\n      clearTimeout(timeoutId);\r\n    };\r\n  }, [positions, flavorTags]);\r\n\r\n  const getScoreForPosition = (position: string): number => {\r\n    const topPercentage = parseFloat(position);\r\n\r\n    // Check which band the tag is in\r\n    if (topPercentage <= 20) {\r\n      return bandLabels[0].score; // Top band - Organic Conversation\r\n    } else if (topPercentage <= 55) {\r\n      return bandLabels[1].score; // Middle band - Guided Interactions\r\n    } else {\r\n      return bandLabels[2].score; // Bottom band - Off Topic\r\n    }\r\n  };\r\n\r\n  const handleTagClick = (flavorTag: RPEncounterFlavorTag, index: number) => {\r\n    const tagPosition = positions[index];\r\n    const score = getScoreForPosition(tagPosition.top);\r\n\r\n    setFreeTags(freeTags - 1);\r\n\r\n    if (freeTags > 0) {\r\n     // partyManager.addPartyScore(score);\r\n     campaignManager.collectEncounterPoints(score);\r\n    }\r\n\r\n    //chatManager.roleplayingEvent(flavorTag);\r\n\r\n    campaignManager.selectRoleplayFlavorTag(flavorTag, freeTags);\r\n    setFlavorTags(campaignManager.generateRoleplayEventTags());\r\n  };\r\n  const description = campaignManager.getCurrentEvent()?.flavorText || \"\";\r\n\r\n  const instructions =\r\n    freeTags > 0\r\n      ? description\r\n      : `You may keep roleplaying, but your players are growing bored.`;\r\n  const getPlayerAttitudesStyle = (tag: Tag) => {\r\n    return uiManager.getPlayerAttitudesStyle(tag);\r\n  };\r\n\r\n  const pressHurryButton = () => {\r\n    if (freeTags > 0) {\r\n      partyManager.addPartyTension(10);\r\n      setFreeTags(freeTags - 1);\r\n\r\n      chatManager.dmMessage([\r\n        \"Lets moooove along!\",\r\n        \"Blah Blah blah\",\r\n        \"Theres a lot more game to get to.\",\r\n      ]);\r\n      setFlavorTags(campaignManager.generateRoleplayEventTags());\r\n    } else {\r\n      campaignManager.backToOverview();\r\n    }\r\n  };\r\n\r\n  const getLegend = () => {\r\n    const characters = characterManager.getPlayerCharacters();\r\n\r\n    return (\r\n      <div className=\"roleplay-legend\">\r\n        <div className=\"legend-section\">\r\n          <div className=\"legend-row\">\r\n            <div className=\"sample-tag text-pill type-location\">Location</div>\r\n            <div className=\"sample-desc\">Describe the environment</div>\r\n          </div>\r\n          <div className=\"legend-row\">\r\n            <div className=\"sample-tag text-pill type-encounter\">\r\n              Foreshadow\r\n            </div>\r\n            <div className=\"sample-desc\">Hint about an upcoming encounter</div>\r\n          </div>\r\n          <div className=\"legend-row\">\r\n            <div className=\"sample-tag text-pill type-all\">New Topic</div>\r\n            <div className=\"sample-desc\">Introduce/entertain new ideas</div>\r\n          </div>\r\n          <div className=\"legend-row\">\r\n            <div className=\"sample-tag text-pill type-rumor\">Resolve Topic</div>\r\n            <div className=\"sample-desc\">\r\n              Integrate/confirm introduced topics\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"legend-section\">\r\n          <div className=\"legend-column\">\r\n            <div className=\"legend-watchfor-container\">\r\n              <div className=\"sample-tag text-pill type-backstory\">\r\n                Backstory\r\n              </div>\r\n              <div className=\"sample-tag text-pill type-magic-item\">\r\n                Magic Item\r\n              </div>\r\n              <div className=\"sample-tag text-pill type-plot-hook\">\r\n                Plot Hooks\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"legend-section attitudes\">\r\n          <div className=\"legend-player-row\">\r\n            <div className=\"legend-player-column\">\r\n              <div className=\"legend-title\">Player Attitudes:</div>\r\n              <div className=\"attitude-row\">\r\n                <span className=\"attitude like\">Like</span>\r\n                <span className=\"attitude hate\">Hate</span>\r\n                <span className=\"attitude neutral\">Mixed</span>\r\n              </div>\r\n            </div>\r\n            <div className=\"legend-player-column\">\r\n              <div className=\"encounter-rp-icon-container\">\r\n                <div className=\"legend-player-row\">\r\n                  {characters.map((character, index) => (\r\n                    <CImage\r\n                      key={`char-${character.id}-${index}`}\r\n                      imageId={character.icon}\r\n                    />\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"legend-character-info\">+2/-1 Attention</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n  const getInstructions = () => {\r\n    const instructions = [\r\n      \"Click on the topics below to discuss.\",\r\n      \"Players will lose attention after losing patience.\",\r\n      \"Increase tension by hurrying the players.\",\r\n    ];\r\n    return <InstructionsPanel instructions={instructions} />;\r\n  };\r\n\r\n  return (\r\n    <div className=\"encounter-roleplay-container\">\r\n      <EncounterHeader\r\n        title={`Roleplay in ${encounter.location.name}`}\r\n        description={instructions}\r\n        leftContent={getInstructions()}\r\n        rightContent={\r\n          <div className=\"encounter-roleplay-skill-container\">\r\n            <FillBar\r\n              totalSegments={5}\r\n              filledSegments={freeTags}\r\n              theme=\"engagement\"\r\n              label=\"Party Patience\"\r\n            />\r\n            <div\r\n              className={`encounter-roleplay-hurry-button`}\r\n              onClick={() => pressHurryButton()}\r\n            >\r\n              {freeTags > 0 ? \"Hurry Players\" : \"End Roleplay\"}\r\n            </div>\r\n            <div className=\"encounter-roleplay-hurry-text\">\r\n              {freeTags > 0 ? \"+10 Tension\" : \"\"}\r\n            </div>\r\n          </div>\r\n        }\r\n        instructions={[true, false]}\r\n      />\r\n      <div\r\n        className={`encounter-roleplay-flavor-tags-container  ${\r\n          freeTags <= 0 ? \"disabled\" : \"\"\r\n        } `}\r\n        ref={containerRef}\r\n      >\r\n        {bandLabels.map((label, index) => (\r\n          <div\r\n            key={`band-label-${index}`}\r\n            className={`band-label ${freeTags <= 0 ? \"disabled\" : \"\"} `}\r\n            style={{ top: label.top }}\r\n          >\r\n            {label.text}\r\n            <DiceScore\r\n              score={label.score}\r\n              className=\"band-score\"\r\n              />\r\n          </div>\r\n        ))}\r\n        {flavorTags.map((flavorTag, index) => {\r\n          if (flavorTag.tag) {\r\n            return (\r\n              <FlavorTagPill\r\n                key={index}\r\n                tag={flavorTag.tag}\r\n                style={positions[index]}\r\n                onClick={() => handleTagClick(flavorTag, index)}\r\n                className={`text-pill theme-${\r\n                  flavorTag.tag.theme\r\n                } type-${flavorTag.tag.source} ${getPlayerAttitudesStyle(\r\n                  flavorTag.tag.tag\r\n                )}`}\r\n                tooltipText={tagManager.getTooltipText(flavorTag)}\r\n              />\r\n            );\r\n          } else if (flavorTag.type === \"treasure\") {\r\n            // Convert treasure type to FlavorTagSource.TREASURE\r\n            return (\r\n              <FlavorTagPill\r\n                key={index}\r\n                tag={{\r\n                  tag: { name: \"Treasure\" },\r\n                  source: FlavorTagSource.TREASURE,\r\n                  theme: FlavorTagTheme.NONE,\r\n                }}\r\n                style={positions[index]}\r\n                onClick={() => handleTagClick(flavorTag, index)}\r\n                tooltipText={tagManager.getTooltipText(flavorTag)}\r\n                className=\"encounter-flavor-tag\"\r\n              />\r\n            );\r\n          } else if (flavorTag.type === \"dmpoint\") {\r\n            // Convert dmpoint type to FlavorTagSource.DM_POINT\r\n            return (\r\n              <FlavorTagPill\r\n                key={index}\r\n                tag={{\r\n                  tag: { name: \"DM Point\" },\r\n                  source: FlavorTagSource.DM_POINT,\r\n                  theme: FlavorTagTheme.NONE,\r\n                }}\r\n                style={positions[index]}\r\n                onClick={() => handleTagClick(flavorTag, index)}\r\n                tooltipText={tagManager.getTooltipText(flavorTag)}\r\n                className=\"encounter-flavor-tag\"\r\n              />\r\n            );\r\n          } else {\r\n            return (\r\n              <div\r\n                key={index}\r\n                className={`encounter-rp-icon theme-character`}\r\n                style={positions[index]}\r\n                data-tooltip={`${tagManager.getTooltipText(flavorTag)}`}\r\n                onClick={() => handleTagClick(flavorTag, index)}\r\n              >\r\n                <TooltipWrapper\r\n                  content={`Click to focus on ${\r\n                    flavorTag.character?.name\r\n                  }. This may bore some of your players, but ${\r\n                    playerManager.getPlayerAssignedCharacter(\r\n                      flavorTag.character\r\n                    )?.name\r\n                  } will like it.`}\r\n                  preservePositioning={true}\r\n                  translate={[-30, -150]}\r\n                >\r\n                  <div className=\"encounter-rp-icon-container\">\r\n                    <CImage\r\n                      imageId={flavorTag.character?.icon || \"icon_character\"}\r\n                    />\r\n                  </div>\r\n                </TooltipWrapper>\r\n              </div>\r\n            );\r\n          }\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GameEncounterRoleplay;\r\n","import React from 'react';\nimport { Character } from '../../models';\nimport CImage from '../UI/cimage';\n\ninterface CharacterTokenProps {\n    character: Character;\n    isSelected?: boolean;\n    onClick?: (e: React.MouseEvent<HTMLDivElement>) => void;\n    mini?: boolean;\n    style?: React.CSSProperties;\n    'data-character-id'?: string;  // Add this prop for animation targeting\n    className?:string;\n    \n  }\n\n  const CharacterToken: React.FC<CharacterTokenProps> = ({ \n    character, \n    isSelected = false, \n    onClick,\n    mini = false,\n    style = {},\n    'data-character-id': characterId,\n    className = ''\n  }) => {\n    return (\n      <div \n        className={`character-token ${isSelected ? 'selected' : ''} ${mini ? 'mini' : ''}  ${className}`}\n        onClick={onClick}\n        style={style}\n        data-character-id={characterId}\n      >\n        <div className=\"character-icon\">\n          <CImage imageId={character.icon} />\n        </div>\n        {!mini && (\n          <div className=\"character-name\">\n            {character.name}\n          </div>\n        )}\n      </div>\n    );\n  };\nexport default CharacterToken;","import { BUILDING_EFFECT_TYPE, BuildingEffect, Character, EncounterFlavorTag, Tag, TownBuilding } from \"../../models\";\r\nimport { useAppManager } from \"../managerContexts\";\r\nimport CImage from \"../UI/cimage\";\r\nimport DiceScore from \"../UI/DiceScore\";\r\nimport CharacterToken from \"./characterToken\";\r\nimport './town.scss';\r\n\r\ninterface BuildingCardProps {\r\n    building: TownBuilding;\r\n    onClick: (e: React.MouseEvent<HTMLDivElement>) => void;  // Update to pass event\r\n    isSelectable: boolean;\r\n    'data-building-id'?: string;  // Add this prop for animation targeting\r\n    onCharacterClick: (character: Character, rect: DOMRect) => void;  // Add this\r\n    onTagClick: (tag: EncounterFlavorTag, building: TownBuilding) => void;\r\n  }\r\n  \r\n\r\n  const BuildingCard: React.FC<BuildingCardProps> = ({ \r\n    building, \r\n    onClick, \r\n    isSelectable,\r\n    'data-building-id': buildingId ,\r\n    onCharacterClick,\r\n    onTagClick,\r\n  }) => {\r\n    const appManager = useAppManager();\r\n    const townManager = appManager.getTownManager();\r\n    const uiManager = appManager.getUiManager();\r\n\r\n\r\n    const renderPositionEffect = (effect: BuildingEffect) => {\r\n      const value = effect.value;\r\n      const effectType = effect.type;\r\n      let isIcon = false; \r\n      let iconText = '';\r\n      let iconId = '';\r\n      let textClass = ';'\r\n      switch(effectType) {\r\n        case BUILDING_EFFECT_TYPE.CAMPAIGN_POINT:\r\n       //   isIcon = true;\r\n       return (\r\n        <DiceScore\r\n          score = {effect.value}\r\n          />\r\n       )\r\n         // iconId = 'icon_dmpoint';\r\n          break;\r\n        // case BUILDING_EFFECT_TYPE.ADD_PLAYER_POINT:\r\n        //   isIcon = true;\r\n        //   iconId = 'icon_playerpoint';\r\n        //   break;\r\n        case BUILDING_EFFECT_TYPE.ADD_TREASURE:\r\n          isIcon = true;\r\n          iconId = 'icon_treasure1';\r\n          break;\r\n         case BUILDING_EFFECT_TYPE.ADD_ENJOYMENT:\r\n            iconText = value > 0 ? '😊' : '😞'\r\n          break;\r\n        case BUILDING_EFFECT_TYPE.ADD_TENSION:\r\n           iconText = '' + value;  \r\n          if(value > 0) {\r\n            iconText = '+' + iconText;\r\n              textClass = ' tension-up';\r\n            }else{\r\n              textClass = ' tension-down';\r\n            }\r\n            return (\r\n              <div className='effect-score'>\r\n                <div className ={'effect-score-label'}>\r\n                  TENSION\r\n                </div>\r\n                <div className ={'effect-score-value'}>\r\n                  {iconText}\r\n                </div>\r\n              </div>\r\n            )\r\n          break;\r\n        // case BUILDING_EFFECT_TYPE.ADD_SCORE:\r\n        //   return (\r\n        //     <div className='effect-score'>\r\n        //       <div className ={'effect-score-label'}>\r\n        //         SCORE\r\n        //       </div>\r\n        //       <div className ={'effect-score-value'}>\r\n        //         +{value}\r\n        //       </div>\r\n        //     </div>\r\n        //   )\r\n        //   break;\r\n        case BUILDING_EFFECT_TYPE.INJURE:\r\n          iconText = '💔';\r\n          break;\r\n      }\r\n\r\n      if(isIcon) {\r\n         return (\r\n          <div className={`effect-display-icon ${textClass}`}>\r\n            <CImage imageId={iconId} />\r\n          </div>\r\n        )\r\n\r\n      } else {\r\n        return (\r\n          <div className={`effect-emoji-display ${textClass}`}>\r\n            {iconText}\r\n          </div>\r\n        )\r\n      }\r\n\r\n     \r\n    }\r\n\r\n\r\n\r\n    const renderEffect = (effect: any) => {\r\n\r\n      let effectString = '';\r\n      let effectClass = '';\r\n    \r\n      switch(effect.type) {\r\n        case BUILDING_EFFECT_TYPE.ADD_TENSION:\r\n          effectString = (effect.value > 0 ? '+' : '') +  effect.value + ' tension';\r\n          effectClass = 'tension-' + (effect.value > 0 ? 'up' : 'down');\r\n          break;\r\n        case BUILDING_EFFECT_TYPE.ADD_ENJOYMENT:\r\n          effectString=  effect.value > 0 ? '😊' : '😞';\r\n          break;\r\n        // case BUILDING_EFFECT_TYPE.ADD_INVOLVEMENT:\r\n        //   effectString = (effect.value > 0 ? '+' : '') +  effect.value + ' tension';\r\n        //   effectClass = 'attention-' + (effect.value > 0 ? 'up' : 'down');\r\n\r\n        //   break;\r\n        // case BUILDING_EFFECT_TYPE.ADD_REWARDS:\r\n        //   effectString = effect.value + ' rewards';\r\n        //   break;\r\n        case BUILDING_EFFECT_TYPE.REPLENISH_MAGIC:\r\n          effectString = '✨';\r\n          break;\r\n        case BUILDING_EFFECT_TYPE.REPLENISH_TOOLS:\r\n          effectString = '🔧';\r\n          break;\r\n        // case BUILDING_EFFECT_TYPE.ADD_BACKSTORY:\r\n        //   effectString = 'backstory';\r\n        //   break;\r\n        case BUILDING_EFFECT_TYPE.HEAL:\r\n          effectString = '❤️';\r\n          break;\r\n        case BUILDING_EFFECT_TYPE.RESURRECT:\r\n          effectString = '🔄';\r\n          break;\r\n        case BUILDING_EFFECT_TYPE.INJURE:\r\n          effectString = '💔';\r\n          break;\r\n        case BUILDING_EFFECT_TYPE.USE_TOOLS:\r\n          effectClass = 'use-tools';\r\n          effectString = '-🔧';\r\n          break;\r\n        case BUILDING_EFFECT_TYPE.USE_MAGIC:\r\n          effectClass = 'use-magic';\r\n          effectString = '-✨';\r\n          break;\r\n        //case BUILDING_EFFECT_TYPE.CAMPAIGN_POINT:\r\n          // return (\r\n          //   <div className=\"effect-display-icon\">\r\n          //     <CImage imageId=\"icon_dmpoint\" />\r\n          //   </div>\r\n          // );\r\n      //    effectClass = 'dm-point';\r\n      //    effectString = '🎲';\r\n    \r\n        // case BUILDING_EFFECT_TYPE.ADD_PLAYER_POINT:\r\n        //   return (\r\n        //     <div className=\"effect-display-icon\">\r\n        //       <CImage imageId=\"icon_playerpoint\" />\r\n        //     </div>\r\n        //   );\r\n      //  break;\r\n        case BUILDING_EFFECT_TYPE.ADD_TREASURE:\r\n          return (\r\n            <div className=\"effect-display-icon\">\r\n              <CImage imageId=\"icon_treasure1\" />\r\n            </div>\r\n          );\r\n       \r\n\r\n\r\n        default:\r\n          effectString += effect.type;\r\n      }\r\n\r\n      return (\r\n        <div className={`town-effect-display ${effectClass}`}>\r\n          {effectString}\r\n        </div>\r\n      );\r\n\r\n    }\r\n\r\n\r\n\r\n    return (\r\n        <div \r\n          className={`building-card ${isSelectable ? 'selectable' : ''}`}\r\n          style={{\r\n            left: `${building.position?.x}%`,\r\n            top: `${building.position?.y}%`,\r\n            width: `${building.size?.width}px`,\r\n            height: `${building.size?.height}px`\r\n          }}\r\n          onClick={onClick}\r\n          data-building-id={buildingId}\r\n        >\r\n        <div className=\"building-header\">\r\n          <div className=\"building-name\">{building.building.name}</div>\r\n       \r\n          <div className=\"effect-row\">\r\n            {building.effects.map((effect, index) => (\r\n                <div key={index} className={`effect ${effect.type}`}>\r\n                  {renderEffect(effect)}\r\n                </div>\r\n            ))}\r\n          </div>\r\n                               \r\n          </div>\r\n          \r\n       \r\n        \r\n        {/* <div className=\"building-tags\">\r\n        {building.tags.map((flavorTag, index) => {\r\n          const isResolved = building.resolvedTags.some(t => t.name === flavorTag.tag.name);\r\n          return (\r\n            <div \r\n              key={index}\r\n              className={`tag text-pill type-${flavorTag.source} ${uiManager.getPlayerAttitudesStyle(flavorTag.tag)} theme-${flavorTag.theme} ${building.isHighlighted ? 'clickable' : ''} ${isResolved ? 'resolved' : ''}`}// className={`text-pill type-${flavorTag.source} ${uiManager.getPlayerAttitudesStyle(flavorTag.tag)} theme-${flavorTag.theme}`}>\r\n              onClick={() => {\r\n                if (building.isHighlighted && !isResolved) {\r\n                  onTagClick(flavorTag, building);\r\n                }\r\n              }}\r\n            >\r\n              {flavorTag.tag.name}\r\n            </div>\r\n          );\r\n        })}\r\n      </div> */}\r\n        \r\n        <div className=\"visitor-slots\">\r\n                {Array(building.capacity).fill(0).map((_, index) => (\r\n                    <div key={index} className={`slot ${index < building.currentVisitors.length ? 'occupied' : ''}`}>\r\n                        {building.currentVisitors[index] ? (\r\n                          \r\n                             <CharacterToken \r\n                                character={building.currentVisitors[index]} \r\n                                mini \r\n                                onClick={(e) => onCharacterClick(\r\n                                    building.currentVisitors[index], \r\n                                    e.currentTarget.getBoundingClientRect()\r\n                                )} \r\n                            />\r\n                          \r\n                           \r\n                        ) : (\r\n                          <div className=\"slot-effect\">\r\n                                {building.positionEffects[index].map((effect, index) => (\r\n                                    <div key={index} className={`effect ${effect.type}`}>\r\n                                      {renderPositionEffect(effect)}\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n          \r\n                        )}\r\n                    </div>\r\n\r\n                ))}\r\n            </div>\r\n            <div className={`building-effect ${building.isHighlighted ? 'hidden' : ''}`}>\r\n            {building.building.description}\r\n          </div>\r\n            {building.isHighlighted && (\r\n                <div className=\"interaction-hint\">\r\n                    Click on tags to gain their effects\r\n                </div>\r\n            )}\r\n      </div>\r\n    );\r\n  };\r\n\r\nexport default BuildingCard;","import React from 'react';\r\nimport { Character } from '../../models';\r\nimport './characterSelector.scss';\r\nimport CharacterToken from './characterToken';\r\n\r\ninterface CharacterSelectorProps {\r\n  characters: Character[];\r\n  selectedCharacter: Character | null;\r\n  onCharacterClick: (character: Character, elementRect: DOMRect) => void;\r\n  exhaustion?: number;\r\n  onRandomClick?: () => void;\r\n  onEndClick?: () => void;\r\n}\r\n\r\nconst CharacterSelector: React.FC<CharacterSelectorProps> = ({\r\n  characters,\r\n  selectedCharacter,\r\n  onCharacterClick,\r\n  exhaustion,\r\n  onRandomClick,\r\n  onEndClick\r\n}) => {\r\n  return (\r\n    <div className=\"character-holder\">\r\n      <div className=\"characters-title\">\r\n        {exhaustion === 0 ? 'Click a Character' : `Next action ${exhaustion} Party Exhaustion`}\r\n      </div>\r\n      \r\n      <div className=\"characters-display\">\r\n        <div className=\"characters-row\">\r\n          {onRandomClick && (\r\n            <div className=\"selector-button random-button\" onClick={onRandomClick}>\r\n              RANDOM\r\n            </div>\r\n          )}\r\n          <div className = \"character-selector-line\">\r\n          {characters.map((character, index) => (\r\n            <CharacterToken\r\n              key={index}\r\n              character={character}\r\n              isSelected={selectedCharacter === character}\r\n              onClick={(e) => onCharacterClick(character, e.currentTarget.getBoundingClientRect())}\r\n              data-character-id={String(character.id)}\r\n            />\r\n\r\n          ))}\r\n          </div>\r\n          {onEndClick && (\r\n            <div className=\"selector-button end-button\" onClick={onEndClick}>\r\n              LEAVE\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CharacterSelector;\r\n","import { Building, BUILDING_TYPE } from \"../models\";\nimport { TAG } from \"./tags\";\n\nexport const BUILDINGS: Record<string,Building> = {\n    \"BARRACKS\": {\n        name: \"Barracks\",\n        type: BUILDING_TYPE.BARRACKS,\n        description: \"Train and improve combat skills\",\n        tags: [TAG.WEAPONS, TAG.ARMOR],\n        effects: []\n    },\n    \"TEMPLE\": {\n        name: \"Temple\",\n        type: BUILDING_TYPE.TEMPLE,\n        description: \"Heal wounds or resurrect fallen heroes\",\n        tags: [TAG.MAGIC, TAG.HEALING],\n        effects: []\n\n    },\n    \"SHOP\": {\n        name: \"Shop\",\n        type: BUILDING_TYPE.SHOP,\n        description: \"Replenish tools and find magic items.\",\n        tags: [TAG.TOOLS, TAG.WEAPONS],\n        allowMagicItems: true,\n        effects: []\n    },\n    \"MARKETPLACE\": {\n        name: \"Marketplace\",\n        type: BUILDING_TYPE.SHOP,\n        description: \"Replenish tools and find magic items.\",\n        tags: [TAG.TOOLS],\n       // allowMagicItems: true,\n        effects: []\n    },\n    \"TAVERN\": {\n        name: \"Tavern\",\n        type: BUILDING_TYPE.TAVERN,\n        description: \"Gossip, rumors, and conversation.\",\n        tags: [],\n        addFriendlyTags: true,\n        effects: []\n    },\n    \n    \"GUILD_HALL\": {\n        name: \"Guild Hall\",\n        type: BUILDING_TYPE.GUILD_HALL,\n        description: \"Replenish Magic, Level Up, and find magic items.\",\n        tags: [TAG.LEVEL_UP],\n        allowMagicItems: true,\n        effects: []\n    },\n    \"LIBRARY\": {\n        name: \"Library\",\n        type: BUILDING_TYPE.LIBRARY,\n        description: \"Replenish Magic\",\n        tags: [TAG.BOOKS],\n        effects: []\n    },\n    \"FIRE\": {\n        name: \"Fire\",\n        type: BUILDING_TYPE.FIRE,\n        description: \"Replenish ✨, 🔧\",\n        tags: [],\n        effects: []\n    },\n    \"CONFRONTATION\": {\n        name: \"Confrontation\",\n        type: BUILDING_TYPE.CONFRONTATION,\n        description: \"Increase Stress, chance of reduced attitude\",\n        tags: [],\n        addFriendlyTags: true,\n        effects: []\n    }\n}\n\nexport const DEFAULT_TOWN_BUILDINGS: Building[] = [\n    BUILDINGS.BARRACKS,\n    BUILDINGS.TEMPLE,\n    BUILDINGS.SHOP,\n    BUILDINGS.MARKETPLACE,\n    BUILDINGS.TAVERN,\n    BUILDINGS.GUILD_HALL,\n    BUILDINGS.LIBRARY,\n    BUILDINGS.FIRE,\n    BUILDINGS.CONFRONTATION\n];\n\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport {\r\n  Encounter,\r\n  Character,\r\n  Tag,\r\n  TownBuilding,\r\n  BUILDING_TYPE,\r\n  EncounterFlavorTag,\r\n  BuildingEffect,\r\n  BUILDING_EFFECT_TYPE,\r\n  Building,\r\n  ResultConfig,\r\n} from \"../../models\";\r\nimport EncounterHeader from \"./encounterHeader\";\r\n\r\nimport \"./town.scss\";\r\nimport {\r\n  useAppManager,\r\n  useCampaignManager,\r\n  useCharacterManager,\r\n} from \"../managerContexts\";\r\nimport BuildingCard from \"./buildingCard\";\r\nimport CharacterToken from \"./characterToken\";\r\nimport CharacterSelector from \"./characterSelector\";\r\nimport { DEFAULT_TOWN_BUILDINGS } from \"../../consts/buildings\";\r\nimport InstructionsPanel from \"../UI/InstructionsPanel\";\r\n\r\ninterface GameEncounterTownProps {\r\n  encounter: Encounter;\r\n}\r\n\r\nconst GameEncounterTown: React.FC<GameEncounterTownProps> = ({ encounter }) => {\r\n  const appManager = useAppManager();\r\n  const townManager = appManager.getTownManager();\r\n  const characterManager = useCharacterManager();\r\n  const [buildings, setBuildings] = useState<TownBuilding[]>([]);\r\n  const [selectedCharacter, setSelectedCharacter] = useState<Character | null>(\r\n    null\r\n  );\r\n  const [characters, setCharacters] = useState<Character[]>(\r\n    characterManager.getCharacters()\r\n  );\r\n  const [exhaustion, setExhaustion] = useState<number>(0);\r\n  const [assignedCharacters, setAssignedCharacters] = useState<Set<string>>(\r\n    new Set()\r\n  );\r\n  const [townResultsVisible, setTownResultsVisible] = useState(false);\r\n  const [selectedBuilding, setSelectedBuilding] = useState<TownBuilding | null>(null);\r\n  const [remainingTags, setRemainingTags] = useState<number>(0);\r\n  const [townResultConfig, setTownResultConfig] = useState<\r\n    ResultConfig | undefined\r\n  >();\r\n\r\n  const [animatingCharacter, setAnimatingCharacter] = useState<{\r\n    character: Character;\r\n    from: DOMRect;\r\n    to: DOMRect;\r\n  } | null>(null);\r\n  const [autoAssign, setAutoAssign] = useState<boolean>(true);\r\n  const campaignManager = useCampaignManager();\r\n\r\n  // Add this helper function\r\n  const getAvailableBuildings = () => {\r\n    return buildings.filter((b) => b.currentVisitors.length < b.capacity);\r\n  };\r\n\r\n  const generateTownBuildings = useCallback((encounter: Encounter): TownBuilding[] => {\r\n    const buildingTypes = Object.values(BUILDING_TYPE);\r\n    const generatedBuildings: TownBuilding[] = [];\r\n\r\n    // Random number of buildings between 4 and 7\r\n    const minBuildings = encounter.town?.[0]?.nbBuildings[0] || 4;\r\n    const maxBuildings = encounter.town?.[0]?.nbBuildings[1] || 7;\r\n\r\n    const numBuildings =\r\n      minBuildings +\r\n      Math.floor(Math.random() * (maxBuildings - minBuildings + 1));\r\n\r\n    // Create a grid system to help with positioning\r\n    const gridCellsX = 4; // 4x4 grid\r\n    const gridCellsY = 3; // 4x4 grid\r\n\r\n    const cellWidth = 100 / gridCellsX;\r\n    const cellHeight = 100 / gridCellsY;\r\n    const usedCells: Set<string> = new Set();\r\n\r\n    const availableBuildings = [\r\n      ...(encounter.town?.[0]?.buildings || DEFAULT_TOWN_BUILDINGS),\r\n    ];\r\n\r\n    const requiredBuildings = availableBuildings.filter(\r\n      (b) => b.required\r\n    );\r\n\r\n\r\n    for (let i = 0; i < numBuildings; i++) {\r\n      // Pick random building type\r\n      const randomBuilding =\r\n        requiredBuildings.length > i\r\n          ? requiredBuildings[i]\r\n          : availableBuildings[\r\n              Math.floor(Math.random() * availableBuildings.length)\r\n            ];\r\n\r\n\r\n      // remove that building from the list\r\n      availableBuildings.splice(availableBuildings.indexOf(randomBuilding), 1);\r\n\r\n      // Find an unused grid cell\r\n      let cellX: number, cellY: number;\r\n      do {\r\n        cellX = Math.floor(Math.random() * gridCellsX);\r\n        cellY = Math.floor(Math.random() * gridCellsY);\r\n      } while (usedCells.has(`${cellX},${cellY}`));\r\n\r\n      usedCells.add(`${cellX},${cellY}`);\r\n\r\n      // Add some randomness to position within cell\r\n      const x = cellX * cellWidth + Math.random() * (cellWidth / 4);\r\n      const y = cellY * cellHeight; //+ (Math.random() * (cellHeight/4));\r\n\r\n      // Random size variations\r\n      const width = 200 + Math.random() * 100;\r\n      const height = 150 + Math.random() * 50;\r\n      const capacity = Math.max(randomBuilding.maxCapacity || 1, (Math.floor(Math.random() * 2) + 1)); // Random capacity between 1 and 3\r\n      const building: TownBuilding = {\r\n        building: randomBuilding,\r\n        tags: townManager.getTagsForBuilding(randomBuilding),\r\n        resolvedTags: [], \r\n        capacity,\r\n        currentVisitors: [],\r\n        effects: [...randomBuilding.effects],\r\n        positionEffects: getPositionEffects(randomBuilding, capacity),\r\n        //\tscore: Math.floor(Math.random() * 5) * 5 + 5,\r\n        position: {\r\n          x,\r\n          y,\r\n        },\r\n        id: `${i}`,\r\n      };\r\n\r\n      generatedBuildings.push(building);\r\n    }\r\n    return generatedBuildings;\r\n  }, [townManager]);\r\n\r\n  const renderResultInfo = () => {\r\n    if (!townResultConfig) return null;\r\n    return (\r\n      <> \r\n        <div className=\"town-result-info-item\"> </div> \r\n      </>\r\n    );\r\n  };\r\n\r\n  const closeResultModal = () => {\r\n    setTownResultsVisible(false);\r\n    setTownResultConfig(undefined);\r\n  };\r\n\r\n  const handleTagClick = useCallback((\r\n    flavorTag: EncounterFlavorTag,\r\n    building: TownBuilding\r\n  ) => {\r\n\r\n\r\n\r\n    campaignManager.exposeTag(flavorTag);    // Update buildings state to mark tag as resolved\r\n    const updatedBuildings = buildings.map((b) => {\r\n      if (b.id === building.id) {\r\n        const updatedBuilding = {\r\n          ...b,\r\n          isHighlighted: false,\r\n          resolvedTags: [...b.resolvedTags, flavorTag.tag],\r\n        };\r\n        // Update selectedBuilding if this is the one we're viewing\r\n        if (selectedBuilding && selectedBuilding.id === b.id) {\r\n          setSelectedBuilding(updatedBuilding);\r\n        }\r\n        return updatedBuilding;\r\n      }\r\n      return b;\r\n    });\r\n    setBuildings(updatedBuildings);\r\n\r\n    const buildingElement = document.querySelector(\r\n      `[data-building-id=\"${building.id}\"]`\r\n    );\r\n    if (buildingElement) {\r\n      buildingElement.classList.remove(\"highlight\");\r\n    }\r\n  }, [appManager, campaignManager, buildings, selectedBuilding]);\r\n\r\n  const townResultTagClick = useCallback((tag: EncounterFlavorTag) => {\r\n    if (!townResultConfig || !selectedBuilding) return;\r\n    setRemainingTags((prev) => prev - 1);\r\n appManager.getUiManager().closeModal();\r\n    handleTagClick(tag, selectedBuilding);\r\n    // There are only one clicks allowed in town so lets close the modal too for now.....\r\n   \r\n  setTownResultsVisible(false);\r\n  }, [townResultConfig, selectedBuilding, handleTagClick]);\r\n\r\n  // Show modal using the new TagModal system\r\n  useEffect(() => {\r\n    if (townResultsVisible && townResultConfig && selectedBuilding) {\r\n      appManager.getUiManager().showTagModal({\r\n        title: townResultConfig.title,\r\n        description: townResultConfig.description,\r\n        tags: townResultConfig.tags,\r\n        effects: townResultConfig.results,\r\n        selectedTags: selectedBuilding.resolvedTags,\r\n        remainingClicks: remainingTags,\r\n        tagInstructions: \"Click on the tags to reveal them.\",\r\n        onTagClick: townResultTagClick,\r\n        onClose: closeResultModal\r\n      });\r\n    }\r\n  }, [townResultsVisible, townResultConfig, selectedBuilding, remainingTags, appManager, townResultTagClick]);\r\n\r\n  const getPositionEffects = (\r\n    building: Building,\r\n    capacity: number\r\n  ): BuildingEffect[][] => {\r\n    // Restrict position effects from using the same effect as the main building effect.\r\n\r\n    const randomEffect = () => {\r\n      if (Math.random() < 0.5) {\r\n        return { type: BUILDING_EFFECT_TYPE.NONE, value: 0 };\r\n      }\r\n      if (Math.random() < 0.3) {\r\n        switch (Math.floor(Math.random() * 9)) {\r\n          case 0:\r\n          case 1:\r\n          case 2:\r\n            if (\r\n              building.effects.some(\r\n                (effect) => effect.type === BUILDING_EFFECT_TYPE.ADD_TENSION\r\n              )\r\n            )\r\n              break;\r\n            return {\r\n              type: BUILDING_EFFECT_TYPE.ADD_TENSION,\r\n              value: Math.random() > 0.5 ? 5 : -5,\r\n            };\r\n          case 3:\r\n          case 4:\r\n            if (\r\n              building.effects.some(\r\n                (effect) => effect.type === BUILDING_EFFECT_TYPE.ADD_ENJOYMENT\r\n              )\r\n            )\r\n              break;\r\n            return {\r\n              type: BUILDING_EFFECT_TYPE.ADD_ENJOYMENT,\r\n              value: Math.random() > 0.5 ? 1 : -1,\r\n            };\r\n          case 5:\r\n            if (\r\n              building.effects.some(\r\n                (effect) => effect.type === BUILDING_EFFECT_TYPE.CAMPAIGN_POINT\r\n              )\r\n            )\r\n              break;\r\n            return { type: BUILDING_EFFECT_TYPE.CAMPAIGN_POINT, value: Math.floor(Math.random() * 4) + 1 };\r\n          // case 6:\r\n          //   if (\r\n          //     building.effects.some(\r\n          //       (effect) =>\r\n          //         effect.type === BUILDING_EFFECT_TYPE.ADD_PLAYER_POINT\r\n          //     )\r\n          //   )\r\n          //     break;\r\n          //   return { type: BUILDING_EFFECT_TYPE.ADD_PLAYER_POINT, value: 1 };\r\n          case 6:\r\n          case 7:\r\n            if (\r\n              building.effects.some(\r\n                (effect) => effect.type === BUILDING_EFFECT_TYPE.ADD_TREASURE\r\n              )\r\n            )\r\n              break;\r\n            return { type: BUILDING_EFFECT_TYPE.ADD_TREASURE, value: 1 };\r\n          case 8:\r\n            if (\r\n              building.effects.some(\r\n                (effect) => effect.type === BUILDING_EFFECT_TYPE.INJURE\r\n              )\r\n            )\r\n              break;\r\n            if (\r\n              building.effects.some(\r\n                (effect) => effect.type === BUILDING_EFFECT_TYPE.HEAL\r\n              )\r\n            )\r\n              break;\r\n            return { type: BUILDING_EFFECT_TYPE.INJURE, value: 1 };\r\n          default:\r\n            return { type: BUILDING_EFFECT_TYPE.ADD_TREASURE, value: 1 };\r\n        }\r\n      }\r\n\r\n      // if (Math.random() < 0.2) {\r\n      //   return { type: BUILDING_EFFECT_TYPE.ADD_SCORE, value: 20 };\r\n      // } else {\r\n      //   return {\r\n      //     type: BUILDING_EFFECT_TYPE.ADD_SCORE,\r\n      //     value: (Math.floor(Math.random() * 2) + 1) * 5,\r\n      //   };\r\n      // }\r\n       return { type: BUILDING_EFFECT_TYPE.ADD_TREASURE, value: 1 };\r\n    };\r\n\r\n    const positionEffects = Array.from({ length: capacity }, () => {\r\n      return [randomEffect()];\r\n    });\r\n\r\n    return positionEffects;\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Generate random buildings or use encounter-defined ones\r\n    const generatedBuildings = generateTownBuildings(encounter);\r\n    setBuildings(generatedBuildings);\r\n  }, [encounter, generateTownBuildings]);\r\n\r\n  // Add this new function\r\n  const assignCharacterToBuilding = (\r\n    character: Character,\r\n    building: TownBuilding,\r\n    fromRect: DOMRect,\r\n    buildingRect: DOMRect\r\n  ) => {\r\n    // Calculate target slot position\r\n    const slotIndex = building.currentVisitors.length;\r\n    const toRect = getSlotPosition(buildingRect, slotIndex, building.capacity);\r\n    // Start animation\r\n    setAnimatingCharacter({ character, from: fromRect, to: toRect });\r\n\r\n    // Force a reflow before applying transform\r\n    requestAnimationFrame(() => {\r\n      const animatingElement = document.querySelector(\r\n        \".character-token.animating\"\r\n      );\r\n      if (animatingElement) {\r\n        // Set CSS variables for the transform\r\n        (animatingElement as HTMLElement).style.setProperty(\r\n          \"--move-x\",\r\n          `${toRect.left - fromRect.left}px`\r\n        );\r\n        (animatingElement as HTMLElement).style.setProperty(\r\n          \"--move-y\",\r\n          `${toRect.top - fromRect.top}px`\r\n        );\r\n        // Add moving class to trigger animation\r\n        animatingElement.classList.add(\"moving\");\r\n      }\r\n    });\r\n\r\n    // Update assigned characters\r\n    setAssignedCharacters((prev) => new Set([...prev, String(character.id)]));\r\n\r\n    // After animation completes, update building and apply effect\r\n    setTimeout(() => {\r\n      setAnimatingCharacter(null);\r\n\r\n      // Update building\r\n      const updatedBuildings = buildings.map((b) => ({\r\n        ...b,\r\n        isHighlighted: b.id === building.id,\r\n        currentVisitors:\r\n          b.id === building.id\r\n            ? [...b.currentVisitors, character]\r\n            : b.currentVisitors,\r\n      }));\r\n      setBuildings(updatedBuildings);      // highlight building\r\n      const buildingElement = document.querySelector(\r\n        `[data-building-id=\"${building.id}\"]`\r\n      );\r\n      if (buildingElement) {\r\n        buildingElement.classList.add(\"highlight\");\r\n      }\r\n      \r\n      // Apply effect\r\n      setTimeout(() => {\r\n        const townResults = townManager.townBuildingResolved(character, building, slotIndex);\r\n        setTownResultConfig(townResults);\r\n        setRemainingTags(1);\r\n        setSelectedBuilding(building);\r\n        setTownResultsVisible(true);\r\n      }, 100);\r\n    }, 1000); // Match this with CSS animation duration\r\n  };\r\n\r\n  // Add this helper function to calculate slot position\r\n  const getSlotPosition = (\r\n    buildingRect: DOMRect,\r\n    slotIndex: number,\r\n    totalSlots: number\r\n  ) => {\r\n    const slotWidth = 100; // Width of character token in slot\r\n    const slotSpacing = 10; // Space between slots\r\n    //const totalWidth = (slotWidth * totalSlots) + (slotSpacing * (totalSlots - 1));\r\n    const startX = buildingRect.left + 42; //+ (buildingRect.width - totalWidth) / 2;\r\n    const y = buildingRect.bottom - 122; // Position slots near bottom of building\r\n\r\n    return new DOMRect(\r\n      startX + (slotWidth + slotSpacing) * slotIndex,\r\n      y,\r\n      slotWidth,\r\n      slotWidth\r\n    );\r\n  };\r\n  // Modify handleCharacterClick\r\n  const handleCharacterClick = (character: Character, elementRect: DOMRect) => {\r\n    //if (assignedCharacters.has(String(character.id))) return;\r\n\r\n    if (autoAssign) {\r\n      const availableBuildings = getAvailableBuildings();\r\n      if (availableBuildings.length > 0) {\r\n        const randomBuilding =\r\n          availableBuildings[\r\n            Math.floor(Math.random() * availableBuildings.length)\r\n          ];\r\n        const buildingElement = document.querySelector(\r\n          `[data-building-id=\"${randomBuilding.id}\"]`\r\n        );\r\n        if (buildingElement) {\r\n          const buildingRect = buildingElement.getBoundingClientRect();\r\n          assignCharacterToBuilding(\r\n            character,\r\n            randomBuilding,\r\n            elementRect,\r\n            buildingRect\r\n          );\r\n          townManager.townBuildingAssigned(character, randomBuilding);\r\n          if (exhaustion > 0) {\r\n            appManager.getPartyManager().exhaustParty(exhaustion);\r\n          }\r\n\r\n          setExhaustion(exhaustion + 2);\r\n        }\r\n      }\r\n    } else {\r\n      setSelectedCharacter(character);\r\n    }\r\n  };\r\n  // Modify handleBuildingClick\r\n  const handleBuildingClick = (\r\n    building: TownBuilding,\r\n    elementRect: DOMRect\r\n  ) => {\r\n    if (\r\n      !selectedCharacter ||\r\n      building.currentVisitors.length >= building.capacity\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    const characterElement = document.querySelector(\r\n      `[data-character-id=\"${selectedCharacter.id}\"]`\r\n    );\r\n    if (characterElement) {\r\n      const characterRect = characterElement.getBoundingClientRect();\r\n      assignCharacterToBuilding(\r\n        selectedCharacter,\r\n        building,\r\n        characterRect,\r\n        elementRect\r\n      );\r\n    }\r\n\r\n    setSelectedCharacter(null);\r\n  };\r\n\r\n  return (\r\n    <div className=\"town-encounter\">\r\n      <EncounterHeader\r\n        title={encounter.location.name}\r\n        description={campaignManager.getCurrentEvent()?.flavorText || \"\"}\r\n        leftContent={\r\n          <InstructionsPanel\r\n            instructions={[\r\n              \"Click a character on the right to\",\r\n              \"urge a player to visit a location\",\r\n              \"Non-active players lose attention \",\r\n            ]}\r\n          />\r\n        }\r\n        rightContent={\r\n          <CharacterSelector\r\n            characters={characters}\r\n            selectedCharacter={selectedCharacter}\r\n            onCharacterClick={handleCharacterClick}\r\n            exhaustion={exhaustion}\r\n            onEndClick={() => campaignManager.backToOverview()}\r\n            onRandomClick={() => {\r\n              const availableBuildings = getAvailableBuildings();\r\n              if (availableBuildings.length > 0) {\r\n                const randomBuilding =\r\n                  availableBuildings[\r\n                    Math.floor(Math.random() * availableBuildings.length)\r\n                  ];\r\n                const randomCharacter =\r\n                  characters[Math.floor(Math.random() * characters.length)];\r\n                const buildingElement = document.querySelector(\r\n                  `[data-building-id=\"${randomBuilding.id}\"]`\r\n                );\r\n                const characterElement = document.querySelector(\r\n                  `[data-character-id=\"${randomCharacter.id}\"]`\r\n                );\r\n                if (buildingElement && characterElement) {\r\n                  const buildingRect = buildingElement.getBoundingClientRect();\r\n                  const characterRect =\r\n                    characterElement.getBoundingClientRect();\r\n                  assignCharacterToBuilding(\r\n                    randomCharacter,\r\n                    randomBuilding,\r\n                    characterRect,\r\n                    buildingRect\r\n                  );\r\n                  townManager.townBuildingAssigned(\r\n                    randomCharacter,\r\n                    randomBuilding\r\n                  );\r\n                  if (exhaustion > 0) {\r\n                    appManager.getPartyManager().exhaustParty(exhaustion);\r\n                  }\r\n\r\n                  setExhaustion(exhaustion + 2);\r\n                }\r\n              }\r\n            }}\r\n          />\r\n        }\r\n        instructions={[true, false]}\r\n        childClass=\"small-font\"\r\n      />\r\n      <div className=\"buildings-container\">\r\n        {buildings.map((building, index) => (\r\n          <BuildingCard\r\n            key={index}\r\n            building={building}\r\n            onClick={(e) =>\r\n              handleBuildingClick(\r\n                building,\r\n                e.currentTarget.getBoundingClientRect()\r\n              )\r\n            }\r\n            isSelectable={\r\n              selectedCharacter !== null &&\r\n              building.currentVisitors.length < building.capacity\r\n            }\r\n            data-building-id={building.id}\r\n            onTagClick={handleTagClick}\r\n            onCharacterClick={handleCharacterClick}\r\n          />\r\n        ))}{\" \"}\r\n      </div>\r\n      {animatingCharacter && (\r\n        <CharacterToken\r\n          character={animatingCharacter.character}\r\n          style={{\r\n            position: \"fixed\",\r\n            left: `${animatingCharacter.from.left}px`,\r\n            top: `${animatingCharacter.from.top}px`,\r\n            width: `${animatingCharacter.from.width}px`,\r\n            height: `${animatingCharacter.from.height}px`,\r\n            transition: \"transform 1.0s ease\", // Changed from 'all' to just 'transform'\r\n          }}\r\n          className=\"animating\" // Add this class\r\n          mini={true} // Add this to match destination size\r\n          onClick={() => {}}\r\n        />\r\n      )}\r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GameEncounterTown;\r\n","\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { Encounter, Player, Character, EncounterFlavorTag, FlavorTagSource, TravelResultConfig, EffectData, ATTRIBUTE_TYPE } from '../../models';\r\nimport { useAppManager, useCampaignManager, usePlayerManager } from \"../managerContexts\";\r\nimport EncounterHeader from \"./encounterHeader\";\r\nimport FlavorTagPill from \"../UI/FlavorTagPill\";\r\nimport \"./gameRoom.scss\";\r\nimport \"./gameEncounterTrap.scss\";\r\n\r\ninterface GameEncounterTrapProps {\r\n  encounter: Encounter;\r\n}\r\n\r\ninterface TrapResult {\r\n  type: 'success' | 'survived' | 'injured' | 'death';\r\n  minRoll: number;\r\n  maxRoll: number;\r\n  dmRewards: number[];\r\n}\r\n\r\ninterface CharacterRoll {\r\n  character: Character;\r\n  player: Player;\r\n  roll: number;\r\n  result: TrapResult;\r\n  dmReward: number;\r\n}\r\n\r\nconst GameEncounterTrap: React.FC<GameEncounterTrapProps> = ({ encounter }) => {\r\n  // Phase management\r\n  const [phase, setPhase] = useState<'setup' | 'disarm' | 'resolved'>('setup');\r\n  \r\n  // Trap configuration\r\n  const [trapResults, setTrapResults] = useState<TrapResult[]>([\r\n    { type: 'death', minRoll: 0, maxRoll: 0, dmRewards: [] },\r\n    { type: 'injured', minRoll: 1, maxRoll: 3, dmRewards: [] },\r\n    { type: 'survived', minRoll: 4, maxRoll: 5, dmRewards: [] },\r\n    { type: 'success', minRoll: 6, maxRoll: 7, dmRewards: [] }\r\n  ]);\r\n  \r\n  // Character states\r\n  const [characterRolls, setCharacterRolls] = useState<CharacterRoll[]>([]);\r\n  const [usedDisarmAttempts, setUsedDisarmAttempts] = useState<Set<string>>(new Set());\r\n  const [highlightedCells, setHighlightedCells] = useState<{character: string, roll: number}[]>([]);\r\n  \r\n  // UI states\r\n  const [showResults, setShowResults] = useState(false);\r\n  const [resultConfig, setResultConfig] = useState<TravelResultConfig | null>(null);\r\n  const [boredomRisks, setBoredomRisks] = useState<{[playerId: string]: number}>({});\r\n\r\n  const appManager = useAppManager();\r\n  const campaignManager = useCampaignManager();\r\n  const playerManager = usePlayerManager();\r\n  const characterManager = appManager.getCharacterManager();\r\n  const tagManager = appManager.getTagManager();\r\n  const partyManager = appManager.getPartyManager();\r\n\r\n  const players = playerManager.getPlayers();\r\n  const allCharacters = players.flatMap(player => \r\n    player.characters.map(char => ({ character: char, player }))\r\n  );\r\n  const locationTags = campaignManager.currentEncounter?.location.tags || [];\r\n  const collectedLocationTags = tagManager.locationTagsCollected;\r\n  const unexposedLocationTags = locationTags.filter(tag => \r\n    !collectedLocationTags.some(collected => collected.name === tag.name)\r\n  );\r\n\r\n  // Initialize trap with random DM rewards\r\n  useEffect(() => {\r\n    initializeTrap();\r\n    calculateBoredomRisks();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    calculateBoredomRisks();\r\n  }, [trapResults]);\r\n\r\n  const initializeTrap = () => {\r\n    const newTrapResults = trapResults.map(result => ({\r\n      ...result,\r\n      dmRewards: Array.from({ length: result.maxRoll - result.minRoll + 1 }, () => \r\n        Math.floor(Math.random() * 6) + 1\r\n      )\r\n    }));\r\n    setTrapResults(newTrapResults);\r\n  };\r\n\r\n  const calculateBoredomRisks = () => {\r\n    const successRange = trapResults.find(r => r.type === 'success');\r\n    if (!successRange) return;\r\n    \r\n    const successChance = ((successRange.maxRoll - successRange.minRoll + 1) / 8) * 100;\r\n    const baseBoredomRisk = Math.max(0, successChance - 50); // Higher success = higher boredom risk\r\n    \r\n    const risks: {[playerId: string]: number} = {};\r\n    players.forEach(player => {\r\n      risks[player.id.toString()] = Math.min(90, baseBoredomRisk + (Math.random() * 20 - 10));\r\n    });\r\n    setBoredomRisks(risks);\r\n  };\r\n\r\n  const getTensionFromDifficulty = () => {\r\n    const deathRange = trapResults.find(r => r.type === 'death');\r\n    const injuredRange = trapResults.find(r => r.type === 'injured');\r\n    if (!deathRange || !injuredRange) return 0;\r\n    \r\n    const deathChance = ((deathRange.maxRoll - deathRange.minRoll + 1) / 8) * 100;\r\n    const injuryChance = ((injuredRange.maxRoll - injuredRange.minRoll + 1) / 8) * 100;\r\n    \r\n    return Math.floor(deathChance * 2 + injuryChance * 1);\r\n  };\r\n\r\n  const getDeathAndInjuryPercentages = () => {\r\n    const deathRange = trapResults.find(r => r.type === 'death');\r\n    const injuredRange = trapResults.find(r => r.type === 'injured');\r\n    \r\n    const deathChance = deathRange ? ((deathRange.maxRoll - deathRange.minRoll + 1) / 8) * 100 : 0;\r\n    const injuryChance = injuredRange ? ((injuredRange.maxRoll - injuredRange.minRoll + 1) / 8) * 100 : 0;\r\n    \r\n    return { deathChance, injuryChance };\r\n  };\r\n\r\n  const adjustDifficultyBand = (resultType: string, newMin: number, newMax: number) => {\r\n    if (newMin > newMax || newMax - newMin < 0) return;\r\n    \r\n    const newResults = [...trapResults];\r\n    const resultIndex = newResults.findIndex(r => r.type === resultType);\r\n    if (resultIndex === -1) return;\r\n    \r\n    // Check for overlaps with other bands\r\n    const otherBands = newResults.filter((_, index) => index !== resultIndex);\r\n    const hasOverlap = otherBands.some(band => \r\n      (newMin >= band.minRoll && newMin <= band.maxRoll) ||\r\n      (newMax >= band.minRoll && newMax <= band.maxRoll) ||\r\n      (newMin <= band.minRoll && newMax >= band.maxRoll)\r\n    );\r\n    \r\n    if (hasOverlap) return;\r\n    \r\n    newResults[resultIndex] = {\r\n      ...newResults[resultIndex],\r\n      minRoll: newMin,\r\n      maxRoll: newMax,\r\n      dmRewards: Array.from({ length: newMax - newMin + 1 }, () => \r\n        Math.floor(Math.random() * 6) + 1\r\n      )\r\n    };\r\n    \r\n    setTrapResults(newResults);\r\n  };\r\n\r\n  const getDisarmChance = (character: Character) => {\r\n    const tools = characterManager.getRemainingAttributes(character, ATTRIBUTE_TYPE.TOOLS) || 0;\r\n    const baseChance = tools * 10; // 10% per tool\r\n    const isTagExposed = unexposedLocationTags.length === 0;\r\n    return Math.min(95, baseChance + (isTagExposed ? 25 : 0));\r\n  };\r\n\r\n  const getAssignedLocationTag = (characterIndex: number) => {\r\n    if (unexposedLocationTags.length > 0) {\r\n      return unexposedLocationTags[characterIndex % unexposedLocationTags.length];\r\n    }\r\n    if (collectedLocationTags.length > 0) {\r\n      return collectedLocationTags[characterIndex % collectedLocationTags.length];\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const handleDisarmAttempt = (character: Character, player: Player) => {\r\n    const characterId = character.id.toString();\r\n    if (usedDisarmAttempts.has(characterId)) return;\r\n    \r\n    const disarmChance = getDisarmChance(character);\r\n    const roll = Math.random() * 100;\r\n    const success = roll < disarmChance;\r\n    \r\n    setUsedDisarmAttempts(prev => new Set([...prev, characterId]));\r\n    \r\n    // Get character index for tag assignment\r\n    const characterIndex = allCharacters.findIndex(c => c.character.id === character.id);\r\n    const assignedTag = getAssignedLocationTag(characterIndex);\r\n    \r\n    const results: EffectData[] = [];\r\n    \r\n    // Player experience\r\n    playerManager.addPlayerExp(player, 1);\r\n    results.push({\r\n      object: player,\r\n      effects: [{\r\n        effect: \"+1 Experience\",\r\n        class: \"player-exp\"\r\n      }]\r\n    });\r\n    \r\n    // Tool loss\r\n    const currentTools = characterManager.getRemainingAttributes(character, ATTRIBUTE_TYPE.TOOLS) || 0;\r\n    const toolsLost = Math.floor(currentTools / 2);\r\n    if (toolsLost > 0) {\r\n      characterManager.setAttributeUsed(character, ATTRIBUTE_TYPE.TOOLS, toolsLost);\r\n      results.push({\r\n        object: character,\r\n        effects: [{\r\n          effect: `-${toolsLost} Tools`,\r\n          class: \"character-tools\"\r\n        }]\r\n      });\r\n    }\r\n    \r\n    if (success) {\r\n      // Shift all ranges up by 1\r\n      const newResults = trapResults.map(result => ({\r\n        ...result,\r\n        minRoll: Math.min(7, result.minRoll + 1),\r\n        maxRoll: Math.min(7, result.maxRoll + 1)\r\n      }));\r\n      setTrapResults(newResults);\r\n      \r\n      // Expose location tag if not already exposed\r\n      if (assignedTag && unexposedLocationTags.some(tag => tag.name === assignedTag.name)) {\r\n        const flavorTag: EncounterFlavorTag = {\r\n          tag: assignedTag,\r\n          source: FlavorTagSource.LOCATION,\r\n          theme: tagManager.getTheme()\r\n        };\r\n        campaignManager.exposeTag(flavorTag);\r\n        \r\n        results.push({\r\n          object: 'party',\r\n          effects: [{\r\n            effect: `Exposed: ${assignedTag.name}`,\r\n            class: \"location-tag\"\r\n          }]\r\n        });\r\n      }\r\n      \r\n      showResultsModal(\"Trap Disarmed!\", `${character.name} successfully disarmed the trap!`, results);\r\n    } else {\r\n      // Shift all ranges down by 1\r\n      const newResults = trapResults.map(result => ({\r\n        ...result,\r\n        minRoll: Math.max(0, result.minRoll - 1),\r\n        maxRoll: Math.max(0, result.maxRoll - 1)\r\n      }));\r\n      setTrapResults(newResults);\r\n      \r\n      // Add tension\r\n      partyManager.addPartyTension(10);\r\n      results.push({\r\n        object: 'party',\r\n        effects: [{\r\n          effect: \"+10 Tension\",\r\n          class: \"tension\"\r\n        }]\r\n      });\r\n      \r\n      showResultsModal(\"Disarm Failed\", `${character.name} failed to disarm the trap!`, results);\r\n    }\r\n  };\r\n\r\n  const handleReactToTrap = () => {\r\n    const rolls: CharacterRoll[] = [];\r\n    \r\n    allCharacters.forEach(({ character, player }) => {\r\n      const roll = Math.floor(Math.random() * 8); // 0-7\r\n      const result = trapResults.find(r => roll >= r.minRoll && roll <= r.maxRoll);\r\n      const dmReward = result?.dmRewards[roll - result.minRoll] || 0;\r\n      \r\n      if (result) {\r\n        rolls.push({\r\n          character,\r\n          player,\r\n          roll,\r\n          result,\r\n          dmReward\r\n        });\r\n      }\r\n    });\r\n    \r\n    setCharacterRolls(rolls);\r\n    setHighlightedCells(rolls.map(r => ({ character: r.character.id.toString(), roll: r.roll })));\r\n    \r\n    // Process results after highlighting\r\n    setTimeout(() => {\r\n      processCharacterRolls(rolls);\r\n    }, 1500);\r\n  };\r\n\r\n  const processCharacterRolls = (rolls: CharacterRoll[]) => {\r\n    const results: EffectData[] = [];\r\n    let totalDmRewards = 0;\r\n    \r\n    rolls.forEach(({ character, player, result, dmReward }) => {\r\n      // Apply injuries or death\r\n      if (result.type === 'injured') {\r\n        partyManager.addInjury(character);\r\n        results.push({\r\n          object: character,\r\n          effects: [{\r\n            effect: \"Injured\",\r\n            class: \"character-injury\"\r\n          }]\r\n        });\r\n      } else if (result.type === 'death') {\r\n        partyManager.addInjury(character); // This will kill if already injured\r\n        partyManager.addInjury(character); // Ensure death\r\n        results.push({\r\n          object: character,\r\n          effects: [{\r\n            effect: \"Died\",\r\n            class: \"character-death\"\r\n          }]\r\n        });\r\n      }\r\n      \r\n      // Add DM rewards\r\n      if (dmReward > 0) {\r\n        totalDmRewards += dmReward;\r\n        results.push({\r\n          object: character,\r\n          effects: [{\r\n            effect: `+${dmReward} DM Points`,\r\n            class: \"dm-points\"\r\n          }]\r\n        });\r\n      }\r\n      \r\n      // Apply boredom risk\r\n      const boredomRisk = boredomRisks[player.id.toString()] || 0;\r\n      if (Math.random() * 100 < boredomRisk) {\r\n        partyManager.updateAttention(player, -1);\r\n        results.push({\r\n          object: player,\r\n          effects: [{\r\n            effect: \"-1 Attention (Boredom)\",\r\n            class: \"player-attention\"\r\n          }]\r\n        });\r\n      }\r\n    });\r\n    \r\n    if (totalDmRewards > 0) {\r\n      campaignManager.addDmExp(totalDmRewards);\r\n    }\r\n    \r\n    setHighlightedCells([]);\r\n    showResultsModal(\"Trap Results\", \"Characters have reacted to the trap!\", results);\r\n    setPhase('resolved');\r\n  };\r\n\r\n  const showResultsModal = (title: string, description: string, results: EffectData[]) => {\r\n    const mockTravelOption = {\r\n      id: \"trap_result\",\r\n      name: title,\r\n      description: description,\r\n      time: 0,\r\n      tags: 0,\r\n      score: 0,\r\n      boredom: 0,\r\n      exhaustion: 0,\r\n      tagInstructions: \"\",\r\n      repeatable: false\r\n    };\r\n\r\n    const resultConfig: TravelResultConfig = {\r\n      results: results,\r\n      title: title,\r\n      description: description,\r\n      tags: [],\r\n      travelOption: mockTravelOption,\r\n      info: {\r\n        score: 0,\r\n        time: 0,\r\n        boredom: 0,\r\n        exhaustion: 0\r\n      }\r\n    };\r\n\r\n    setResultConfig(resultConfig);\r\n    setShowResults(true);\r\n  };\r\n\r\n  const renderDifficultyAdjustment = () => {\r\n    const { deathChance, injuryChance } = getDeathAndInjuryPercentages();\r\n    const tension = getTensionFromDifficulty();\r\n    \r\n    return (\r\n      <div className=\"difficulty-adjustment\">\r\n        <h3>Trap Difficulty Configuration</h3>\r\n        <div className=\"risk-stats\">\r\n          <div className=\"risk-stat\">Death: {deathChance.toFixed(1)}%</div>\r\n          <div className=\"risk-stat\">Injury: {injuryChance.toFixed(1)}%</div>\r\n          <div className=\"risk-stat\">Tension: +{tension}</div>\r\n        </div>\r\n        <div className=\"boredom-risks\">\r\n          <h4>Boredom Risks:</h4>\r\n          {players.map(player => (\r\n            <div key={player.id} className=\"boredom-risk\">\r\n              {player.name}: {(boredomRisks[player.id.toString()] || 0).toFixed(1)}%\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <button \r\n          className=\"introduce-trap-button\"\r\n          onClick={() => setPhase('disarm')}\r\n        >\r\n          Introduce Trap\r\n        </button>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderDisarmInterface = () => (\r\n    <div className=\"disarm-interface\">\r\n      <h3>Disarm Attempts</h3>\r\n      <div className=\"character-disarm-options\">\r\n        {allCharacters.map(({ character, player }, index) => {\r\n          const disarmChance = getDisarmChance(character);\r\n          const isUsed = usedDisarmAttempts.has(character.id.toString());\r\n          const assignedTag = getAssignedLocationTag(index);\r\n          const borderColor = disarmChance < 35 ? '#e74c3c' : disarmChance > 75 ? '#27ae60' : '#f39c12';\r\n          \r\n          return (\r\n            <div \r\n              key={character.id}\r\n              className={`character-disarm-card ${isUsed ? 'disabled' : ''}`}\r\n              style={{ borderColor }}\r\n            >\r\n              <div className=\"character-info\">\r\n                <div className=\"character-name\">{character.name}</div>\r\n                <div className=\"character-player\">({player.name})</div>\r\n              </div>\r\n              {assignedTag && (\r\n                <FlavorTagPill\r\n                  tag={{\r\n                    tag: assignedTag,\r\n                    source: FlavorTagSource.LOCATION,\r\n                    theme: tagManager.getTheme()\r\n                  }}\r\n                  disabled={false}\r\n                  className=\"assigned-tag\"\r\n                  showTooltip={true}\r\n                />\r\n              )}\r\n              <div className=\"disarm-chance\">{disarmChance}% success</div>\r\n              <button \r\n                className=\"disarm-button\"\r\n                disabled={isUsed}\r\n                onClick={() => handleDisarmAttempt(character, player)}\r\n              >\r\n                {isUsed ? 'Used' : 'Disarm'}\r\n              </button>\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n      <button \r\n        className=\"react-to-trap-button\"\r\n        onClick={handleReactToTrap}\r\n      >\r\n        React to Trap\r\n      </button>\r\n    </div>\r\n  );\r\n\r\n  const renderTrapGrid = () => (\r\n    <div className=\"trap-grid\">\r\n      <div className=\"grid-labels\">\r\n        <div className=\"result-label success\">Success</div>\r\n        <div className=\"result-label survived\">Survived</div>\r\n        <div className=\"result-label injured\">Injured</div>\r\n        <div className=\"result-label death\">Death</div>\r\n      </div>\r\n      <div className=\"grid-content\">\r\n        {/* Render grid rows from 7 to 0 */}\r\n        {Array.from({ length: 8 }, (_, i) => 7 - i).map(rollValue => {\r\n          const result = trapResults.find(r => rollValue >= r.minRoll && rollValue <= r.maxRoll);\r\n          const dmReward = result?.dmRewards[rollValue - result.minRoll] || 0;\r\n          \r\n          return (\r\n            <div key={rollValue} className=\"grid-row\">\r\n              <div className=\"roll-number\">{rollValue}</div>\r\n              {allCharacters.map(({ character }, charIndex) => {\r\n                const isHighlighted = highlightedCells.some(h => \r\n                  h.character === character.id.toString() && h.roll === rollValue\r\n                );\r\n                \r\n                return (\r\n                  <div \r\n                    key={`${rollValue}-${character.id}`}\r\n                    className={`grid-cell ${result?.type || ''} ${isHighlighted ? 'highlighted' : ''}`}\r\n                  >\r\n                    {isHighlighted && (\r\n                      <div className=\"character-marker\">👤</div>\r\n                    )}\r\n                    {dmReward > 0 && !isHighlighted && (\r\n                      <div className=\"dm-reward-marker\">{dmReward}</div>\r\n                    )}\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          );\r\n        })}\r\n        {/* Character headers at bottom */}\r\n        <div className=\"character-headers\">\r\n          <div className=\"roll-number-header\">#</div>\r\n          {allCharacters.map(({ character, player }) => (\r\n            <div key={character.id} className=\"character-header\">\r\n              <div className=\"character-name\">{character.name}</div>\r\n              <div className=\"character-player\">({player.name})</div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"game-encounter-trap\">\r\n      <EncounterHeader\r\n        title={`Trap - ${encounter.location.name}`}\r\n        description=\"Configure the trap difficulty and manage character survival!\"\r\n        childClass=\"small-font\"\r\n      />\r\n      \r\n      <div className=\"trap-content\">\r\n        {renderTrapGrid()}\r\n        \r\n        <div className=\"trap-controls\">\r\n          {phase === 'setup' && renderDifficultyAdjustment()}\r\n          {phase === 'disarm' && renderDisarmInterface()}\r\n          {phase === 'resolved' && (\r\n            <button \r\n              className=\"end-trap-button\"\r\n              onClick={() => campaignManager.backToOverview()}\r\n            >\r\n              End Trap Encounter\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {showResults && resultConfig && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal-container\">\r\n            <div className=\"modal-header\">\r\n              {resultConfig.title}\r\n              <button className=\"close-button\" onClick={() => setShowResults(false)}>×</button>\r\n            </div>\r\n            <div className=\"modal-description\">{resultConfig.description}</div>\r\n            <div className=\"trap-results\">\r\n              {resultConfig.results.map((result, index) => (\r\n                <div key={index} className=\"effect-display\">\r\n                  <div className=\"effect-target\">\r\n                    {typeof result.object === 'string' ? result.object : result.object.name}\r\n                  </div>\r\n                  <div className=\"effect-list\">\r\n                    {result.effects?.map((effect, effectIndex) => (\r\n                      <div key={effectIndex} className={`effect ${effect.class}`}>\r\n                        {effect.effect}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n            <div className=\"modal-actions\">\r\n              <button onClick={() => setShowResults(false)}>OK</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GameEncounterTrap;","import React from 'react';\r\nimport './CContainer.scss';\r\n\r\ninterface CContainerProps {\r\n  children: React.ReactNode;\r\n  title?: string;\r\n  variant?: string;\r\n  className?: string;\r\n  style?: React.CSSProperties;\r\n}\r\n\r\nconst CContainer: React.FC<CContainerProps> = ({ \r\n  children, \r\n  title, \r\n  variant = 'primary', \r\n  className = '', \r\n  style \r\n}) => {\r\n  const containerClasses = [\r\n    'c-container',\r\n    `c-container--${variant}`,\r\n    className\r\n  ].filter(Boolean).join(' ');\r\n\r\n  return (\r\n    <div className={containerClasses} style={style}>\r\n      {title && (\r\n        <div className=\"c-container__title-bar\">\r\n          <span className=\"c-container__title\">{title}</span>\r\n        </div>\r\n      )}\r\n      <div className=\"c-container__content\">\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CContainer;\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport {\r\n  Character,\r\n  ATTRIBUTE_TYPE,\r\n  Tag,\r\n  FlavorTagSource,\r\n  FlavorTagTheme,\r\n  Challenge,\r\n} from \"../../models\";\r\nimport {\r\n  useAppManager,\r\n  useCampaignManager,\r\n  useCharacterManager,\r\n} from \"../managerContexts\";\r\nimport { getCombinedAttributes } from \"../../consts/characterConsts\";\r\nimport FillBar from \"../UI/fillBar\";\r\nimport CImage from \"../UI/cimage\";\r\nimport CContainer from \"../UI/CContainer\";\r\nimport \"./enhancedSkillChallenge.scss\";\r\nimport TagPill from \"../UI/TagPill\";\r\nimport FlavorTagPill from \"../UI/FlavorTagPill\";\r\nimport DiceScore from \"../UI/DiceScore\";\r\nimport { render } from \"@testing-library/react\";\r\n\r\n// Animation timing constants\r\nconst ANIMATION_TIMINGS = {\r\n  SELECTION_DURATION: 2500, // Total time for spot selection animation\r\n  CYCLE_SPEED: 100, // Time between highlight changes during cycling\r\n  FINAL_PULSE_DURATION: 800, // Time the final selected spot pulses before resolution\r\n  SPOT_HIGHLIGHT_SCALE: 1.15, // Scale factor for highlighted spots during cycling\r\n} as const;\r\n\r\n// Enhanced types for the new skill challenge system\r\nexport enum CSPOT_TYPE {\r\n  USE_ATTRIBUTE_COMBAT = \"use_attribute_combat\",\r\n  USE_ATTRIBUTE_MAGIC = \"use_attribute_magic\",\r\n  USE_ATTRIBUTE_TOOLS = \"use_attribute_tools\",\r\n  UNLOCK_ASSIST = \"free_spot\", // Special spots with no attribute cost\r\n}\r\n\r\nexport interface CSpot {\r\n  id: string;\r\n  type: CSPOT_TYPE;\r\n  position: number;\r\n  used: boolean;\r\n  icon: string;\r\n  characterId?: string; // ID of character who used this spot\r\n  scorePoints?: number; // Optional dice score points (1-3)\r\n  challengePoints?: number; // Challenge difficulty (1-3 circles)\r\n}\r\n\r\nexport interface ChallengeRow {\r\n  id: string;\r\n  theme: \"COMBAT\" | \"GEAR\" | \"MAGIC\";\r\n  name: string;\r\n  description: string;\r\n  cspots: CSpot[];\r\n  selected: boolean;\r\n  animatingSelection?: boolean;\r\n}\r\n\r\nexport interface CharacterPosition {\r\n  characterId: string;\r\n  rowIndex: number;\r\n  position: number;\r\n}\r\n\r\ninterface SkillTotals {\r\n  combat: number;\r\n  magic: number;\r\n  gear: number;\r\n}\r\n\r\ninterface SkillThresholds {\r\n  combat: number;\r\n  magic: number;\r\n  gear: number;\r\n}\r\n\r\ninterface RewardLevel {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  tensionChange: number;\r\n  attentionChange: number;\r\n  scoreBonus: number;\r\n}\r\n\r\ninterface AssistTag {\r\n  id: string;\r\n  tag: Tag;\r\n  state: \"AVAILABLE\" | \"ACTIVE\" | \"USED\" | \"UNAVAILABLE\";\r\n  isLocationTag: boolean;\r\n}\r\n\r\ninterface EnhancedSkillChallengeProps {\r\n  challengeLength?: number; // Number of spots in each challenge row (12-20)\r\n  authoredTag?: Tag; // Main tag associated with this challenge\r\n  skillThresholds?: SkillThresholds; // Thresholds for combat/magic/gear (default 5 each)\r\n  onComplete?: () => void;\r\n  authoredAssistTags?: Tag[]; // Tags that can assist in the challenge\r\n  generateRandomAssistTags?: boolean; // If true, will generate random assist tags\r\n  config? : any; // Additional configuration object\r\n}\r\n\r\nconst EnhancedSkillChallenge: React.FC<EnhancedSkillChallengeProps> = ({\r\n  challengeLength = 10,\r\n  authoredTag,\r\n  skillThresholds = { combat: 5, magic: 5, gear: 5 },\r\n  onComplete,\r\n  authoredAssistTags = [],\r\n  generateRandomAssistTags = false,\r\n  config,\r\n}) => {\r\n  const appManager = useAppManager();\r\n  const campaignManager = useCampaignManager();\r\n  const characterManager = useCharacterManager();\r\n  const tagManager = appManager.getTagManager();\r\n  const chatManager = appManager.getChatManager();\r\n\r\n  // Core state\r\n  const [characters] = useState<Character[]>(characterManager.getCharacters());\r\n  const [selectedCharacter, setSelectedCharacter] = useState<Character | null>(\r\n    null\r\n  );\r\n  const [challengeRows, setChallengeRows] = useState<ChallengeRow[]>([]);\r\n  const [characterPositions, setCharacterPositions] = useState<\r\n    CharacterPosition[]\r\n  >(\r\n    characters.map((char) => ({\r\n      characterId: String(char.id),\r\n      rowIndex: -1,\r\n      position: -1,\r\n    }))\r\n  );\r\n  const successTag =\r\n    authoredTag ||\r\n    tagManager.getOutstandingEncounterTags()[0] ||\r\n    tagManager.generateRelevantFlavorTags(1)[0]?.tag;\r\n\r\n  // Enhanced tracking state\r\n  const [skillTotals, setSkillTotals] = useState<SkillTotals>({\r\n    combat: 0,\r\n    magic: 0,\r\n    gear: 0,\r\n  });\r\n  const [assistTags, setAssistTags] = useState<AssistTag[]>([]);\r\n  const [currentRewardLevel, setCurrentRewardLevel] = useState<number>(0);\r\n  const [movesCompleted, setMovesCompleted] = useState<number>(0);\r\n  const [challengeComplete, setChallengeComplete] = useState<boolean>(false);\r\n  const [assistBonus, setAssistBonus] = useState<number>(0); // Track number of assist tags used\r\n\r\n  // Check if we're in failure state (no skills completed)\r\n  const isFailureState = () => {\r\n    return skillsCompleted() === 0;\r\n  };\r\n\r\n  // UI state\r\n  const [highlightedSpot, setHighlightedSpot] = useState<{\r\n    rowIndex: number;\r\n    spotIndex: number;\r\n  } | null>(null);\r\n  const [finalSelectedSpot, setFinalSelectedSpot] = useState<{\r\n    rowIndex: number;\r\n    spotIndex: number;\r\n  } | null>(null);\r\n\r\n  // Reward levels configuration\r\n  const rewardLevels: RewardLevel[] = [\r\n    {\r\n      id: \"failure\",\r\n      name: \"Failure\",\r\n      description: \"-50 Tension, -1 Attention\",\r\n      tensionChange: -50,\r\n      attentionChange: -1,\r\n      scoreBonus: 0,\r\n    },\r\n    {\r\n      id: \"simple\",\r\n      name: \"Simple\",\r\n      description: \"-5 Tension\",\r\n      tensionChange: -5,\r\n      attentionChange: 0,\r\n      scoreBonus: 1,\r\n    },\r\n    {\r\n      id: \"challenging\",\r\n      name: \"Challenging\",\r\n      description: \"+5 Tension\",\r\n      tensionChange: 5,\r\n      attentionChange: 0,\r\n      scoreBonus: 2,\r\n    },\r\n    {\r\n      id: \"hard\",\r\n      name: \"Hard\",\r\n      description: \"+15 Tension, +1 Attention\",\r\n      tensionChange: 15,\r\n      attentionChange: 1,\r\n      scoreBonus: 3,\r\n    },\r\n  ];\r\n\r\n  // Helper functions\r\n  const getIconForSpotType = (type: CSPOT_TYPE, points: number = 1): string => {\r\n    // Return circle indicators instead of emoji icons\r\n    const circle = \"●\";\r\n    return Array(points).fill(circle).join(\"\");\r\n  };\r\n\r\n  const getIconForTheme = (theme: \"COMBAT\" | \"GEAR\" | \"MAGIC\"): string => {\r\n    switch (theme) {\r\n      case \"COMBAT\":\r\n        return \"⚔️\";\r\n      case \"MAGIC\":\r\n        return \"✨\";\r\n      case \"GEAR\":\r\n        return \"🔧\";\r\n      default:\r\n        return \"❓\";\r\n    }\r\n  };\r\n\r\n  const getThemeColorClass = (type: CSPOT_TYPE): string => {\r\n    switch (type) {\r\n      case CSPOT_TYPE.USE_ATTRIBUTE_COMBAT:\r\n        return \"theme-combat\";\r\n      case CSPOT_TYPE.USE_ATTRIBUTE_MAGIC:\r\n        return \"theme-magic\";\r\n      case CSPOT_TYPE.USE_ATTRIBUTE_TOOLS:\r\n        return \"theme-gear\";\r\n      case CSPOT_TYPE.UNLOCK_ASSIST:\r\n        return \"theme-neutral\";\r\n      default:\r\n        return \"theme-neutral\";\r\n    }\r\n  };\r\n\r\n  // Generate dice pip pattern for challenge spots\r\n  const renderDicePips = (\r\n    points: number,\r\n    includeAssistBonus: boolean = true\r\n  ) => {\r\n    const appliedAssistBonus = includeAssistBonus ? assistBonus : 0;\r\n    const totalPoints = points + appliedAssistBonus;\r\n    const clampedPoints = Math.min(Math.max(totalPoints, 1), 6); // Clamp between 1-6 for dice patterns\r\n\r\n    const pipPositions = {\r\n      1: [\"center\"],\r\n      2: [\"top-left\", \"bottom-right\"],\r\n      3: [\"top-left\", \"center\", \"bottom-right\"],\r\n      4: [\"top-left\", \"top-right\", \"bottom-left\", \"bottom-right\"],\r\n      5: [\"top-left\", \"top-right\", \"center\", \"bottom-left\", \"bottom-right\"],\r\n      6: [\r\n        \"top-left\",\r\n        \"top-right\",\r\n        \"middle-left\",\r\n        \"middle-right\",\r\n        \"bottom-left\",\r\n        \"bottom-right\",\r\n      ],\r\n    };\r\n\r\n    const positions = pipPositions[\r\n      clampedPoints as keyof typeof pipPositions\r\n    ] || [\"center\"];\r\n\r\n    return (\r\n      <div className=\"dice-face\">\r\n        {positions.map((position, index) => {\r\n          const isAssistBonus = index >= points && appliedAssistBonus > 0;\r\n          return (\r\n            <div\r\n              key={index}\r\n              className={`pip ${position} ${\r\n                isAssistBonus ? \"assist-bonus\" : \"\"\r\n              }`}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const getAttributeForSpotType = (type: CSPOT_TYPE): ATTRIBUTE_TYPE => {\r\n    switch (type) {\r\n      case CSPOT_TYPE.USE_ATTRIBUTE_COMBAT:\r\n        return ATTRIBUTE_TYPE.COMBAT;\r\n      case CSPOT_TYPE.USE_ATTRIBUTE_MAGIC:\r\n        return ATTRIBUTE_TYPE.MAGIC;\r\n      case CSPOT_TYPE.USE_ATTRIBUTE_TOOLS:\r\n        return ATTRIBUTE_TYPE.TOOLS;\r\n      default:\r\n        return ATTRIBUTE_TYPE.COMBAT;\r\n    }\r\n  };\r\n\r\n  const getSkillKeyForType = (type: CSPOT_TYPE): keyof SkillTotals => {\r\n    switch (type) {\r\n      case CSPOT_TYPE.USE_ATTRIBUTE_COMBAT:\r\n        return \"combat\";\r\n      case CSPOT_TYPE.USE_ATTRIBUTE_MAGIC:\r\n        return \"magic\";\r\n      case CSPOT_TYPE.USE_ATTRIBUTE_TOOLS:\r\n        return \"gear\";\r\n      default:\r\n        return \"combat\";\r\n    }\r\n  };\r\n\r\n  const getAttributeForChallengeRowType = (\r\n    rowIndex: number\r\n  ): ATTRIBUTE_TYPE => {\r\n    const row = challengeRows[rowIndex];\r\n    switch (row.theme) {\r\n      case \"COMBAT\":\r\n        return ATTRIBUTE_TYPE.COMBAT;\r\n      case \"MAGIC\":\r\n        return ATTRIBUTE_TYPE.MAGIC;\r\n      case \"GEAR\":\r\n        return ATTRIBUTE_TYPE.TOOLS;\r\n      default:\r\n        return ATTRIBUTE_TYPE.COMBAT;\r\n    }\r\n  };\r\n\r\n  const canPlayerAffordRow = (character: Character, rowIndex: number): boolean => {\r\n    const attributeType = getAttributeForChallengeRowType(rowIndex);\r\n    const remainingAttributes = characterManager.getRemainingAttributes(character, attributeType);\r\n    return remainingAttributes >= 1;\r\n  };\r\n\r\n  const getAttributeCostText = (rowIndex: number): string => {\r\n    const attributeType = getAttributeForChallengeRowType(rowIndex);\r\n    const attributeName = characterManager.getUFAttributeName(attributeType);\r\n    return `Character uses one ${attributeName}`;\r\n  };\r\n\r\n  const getUserFacingTheme = (theme: \"COMBAT\" | \"GEAR\" | \"MAGIC\"): string => {\r\n    switch (theme) {\r\n      case \"COMBAT\":\r\n        return \"Might\";\r\n      case \"GEAR\":\r\n        return \"Skill\";\r\n      case \"MAGIC\":\r\n        return \"Magic\";\r\n      default:\r\n        return \"Unknown\";\r\n    }\r\n  };\r\n\r\n  // Initialize the challenge field with 3 themed rows\r\n  const initializeChallengeField = (totalUnlockSpotsNeeded: number): void => {\r\n    const themes: Array<\"COMBAT\" | \"GEAR\" | \"MAGIC\"> = [\r\n      \"COMBAT\",\r\n      \"GEAR\",\r\n      \"MAGIC\",\r\n    ];\r\n    const rows: ChallengeRow[] = [];\r\n\r\n    const unlockSpotsPerRow = Math.ceil(totalUnlockSpotsNeeded / themes.length);\r\n    let totalUnlockSpotsAdded = 0;\r\n\r\n    themes.forEach((theme, rowIndex) => {\r\n      const rowSpots: CSpot[] = [];\r\n\r\n      for (let i = 0; i < challengeLength; i++) {\r\n        let spotType: CSPOT_TYPE;\r\n        const themeChance = Math.random();\r\n\r\n        if (themeChance < 0.7) {\r\n          switch (theme) {\r\n            case \"COMBAT\":\r\n              spotType = CSPOT_TYPE.USE_ATTRIBUTE_COMBAT;\r\n              break;\r\n            case \"GEAR\":\r\n              spotType = CSPOT_TYPE.USE_ATTRIBUTE_TOOLS;\r\n              break;\r\n            case \"MAGIC\":\r\n              spotType = CSPOT_TYPE.USE_ATTRIBUTE_MAGIC;\r\n              break;\r\n          }\r\n        } else {\r\n          const otherTypes = [\r\n            CSPOT_TYPE.USE_ATTRIBUTE_COMBAT,\r\n            CSPOT_TYPE.USE_ATTRIBUTE_MAGIC,\r\n            CSPOT_TYPE.USE_ATTRIBUTE_TOOLS,\r\n          ];\r\n          spotType = otherTypes[Math.floor(Math.random() * otherTypes.length)];\r\n        }\r\n\r\n        // Add random score points to one spot per row\r\n        const hasScore = i === Math.floor(Math.random() * challengeLength);\r\n        const scorePoints = hasScore\r\n          ? Math.floor(Math.random() * 3) + 1\r\n          : undefined;\r\n\r\n        // Determine challenge points (1-3 circles for difficulty)\r\n        const challengePoints = Math.floor(Math.random() * 3) + 1;\r\n        rowSpots.push({\r\n          id: `${theme.toLowerCase()}_row_spot_${i}`,\r\n          type: spotType,\r\n          position: i,\r\n          used: false,\r\n          icon: getIconForSpotType(spotType, challengePoints),\r\n          scorePoints,\r\n          challengePoints, // Add this to track difficulty\r\n        });\r\n      }\r\n\r\n      rows.push({\r\n        id: `row_${rowIndex}`,\r\n        theme,\r\n        name: `${getUserFacingTheme(theme)}`,\r\n        description: `Focus on ${theme.toLowerCase()} skills`,\r\n        cspots: rowSpots,\r\n        selected: false,\r\n      });\r\n    });\r\n\r\n    // Now that our rows are populoared we can randomly distribute the ASSIST UNLOCKS\r\n    while (totalUnlockSpotsAdded < totalUnlockSpotsNeeded) {\r\n      // get a random row\r\n      const randomRowIndex = Math.floor(Math.random() * rows.length);\r\n      const row = rows[randomRowIndex];\r\n      // find a random position that is not already an UNLOCK ASSIST\r\n      const availablePositions = row.cspots\r\n        .map((spot, index) =>\r\n          spot.type !== CSPOT_TYPE.UNLOCK_ASSIST ? index : -1\r\n        )\r\n        .filter((index) => index !== -1);\r\n      if (availablePositions.length === 0) continue; // all spots are UNLOCK ASSIST, skip\r\n      const randomPosIndex = Math.floor(\r\n        Math.random() * availablePositions.length\r\n      );\r\n      const pos = availablePositions[randomPosIndex];\r\n      // replace that spot with an UNLOCK ASSIST\r\n      row.cspots[pos] = {\r\n        id: `${row.theme.toLowerCase()}_row_spot_${pos}_unlock`,\r\n        type: CSPOT_TYPE.UNLOCK_ASSIST,\r\n        position: pos,\r\n        used: false,\r\n        icon: getIconForSpotType(CSPOT_TYPE.UNLOCK_ASSIST),\r\n        challengePoints: 0,\r\n      };\r\n      totalUnlockSpotsAdded++;\r\n    }\r\n\r\n    setChallengeRows(rows);\r\n  };\r\n\r\n  // Initialize assist tags (8 total: location tags + random tags)\r\n  const initializeAssistTags = () => {\r\n    const tags: AssistTag[] = [];\r\n    if (authoredAssistTags && authoredAssistTags.length > 0) {\r\n      authoredAssistTags.forEach((tag, index) => {\r\n        tags.push({\r\n          id: `authored_assist_${index}`,\r\n          tag: tag,\r\n          state: tagManager.isTagCollected(tag) ? \"AVAILABLE\" : \"UNAVAILABLE\",\r\n          isLocationTag: true,\r\n        });\r\n      });\r\n    }\r\n    if (generateRandomAssistTags) {\r\n      // Add location tags from current encounter (if any)\r\n      // This would need to be populated from encounter context\r\n      const locationTags = tagManager.getOutstandingLocationTags();\r\n      locationTags.forEach((tag, index) => {\r\n        tags.push({\r\n          id: `location_${index}`,\r\n          tag: tag,\r\n          state: \"UNAVAILABLE\",\r\n          isLocationTag: true,\r\n        });\r\n      });\r\n\r\n      const collectedLocationTags = tagManager.getCollectedLocationTags();\r\n      collectedLocationTags.forEach((tag, index) => {\r\n        tags.push({\r\n          id: `collected_location_${index}`,\r\n          tag: tag,\r\n          state: \"AVAILABLE\",\r\n          isLocationTag: true,\r\n        });\r\n      });\r\n\r\n      // Add random tags to reach total of 5\r\n      const randomTags = tagManager.generateRelevantFlavorTags(5);\r\n      randomTags.forEach((tag, index) => {\r\n        tags.push({\r\n          id: `assist_${index}`,\r\n          tag: tag.tag,\r\n          state: tagManager.isTagCollected(tag.tag)\r\n            ? \"AVAILABLE\"\r\n            : \"UNAVAILABLE\", // 60% available initially\r\n          isLocationTag: false,\r\n        });\r\n      });\r\n    }\r\n    const tagsToAdd = tags.slice(0, 5);\r\n    setAssistTags(tagsToAdd);\r\n\r\n    const unavailableAssistTags = tagsToAdd.filter(\r\n      (tag) => tag.state === \"UNAVAILABLE\"\r\n    );\r\n\r\n    initializeChallengeField(unavailableAssistTags.length);\r\n  };\r\n\r\n  // Initialize on mount\r\n  useEffect(() => {\r\n    initializeAssistTags();\r\n  }, []); // Empty dependency array means this runs once on mount\r\n\r\n  const nbAvailableAssistTags = assistTags.filter(\r\n    (tag) => tag.state === \"AVAILABLE\"\r\n  ).length;\r\n\r\n  // Character selection\r\n  const handleCharacterClick = (character: Character) => {\r\n    if (selectedCharacter && selectedCharacter.id === character.id) {\r\n      // Deselect if already selected\r\n      setSelectedCharacter(null);\r\n\r\n      // Deactivate all active assist tags and reset bonus\r\n      setAssistTags((prev) =>\r\n        prev.map((tag) =>\r\n          tag.state === \"ACTIVE\" ? { ...tag, state: \"AVAILABLE\" } : tag\r\n        )\r\n      );\r\n      setAssistBonus(0);\r\n      return;\r\n    }\r\n    setSelectedCharacter(character);\r\n  };\r\n\r\n  // Row selection with animation\r\n  const handleRowClick = async (rowIndex: number) => {\r\n    if (!selectedCharacter) return;\r\n\r\n    // Check if player can afford this row\r\n    if (!canPlayerAffordRow(selectedCharacter, rowIndex)) {\r\n      return;\r\n    }\r\n\r\n    // get player from charachter: \r\n    const player = appManager.getPlayerManager().getPlayerAssignedCharacter(selectedCharacter);\r\n   // Expose the tag in the campaign system\r\n          appManager.getPartyManager().playersTakeAction(((player && [player.name]) || undefined), true);\r\n    // Clear any previous highlight states\r\n    setHighlightedSpot(null);\r\n    setFinalSelectedSpot(null);\r\n\r\n    // Start selection animation\r\n    setChallengeRows((prev) =>\r\n      prev.map((row, index) => ({\r\n        ...row,\r\n        selected: index === rowIndex,\r\n        animatingSelection: index === rowIndex,\r\n      }))\r\n    );\r\n\r\n    const row = challengeRows[rowIndex];\r\n    const availableSpots = row.cspots.filter(spot => !spot.used);\r\n    \r\n    // Pre-select the target spot\r\n    const randomSpotIndex = Math.floor(Math.random() * availableSpots.length);\r\n    const targetSpot = availableSpots[randomSpotIndex];\r\n    const targetSpotIndex = row.cspots.findIndex(spot => spot.id === targetSpot.id);\r\n    \r\n    // Cycling animation\r\n    let currentHighlightIndex = 0;\r\n    let startTime = Date.now();\r\n    let shouldStop = false;\r\n    \r\n    const cycleInterval = setInterval(() => {\r\n      if (availableSpots.length > 0) {\r\n        const spotIndex = row.cspots.findIndex(spot => spot.id === availableSpots[currentHighlightIndex].id);\r\n        setHighlightedSpot({ rowIndex, spotIndex });\r\n        \r\n        // Check if we should stop cycling (after minimum time has passed)\r\n        const elapsedTime = Date.now() - startTime;\r\n        if (elapsedTime >= ANIMATION_TIMINGS.SELECTION_DURATION - ANIMATION_TIMINGS.FINAL_PULSE_DURATION) {\r\n          shouldStop = true;\r\n        }\r\n        \r\n        // Move to next spot\r\n        currentHighlightIndex = (currentHighlightIndex + 1) % availableSpots.length;\r\n        \r\n        // Stop when we land on the target spot (and minimum time has passed)\r\n        if (shouldStop && spotIndex === targetSpotIndex) {\r\n          clearInterval(cycleInterval);\r\n          setHighlightedSpot(null);\r\n          \r\n          // Set final selected spot for pulsing\r\n          setFinalSelectedSpot({ rowIndex, spotIndex: targetSpotIndex });\r\n          \r\n          // After pulse, resolve the selection\r\n          setTimeout(() => {\r\n            setChallengeRows((prev) =>\r\n              prev.map((r, idx) => ({\r\n                ...r,\r\n                animatingSelection: false,\r\n              }))\r\n            );\r\n            \r\n            setFinalSelectedSpot(null);\r\n            resolveSpotSelection(rowIndex, targetSpot, selectedCharacter);\r\n          }, ANIMATION_TIMINGS.FINAL_PULSE_DURATION);\r\n        }\r\n      }\r\n    }, ANIMATION_TIMINGS.CYCLE_SPEED);\r\n  };\r\n\r\n  // Resolve spot selection and effects\r\n  const resolveSpotSelection = (\r\n    rowIndex: number,\r\n    spot: CSpot,\r\n    character: Character\r\n  ) => {\r\n    // Note: For now, skip attention reduction as ATTENTION is not in ATTRIBUTE_TYPE enum\r\n    // This would need to be implemented when attention system is available\r\n\r\n    // Mark spot as used and assign to character\r\n    setChallengeRows((prev) =>\r\n      prev.map((row, index) =>\r\n        index === rowIndex\r\n          ? {\r\n              ...row,\r\n              cspots: row.cspots.map((s) =>\r\n                s.id === spot.id\r\n                  ? { ...s, used: true, characterId: String(character.id) }\r\n                  : s\r\n              ),\r\n            }\r\n          : row\r\n      )\r\n    );\r\n\r\n    // Handle UNLOCK_ASSIST spots\r\n    if (spot.type === CSPOT_TYPE.UNLOCK_ASSIST) {\r\n      // Show assist options modal\r\n      renderAssistOptionsResults();\r\n    } else {\r\n      // Add skill points for non-assist spots\r\n      const skillKey = getSkillKeyForType(spot.type);\r\n      setSkillTotals((prev) => ({\r\n        ...prev,\r\n        [skillKey]: prev[skillKey] + spot.challengePoints! + assistBonus,\r\n      }));\r\n\r\n      // Add used attribute to character\r\n      const attributeType = getAttributeForChallengeRowType(rowIndex);\r\n      characterManager.addUsedAttribute(character, attributeType);\r\n    }\r\n\r\n    // Update moves completed and reward level\r\n    setMovesCompleted((prev) => {\r\n      const newCount = prev + 1;\r\n      updateRewardLevel(newCount);\r\n      return newCount;\r\n    });\r\n\r\n    // Clear selections\r\n    setSelectedCharacter(null);\r\n    setChallengeRows((prev) =>\r\n      prev.map((row) => ({ ...row, selected: false }))\r\n    );\r\n\r\n    // Convert all ACTIVE assist tags to USED and reset bonus\r\n    setAssistTags((prev) =>\r\n      prev.map((tag) =>\r\n        tag.state === \"ACTIVE\" ? { ...tag, state: \"USED\" } : tag\r\n      )\r\n    );\r\n    setAssistBonus(0);\r\n    \r\n    if (spot.scorePoints) {\r\n      // Add score to campaign via campaign manager\r\n      campaignManager.addEncounterPoints(spot.scorePoints);\r\n      console.log(\r\n        `Character ${character.name} gained ${spot.scorePoints} encounter points!`\r\n      );\r\n    }\r\n  };\r\n\r\n  const skillsCompleted = () => {\r\n    const magicCompleted = skillTotals.magic >= skillThresholds.magic;\r\n    const combatCompleted = skillTotals.combat >= skillThresholds.combat;\r\n    const gearCompleted = skillTotals.gear >= skillThresholds.gear;\r\n    return (\r\n      (magicCompleted ? 1 : 0) +\r\n      (combatCompleted ? 1 : 0) +\r\n      (gearCompleted ? 1 : 0)\r\n    );\r\n  };\r\n\r\n  // Update reward level based on progress\r\n  const updateRewardLevel = (moves: number) => {\r\n    const skills = skillsCompleted();\r\n\r\n    if (skills === 0) {\r\n      setCurrentRewardLevel(0); // Failure\r\n    } else if (skills === 1) {\r\n      setCurrentRewardLevel(1); // Simple\r\n    } else if (skills === 2) {\r\n      setCurrentRewardLevel(2); // Challenging\r\n    } else {\r\n      setCurrentRewardLevel(3); // Hard\r\n    }\r\n  };\r\n\r\n  // Calculate current reward level reactively\r\n  const getCurrentRewardLevel = () => {\r\n    const skills = skillsCompleted();\r\n\r\n    if (skills === 0) {\r\n      return 0; // Failure\r\n    } else if (skills === 1) {\r\n      return 1; // Simple\r\n    } else if (skills === 2) {\r\n      return 2; // Challenging\r\n    } else {\r\n      return 3; // Hard\r\n    }\r\n  };\r\n\r\n  // Handle assist tag click\r\n  const handleAssistTagClick = (tagId: string) => {\r\n    const clickedTag = assistTags.find((tag) => tag.id === tagId);\r\n\r\n    if (clickedTag) {\r\n      if (clickedTag.state === \"AVAILABLE\") {\r\n        // Activate the tag and increment bonus\r\n        setAssistTags((prev) =>\r\n          prev.map((tag) =>\r\n            tag.id === tagId ? { ...tag, state: \"ACTIVE\" } : tag\r\n          )\r\n        );\r\n        setAssistBonus((prev) => prev + 1);\r\n        chatManager.triggerChallengeAssistChat(\r\n          clickedTag.tag,\r\n          selectedCharacter || undefined\r\n        );\r\n      } else if (clickedTag.state === \"ACTIVE\") {\r\n        // Deactivate the tag and decrement bonus\r\n        setAssistTags((prev) =>\r\n          prev.map((tag) =>\r\n            tag.id === tagId ? { ...tag, state: \"AVAILABLE\" } : tag\r\n          )\r\n        );\r\n        setAssistBonus((prev) => Math.max(0, prev - 1));\r\n      }\r\n    }\r\n\r\n    // // Show tag resolution (implementation depends on tag system)\r\n    // const tag = assistTags.find((t) => t.id === tagId);\r\n    // if (tag) {\r\n    //   setCurrentResultTag(tag.tag);\r\n    //   setShowResults(true);\r\n    // }\r\n  };\r\n\r\n  // Accept challenge completion\r\n  const handleAcceptChallenge = () => {\r\n    setChallengeComplete(true);\r\n\r\n    // Apply reward effects\r\n    const currentReward = rewardLevels[currentRewardLevel];\r\n\r\n    // Apply tension/attention changes (implementation depends on campaign system)\r\n    console.log(`Challenge completed with reward: ${currentReward.name}`);\r\n\r\n    // Show completion modal or expose authored tag\r\n    if (authoredTag) {\r\n      // Use TagModal instead of setting state for ResultsDisplay\r\n      appManager.getUiManager().showTagModal({\r\n        title: `Challenge Completed`,\r\n        description: config?.successText,\r\n        tags: [\r\n          tagManager.tagToEncounterFlavorTag(\r\n            authoredTag,\r\n            FlavorTagSource.ENCOUNTER,\r\n            FlavorTagTheme.NONE\r\n          )\r\n        ],\r\n        effects: [], // Could add challenge completion effects here\r\n        selectedTags: [], // No previously selected tags\r\n        remainingClicks: 1, // Allow clicking the tag to acknowledge\r\n\r\n        onTagClick: (tag) => {\r\n          // Expose the tag and complete the challenge\r\n          \r\n          // Use setTimeout to ensure the tag click completes before closing modal\r\n          setTimeout(() => {\r\n            appManager.getUiManager().closeModal();\r\n            if (onComplete) onComplete();\r\n            campaignManager.exposeTag(tag);\r\n          }, 100);\r\n        },\r\n        onClose: () => {\r\n          // If they close without clicking, still complete\r\n          if (onComplete) onComplete();\r\n        }\r\n      });\r\n    } else {\r\n      // Default completion with attention bonus\r\n      if (onComplete) onComplete();\r\n    }\r\n  };\r\n\r\n  const renderAssistOptionsResults = () => {\r\n    const unavailableAssistTags = assistTags.filter(\r\n      (tag) => tag.state === \"UNAVAILABLE\"\r\n    );\r\n\r\n    if (unavailableAssistTags.length === 0) return;\r\n\r\n    // Convert unavailable assist tags to EncounterFlavorTag format\r\n    const tagsForModal = unavailableAssistTags.map(assistTag => \r\n      tagManager.tagToEncounterFlavorTag(\r\n        assistTag.tag,\r\n        campaignManager.getPotentialTagSource(assistTag.tag),\r\n        FlavorTagTheme.NONE\r\n      )\r\n    );\r\n\r\n    appManager.getUiManager().showTagModal({\r\n      title: \"Exposition Opportunity\",\r\n      description: \"During the challenge, an opportunity to introduce one of the following topics comes up.\",\r\n      tags: tagsForModal,\r\n      effects: [], // No effects for assist unlock\r\n      selectedTags: [], // No previously selected tags\r\n      remainingClicks: 1, // Only allow one tag click\r\n   //   tagInstructions: \"Select one assistance option to unlock\",\r\n      onTagClick: (tag) => {\r\n        // Find the corresponding assist tag and update its state\r\n        const assistTag = unavailableAssistTags.find(at => at.tag.name === tag.tag.name);\r\n        if (assistTag) {\r\n          setAssistTags(prev => \r\n            prev.map(at => \r\n              at.id === assistTag.id \r\n                ? { ...at, state: \"AVAILABLE\" }\r\n                : at\r\n            )\r\n          );\r\n       \r\n\r\n\r\n          campaignManager.exposeTag(tag);\r\n          // Use setTimeout to ensure the tag click completes before closing modal\r\n          setTimeout(() => {\r\n            appManager.getUiManager().closeModal();\r\n          }, 100);\r\n        }\r\n      },\r\n      onClose: () => {\r\n        // Modal closed, nothing special needed\r\n        console.log(\"Assist options modal closed\");\r\n      }\r\n    });\r\n  };\r\n\r\n  // Render character list\r\n  const renderCharacterList = (isActive: boolean) => (\r\n    <CContainer title=\"Heroes\" variant={isActive ? \"primary\" : \"secondary\"}>\r\n      {characters.map((character) => {\r\n        // Get total attributes from class/race combination\r\n        const totalAttributes = getCombinedAttributes(character);\r\n\r\n        // Calculate used attributes from attributeLoss\r\n        const combatUsed =\r\n          character.attributeLoss?.[ATTRIBUTE_TYPE.COMBAT] || 0;\r\n        const magicUsed = character.attributeLoss?.[ATTRIBUTE_TYPE.MAGIC] || 0;\r\n        const toolsUsed = character.attributeLoss?.[ATTRIBUTE_TYPE.TOOLS] || 0;\r\n\r\n        // Calculate remaining attributes\r\n        const combatTotal = totalAttributes[ATTRIBUTE_TYPE.COMBAT] || 0;\r\n        const magicTotal = totalAttributes[ATTRIBUTE_TYPE.MAGIC] || 0;\r\n        const toolsTotal = totalAttributes[ATTRIBUTE_TYPE.TOOLS] || 0;\r\n\r\n        return (\r\n          <div\r\n            key={character.id}\r\n            className={`character-item ${\r\n              selectedCharacter?.id === character.id\r\n                ? \"selected\"\r\n                : selectedCharacter\r\n                ? \"disabled\"\r\n                : \"\"\r\n            }`}\r\n            onClick={() => handleCharacterClick(character)}\r\n          >\r\n            <div className=\"left-side\">\r\n              <div className=\"character-name\">{character.name}</div>\r\n              <div className=\"character-icon\">\r\n                <CImage imageId={character.icon} />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"character-info\">\r\n              {/* Combat attribute row */}\r\n              <div className=\"attribute-row\">\r\n                <span className=\"attribute-label\"></span>\r\n                <div className=\"attribute-icons\">\r\n                  {Array.from(\r\n                    { length: Math.max(1, combatTotal) },\r\n                    (_, index) => (\r\n                      <span\r\n                        key={`combat-${index}`}\r\n                        className={`attribute-icon ${\r\n                          combatTotal === 0 || index >= combatTotal - combatUsed\r\n                            ? \"used\"\r\n                            : \"available\"\r\n                        }`}\r\n                      >\r\n                        ⚔️\r\n                      </span>\r\n                    )\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Magic attribute row */}\r\n              <div className=\"attribute-row\">\r\n                <span className=\"attribute-label\"></span>\r\n                <div className=\"attribute-icons\">\r\n                  {Array.from(\r\n                    { length: Math.max(1, magicTotal) },\r\n                    (_, index) => (\r\n                      <span\r\n                        key={`magic-${index}`}\r\n                        className={`attribute-icon ${\r\n                          magicTotal === 0 || index >= magicTotal - magicUsed\r\n                            ? \"used\"\r\n                            : \"available\"\r\n                        }`}\r\n                      >\r\n                        ✨\r\n                      </span>\r\n                    )\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Tools attribute row */}\r\n              <div className=\"attribute-row\">\r\n                <span className=\"attribute-label\"></span>\r\n                <div className=\"attribute-icons\">\r\n                  {Array.from(\r\n                    { length: Math.max(1, toolsTotal) },\r\n                    (_, index) => (\r\n                      <span\r\n                        key={`tools-${index}`}\r\n                        className={`attribute-icon ${\r\n                          toolsTotal === 0 || index >= toolsTotal - toolsUsed\r\n                            ? \"used\"\r\n                            : \"available\"\r\n                        }`}\r\n                      >\r\n                        🔧\r\n                      </span>\r\n                    )\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        );\r\n      })}\r\n    </CContainer>\r\n  );\r\n\r\n  // Render challenge rows\r\n  const renderChallengeRows = (active: boolean) => (\r\n    <CContainer\r\n      title=\"Methods and Tactics\"\r\n      variant={active ? \"primary\" : \"secondary\"}\r\n    >\r\n      <div className=\"challenge-rows\">\r\n        {challengeRows.map((row, rowIndex) => {\r\n          const isRowDisabled = selectedCharacter && !canPlayerAffordRow(selectedCharacter, rowIndex);\r\n          const canAffordRow = selectedCharacter && canPlayerAffordRow(selectedCharacter, rowIndex);\r\n          \r\n          return (\r\n            <div\r\n              key={row.id}\r\n              className={`challenge-row theme-${row.theme.toLowerCase()} \r\n                ${row.selected ? \"selected\" : \"\"} \r\n                ${row.animatingSelection ? \"animating\" : \"\"}\r\n                ${!selectedCharacter ? \"disabled\" : \"\"}\r\n                ${isRowDisabled ? \"attribute-disabled\" : \"\"}\r\n                ${canAffordRow ? \"show-cost\" : \"\"}`}\r\n              data-cost-text={canAffordRow ? getAttributeCostText(rowIndex) : \"\"}\r\n              onClick={() => handleRowClick(rowIndex)}\r\n            >\r\n            <div className=\"row-header\">\r\n              <div className=\"row-icon\">{getIconForTheme(row.theme)}</div>\r\n              <div className=\"row-label\">{row.name}</div>\r\n            </div>\r\n\r\n            <div className=\"challenge-spots\">\r\n              {row.cspots.map((spot, spotIndex) => {\r\n                const isHighlighted = highlightedSpot?.rowIndex === rowIndex && highlightedSpot?.spotIndex === spotIndex;\r\n                const isFinalSelected = finalSelectedSpot?.rowIndex === rowIndex && finalSelectedSpot?.spotIndex === spotIndex;\r\n                \r\n                return (\r\n                  <div\r\n                    key={spot.id}\r\n                    className={`challenge-spot ${\r\n                      spot.used ? \"used\" : \"available\"\r\n                    } ${\r\n                      isHighlighted ? \"cycling-highlight\" : \"\"\r\n                    } ${\r\n                      isFinalSelected ? \"final-selected\" : \"\"\r\n                    } ${getThemeColorClass(spot.type)}`}\r\n                    data-row={rowIndex}\r\n                    data-spot-position={spot.position}\r\n                  >\r\n                    <div className=\"spot-icon\">\r\n                      {!spot.used && spot.type === CSPOT_TYPE.UNLOCK_ASSIST ? (\r\n                        <FlavorTagPill\r\n                          showTooltip={true}\r\n                          disabled={false}\r\n                          tag={tagManager.tagToEncounterFlavorTag(\r\n                            {\r\n                              name: \"?\",\r\n                            },\r\n                            FlavorTagSource.NONE,\r\n                            FlavorTagTheme.NONE\r\n                          )}\r\n                        />\r\n                      ) : (\r\n                        !spot.used && renderDicePips(spot.challengePoints || 1)\r\n                      )}\r\n                    </div>\r\n\r\n                    {!spot.used && spot.scorePoints && (\r\n                      <div className=\"score-indicator\">\r\n                        <DiceScore score={spot.scorePoints}></DiceScore>\r\n                      </div>\r\n                    )}\r\n\r\n                    {spot.used && spot.characterId && (\r\n                      <div className=\"character-marker\">\r\n                        <CImage\r\n                          imageId={\r\n                            characters.find(\r\n                              (c) => String(c.id) === spot.characterId\r\n                            )?.icon\r\n                          }\r\n                        />\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </CContainer>\r\n  );\r\n\r\n  // Render assist tags panel\r\n  const renderAssistTags = (active: boolean) => (\r\n    <CContainer\r\n      title=\"Potential Assistance\"\r\n      variant={active ? \"primary\" : \"secondary\"}\r\n    >\r\n      <div\r\n        className={`assist-tags-container ${\r\n          !selectedCharacter ? \"disabled\" : \"\"\r\n        }`}\r\n      >\r\n        {assistTags.map((assistTag) => (\r\n          <div\r\n            key={assistTag.id}\r\n            className={`assist-tag ${assistTag.state.toLowerCase()}`}\r\n            onClick={() =>\r\n              (assistTag.state === \"AVAILABLE\" ||\r\n                assistTag.state === \"ACTIVE\") &&\r\n              handleAssistTagClick(assistTag.id)\r\n            }\r\n          >\r\n            <span className=\"tag-name\">\r\n              <FlavorTagPill\r\n                showTooltip={false}\r\n                disabled={\r\n                  assistTag.state !== \"ACTIVE\" &&\r\n                  assistTag.state !== \"AVAILABLE\"\r\n                }\r\n                tag={tagManager.tagToEncounterFlavorTag(\r\n                  assistTag.tag,\r\n                  campaignManager.getPotentialTagSource(assistTag.tag),\r\n                  FlavorTagTheme.NONE\r\n                )}\r\n              />\r\n            </span>\r\n            <span className=\"tag-state\">{assistTag.state}</span>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </CContainer>\r\n  );\r\n\r\n  // Render totals column\r\n  const renderTotalsColumn = () => (\r\n    <div className=\"totals-column\">\r\n      <CContainer title=\"Challenge Status\" variant=\"primary-container\">\r\n        <div className=\"skill-totals\">\r\n          <div className=\"skill-bar\">\r\n            <FillBar\r\n              totalSegments={skillThresholds.combat}\r\n              filledSegments={skillTotals.combat}\r\n              label={`${skillTotals.combat}/${skillThresholds.combat}`}\r\n              theme=\"combat\"\r\n            />\r\n            <div\r\n              className={`skill-icon ${\r\n                skillTotals.combat >= skillThresholds.combat ? \"completed\" : \"\"\r\n              }`}\r\n            >\r\n              <div className=\"skill-circle combat-circle\" />\r\n            </div>\r\n          </div>\r\n          <div className=\"skill-bar\">\r\n            <FillBar\r\n              totalSegments={skillThresholds.gear}\r\n              filledSegments={skillTotals.gear}\r\n              label={`${skillTotals.gear}/${skillThresholds.gear}`}\r\n              theme=\"gear\"\r\n            />\r\n            <div\r\n              className={`skill-icon ${\r\n                skillTotals.gear >= skillThresholds.gear ? \"completed\" : \"\"\r\n              }`}\r\n            >\r\n              <div className=\"skill-circle gear-circle\" />\r\n            </div>\r\n          </div>\r\n          <div className=\"skill-bar\">\r\n            <FillBar\r\n              totalSegments={skillThresholds.magic}\r\n              filledSegments={skillTotals.magic}\r\n              label={`${skillTotals.magic}/${skillThresholds.magic}`}\r\n              theme=\"magic\"\r\n            />\r\n            <div\r\n              className={`skill-icon ${\r\n                skillTotals.magic >= skillThresholds.magic ? \"completed\" : \"\"\r\n              }`}\r\n            >\r\n              <div className=\"skill-circle magic-circle\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div\r\n            className={`result-tag-container ${\r\n              isFailureState() ? \"failure\" : \"success\"\r\n            }`}\r\n            onClick={handleAcceptChallenge}\r\n            style={\r\n              !isFailureState()\r\n                ? {\r\n                    backgroundColor: \"var(--ui-color-primary)\",\r\n                    border: \"6px solid white\",\r\n                  }\r\n                : {\r\n                    backgroundColor: \"var(--ui-color-failure)\",\r\n                    border: \"6px solid var(--ui-color-failure-border)\",\r\n                  }\r\n            }\r\n          >\r\n            {authoredTag && (\r\n              <div className=\"tag-content\">\r\n                <FlavorTagPill\r\n                  showTooltip={false}\r\n                  disabled={isFailureState()}\r\n                  tag={tagManager.tagToEncounterFlavorTag(\r\n                    successTag,\r\n                    tagManager.isTagCollected(successTag)\r\n                      ? FlavorTagSource.ENCOUNTER\r\n                      : FlavorTagSource.ENCOUNTER_EXPECTED,\r\n                    FlavorTagTheme.NONE\r\n                  )}\r\n                />\r\n                {isFailureState() && <div className=\"diagonal-stripe\"></div>}\r\n              </div>\r\n            )}\r\n            <div className=\"accept-label\">\r\n              {isFailureState() ? \"Accept Failure\" : \"Accept Results\"}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </CContainer>\r\n\r\n      <div className=\"results-meter\">\r\n        {rewardLevels.map((level, index) => (\r\n          <div\r\n            key={level.id}\r\n            className={`reward-level ${\r\n              index === getCurrentRewardLevel() ? \"current\" : \"\"\r\n            }`}\r\n          >\r\n            <div className=\"reward-indicators\">\r\n              {[0, 1, 2].map((dotIndex) => (\r\n                <div\r\n                  key={dotIndex}\r\n                  className={`indicator-dot ${\r\n                    dotIndex < index ? \"filled\" : \"\"\r\n                  }`}\r\n                />\r\n              ))}\r\n            </div>\r\n            <div className=\"reward-content\">\r\n              <span className=\"level-name\">{level.name}</span>\r\n              <span className=\"level-description\">{level.description}</span>\r\n            </div>\r\n          </div>\r\n        ))}\r\n        <div className=\"results-label\">CURRENT RESULT</div>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"enhanced-skill-challenge\">\r\n      <div className=\"challenge-layout\">\r\n        {/* Left side: Character list and challenge rows */}\r\n        <div className=\"left-section\">\r\n          <div className=\"character-column\">\r\n            <div className=\"character-section\">\r\n              {renderCharacterList(!selectedCharacter)}\r\n            </div>\r\n          </div>\r\n          <div className=\"challenge-column\">\r\n            <div className=\"challenge-section\">\r\n              {renderChallengeRows(!!selectedCharacter)}\r\n            </div>\r\n\r\n            <div className=\"assist-section\">\r\n              {renderAssistTags(\r\n                !!selectedCharacter && nbAvailableAssistTags > 0\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"right-section\">{renderTotalsColumn()}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EnhancedSkillChallenge;\r\n","import React from 'react';\r\nimport { Encounter } from '../../models';\r\nimport EnhancedSkillChallenge from './enhancedSkillChallenge';\r\nimport EncounterHeader from './encounterHeader';\r\nimport { useCampaignManager } from '../managerContexts';\r\n\r\ninterface GameEncounterSkillChallengeProps {\r\n  encounter: Encounter;\r\n}\r\n\r\nconst GameEncounterSkillChallenge: React.FC<GameEncounterSkillChallengeProps> = ({ encounter }) => {\r\n  const campaignManager = useCampaignManager();\r\n\r\n  // Extract challenge configuration from encounter\r\n  const challengeConfig = encounter.challenge?.[0];\r\n  const challengeLength = 10; // Enhanced default length\r\n  \r\n  const handleChallengeComplete = () => {\r\n    // Move to next phase or back to overview\r\n    campaignManager.backToOverview();\r\n  };\r\n\r\n  return (\r\n    <div className=\"game-encounter-skill-challenge\">\r\n      <EncounterHeader\r\n        title={challengeConfig?.name || \"Enhanced Skill Challenge\"}\r\n        description={challengeConfig?.description || encounter.location.name || \"Select characters and challenge rows to overcome themed obstacles and collect skill points.\"}\r\n        instructions={[true, false]} // Instructions are enabled/disabled flags\r\n        childClass=\"skill-challenge-header\"\r\n      />\r\n      \r\n      <EnhancedSkillChallenge\r\n        challengeLength={challengeLength}\r\n        authoredTag={challengeConfig?.revealTag}\r\n        authoredAssistTags={challengeConfig?.assistTags}\r\n        skillThresholds={challengeConfig?.skillThresholds}\r\n        onComplete={handleChallengeComplete}\r\n        config={challengeConfig}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GameEncounterSkillChallenge;\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport {\r\n  Encounter,\r\n  Player,\r\n  EncounterFlavorTag,\r\n  FlavorTagSource,\r\n  EffectData,\r\n} from \"../../models\";\r\nimport {\r\n  useAppManager,\r\n  useCampaignManager,\r\n  usePlayerManager,\r\n  useUiManager,\r\n} from \"../managerContexts\";\r\nimport EncounterHeader from \"./encounterHeader\";\r\nimport FlavorTagPill from \"../UI/FlavorTagPill\";\r\nimport DiceScore from \"../UI/DiceScore\";\r\nimport Cimage from \"../UI/cimage\";\r\nimport \"./gameRoom.scss\";\r\nimport \"./gameEncounterPuzzle.scss\";\r\nimport TooltipWrapper from \"../UI/TooltipWrapper\";\r\n\r\n// Configuration constants\r\nconst SHORT_PAUSE_MS = 1000;\r\nconst TINY_PAUSE_MS = 250; // Used for small delays in animations\r\nconst TENSION_SQUARES_ENABLED = false;\r\nconst TENSION_SQUARES_CHANCE = 0.4;\r\nconst NO_HINTS_SCORE = 6;\r\n\r\ntype PuzzleDifficulty = \"simple\" | \"clever\" | \"tricky\";\r\ntype PuzzlePhase = \"setup\" | \"instructions\" | \"solving\" | \"player-stopped\";\r\ntype GridSquareType =\r\n  | \"answer\"\r\n  | \"hint\"\r\n  | \"frustration\"\r\n  | \"exposed\"\r\n  | \"unexposed\"\r\n  | \"directionless\";\r\ntype TensionLevel = \"boring\" | \"low\" | \"high\" | \"crisis\";\r\ntype HintDirection = \"up\" | \"down\" | \"left\" | \"right\";\r\n\r\ninterface GameEncounterPuzzleProps {\r\n  encounter: Encounter;\r\n}\r\n\r\ninterface GridCell {\r\n  type: GridSquareType;\r\n  tag?: EncounterFlavorTag;\r\n  hintDirection?: HintDirection;\r\n  playerIcon?: Player;\r\n  visited: boolean;\r\n  pinned: boolean; // Stays constant between solving attempts\r\n  scoreReward: number; // 0-4 points\r\n  tensionLevel?: TensionLevel;\r\n  isAnswer: boolean;\r\n  isFrustration: boolean;\r\n  isTemporaryFrustration: boolean;\r\n  isFlashing?: boolean;\r\n}\r\n\r\nconst GameEncounterPuzzle: React.FC<GameEncounterPuzzleProps> = ({\r\n  encounter,\r\n}) => {\r\n  // Phase management\r\n  const [currentPhase, setCurrentPhase] = useState<PuzzlePhase>(\"setup\");\r\n\r\n  // Setup phase state\r\n  const [difficulty, setDifficulty] = useState<PuzzleDifficulty>(\"simple\");\r\n  const [hintsCount, setHintsCount] = useState(3);\r\n\r\n  // Grid configuration based on difficulty\r\n  const getGridConfig = (diff: PuzzleDifficulty) => {\r\n    switch (diff) {\r\n      case \"simple\":\r\n        return { rows: 4, cols: 4, reward: 2, extraFrustration: 0 };\r\n      case \"clever\":\r\n        return { rows: 4, cols: 5, reward: 4, extraFrustration: 1 };\r\n      case \"tricky\":\r\n        return { rows: 5, cols: 5, reward: 6, extraFrustration: 2 };\r\n    }\r\n  };\r\n\r\n  // Grid state\r\n  const [grid, setGrid] = useState<GridCell[][]>([]);\r\n  const [selectedPlayer, setSelectedPlayer] = useState<Player | null>(null);\r\n  const [currentScore, setCurrentScore] = useState(0);\r\n  const [soCloseUsed, setSoCloseUsed] = useState(false);\r\n  const [soCloseCount, setSoCloseCount] = useState(0);\r\n  const [highlightedCells, setHighlightedCells] = useState<\r\n    { row: number; col: number }[]\r\n  >([]);\r\n  const [playerPosition, setPlayerPosition] = useState<{\r\n    row: number;\r\n    col: number;\r\n  } | null>(null);\r\n  const [usedPlayers, setUsedPlayers] = useState<Set<number>>(new Set());\r\n  const [isAnimating, setIsAnimating] = useState(false);\r\n  const [buttonsEnabled, setButtonsEnabled] = useState(true);\r\n  const [currentStep, setCurrentStep] = useState<string>(\"\");\r\n  const [adjustHintsMode, setAdjustHintsMode] = useState(false);\r\n  const [floatingIconPosition, setFloatingIconPosition] = useState<{\r\n    x: number;\r\n    y: number;\r\n    targetRow: number;\r\n    targetCol: number;\r\n    player: Player;\r\n    isAnimating: boolean;\r\n  } | null>(null);\r\n  const [currentStepPlayerIcon, setCurrentStepPlayerIcon] = useState<{\r\n    player: Player;\r\n    isVisible: boolean;\r\n  } | null>(null);\r\n  const [gridPlayerIcon, setGridPlayerIcon] = useState<{\r\n    player: Player;\r\n    row: number;\r\n    col: number;\r\n    isVisible: boolean;\r\n  } | null>(null);\r\n  // Store the generated hint tags to maintain consistency between setup and grid\r\n  const [generatedHintTags, setGeneratedHintTags] = useState<any[]>([]);\r\n\r\n  const appManager = useAppManager();\r\n  const campaignManager = useCampaignManager();\r\n  const playerManager = usePlayerManager();\r\n  const uiManager = useUiManager();\r\n  const tagManager = appManager.getTagManager();\r\n  const partyManager = appManager.getPartyManager();\r\n  const chatManager = appManager.getChatManager();\r\n\r\n  const players = playerManager.getPlayers();\r\n\r\n  // Helper functions\r\n  const getSoCloseLimit = (): number => {\r\n    // Eventually this will come from campaignManager\r\n    // For now, hardcoded to 2\r\n    return 2;\r\n  };\r\n\r\n  const getSoCloseRemaining = (): number => {\r\n    return getSoCloseLimit() - soCloseCount;\r\n  };\r\n\r\n  const hasHintSquares = (): boolean => {\r\n    for (let row = 0; row < grid.length; row++) {\r\n      for (let col = 0; col < grid[row].length; col++) {\r\n        if (grid[row][col].type === \"hint\") {\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const calculateScore = (\r\n    hints: number,\r\n    isNoHintsAvailable: boolean = false,\r\n    puzzleDifficulty: PuzzleDifficulty = \"tricky\"\r\n  ): number => {\r\n    // if (hints === 0 && isNoHintsAvailable) return NO_HINTS_SCORE;\r\n    // let score = hints >= 10 ? 1 : 1 + Math.floor((10 - hints) / 1) * 0.5;\r\n    // if (hints <= 1) score += hints === 0 ? 5 : 2;\r\n\r\n    // Apply difficulty multiplier\r\n    switch (puzzleDifficulty) {\r\n      case \"simple\":\r\n        // score *= 0.5; // Half the score\r\n        return 4;\r\n\r\n      case \"clever\":\r\n        //   score *= 0.75; // Three-quarters the score\r\n        return 6;\r\n\r\n      case \"tricky\":\r\n        return 8;\r\n      // Keep current values (multiplier of 1.0)\r\n    }\r\n    return 1;\r\n    //  return Math.round(score * 10) / 10; // Round to 1 decimal place\r\n  };\r\n\r\n  const calculateAbandonmentCost = (\r\n    currentScore: number\r\n  ): { attitude: number; tension: number } => {\r\n    console.log(\"calculateAbandonmentCost called with score:\", currentScore);\r\n    return {\r\n      attitude: 1,\r\n      tension: 20,\r\n    };\r\n  };\r\n\r\n  const getValidHintDirections = (\r\n    row: number,\r\n    col: number,\r\n    gridConfig: ReturnType<typeof getGridConfig>\r\n  ): HintDirection[] => {\r\n    const directions: HintDirection[] = [];\r\n    if (row > 0) directions.push(\"up\");\r\n    if (row < gridConfig.rows - 1) directions.push(\"down\");\r\n    if (col > 0) directions.push(\"left\");\r\n    if (col < gridConfig.cols - 1) directions.push(\"right\");\r\n    return directions;\r\n  };\r\n\r\n  const getNextDirection = (\r\n    current: HintDirection,\r\n    valid: HintDirection[]\r\n  ): HintDirection => {\r\n    const order: HintDirection[] = [\"up\", \"right\", \"down\", \"left\"];\r\n    const currentIndex = order.indexOf(current);\r\n\r\n    for (let i = 1; i <= 4; i++) {\r\n      const nextIndex = (currentIndex + i) % 4;\r\n      const nextDir = order[nextIndex];\r\n      if (valid.includes(nextDir)) return nextDir;\r\n    }\r\n    return current; // Fallback\r\n  };\r\n\r\n  const getTensionDisplay = (level: TensionLevel): string => {\r\n    switch (level) {\r\n      case \"boring\":\r\n        return \"--\";\r\n      case \"low\":\r\n        return \"-\";\r\n      case \"high\":\r\n        return \"+\";\r\n      case \"crisis\":\r\n        return \"++\";\r\n    }\r\n  };\r\n\r\n  const getTensionValue = (level: TensionLevel): number => {\r\n    switch (level) {\r\n      case \"boring\":\r\n        return -5;\r\n      case \"low\":\r\n        return -2;\r\n      case \"high\":\r\n        return 2;\r\n      case \"crisis\":\r\n        return 5;\r\n    }\r\n  };\r\n\r\n  const getTensionColor = (level: TensionLevel): string => {\r\n    return level === \"boring\" || level === \"low\" ? \"black\" : \"orange\";\r\n  };\r\n\r\n  // Helper function to generate available hint tags (shared between setup and grid generation)\r\n  const getAvailableHintTags = useCallback(() => {\r\n    const allCollectedTags = tagManager.getCollectedTags();\r\n    const currentLocationTagsCollected = tagManager.locationTagsCollected;\r\n\r\n    // Filter out location tags from collected tags to get available hint tags\r\n    const availableHintTags = allCollectedTags.filter(\r\n      (tag) =>\r\n        !currentLocationTagsCollected.some(\r\n          (locTag: any) => locTag.name === tag.name\r\n        )\r\n    );\r\n\r\n    // Shuffle and return the tags (we'll slice as needed)\r\n    return [...availableHintTags].sort(() => Math.random() - 0.5);\r\n  }, [tagManager]);\r\n\r\n  // Grid generation functions\r\n  const createEmptyGrid = (rows: number, cols: number): GridCell[][] => {\r\n    const newGrid: GridCell[][] = [];\r\n    for (let row = 0; row < rows; row++) {\r\n      newGrid[row] = [];\r\n      for (let col = 0; col < cols; col++) {\r\n        newGrid[row][col] = {\r\n          type: \"unexposed\",\r\n          visited: false,\r\n          pinned: false,\r\n          scoreReward: 0,\r\n          isAnswer: false,\r\n          isFrustration: false,\r\n          isTemporaryFrustration: false,\r\n        };\r\n      }\r\n    }\r\n    return newGrid;\r\n  };\r\n\r\n  const generatePinnedGrid = useCallback((): GridCell[][] => {\r\n    const gridConfig = getGridConfig(difficulty);\r\n    const newGrid = createEmptyGrid(gridConfig.rows, gridConfig.cols);\r\n    const totalCells = gridConfig.rows * gridConfig.cols;\r\n    const usedPositions = new Set<string>();\r\n\r\n    // Get current values\r\n    const currentLocationTags =\r\n      campaignManager.currentEncounter?.location.tags || [];\r\n    const outstandingLocationTags = tagManager.getOutstandingLocationTags();\r\n    const currentAnswerTag = campaignManager.getCurrentEvent()?.tags?.[0] ?? {\r\n      name: \"MAXIM Fix Me\",\r\n      description: \"Placeholder answer tag\",\r\n      theme: \"neutral\",\r\n    };\r\n    const currentAnswerTags = [currentAnswerTag];\r\n\r\n    // Helper for valid hint directions\r\n    const getValidHintDirections = (\r\n      row: number,\r\n      col: number\r\n    ): HintDirection[] => {\r\n      const directions: HintDirection[] = [];\r\n      if (row > 0) directions.push(\"up\");\r\n      if (row < gridConfig.rows - 1) directions.push(\"down\");\r\n      if (col > 0) directions.push(\"left\");\r\n      if (col < gridConfig.cols - 1) directions.push(\"right\");\r\n      return directions;\r\n    };\r\n\r\n    // Helper to get random empty position\r\n    const getRandomEmptyPosition = () => {\r\n      const emptyCells: { row: number; col: number }[] = [];\r\n      for (let row = 0; row < gridConfig.rows; row++) {\r\n        for (let col = 0; col < gridConfig.cols; col++) {\r\n          const key = `${row}-${col}`;\r\n          if (!usedPositions.has(key)) {\r\n            emptyCells.push({ row, col });\r\n          }\r\n        }\r\n      }\r\n      if (emptyCells.length === 0) return null;\r\n      return emptyCells[Math.floor(Math.random() * emptyCells.length)];\r\n    };\r\n\r\n    // 1. Add answer squares (from encounter.tags)\r\n    currentAnswerTags.forEach((tag) => {\r\n      const pos = getRandomEmptyPosition();\r\n      if (pos) {\r\n        const flavorTag = tag.name\r\n          ? tagManager.tagToEncounterFlavorTag(\r\n              tag,\r\n              FlavorTagSource.PUZZLE_ANSWER\r\n            )\r\n          : {\r\n              tag: {\r\n                name: \"MAXIM Fix Me\",\r\n                description: \"Placeholder answer tag\",\r\n                theme: \"neutral\",\r\n              },\r\n              source: \"ENCOUNTER\" as any,\r\n              theme: tagManager.getTheme(),\r\n            };\r\n        newGrid[pos.row][pos.col] = {\r\n          type: \"answer\",\r\n          tag: flavorTag,\r\n          visited: false,\r\n          pinned: true,\r\n          scoreReward: 0,\r\n          isAnswer: true,\r\n          isFrustration: false,\r\n          isTemporaryFrustration: false,\r\n        };\r\n        usedPositions.add(`${pos.row}-${pos.col}`);\r\n      }\r\n    });\r\n\r\n    // 2. Add location tags (exposed ones become hints, unexposed stay as location tags)\r\n    currentLocationTags.forEach((tag) => {\r\n      const pos = getRandomEmptyPosition();\r\n      if (pos) {\r\n        const isExposed = !outstandingLocationTags.some(\r\n          (collected) => collected.name === tag.name\r\n        );\r\n        const validDirections = getValidHintDirections(pos.row, pos.col);\r\n        const randomDirection =\r\n          validDirections[Math.floor(Math.random() * validDirections.length)];\r\n\r\n        const flavorTag = tagManager.tagToEncounterFlavorTag(\r\n          tag,\r\n          FlavorTagSource.LOCATION\r\n        );\r\n        newGrid[pos.row][pos.col] = {\r\n          type: isExposed ? \"hint\" : \"unexposed\",\r\n          tag: flavorTag,\r\n          hintDirection: isExposed ? randomDirection : undefined,\r\n          visited: false,\r\n          pinned: true,\r\n          scoreReward: 0,\r\n          isAnswer: false,\r\n          isFrustration: false,\r\n          isTemporaryFrustration: false,\r\n        };\r\n        usedPositions.add(`${pos.row}-${pos.col}`);\r\n      }\r\n    });\r\n\r\n    // 3. Add hint squares (using stored hint tags for consistency)\r\n    const hintsToAdd = Math.min(hintsCount, generatedHintTags.length);\r\n\r\n    for (let i = 0; i < hintsToAdd; i++) {\r\n      const pos = getRandomEmptyPosition();\r\n      if (pos) {\r\n        const validDirections = getValidHintDirections(pos.row, pos.col);\r\n        const randomDirection =\r\n          validDirections[Math.floor(Math.random() * validDirections.length)];\r\n        const hintTag = tagManager.tagToEncounterFlavorTag(\r\n          generatedHintTags[i],\r\n          FlavorTagSource.PUZZLE\r\n        );\r\n\r\n        newGrid[pos.row][pos.col] = {\r\n          type: \"hint\",\r\n          tag: hintTag,\r\n          hintDirection: randomDirection,\r\n          visited: false,\r\n          pinned: true,\r\n          scoreReward: 0,\r\n          isAnswer: false,\r\n          isFrustration: false,\r\n          isTemporaryFrustration: false,\r\n        };\r\n        usedPositions.add(`${pos.row}-${pos.col}`);\r\n      }\r\n    }\r\n\r\n    // 4. Add frustration squares\r\n    const baseFrustration = Math.floor(Math.random() * 4) + 1; // 1-4\r\n    const totalFrustration = baseFrustration + gridConfig.extraFrustration;\r\n\r\n    for (let i = 0; i < totalFrustration; i++) {\r\n      const pos = getRandomEmptyPosition();\r\n      if (pos) {\r\n        newGrid[pos.row][pos.col] = {\r\n          type: \"frustration\",\r\n          visited: false,\r\n          pinned: true,\r\n          scoreReward: 0,\r\n          isAnswer: false,\r\n          isFrustration: true,\r\n          isTemporaryFrustration: false,\r\n        };\r\n        usedPositions.add(`${pos.row}-${pos.col}`);\r\n      }\r\n    }\r\n\r\n    // 5. Add score rewards with guaranteed distribution\r\n    const scoreRewardCoverage = 0.5; // 50% of grid squares should have score rewards\r\n    const allPositions: { row: number; col: number }[] = [];\r\n    for (let row = 0; row < gridConfig.rows; row++) {\r\n      for (let col = 0; col < gridConfig.cols; col++) {\r\n        allPositions.push({ row, col });\r\n      }\r\n    }\r\n\r\n    const targetScoreSquares = Math.floor(totalCells * scoreRewardCoverage);\r\n    const shuffledPositions = allPositions\r\n      .sort(() => Math.random() - 0.5)\r\n      .filter((s) => !newGrid[s.row][s.col].isFrustration);\r\n\r\n    // Define guaranteed rewards based on grid size\r\n    const guaranteedRewards: number[] = [];\r\n\r\n    // Always have one big prize (4 points for largest puzzle, 3 for others)\r\n    const bigPrize = difficulty === \"tricky\" ? 6 : 4;\r\n    guaranteedRewards.push(bigPrize);\r\n\r\n    // At least 2 three-point rewards (but only if we have big prize of 4)\r\n    if (difficulty === \"tricky\") {\r\n      guaranteedRewards.push(3, 3);\r\n    }\r\n\r\n    // At least 3 two-point rewards\r\n    guaranteedRewards.push(2, 2, 2);\r\n\r\n    // Fill remaining squares with 1-point rewards up to target coverage\r\n    const remainingSquares = targetScoreSquares - guaranteedRewards.length;\r\n    for (let i = 0; i < remainingSquares; i++) {\r\n      guaranteedRewards.push(1);\r\n    }\r\n\r\n    // Apply the rewards to random positions\r\n    for (\r\n      let i = 0;\r\n      i < guaranteedRewards.length && i < shuffledPositions.length;\r\n      i++\r\n    ) {\r\n      const pos = shuffledPositions[i];\r\n      newGrid[pos.row][pos.col].scoreReward = guaranteedRewards[i];\r\n    }\r\n    // be sure the answer has a big prize:\r\n    const answerPos = allPositions.find(\r\n      (pos) => newGrid[pos.row][pos.col].isAnswer\r\n    );\r\n    if (answerPos) {\r\n      newGrid[answerPos.row][answerPos.col].scoreReward = bigPrize;\r\n    }\r\n\r\n    // 6. Add tension levels to some squares if enabled\r\n    if (TENSION_SQUARES_ENABLED) {\r\n      const tensionLevels: TensionLevel[] = [\"boring\", \"low\", \"high\", \"crisis\"];\r\n\r\n      allPositions.forEach((pos) => {\r\n        const cell = newGrid[pos.row][pos.col];\r\n        if (\r\n          !cell.isAnswer &&\r\n          !cell.isFrustration &&\r\n          Math.random() < TENSION_SQUARES_CHANCE\r\n        ) {\r\n          cell.tensionLevel =\r\n            tensionLevels[Math.floor(Math.random() * tensionLevels.length)];\r\n        }\r\n      });\r\n    }\r\n\r\n    return newGrid;\r\n  }, [difficulty, hintsCount, campaignManager, tagManager, generatedHintTags]);\r\n\r\n  const generateNonPinnedCells = (baseGrid: GridCell[][]): GridCell[][] => {\r\n    const gridConfig = getGridConfig(difficulty);\r\n    const newGrid = baseGrid.map((row) => row.map((cell) => ({ ...cell })));\r\n\r\n    // Find non-pinned positions\r\n    const nonPinnedPositions: { row: number; col: number }[] = [];\r\n    for (let row = 0; row < gridConfig.rows; row++) {\r\n      for (let col = 0; col < gridConfig.cols; col++) {\r\n        if (!newGrid[row][col].pinned) {\r\n          nonPinnedPositions.push({ row, col });\r\n        }\r\n      }\r\n    }\r\n\r\n    // Generate relevant tags for non-pinned positions\r\n    if (nonPinnedPositions.length > 0) {\r\n      const relevantTags = tagManager.generateRelevantFlavorTags(\r\n        nonPinnedPositions.length,\r\n        [\r\n          FlavorTagSource.ENCOUNTER,\r\n          FlavorTagSource.PUZZLE_ANSWER,\r\n          FlavorTagSource.LOCATION,\r\n          FlavorTagSource.QUEST,\r\n          FlavorTagSource.QUEST_TERMINAL,\r\n          FlavorTagSource.FORESHADOWING_RANDOM,\r\n        ]\r\n      );\r\n\r\n      nonPinnedPositions.forEach((pos, index) => {\r\n        if (index < relevantTags.length) {\r\n          newGrid[pos.row][pos.col] = {\r\n            type: \"unexposed\",\r\n            tag: relevantTags[index],\r\n            visited: false,\r\n            pinned: false,\r\n            scoreReward: newGrid[pos.row][pos.col].scoreReward, // Keep existing score rewards\r\n            tensionLevel: newGrid[pos.row][pos.col].tensionLevel, // Keep existing tension\r\n            isAnswer: false,\r\n            isFrustration: false,\r\n            isTemporaryFrustration: false,\r\n          };\r\n        }\r\n      });\r\n    }\r\n\r\n    return newGrid;\r\n  };\r\n\r\n  // Initialize pinned grid on phase change\r\n  useEffect(() => {\r\n    if (currentPhase === \"instructions\") {\r\n      const pinnedGrid = generatePinnedGrid();\r\n      setGrid(pinnedGrid);\r\n      setCurrentStep(\r\n        `The players are considering what they know so far. You will need to call on one of them to start.`\r\n      );\r\n    }\r\n  }, [currentPhase, difficulty, hintsCount, generatePinnedGrid]);\r\n\r\n  // Generate and store hint tags when setup changes\r\n  useEffect(() => {\r\n    const hintTags = getAvailableHintTags();\r\n    setGeneratedHintTags(hintTags);\r\n  }, [difficulty, hintsCount, tagManager, getAvailableHintTags]);\r\n\r\n  // Ensure hints count doesn't exceed available collected tags\r\n  useEffect(() => {\r\n    const allCollectedTags = tagManager.getCollectedTags();\r\n    const currentLocationTagsCollected = tagManager.locationTagsCollected;\r\n    const maxAvailableHints =\r\n      allCollectedTags.length - currentLocationTagsCollected.length;\r\n\r\n    if (hintsCount > maxAvailableHints) {\r\n      setHintsCount(Math.max(0, maxAvailableHints));\r\n    }\r\n  }, [difficulty, tagManager, hintsCount]);\r\n\r\n  // Phase handlers\r\n  const handlePresentPuzzle = () => {\r\n    partyManager.exhaustParty(getExhaustionCost());\r\n    setCurrentPhase(\"instructions\");\r\n  };\r\n\r\n  const handlePlayersAttempt = () => {\r\n    // Generate full grid with all cells populated when starting solving phase\r\n    const fullGrid = generateNonPinnedCells(grid);\r\n    setGrid(fullGrid);\r\n    setCurrentPhase(\"solving\");\r\n  };\r\n\r\n  const handleHintDirectionChange = (row: number, col: number) => {\r\n    if (\r\n      currentPhase !== \"instructions\" &&\r\n      !(currentPhase === \"solving\" && !selectedPlayer)\r\n    )\r\n      return;\r\n\r\n    const gridConfig = getGridConfig(difficulty);\r\n    const validDirections = getValidHintDirections(row, col, gridConfig);\r\n    const currentDirection = grid[row][col].hintDirection;\r\n\r\n    if (currentDirection) {\r\n      const nextDirection = getNextDirection(currentDirection, validDirections);\r\n\r\n      setGrid((prevGrid) => {\r\n        const newGrid = [...prevGrid];\r\n        newGrid[row][col] = {\r\n          ...newGrid[row][col],\r\n          hintDirection: nextDirection,\r\n        };\r\n        return newGrid;\r\n      });\r\n    }\r\n  };\r\n\r\n  const handlePlayerSelect = (player: Player) => {\r\n    if (currentPhase !== \"solving\" || usedPlayers.has(player.id) || isAnimating)\r\n      return;\r\n\r\n    setSelectedPlayer(player);\r\n    setSoCloseUsed(false);\r\n    setPlayerPosition(null);\r\n    setIsAnimating(true);\r\n    setButtonsEnabled(false); // Disable buttons during animation\r\n    setCurrentStep(\r\n      `${player.name} looks through their notes fom earlier in the session...`\r\n    );\r\n\r\n    // Show player icon in current-step container\r\n    setCurrentStepPlayerIcon({\r\n      player: player,\r\n      isVisible: true,\r\n    });\r\n\r\n    // Mark player as used\r\n    setUsedPlayers((prev) => new Set([...prev, player.id]));\r\n\r\n    // Start floating icon animation\r\n    //startFloatingIconAnimation(player);\r\n\r\n    // // Clear temporary frustration and visited states\r\n    // setGrid((prevGrid) => {\r\n    //   const newGrid = prevGrid.map((row) =>\r\n    //     row.map((cell) => ({\r\n    //       ...cell,\r\n    //       visited: false,\r\n    //       isTemporaryFrustration: false,\r\n    //       playerIcon: undefined,\r\n    //     }))\r\n    //   );\r\n    //   return newGrid;\r\n    // });\r\n\r\n    // Clear any existing grid player icon\r\n    setGridPlayerIcon(null);\r\n\r\n    // Start the solving attempt directly with current grid\r\n    setTimeout(() => {\r\n      // // choose one of five random strings here\r\n      // const randomIdeas = [\r\n      //   `${player.name} has an idea...`,\r\n      //   `${player.name} points to something they wrote on their notes from earlier`,\r\n      //   `${player.name} considers thoughtfully for a minute and makes a totally random guess`,\r\n\r\n      // ];\r\n\r\n      // setCurrentStep(randomIdeas[Math.floor(Math.random() * randomIdeas.length)]);\r\n      startSolvingAttempt(player, grid);\r\n    }, TINY_PAUSE_MS);\r\n  };\r\n\r\n  const startFloatingIconAnimation = (player: Player) => {\r\n    // Get player button position (this would need to be calculated based on the player button)\r\n    // For now, we'll start from a fixed position and animate to grid\r\n    const startX = 50; // This should be calculated from player button position\r\n    const startY = 200;\r\n\r\n    setFloatingIconPosition({\r\n      x: startX,\r\n      y: startY,\r\n      targetRow: -1,\r\n      targetCol: -1,\r\n      player: player,\r\n      isAnimating: true,\r\n    });\r\n\r\n    // After a short delay, move to grid center\r\n    setTimeout(() => {\r\n      setFloatingIconPosition((prev) =>\r\n        prev\r\n          ? {\r\n              ...prev,\r\n              x: 500, // This should be calculated based on grid position\r\n              y: 300,\r\n            }\r\n          : null\r\n      );\r\n    }, 100);\r\n\r\n    // Clear the floating icon after animation\r\n    setTimeout(() => {\r\n      setFloatingIconPosition(null);\r\n    }, 1500);\r\n  };\r\n\r\n  const startSolvingAttempt = (player: Player, currentGrid: GridCell[][]) => {\r\n    const gridConfig = getGridConfig(difficulty);\r\n\r\n    // Find a random non-frustration square\r\n    const validSquares: { row: number; col: number }[] = [];\r\n    for (let row = 0; row < gridConfig.rows; row++) {\r\n      for (let col = 0; col < gridConfig.cols; col++) {\r\n        const cell = currentGrid[row][col];\r\n        if (!cell.isFrustration && !cell.isTemporaryFrustration) {\r\n          validSquares.push({ row, col });\r\n        }\r\n      }\r\n    }\r\n\r\n    if (validSquares.length > 0) {\r\n      const randomSquare =\r\n        validSquares[Math.floor(Math.random() * validSquares.length)];\r\n\r\n      setTimeout(() => {\r\n        activateGridSquare(randomSquare.row, randomSquare.col, player);\r\n      }, SHORT_PAUSE_MS);\r\n    }\r\n  };\r\n\r\n  const activateGridSquare = (\r\n    row: number,\r\n    col: number,\r\n    player: Player,\r\n    shouldAnimate: boolean = true\r\n  ) => {\r\n    const cell = grid[row][col];\r\n\r\n    // Set grid player icon to fade in at this position\r\n    setGridPlayerIcon({\r\n      player: player,\r\n      row: row,\r\n      col: col,\r\n      isVisible: true,\r\n    });\r\n\r\n    // Animate floating icon to this grid square\r\n    if (shouldAnimate) {\r\n      animateIconToGridSquare(row, col, player);\r\n    }\r\n\r\n    if (shouldAnimate) {\r\n      // 5 Random options:\r\n      const randomMessages = [\r\n        `${player.name} ponders ${cell.tag?.tag.name || \"the puzzle\"}`,\r\n        `${player.name} examines the possibility of ${\r\n          cell.tag?.tag.name || \"a bug (this is a bug...really)\"\r\n        }`,\r\n        `${player.name} looks into ${cell.tag?.tag.name || \"the puzzle\"}`,\r\n        `${player.name} has an idea...`,\r\n        `${player.name} points to something they wrote on their notes from earlier`,\r\n        `${player.name} considers thoughtfully for a minute and makes a totally random guess`,\r\n      ];\r\n\r\n      setCurrentStep(\r\n        randomMessages[Math.floor(Math.random() * randomMessages.length)]\r\n      );\r\n\r\n      // Flash the grid square before activation\r\n      setGrid((prevGrid) => {\r\n        const newGrid = [...prevGrid];\r\n        newGrid[row][col] = {\r\n          ...newGrid[row][col],\r\n          isFlashing: true,\r\n        };\r\n        return newGrid;\r\n      });\r\n\r\n      setTimeout(() => {\r\n        // If this is a \"So Close\" activation, reset the soCloseUsed flag\r\n        if (soCloseUsed) {\r\n          setSoCloseUsed(false);\r\n        }\r\n\r\n        // Remove flash and mark as visited\r\n        setGrid((prevGrid) => {\r\n          const newGrid = [...prevGrid];\r\n          newGrid[row][col] = {\r\n            ...newGrid[row][col],\r\n            visited: true,\r\n            playerIcon: player,\r\n            isTemporaryFrustration: true,\r\n            isFlashing: false,\r\n          };\r\n          return newGrid;\r\n        });\r\n\r\n        setPlayerPosition({ row, col });\r\n\r\n        // Handle different cell types after animation\r\n        setTimeout(() => {\r\n          processGridCellActivation(row, col, player, cell);\r\n        }, SHORT_PAUSE_MS);\r\n      }, SHORT_PAUSE_MS);\r\n    } else {\r\n      // Immediate activation without animation\r\n      setGrid((prevGrid) => {\r\n        const newGrid = [...prevGrid];\r\n        newGrid[row][col] = {\r\n          ...newGrid[row][col],\r\n          visited: true,\r\n          playerIcon: player,\r\n          isTemporaryFrustration: true,\r\n        };\r\n        return newGrid;\r\n      });\r\n\r\n      setPlayerPosition({ row, col });\r\n      processGridCellActivation(row, col, player, cell);\r\n    }\r\n  };\r\n\r\n  const animateIconToGridSquare = (\r\n    row: number,\r\n    col: number,\r\n    player: Player\r\n  ) => {\r\n    // Calculate grid square position (this would need to be calculated based on actual grid position)\r\n    const gridSquareX = 500 + col * 195; // Approximate based on 155px + 40px gap\r\n    const gridSquareY = 300 + row * 195;\r\n\r\n    setFloatingIconPosition((prev) =>\r\n      prev\r\n        ? {\r\n            ...prev,\r\n            x: gridSquareX,\r\n            y: gridSquareY,\r\n            targetRow: row,\r\n            targetCol: col,\r\n          }\r\n        : null\r\n    );\r\n\r\n    // Clear the floating icon after reaching target\r\n    setTimeout(() => {\r\n      setFloatingIconPosition(null);\r\n    }, 1000);\r\n  };\r\n\r\n  const processGridCellActivation = (\r\n    row: number,\r\n    col: number,\r\n    player: Player,\r\n    cell: GridCell\r\n  ) => {\r\n    // Handle different cell types\r\n    if (cell.type === \"hint\") {\r\n      setCurrentStep(`${player.name} found a hint!`);\r\n      handleHintActivation(row, col, player);\r\n    } else if (cell.isFrustration) {\r\n      setCurrentStep(`${player.name} is annoyed by the puzzle.`);\r\n      handleFrustrationActivation(player);\r\n    } else if (cell.isTemporaryFrustration) {\r\n      setCurrentStep(\r\n        `${player.name} already came to this conclusion earlier and is frustrated.`\r\n      );\r\n      handleFrustrationActivation(player);\r\n    } else if (cell.isAnswer) {\r\n      setCurrentStep(`${player.name} found the answer!`);\r\n      handleAnswerActivation(player);\r\n    } else if (cell.type === \"unexposed\") {\r\n      setCurrentStep(`${player.name} considers a new topic!`);\r\n      handleUnexposedTagActivation(row, col, player);\r\n      setButtonsEnabled(true);\r\n    } else if (cell.type === \"exposed\" || cell.type === \"directionless\") {\r\n      setCurrentStep(`${player.name} needs to choose a think...`);\r\n      handleDirectionlessActivation(row, col, player);\r\n    } else {\r\n      setCurrentStep(`${player.name} explores the square...`);\r\n      setIsAnimating(false);\r\n      // setButtonsEnabled(true);\r\n    }\r\n\r\n    // Handle score reward\r\n\r\n    // Handle score reward\r\n    if (cell.scoreReward > 0) {\r\n      setCurrentScore((prev) => prev + cell.scoreReward);\r\n      // Award points to campaign\r\n      campaignManager.addEncounterPoints(cell.scoreReward);\r\n\r\n      // Remove the score reward from the grid cell by updating state\r\n      setGrid((prevGrid) => {\r\n        const newGrid = [...prevGrid];\r\n        newGrid[row][col] = {\r\n          ...newGrid[row][col],\r\n          scoreReward: 0, // Remove the score reward\r\n        };\r\n        return newGrid;\r\n      });\r\n      cell.scoreReward = 0; // Also reset the cell directly\r\n    }\r\n\r\n    // Handle tension\r\n    if (cell.tensionLevel) {\r\n      const tensionChange = getTensionValue(cell.tensionLevel);\r\n      partyManager.addPartyTension(tensionChange);\r\n    }\r\n  };\r\n\r\n  const handleHintActivation = (row: number, col: number, player: Player) => {\r\n    const cell = grid[row][col];\r\n    const direction = cell.hintDirection;\r\n\r\n    if (direction) {\r\n      const nextPos = getNextPosition(row, col, direction);\r\n      if (nextPos) {\r\n        // Add exhaustion for hint usage\r\n        partyManager.exhaustParty(1);\r\n\r\n        setCurrentStep(\r\n          `Hint points ${direction}! ${player.name} is following the hint...`\r\n        );\r\n\r\n        setTimeout(() => {\r\n          setHighlightedCells([nextPos]);\r\n          setCurrentStep(`${player.name} is moving to the indicated square...`);\r\n\r\n          setTimeout(() => {\r\n            setHighlightedCells([]);\r\n            // Mark current position as visited before moving\r\n            setGrid((prevGrid) => {\r\n              const newGrid = [...prevGrid];\r\n              newGrid[row][col] = {\r\n                ...newGrid[row][col],\r\n                visited: true,\r\n              };\r\n              return newGrid;\r\n            });\r\n\r\n            // Update grid player icon position for the move\r\n            setGridPlayerIcon((prev) =>\r\n              prev\r\n                ? {\r\n                    ...prev,\r\n                    row: nextPos.row,\r\n                    col: nextPos.col,\r\n                  }\r\n                : null\r\n            );\r\n\r\n            activateGridSquare(nextPos.row, nextPos.col, player, true);\r\n          }, SHORT_PAUSE_MS * 2);\r\n        }, SHORT_PAUSE_MS);\r\n      } else {\r\n        setIsAnimating(false);\r\n        setButtonsEnabled(true);\r\n      }\r\n    } else {\r\n      setIsAnimating(false);\r\n      setButtonsEnabled(true);\r\n    }\r\n  };\r\n\r\n  const getNextPosition = (\r\n    row: number,\r\n    col: number,\r\n    direction: HintDirection\r\n  ): { row: number; col: number } | null => {\r\n    const gridConfig = getGridConfig(difficulty);\r\n\r\n    switch (direction) {\r\n      case \"up\":\r\n        return row > 0 ? { row: row - 1, col } : null;\r\n      case \"down\":\r\n        return row < gridConfig.rows - 1 ? { row: row + 1, col } : null;\r\n      case \"left\":\r\n        return col > 0 ? { row, col: col - 1 } : null;\r\n      case \"right\":\r\n        return col < gridConfig.cols - 1 ? { row, col: col + 1 } : null;\r\n    }\r\n  };\r\n\r\n  const handleFrustrationActivation = (player: Player) => {\r\n    // Apply effects\r\n    partyManager.addEnjoyment(player, -1);\r\n    partyManager.updateAttention(player, -1);\r\n    const results: EffectData[] = [];\r\n    results.push({\r\n      object: player,\r\n      effects: [\r\n        { effect: \"-1 Attention\", class: \"player-attention\" },\r\n        { effect: \"-1 Attitude\", class: \"player-attitude\" },\r\n      ],\r\n    });\r\n\r\n    // Show modal using uiManager\r\n    uiManager.showModal({\r\n      title: `${player.name} became frustrated!`,\r\n      type: \"puzzle\",\r\n      effectData: results,\r\n      options: [\r\n        {\r\n          id: \"continue\",\r\n          title: \"Continue\",\r\n          description: `${player.name} became frustrated!`,\r\n          callback: () => {\r\n            setIsAnimating(false);\r\n            setButtonsEnabled(true);\r\n            setCurrentPhase(\"player-stopped\");\r\n          },\r\n        },\r\n      ],\r\n      onClose: () => {\r\n        setIsAnimating(false);\r\n        setButtonsEnabled(true);\r\n        setCurrentPhase(\"player-stopped\");\r\n      },\r\n    });\r\n  };\r\n\r\n  const handleAnswerActivation = (player: Player) => {\r\n    const score = calculateScore(hintsCount, false, difficulty);\r\n    // Apply effects\r\n    campaignManager.addEncounterPoints(score);\r\n    // Add player experience (implement in player manager)\r\n    const results: EffectData[] = [];\r\n    playerManager.addPlayerExp(player, 1);\r\n    results.push({\r\n      object: player,\r\n      effects: [\r\n        {\r\n          effect: \"+1 Experience\",\r\n          class: \"player-exp\",\r\n        },\r\n      ],\r\n    });\r\n    players.forEach((p) => {\r\n      if (p.id !== player.id) {\r\n        partyManager.addEnjoyment(p, 1);\r\n        results.push({\r\n          object: p,\r\n          effects: [\r\n            {\r\n              effect: \"+1 Attitude\",\r\n              class: \"player-attitude\",\r\n            },\r\n          ],\r\n        });\r\n      }\r\n    });\r\n\r\n    // Show modal using uiManager\r\n    // uiManager.showModal({\r\n    //   title: \"Puzzle Solved!\",\r\n    //   type: \"puzzle\",\r\n    //   options: [\r\n    //     {\r\n    //       id: \"continue\",\r\n    //       title: \"Return to Encounter\",\r\n    //       description: `Gained ${score} campaign score and experience!`,\r\n    //       callback: () => {\r\n    //         campaignManager.backToOverview();\r\n    //       },\r\n    //     },\r\n    //   ],\r\n    //   onClose: () => {\r\n    //     campaignManager.backToOverview();\r\n    //   },\r\n    // });\r\n    uiManager.showRewardModal(getGridConfig(difficulty).reward, true);\r\n\r\n    setIsAnimating(false);\r\n    setButtonsEnabled(true);\r\n  };\r\n\r\n  const handleUnexposedTagActivation = (\r\n    row: number,\r\n    col: number,\r\n    player: Player\r\n  ) => {\r\n    const cell = grid[row][col];\r\n    if (cell.tag) {\r\n      // Expose the tag\r\n      campaignManager.exposeTag(cell.tag);\r\n\r\n      // Convert to directionless and pin\r\n      setGrid((prevGrid) => {\r\n        const newGrid = [...prevGrid];\r\n        newGrid[row][col] = {\r\n          ...newGrid[row][col],\r\n          type: \"directionless\",\r\n          pinned: true,\r\n        };\r\n        return newGrid;\r\n      });\r\n\r\n      let playerActionString = `${player.name} investigated ${cell.tag.tag.name}`;\r\n      if (Math.random() > 0.5) {\r\n        playerActionString = `${player.name} thought ${cell.tag.tag.name} was related somehow`;\r\n      }\r\n\r\n      // End player's journey here when they expose a tag\r\n      setCurrentStep(playerActionString);\r\n      setIsAnimating(false);\r\n      setButtonsEnabled(true);\r\n      setCurrentPhase(\"player-stopped\");\r\n    } else {\r\n      setIsAnimating(false);\r\n      setButtonsEnabled(true);\r\n      setCurrentPhase(\"player-stopped\");\r\n    }\r\n  };\r\n\r\n  const handleDirectionlessActivation = (\r\n    row: number,\r\n    col: number,\r\n    player: Player\r\n  ) => {\r\n    // Player stops at directionless squares and must choose what to do next\r\n    setCurrentStep(`${player.name} needs to choose what to do next...`);\r\n    setIsAnimating(false);\r\n    setButtonsEnabled(true);\r\n    setCurrentPhase(\"player-stopped\");\r\n  };\r\n\r\n  const handleSoClose = () => {\r\n    if (\r\n      !selectedPlayer ||\r\n      !playerPosition ||\r\n      soCloseUsed ||\r\n      soCloseCount >= getSoCloseLimit()\r\n    )\r\n      return;\r\n\r\n    //all other players lose one attention\r\n    players.forEach((p) => {\r\n      if (p.id !== selectedPlayer.id) {\r\n        partyManager.updateAttention(p, -1);\r\n      }\r\n    });\r\n    // reduce tension by 5, then 10, then 15 etc.\r\n    partyManager.addPartyTension(-5 * (soCloseCount + 1));\r\n\r\n    setSoCloseUsed(true);\r\n    setSoCloseCount((prev) => prev + 1);\r\n    setButtonsEnabled(false); // Disable buttons during So Close selection\r\n    chatManager.dmMessage(\r\n      `Ah, close...${\r\n        grid[playerPosition.row][playerPosition.col].tag?.tag.name || \"that\"\r\n      } was misleading but you are close...`\r\n    );\r\n    setCurrentStep(`nudge ${selectedPlayer.name} in the right direction`);\r\n    const allAdjacentPositions = getDiagonalAndOrthogonalPositions(\r\n      playerPosition.row,\r\n      playerPosition.col\r\n    );\r\n\r\n    // filter out answer grid\r\n    const highlightCells = allAdjacentPositions.filter(\r\n      (cell) => !grid[cell.row][cell.col].isAnswer\r\n    );\r\n\r\n    setHighlightedCells(highlightCells);\r\n  };\r\n\r\n  const getDiagonalAndOrthogonalPositions = (\r\n    row: number,\r\n    col: number\r\n  ): { row: number; col: number }[] => {\r\n    const gridConfig = getGridConfig(difficulty);\r\n    const positions: { row: number; col: number }[] = [];\r\n\r\n    for (let r = row - 1; r <= row + 1; r++) {\r\n      for (let c = col - 1; c <= col + 1; c++) {\r\n        if (\r\n          r >= 0 &&\r\n          r < gridConfig.rows &&\r\n          c >= 0 &&\r\n          c < gridConfig.cols &&\r\n          !(r === row && c === col)\r\n        ) {\r\n          positions.push({ row: r, col: c });\r\n        }\r\n      }\r\n    }\r\n\r\n    return positions;\r\n  };\r\n\r\n  const handleAbandonPuzzle = (collectedScore: number) => {\r\n    // Force re-calculation by directly accessing current score\r\n    const cost = calculateAbandonmentCost(collectedScore);\r\n    partyManager.addPartyTension(-cost.tension);\r\n    // Generate effects for the modal\r\n    const results: any[] = [];\r\n    players.forEach((p) => {\r\n      partyManager.addEnjoyment(p, -cost.attitude);\r\n      results.push({\r\n        object: p,\r\n        effects: [\r\n          {\r\n            effect: `-${cost.attitude} Attitude`,\r\n            class: \"player-attitude\",\r\n          },\r\n        ],\r\n      });\r\n    });\r\n\r\n    partyManager.addPartyTension(cost.tension);\r\n    results.push({\r\n      object: \"party\",\r\n      effects: [\r\n        {\r\n          effect: `+${cost.tension}% Tension`,\r\n          class: \"tension\",\r\n        },\r\n      ],\r\n    });\r\n\r\n    // Show modal and return to encounter overview\r\n    uiManager.showModal({\r\n      title: \"Puzzle Abandoned\",\r\n      options: [\r\n        {\r\n          id: \"ok\",\r\n          title: \"Back to Session\",\r\n          callback: () => {\r\n            campaignManager.backToOverview();\r\n          },\r\n        },\r\n      ],\r\n      type: \"puzzle\",\r\n      effectData: results,\r\n      onClose: () => {\r\n        campaignManager.backToOverview();\r\n      },\r\n    });\r\n  };\r\n\r\n  const convertDirectionlessToHints = () => {\r\n    const gridConfig = getGridConfig(difficulty);\r\n    setGrid((prevGrid) => {\r\n      const newGrid = [...prevGrid];\r\n\r\n      for (let row = 0; row < gridConfig.rows; row++) {\r\n        for (let col = 0; col < gridConfig.cols; col++) {\r\n          const cell = newGrid[row][col];\r\n          if (cell.type === \"directionless\") {\r\n            const validDirections = getValidHintDirections(\r\n              row,\r\n              col,\r\n              gridConfig\r\n            );\r\n            const randomDirection =\r\n              validDirections[\r\n                Math.floor(Math.random() * validDirections.length)\r\n              ];\r\n\r\n            newGrid[row][col] = {\r\n              ...newGrid[row][col],\r\n              type: \"hint\",\r\n              hintDirection: randomDirection,\r\n            };\r\n          }\r\n        }\r\n      }\r\n\r\n      return newGrid;\r\n    });\r\n  };\r\n\r\n  // New handlers for player-stopped phase\r\n  const handleAdjustHints = () => {\r\n    const gridConfig = getGridConfig(difficulty);\r\n\r\n    // Add party exhaustion for using adjust hints\r\n    partyManager.exhaustParty(10);\r\n\r\n    setAdjustHintsMode(true);\r\n    setCurrentStep(\"Click on hint squares to rotate their directions.\");\r\n  };\r\n\r\n  const handleNextPlayer = () => {\r\n    const gridConfig = getGridConfig(difficulty);\r\n    setPlayerPosition(null);\r\n    convertDirectionlessToHints();\r\n    // Convert ALL directionless squares to hints (consistent with handleAdjustHints)\r\n    setGrid((prevGrid) => {\r\n      const newGrid = [...prevGrid];\r\n\r\n      for (let row = 0; row < gridConfig.rows; row++) {\r\n        for (let col = 0; col < gridConfig.cols; col++) {\r\n          const cell = newGrid[row][col];\r\n          cell.visited = false;\r\n          if (cell.type === \"directionless\") {\r\n            const validDirections = getValidHintDirections(\r\n              row,\r\n              col,\r\n              gridConfig\r\n            );\r\n            const randomDirection =\r\n              validDirections[\r\n                Math.floor(Math.random() * validDirections.length)\r\n              ];\r\n\r\n            newGrid[row][col] = {\r\n              ...newGrid[row][col],\r\n              type: \"hint\",\r\n              hintDirection: randomDirection,\r\n            };\r\n          }\r\n        }\r\n      }\r\n\r\n      return newGrid;\r\n    });\r\n\r\n    // Reset selected player so UI properly shows no player selected state\r\n    setSelectedPlayer(null);\r\n    setCurrentStepPlayerIcon(null);\r\n    setGridPlayerIcon(null);\r\n    setCurrentPhase(\"solving\");\r\n    setAdjustHintsMode(false);\r\n  };\r\n\r\n  const handlePlayerStoppedHintRotation = (row: number, col: number) => {\r\n    if (!adjustHintsMode || currentPhase !== \"player-stopped\") return;\r\n\r\n    const gridConfig = getGridConfig(difficulty);\r\n    const validDirections = getValidHintDirections(row, col, gridConfig);\r\n    const currentDirection = grid[row][col].hintDirection;\r\n\r\n    if (currentDirection) {\r\n      const nextDirection = getNextDirection(currentDirection, validDirections);\r\n\r\n      setGrid((prevGrid) => {\r\n        const newGrid = [...prevGrid];\r\n        newGrid[row][col] = {\r\n          ...newGrid[row][col],\r\n          hintDirection: nextDirection,\r\n        };\r\n        return newGrid;\r\n      });\r\n    }\r\n  };\r\n\r\n  const getPuzzleHintCost = (difficulty: PuzzleDifficulty) => {\r\n    switch (difficulty) {\r\n      case \"simple\":\r\n        return 1;\r\n      case \"clever\":\r\n        return 2;\r\n      case \"tricky\":\r\n        return 3;\r\n    }\r\n  };\r\n\r\n  const getExhaustionCost = () => {\r\n    //cost is puzzle difficulty * 1 * hints\r\n\r\n    return hintsCount * getPuzzleHintCost(difficulty);\r\n  };\r\n\r\n  // Render functions\r\n  const renderSetupPhase = () => {\r\n    // Calculate maximum available hints based on collected tags\r\n    const allCollectedTags = tagManager.getCollectedTags();\r\n    const currentLocationTagsCollected = tagManager.locationTagsCollected;\r\n    const maxAvailableHints =\r\n      allCollectedTags.length - currentLocationTagsCollected.length;\r\n    const effectiveMaxHints = Math.min(8, maxAvailableHints);\r\n\r\n    // Get the actual hint tags that would be used (using stored tags for consistency)\r\n    const hintTagsToShow = generatedHintTags.slice(0, effectiveMaxHints);\r\n\r\n    return (\r\n      <div className=\"puzzle-setup-modal\">\r\n        <div className=\"setup-header\">\r\n          <h2>Adjust Difficulty and Hints</h2>\r\n        </div>\r\n\r\n        <div className=\"difficulty-options\">\r\n          {([\"simple\", \"clever\", \"tricky\"] as PuzzleDifficulty[]).map(\r\n            (diff) => {\r\n              const iconSquares =\r\n                diff === \"simple\" ? 4 : diff === \"clever\" ? 6 : 9;\r\n              const diffConfig = getGridConfig(diff);\r\n\r\n              return (\r\n                <div\r\n                  key={diff}\r\n                  className={`difficulty-option ${\r\n                    difficulty === diff ? \"selected\" : \"\"\r\n                  }`}\r\n                  onClick={() => setDifficulty(diff)}\r\n                >\r\n                  <div className=\"difficulty-name\">{diff.toUpperCase()}</div>\r\n                  <div className=\"difficulty-icon\">\r\n                    {Array.from({ length: iconSquares }).map((_, i) => (\r\n                      <div key={i} className=\"icon-square\" />\r\n                    ))}\r\n                  </div>\r\n                  <div className=\"party-reward\">\r\n                    <span className=\"reward-label\">Party Reward</span>\r\n                    <span className=\"reward-value\">{diffConfig.reward}</span>\r\n                  </div>\r\n                </div>\r\n              );\r\n            }\r\n          )}\r\n        </div>\r\n\r\n        {maxAvailableHints > 0 && (\r\n          <div className=\"hints-control\">\r\n            <div className=\"hints-header\">\r\n              <span>Hints: {hintsCount}</span>\r\n\r\n              <div className=\"hint-arrows\">\r\n                <button\r\n                  className=\"hint-arrow\"\r\n                  onClick={() =>\r\n                    setHintsCount(Math.min(effectiveMaxHints, hintsCount + 1))\r\n                  }\r\n                  disabled={hintsCount >= effectiveMaxHints}\r\n                >\r\n                  ▲\r\n                </button>\r\n                <button\r\n                  className=\"hint-arrow\"\r\n                  onClick={() => setHintsCount(Math.max(0, hintsCount - 1))}\r\n                  disabled={hintsCount <= 0}\r\n                >\r\n                  ▼\r\n                </button>\r\n              </div>\r\n            </div>\r\n            {hintsCount >= effectiveMaxHints && (\r\n              <div className=\"hints-limit-info\">\r\n                (Limited by previously discussed topics)\r\n              </div>\r\n            )}\r\n            {/* Display available hint tags */}\r\n            {hintsCount > 0 && (\r\n              <span className=\"hint-info\">\r\n                You've been leaving clues and crafting this puzzle all\r\n                <br /> along using the following topics as hints.\r\n              </span>\r\n            )}\r\n            <div className=\"available-hint-tags\">\r\n              {hintTagsToShow.slice(0, hintsCount).map((tag, index) => (\r\n                <FlavorTagPill\r\n                  key={index}\r\n                  tag={tagManager.tagToEncounterFlavorTag(\r\n                    tag,\r\n                    FlavorTagSource.PUZZLE\r\n                  )}\r\n                  showTooltip={false}\r\n                />\r\n              ))}\r\n              {hintsCount === 0 && <span className=\"no-hints\">⊘</span>}\r\n            </div>\r\n            {hintsCount > 0 && (\r\n              <span className=\"exhaustion-info\">\r\n                Exhaustion:{getExhaustionCost()}\r\n              </span>\r\n            )}\r\n\r\n            {/* Score display */}\r\n            <div className=\"score-display\">\r\n              <span>Solving score: </span>\r\n              <DiceScore\r\n                score={calculateScore(\r\n                  hintsCount,\r\n                  maxAvailableHints === 0,\r\n                  difficulty\r\n                )}\r\n              />\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {maxAvailableHints === 0 && (\r\n          <div className=\"no-hints-display\">\r\n            <div className=\"score-info\">\r\n              <div className=\"hint-rewards-note\">No hints available.</div>\r\n              <div className=\"hint-rewards-sub\">\r\n                <i>\r\n                  Discuss topics with your players before asking them to solve\r\n                  puzzles!\r\n                </i>\r\n              </div>\r\n\r\n              {/* Score display for no hints */}\r\n              <div className=\"score-display\">\r\n                <span>Score if players solve: </span>\r\n                <DiceScore score={calculateScore(0, true, difficulty)} />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"setup-actions\">\r\n          <button className=\"present-puzzle-btn\" onClick={handlePresentPuzzle}>\r\n            PRESENT PUZZLE\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderInstructionsPhase = () => {\r\n    return (\r\n      <div className=\"puzzle-instructions\">\r\n        <div className=\"instructions-header\">\r\n          <h3>\r\n            {campaignManager.getCurrentEvent()?.tags?.[0]?.name || \"\"} Puzzle\r\n          </h3>\r\n        </div>\r\n        <div className=\"instructions-content\">\r\n          <p>\r\n            In addition to clues you have left so far leading up to this puzzle,\r\n            the players will use things they have learned about the current\r\n            location to make guesses. Direct them to a desired outcome by\r\n            modifying where the clues lead. Be careful, certain paths or cirular\r\n            logic leads to frustration.\r\n          </p>\r\n        </div>\r\n        <button className=\"players-attempt-btn\" onClick={handlePlayersAttempt}>\r\n          BEGIN\r\n        </button>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderSolvingPhase = (currentScore: number) => {\r\n    const abandonmentCost = calculateAbandonmentCost(currentScore);\r\n    return (\r\n      <div className=\"puzzle-solving\">\r\n        <div className=\"solving-header\">\r\n          <h3>Prompt a player to solve the puzzle</h3>\r\n        </div>\r\n\r\n        {currentStep && (\r\n          <div className=\"current-step\">\r\n            {currentStep}\r\n            {currentStepPlayerIcon && currentStepPlayerIcon.isVisible && (\r\n              <div className=\"current-step-player-icon\">\r\n                <Cimage imageId={currentStepPlayerIcon.player.icon} />\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"player-selection\">\r\n          {players.map((player) => {\r\n            const isUsed = usedPlayers.has(player.id);\r\n            const isSelected = selectedPlayer?.id === player.id;\r\n\r\n            return (\r\n              <button\r\n                key={player.id}\r\n                className={`player-btn ${isSelected ? \"selected\" : \"\"} ${\r\n                  isUsed ? \"used\" : \"\"\r\n                }`}\r\n                onClick={() => handlePlayerSelect(player)}\r\n                disabled={isUsed || !buttonsEnabled}\r\n              >\r\n                <div className=\"player-icon-container\">\r\n                  <div className=\"player-icon-display\">\r\n                    <Cimage imageId={player.icon} />\r\n                  </div>\r\n                </div>\r\n                <span className=\"player-name\">{player.name}</span>\r\n                {isUsed && <span className=\"used-indicator\">✓</span>}\r\n              </button>\r\n            );\r\n          })}\r\n        </div>\r\n\r\n        <button\r\n          className=\"abandon-btn\"\r\n          onClick={() => handleAbandonPuzzle(currentScore)}\r\n          disabled={!buttonsEnabled}\r\n        >\r\n          Abandon Puzzle\r\n          <div className=\"btn-subtitle\">\r\n            -{abandonmentCost.attitude} attitude\r\n          </div>\r\n          {abandonmentCost.tension > 0 && (\r\n            <div className=\"btn-subtitle\">\r\n              -{abandonmentCost.tension} tension\r\n            </div>\r\n          )}\r\n        </button>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderPlayerStoppedPhase = (currentScore: number) => {\r\n    const abandonmentCost = calculateAbandonmentCost(currentScore);\r\n    console.log(\r\n      \"renderPlayerStoppedPhase - currentScore:\",\r\n      currentScore,\r\n      \"abandonmentCost:\",\r\n      abandonmentCost\r\n    );\r\n    const availablePlayers = players.filter(\r\n      (player) => !usedPlayers.has(player.id)\r\n    );\r\n\r\n    return (\r\n      <div className=\"puzzle-solving\">\r\n        {currentStep && <div className=\"current-step\">{currentStep}</div>}\r\n\r\n        <div className=\"player-stopped-options\">\r\n          {availablePlayers.length > 0 && (\r\n            <button\r\n              className=\"next-player-btn\"\r\n              onClick={handleNextPlayer}\r\n              disabled={!buttonsEnabled || availablePlayers.length === 0}\r\n            >\r\n              Next Player\r\n              <div className=\"btn-subtitle\">continue with another player</div>\r\n            </button>\r\n          )}\r\n          {getSoCloseRemaining() > 0 && (\r\n            <button\r\n              className=\"so-close-btn\"\r\n              onClick={handleSoClose}\r\n              disabled={!buttonsEnabled || soCloseCount >= getSoCloseLimit()}\r\n            >\r\n              Suggest\r\n              <div className=\"btn-subtitle\">\r\n                Guide current player to an adjacent topic.\r\n              </div>\r\n              <div className=\"btn-subtitle\">Other players lose 1 attention</div>\r\n            </button>\r\n          )}\r\n          {(availablePlayers.length > 0 || getSoCloseRemaining() > 0) && (\r\n            <button\r\n              className=\"adjust-hints-btn\"\r\n              onClick={handleAdjustHints}\r\n              disabled={!buttonsEnabled || !hasHintSquares()}\r\n            >\r\n              Adjust Hints\r\n              <div className=\"btn-subtitle\">modify hint directions</div>\r\n            </button>\r\n          )}\r\n          <button\r\n            className=\"abandon-btn\"\r\n            onClick={() => handleAbandonPuzzle(currentScore)}\r\n            disabled={!buttonsEnabled}\r\n          >\r\n            Abandon Puzzle\r\n            <div className=\"btn-subtitle\">\r\n              -{abandonmentCost.attitude} attitude\r\n            </div>\r\n            {abandonmentCost.tension > 0 && (\r\n              <div className=\"btn-subtitle\">\r\n                -{abandonmentCost.tension} tension\r\n              </div>\r\n            )}\r\n          </button>\r\n        </div>\r\n\r\n        {/* <div className=\"current-score\">Current Score: {currentScore}</div> */}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const getGridCellTooltipText = (\r\n    cell: GridCell,\r\n    row: number,\r\n    col: number\r\n  ): string => {\r\n    if (cell.type === \"answer\") {\r\n      return \"This is the answer! Guide your players here with a trail of clues.\";\r\n    }\r\n    if (cell.type === \"hint\") {\r\n      if (currentPhase === \"instructions\") {\r\n        return (\r\n          \"Prior discussions of \" +\r\n          (cell.tag?.tag.name || \" this \") +\r\n          \" will help the players solve the puzzle. Click to set the direction that this clue leads to.\"\r\n        );\r\n      } else if (currentPhase === \"solving\" && !selectedPlayer) {\r\n        return (\r\n          \"Prior discussions of \" +\r\n          (cell.tag?.tag.name || \" this \") +\r\n          \" will help the players solve the puzzle. Click to adjust the hint direction before selecting a player.\"\r\n        );\r\n      } else if (currentPhase === \"player-stopped\" && adjustHintsMode) {\r\n        return (\r\n          \"Click to rotate the hint direction for \" +\r\n          (cell.tag?.tag.name || \" this hint\") +\r\n          \".\"\r\n        );\r\n      } else {\r\n        return (\r\n          \"Prior discussions of \" +\r\n          (cell.tag?.tag.name || \" this \") +\r\n          \" will help the players solve the puzzle.\"\r\n        );\r\n      }\r\n    }\r\n    if (cell.type === \"unexposed\") {\r\n      if (currentPhase === \"instructions\") {\r\n        return \"You aren't yet sure what conclusions your players may come to.\";\r\n      }\r\n\r\n      // if this is a highlighted cell in so close mode indicate that we can click on it to expose the tag\r\n\r\n      if (highlightedCells.some((pos) => pos.row === row && pos.col === col)) {\r\n        return \"Click to expose this tag and see what your players think.\";\r\n      }\r\n\r\n      return \"Players may come to the conclusion that this is relevant\";\r\n    }\r\n    if (cell.type === \"directionless\") {\r\n      return (\r\n        \"Your players arent sure how \" +\r\n        (cell.tag?.tag.name || \"stuff \") +\r\n        \" relates to the puzzle, so you aren't sure how they will react.\"\r\n      );\r\n    }\r\n    if (cell.type === \"exposed\") {\r\n      return \"Exposed Tag: Relevance unknown.\";\r\n    }\r\n    if (cell.type === \"frustration\") {\r\n      return \"A player reaching this will become frustrated and lose one attitude.\";\r\n    }\r\n    return \"Empty Square: No special properties.\";\r\n  };\r\n\r\n  const renderGridCell = (cell: GridCell, row: number, col: number) => {\r\n    const isHighlighted = highlightedCells.some(\r\n      (pos) => pos.row === row && pos.col === col\r\n    );\r\n    const isPlayerPosition =\r\n      playerPosition?.row === row && playerPosition?.col === col;\r\n\r\n    // Determine if this cell is clickable\r\n    const isClickable =\r\n      // So Close mode - highlighted cells are clickable\r\n      ((currentPhase === \"solving\" || currentPhase === \"player-stopped\") &&\r\n        isHighlighted &&\r\n        !isAnimating) ||\r\n      // Instructions phase - hint cells are clickable\r\n      (currentPhase === \"instructions\" && cell.type === \"hint\") ||\r\n      // Solving phase with no player selected - hint cells are clickable\r\n      (currentPhase === \"solving\" && !selectedPlayer && cell.type === \"hint\") ||\r\n      // Player-stopped phase in adjust hints mode - hint cells are clickable\r\n      (currentPhase === \"player-stopped\" &&\r\n        adjustHintsMode &&\r\n        cell.type === \"hint\");\r\n\r\n    return (\r\n      <TooltipWrapper\r\n        key={`tooltip-${row}-${col}`}\r\n        content={getGridCellTooltipText(cell, row, col)}\r\n        position=\"top\"\r\n        translate={[-50, -50]}\r\n      >\r\n        <div\r\n          key={`${row}-${col}`}\r\n          className={`grid-cell ${cell.type} ${\r\n            isHighlighted ? \"highlighted\" : \"\"\r\n          } ${isPlayerPosition ? \"player-position\" : \"\"} ${\r\n            cell.isFlashing ? \"flashing\" : \"\"\r\n          }`}\r\n          style={{\r\n            cursor: isClickable ? \"pointer\" : \"default\",\r\n          }}\r\n          onClick={() => {\r\n            // Prioritize highlighted cell activation (So Close mode) over hint rotation\r\n            if (\r\n              (currentPhase === \"solving\" ||\r\n                currentPhase === \"player-stopped\") &&\r\n              isHighlighted &&\r\n              !isAnimating\r\n            ) {\r\n              setHighlightedCells([]);\r\n              //     setButtonsEnabled(true); // Re-enable buttons after So Close selection\r\n              activateGridSquare(row, col, selectedPlayer!);\r\n            } else if (\r\n              currentPhase === \"instructions\" &&\r\n              cell.type === \"hint\"\r\n            ) {\r\n              handleHintDirectionChange(row, col);\r\n            } else if (\r\n              currentPhase === \"solving\" &&\r\n              !selectedPlayer &&\r\n              cell.type === \"hint\"\r\n            ) {\r\n              handleHintDirectionChange(row, col);\r\n            } else if (\r\n              currentPhase === \"player-stopped\" &&\r\n              adjustHintsMode &&\r\n              cell.type === \"hint\"\r\n            ) {\r\n              handlePlayerStoppedHintRotation(row, col);\r\n            }\r\n          }}\r\n        >\r\n          {/* Score reward display */}\r\n          {cell.scoreReward > 0 && (\r\n            <div className=\"score-reward\">\r\n              <DiceScore score={cell.scoreReward} />\r\n            </div>\r\n          )}\r\n\r\n          {/* Tension display */}\r\n          {cell.tensionLevel && (\r\n            <div\r\n              className=\"tension-indicator\"\r\n              style={{ color: getTensionColor(cell.tensionLevel) }}\r\n            >\r\n              {getTensionDisplay(cell.tensionLevel)}\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"cell-tag\">\r\n            {cell.type === \"hint\" ? (\r\n              <div className=\"hint-tag\">\r\n                {cell.tag && (\r\n                  <FlavorTagPill tag={cell.tag} showTooltip={false} />\r\n                )}\r\n              </div>\r\n            ) : cell.type === \"exposed\" ? (\r\n              <div className=\"exposed-tag\">\r\n                {cell.tag && (\r\n                  <FlavorTagPill tag={cell.tag} showTooltip={false} />\r\n                )}\r\n              </div>\r\n            ) : cell.type === \"directionless\" ? (\r\n              <div className=\"exposed-tag\">\r\n                {cell.tag && (\r\n                  <FlavorTagPill tag={cell.tag} showTooltip={false} />\r\n                )}\r\n              </div>\r\n            ) : cell.tag ? (\r\n              <FlavorTagPill tag={cell.tag} showTooltip={false} />\r\n            ) : cell.type === \"unexposed\" ? (\r\n              <div className=\"unexposed-tag\">\r\n                <FlavorTagPill\r\n                  tag={tagManager.tagToEncounterFlavorTag(\r\n                    { name: \"?\" },\r\n                    FlavorTagSource.NONE\r\n                  )}\r\n                  showTooltip={false}\r\n                />\r\n              </div>\r\n            ) : null}\r\n          </div>\r\n\r\n          {/* Hint direction arrow */}\r\n          {cell.type === \"hint\" && cell.hintDirection && (\r\n            <div\r\n              className={`grid-hint-arrow ${cell.hintDirection} ${\r\n                cell.visited ? \"visited\" : \"\"\r\n              }`}\r\n            >\r\n              {cell.hintDirection === \"up\" && \"▲\"}\r\n              {cell.hintDirection === \"down\" && \"▼\"}\r\n              {cell.hintDirection === \"left\" && \"◀\"}\r\n              {cell.hintDirection === \"right\" && \"▶\"}\r\n            </div>\r\n          )}\r\n\r\n          {/* Player icon and visited overlay */}\r\n          {cell.visited && cell.type !== \"directionless\" && (\r\n            <div className=\"visited-overlay\">\r\n              {/* {cell.playerIcon && (\r\n                <div\r\n                  className={\r\n                    isPlayerPosition\r\n                      ? \"current-player-marker\"\r\n                      : \"visited-player-marker\"\r\n                  }\r\n                >\r\n                  {cell.playerIcon.name.charAt(0)}\r\n                </div>\r\n              )} */}\r\n            </div>\r\n          )}\r\n\r\n          {/* Answer indicator */}\r\n          {cell.isAnswer && <div className=\"answer-indicator\"></div>}\r\n\r\n          {/* Frustration indicator */}\r\n          {cell.isFrustration && (\r\n            <div className=\"frustration-indicator\">?!</div>\r\n          )}\r\n        </div>\r\n      </TooltipWrapper>\r\n    );\r\n  };\r\n\r\n  const renderGrid = () => {\r\n    if (grid.length === 0) return null;\r\n\r\n    const gridConfig = getGridConfig(difficulty);\r\n\r\n    return (\r\n      <div className=\"grid-container\">\r\n        <div className=\"grid-hint-instructions\">\r\n          Click hints and location clues{\" \"}\r\n          <span className=\"hint-symbol\">\r\n            <span className=\"hint-pill\">\r\n              <span className=\"hint-arrow-symbol\">▲</span>\r\n            </span>\r\n          </span>{\" \"}\r\n          to indicate where discussions will lead.\r\n        </div>\r\n        <div\r\n          className=\"puzzle-grid\"\r\n          style={{\r\n            gridTemplateRows: `repeat(${gridConfig.rows}, 1fr)`,\r\n            gridTemplateColumns: `repeat(${gridConfig.cols}, 1fr)`,\r\n            position: \"relative\", // Add relative positioning for absolute child\r\n          }}\r\n        >\r\n          {grid.map((row, rowIndex) =>\r\n            row.map((cell, colIndex) =>\r\n              renderGridCell(cell, rowIndex, colIndex)\r\n            )\r\n          )}\r\n\r\n          {/* Grid player icon overlay - positioned absolutely */}\r\n          {gridPlayerIcon && gridPlayerIcon.isVisible && (\r\n            <div\r\n              className=\"grid-player-icon\"\r\n              style={{\r\n                position: \"absolute\",\r\n                left: `${(gridPlayerIcon.col / gridConfig.cols) * 100}%`,\r\n                top: `${(gridPlayerIcon.row / gridConfig.rows) * 100}%`,\r\n                width: `${100 / gridConfig.cols}%`,\r\n                height: `${100 / gridConfig.rows}%`,\r\n              }}\r\n            >\r\n              <Cimage imageId={gridPlayerIcon.player.icon} />\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Legend */}\r\n        <div className=\"grid-legend\">\r\n          <div className=\"legend-item\">\r\n            <span className=\"legend-frustration\">{\"?!\"}</span>\r\n            <span className=\"legend-text\">\r\n              Frustration: -1 active player Attitude\r\n            </span>\r\n          </div>\r\n          <div className=\"legend-item\">\r\n            <span className=\"legend-dice-score\">\r\n              <DiceScore score={4} />\r\n            </span>{\" \"}\r\n            and{\" \"}\r\n            <span className=\"legend-dice-score\">\r\n              <DiceScore score={1} />\r\n            </span>{\" \"}\r\n            Interesting topics: adds potential score\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n  \r\n  const getPuzzleTitle = () => {\r\n    const event = campaignManager.getCurrentEvent();\r\n    if (event && event.flavorText) {\r\n      return event.flavorText;\r\n    }\r\n    return \"Puzzle Event\";\r\n  }\r\n\r\n\r\n  return (\r\n    <div className=\"game-encounter-puzzle\">\r\n      <EncounterHeader\r\n        title={getPuzzleTitle()}\r\n        description=\"You've been leaving clues leading up to this all along.\"\r\n        childClass=\"small-font\"\r\n      />\r\n\r\n      <div className=\"puzzle-content\">\r\n        {currentPhase !== \"setup\" && (\r\n          <div className=\"puzzle-left\">{renderGrid()}</div>\r\n        )}\r\n\r\n        {currentPhase === \"setup\" ? (\r\n          <div className=\"puzzle-setup-container\">{renderSetupPhase()}</div>\r\n        ) : (\r\n          <div className=\"puzzle-right\">\r\n            {currentPhase === \"instructions\" && renderInstructionsPhase()}\r\n            {currentPhase === \"solving\" && renderSolvingPhase(currentScore)}\r\n            {currentPhase === \"player-stopped\" &&\r\n              renderPlayerStoppedPhase(currentScore)}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Floating player icon animation */}\r\n      {floatingIconPosition && floatingIconPosition.isAnimating && (\r\n        <div\r\n          className=\"floating-player-icon\"\r\n          style={{\r\n            position: \"absolute\",\r\n            left: floatingIconPosition.x,\r\n            top: floatingIconPosition.y,\r\n            zIndex: 1000,\r\n            transition: \"all 1s ease-in-out\",\r\n          }}\r\n        >\r\n          <Cimage imageId={floatingIconPosition.player.icon} />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GameEncounterPuzzle;\r\n","\n\nimport { Encounter } from '../../models';\n\n\n\ninterface GameEncounterStoryProps {\n\tencounter: Encounter;\n}\n\n  const GameEncounterStory: React.FC<GameEncounterStoryProps> = ({encounter}) => {\n\n\t\n\t  return (\n\t\t<div className=\"game-encounter-combat\">\n\t\t  <div className=\"encounter-type-title\">Story</div>\n\t\t</div>\n\t  );\n\t};\n\nexport default GameEncounterStory;","import { EffectData, Attribute, ATTRIBUTE_TYPE } from \"../../models\";\r\nimport CImage from \"./cimage\";\r\n\r\ninterface EffectDisplayProps {\r\n\teffectData: EffectData;\r\n}\r\n\r\nconst EffectDisplay: React.FC<EffectDisplayProps> = ({ effectData }) => {\r\n\tconst renderAttributeGains = (attributeGains: Attribute) => {\r\n\t\tconst gains = [];\r\n\t\t\r\n\t\tif (attributeGains[ATTRIBUTE_TYPE.COMBAT] && attributeGains[ATTRIBUTE_TYPE.COMBAT] > 0) {\r\n\t\t\tgains.push(\r\n\t\t\t\t<div key=\"combat\" className=\"attribute-gain-item\">\r\n\t\t\t\t\t<span className=\"attribute-icon combat\">⚔️</span>\r\n\t\t\t\t\t<span className=\"attribute-value\">+{attributeGains[ATTRIBUTE_TYPE.COMBAT]}</span>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t\tif (attributeGains[ATTRIBUTE_TYPE.MAGIC] && attributeGains[ATTRIBUTE_TYPE.MAGIC] > 0) {\r\n\t\t\tgains.push(\r\n\t\t\t\t<div key=\"magic\" className=\"attribute-gain-item\">\r\n\t\t\t\t\t<span className=\"attribute-icon magic\">✨</span>\r\n\t\t\t\t\t<span className=\"attribute-value\">+{attributeGains[ATTRIBUTE_TYPE.MAGIC]}</span>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t\tif (attributeGains[ATTRIBUTE_TYPE.TOOLS] && attributeGains[ATTRIBUTE_TYPE.TOOLS] > 0) {\r\n\t\t\tgains.push(\r\n\t\t\t\t<div key=\"tools\" className=\"attribute-gain-item\">\r\n\t\t\t\t\t<span className=\"attribute-icon tools\">🔧</span>\r\n\t\t\t\t\t<span className=\"attribute-value\">+{attributeGains[ATTRIBUTE_TYPE.TOOLS]}</span>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t\t}\r\n\t\t\r\n\t\treturn gains.length > 0 ? (\r\n\t\t\t<div className=\"attribute-gains-container\">\r\n\t\t\t\t{gains}\r\n\t\t\t</div>\r\n\t\t) : null;\r\n\t};\r\n\r\n\tconst renderEffect = (effect: any, idx: number) => {\r\n\t\t// Special handling for attribute gains\r\n\t\tif (effect.class === 'attribute-gains') {\r\n\t\t\ttry {\r\n\t\t\t\tconst attributeGains: Attribute = JSON.parse(effect.effect);\r\n\t\t\t\tconst gainsDisplay = renderAttributeGains(attributeGains);\r\n\t\t\t\t\r\n\t\t\t\tif (!gainsDisplay) {\r\n\t\t\t\t\treturn null; // No gains to show\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div key={idx} className={`effect-display-effect ${effect.class}`}>\r\n\t\t\t\t\t\t{gainsDisplay}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t} catch (e) {\r\n\t\t\t\t// If parsing fails, fall back to normal text display\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div key={idx} className={`effect-display-effect ${effect.class}`}>\r\n\t\t\t\t\t\t{effect.effect}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// Normal effect rendering\r\n\t\treturn (\r\n\t\t\t<div key={idx} className={`effect-display-effect ${effect.class}`}>\r\n\t\t\t\t{effect.effect}\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"effect-display\">\r\n\t\t\t<div className=\"effect-display-header\">\r\n\t\t\t\t<div className=\"effect-display-name\">{effectData.object === 'party' ? 'Party' : (effectData.object as any).name}</div>\r\n\t\t\t\t{effectData.object !== 'party' && (effectData.object as any).icon && <CImage imageId={(effectData.object as any).icon} />}\r\n\t\t\t</div>\r\n\r\n\t\t\t{effectData.effects?.map((effect, idx) => renderEffect(effect, idx))}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default EffectDisplay;\r\n","import React from 'react';\r\nimport { EncounterFlavorTag, ResultConfig, Tag } from '../../models';\r\nimport EffectDisplay from '../UI/effectDisplay';\r\nimport FlavorTagPill from '../UI/FlavorTagPill';\r\nimport TooltipWrapper from '../UI/TooltipWrapper';\r\n\r\n\r\n\r\ninterface ResultsDisplayProps {\r\n  resultConfig: ResultConfig;\r\n  renderResultInfo: () => React.ReactNode;\r\n  onClose: () => void;\r\n  onTagClick: (tag: EncounterFlavorTag) => void;\r\n  selectedTags: Tag[];\r\n  remainingClicks: number;\r\n}\r\n\r\nconst ResultsDisplay: React.FC<ResultsDisplayProps> = ({\r\n  resultConfig,\r\n  renderResultInfo,\r\n  onClose,\r\n  onTagClick,\r\n  selectedTags,\r\n  remainingClicks\r\n}) => {\r\n  return (\r\n    <div className=\"results-panel\">\r\n      <div className=\"results-panel-container\">\r\n        <div className=\"results-panel-header\">\r\n          {resultConfig.title}\r\n          <div className=\"results-panel-description\">\r\n            {resultConfig.description}\r\n          </div>\r\n          <button\r\n            className=\"close-button\"\r\n            onClick={onClose}\r\n          >\r\n            ×\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"result-info\">\r\n          {renderResultInfo()}\r\n        </div>\r\n\r\n        <div className=\"travel-results\">\r\n          {resultConfig.results.map((result, idx) => (\r\n            <EffectDisplay key={idx} effectData={result} />\r\n          ))}\r\n        </div>\r\n        {resultConfig.tags.length > 0 && remainingClicks > 0 && (\r\n          <div className=\"travel-tag-container\">\r\n            <div className=\"clicks-remaining\">\r\n              <TooltipWrapper\r\n                content=\"Click on the tags to reveal them.\"\r\n                maxWidth=\"200\"\r\n                preservePositioning={true}\r\n                translate={[0, -80]}\r\n              >\r\n                {remainingClicks}\r\n              </TooltipWrapper>\r\n            </div>\r\n            <div className=\"travel-tags-instructions\">\r\n              {resultConfig.travelOption.tagInstructions}\r\n            </div>\r\n            <div className=\"travel-tags-container\">\r\n              <div className=\"travel-tags\">\r\n                {resultConfig.tags.map((tag) => {\r\n                  const tagUsed = selectedTags.includes(tag.tag);\r\n                  return (\r\n                    <FlavorTagPill\r\n                      key={tag.tag.name}\r\n                      tag={tag}\r\n                      onClick={onTagClick}\r\n                      className={`${tagUsed ? \"used\" : \"\"}`}\r\n                      disabled={tagUsed}\r\n                    />\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {remainingClicks > 0 && resultConfig.tags.length === 0 && (\r\n          <div className=\"remaining-clicks-warning\">\r\n            Nothing new to present to the players.\r\n          </div>\r\n      )}\r\n\r\n\r\n        {(resultConfig.tags.length === 0 || remainingClicks === 0) && (\r\n        <div className=\"bottom-container\">\r\n          \r\n          <div\r\n            className={`return-button ${remainingClicks > 0 ? 'disabled' : ''}`}\r\n            onClick={onClose}\r\n          >\r\n            Return\r\n          </div>\r\n          \r\n        </div> )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ResultsDisplay;\r\n","import { useCallback } from \"react\";\r\nimport { Tag, ThemeConfig, TRAVEL_OPTION, TravelOption } from \"../../models\";\r\nimport { useAppManager, useCampaignManager } from \"../managerContexts\";\r\nimport { ConditionalTooltip } from \"./tooltip\";\r\nimport TooltipWrapper from \"./TooltipWrapper\";\r\n\r\ninterface TravelOptionProps {\r\n\ttravelOption: TravelOption;\r\n\ttheme?: ThemeConfig;\r\n\tonClick: () => void;\r\n\tlength?: string;\r\n}\r\n\r\nconst TravelOptionDisplay: React.FC<TravelOptionProps> = ({\r\n\ttravelOption,\r\n\ttheme,\r\n\tonClick,\r\n\tlength,\r\n}) => {\r\n\tconst {\r\n\t\tid,\r\n\t\tname,\r\n\t\tdescription,\r\n\t\ttime,\r\n\t\ttags,\r\n\t\tscore,\r\n\t\tboredom,\r\n\t\ttag,\r\n\t\texhaustion,\r\n\t\ttravelOptionType,\r\n\t} = travelOption;\r\n\tconst appManager = useAppManager();\r\nconst campaignManager = useCampaignManager();\r\n\tconst eventTag = campaignManager.getEventTag(travelOption);\r\n\tconst hasTravelTag = (tag: Tag) => {\r\n\t\t// Uncomment the line below and remove the true return when ready to use the actual function\r\n\t\t\t return appManager.getTagManager().collectedTags.includes(tag);\r\n\t\t//return true;\r\n\t};\r\n\r\n\tconst displayValue = (value: number | undefined) => {\r\n\t\tif (value === -1) return \"?\";\r\n\t\treturn value;\r\n\t};\r\n\t// Determine if the option is locked\r\n\tconst isLocked = eventTag && !hasTravelTag(eventTag);\r\n\r\n\tconst getTagClassType = (type: TRAVEL_OPTION | undefined) => {\r\n\t\tswitch (type) {\r\n\t\t\tcase TRAVEL_OPTION.EXPLORE_CURRENT_LOCATION:\r\n\t\t\t\treturn \"type-explore-current\";\r\n\t\t\tcase TRAVEL_OPTION.EXPLORE_UPCOMING_LOCATION:\r\n\t\t\t\treturn \"type-explore-upcoming\";\r\n\t\t\tcase TRAVEL_OPTION.CAMP:\r\n\t\t\t\treturn \"type-camp\";\r\n\t\t\tcase TRAVEL_OPTION.AMBUSH:\r\n\t\t\t\treturn \"type-ambush\";\r\n\t\t\tcase TRAVEL_OPTION.AMBUSH2:\r\n\t\t\t\treturn \"type-ambush\";\r\n\t\t\tcase TRAVEL_OPTION.TRADERS:\r\n\t\t\t\treturn \"type-traders\";\r\n\t\t\tcase TRAVEL_OPTION.SIDE_QUEST:\r\n\t\t\t\treturn \"type-sidequest\";\r\n\t\t\tcase TRAVEL_OPTION.MAGIC_CACHE:\r\n\t\t\t\treturn \"type-magic-item\";\r\n\t\t\tcase TRAVEL_OPTION.CHARACTER_BACKSTORY:\r\n\t\t\t\treturn \"type-backstory\";\r\n\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"\";\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={`travel-option ${length} ${isLocked ? \"locked\" : \"unlocked\"}`}\r\n\t\t\tonClick={onClick}\r\n\t\t>\r\n\t\t\t{isLocked && (\r\n\t\t\t\t\r\n\t\t\t\t<div className=\"locked-banner\"><TooltipWrapper\r\n\t\t\t\t\tcontent={`Unlocked by introducing ${eventTag?.name}`}\r\n\t\t\t\t\t\r\n\t\t\t\t\tpreservePositioning={false}\r\n\t\t\t\t\t>\t\r\n\t\t\t\t\t<span>UNDISCOVERED</span>\r\n\t\t\t\t\t</TooltipWrapper>\r\n\t\t\t\t</div>\r\n\t\t\t\r\n\t\t\t)}\r\n\t\t\t<div className=\"travel-option-header\">\r\n\t\t\t\t<span className=\"travel-option-name\">{name}</span>\r\n\t\t\t\t{eventTag && (\r\n\t\t\t\t\t<ConditionalTooltip\r\n\t\t\t\t\t\ttooltip={`Unlocked from previous discussions about ` + eventTag.name}\r\n\t\t\t\t\t\tvisible={!isLocked}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tpreservePositioning={true}\r\n\t\t\t\t\t\ttranslate={[0, -40]}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclassName={`travel-option-tag text-pill type-travel ${\r\n\t\t\t\t\t\t\t\thasTravelTag(eventTag) ? \"\" : \"missing\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{eventTag.name}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</ConditionalTooltip>\r\n\t\t\t\t)}\r\n\t\t\t\t<div className=\"travel-option-description\">{description}</div>\r\n\t\t\t</div>{\" \"}\r\n\t\t\t<ConditionalTooltip\r\n\t\t\t\ttooltip=\"Journey Length increase\"\r\n\t\t\t\tvisible={!isLocked}\r\n\t\t\t\tpreservePositioning={true}\r\n\t\t\t\ttranslate={[100, -80]}\r\n\t\t\t>\r\n\t\t\t\t<span className=\"travel-option-detail\">🕒:{displayValue(time)}</span>\r\n\t\t\t</ConditionalTooltip>\r\n\t\t\t<ConditionalTooltip\r\n\t\t\t\ttooltip=\"Boredom Risk Increase\"\r\n\t\t\t\tvisible={!isLocked}\r\n\t\t\t\tpreservePositioning={true}\r\n\t\t\t\ttranslate={[-110, -80]}\r\n\t\t\t>\r\n\t\t\t\t<span className=\"travel-option-detail time\">\r\n\t\t\t\t\t👁️:{displayValue(boredom)}\r\n\t\t\t\t</span>\r\n\t\t\t</ConditionalTooltip>\r\n\t\t\t{tags > 0 && (\r\n\t\t\t\t<ConditionalTooltip\r\n\t\t\t\t\ttooltip={travelOption.tagInstructions || \"Location tags\"}\r\n\t\t\t\t\tvisible={!isLocked}\r\n\t\t\t\t\tpreservePositioning={true}\r\n\t\t\t\t\ttranslate={[-135, 10]}\r\n\t\t\t\t>\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclassName={`travel-option-detail tags text-pill ${isLocked ? 'disabled' : '' } ${getTagClassType(\r\n\t\t\t\t\t\t\ttravelOption.travelOptionType\r\n\t\t\t\t\t\t)}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"travel-option-tag-label\">{tags}</div>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</ConditionalTooltip>\r\n\t\t\t)}{\" \"}\r\n\t\t\t{score !== undefined && score !== 0 && (\r\n\t\t\t\t<ConditionalTooltip\r\n\t\t\t\t\ttooltip=\"Impact on campaign score\"\r\n\t\t\t\t\tvisible={!isLocked}\r\n\t\t\t\t\tpreservePositioning={true}\r\n\t\t\t\t>\r\n\t\t\t\t\t<span className=\"travel-option-detail score\">\r\n\t\t\t\t\t\tScore: {displayValue(score)}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</ConditionalTooltip>\r\n\t\t\t)}{\" \"}\r\n\t\t\t{exhaustion !== undefined && exhaustion !== 0 && (\r\n\t\t\t\t<ConditionalTooltip\r\n\t\t\t\t\ttooltip=\"Party Exhaustion increase\"\r\n\t\t\t\t\tvisible={!isLocked}\r\n\t\t\t\t\tpreservePositioning={true}\r\n\t\t\t\t>\r\n\t\t\t\t\t<span className=\"travel-option-detail score\">\r\n\t\t\t\t\t\tExhaustion: {displayValue(exhaustion)}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</ConditionalTooltip>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default TravelOptionDisplay;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport EncounterHeader from \"./encounterHeader\";\r\nimport {\r\n  useAppManager,\r\n  useCampaignManager,  useCharacterManager,\r\n} from \"../managerContexts\";\r\nimport \"./gameRoom.scss\";\r\nimport partyManager from \"../../managers/partyManager\";\r\nimport ResultsDisplay from \"./resultsDisplay\";\r\nimport {  Encounter,\r\n  TRAVEL_LENGTH,\r\n  TravelOption,\r\n  Tag,\r\n  TravelResultConfig,\r\n  EncounterFlavorTag,\r\n  TRAVEL_OPTION,\r\n  Character,\r\n  Player,\r\n} from \"../../models\";\r\nimport \"../UI/encounterStyle.scss\";\r\nimport TravelOptionDisplay from \"../UI/travelOption\";\r\n\r\nimport TooltipWrapper from \"../UI/TooltipWrapper\";\r\nimport InstructionsPanel from \"../UI/InstructionsPanel\";\r\nimport DiceScore from \"../UI/DiceScore\";\r\ninterface GameEncounterTravelProps {\r\n  encounter: Encounter;\r\n}\r\n\r\n// TODO move this:\r\nconst SMALL_SCORE = 3;\r\nconst MEDIUM_SCORE = 5;\r\nconst LARGE_SCORE = 8;\r\n\r\ninterface JourneyLength {\r\n  rating: \"EPIC\" | \"GREAT\" | \"GOOD\" | \"SHORT\" | \"FUTILE\";\r\n  score: number;\r\n}\r\n\r\nconst GameEncounterTravel: React.FC<GameEncounterTravelProps> = ({\r\n  encounter,\r\n}) => {  const [usedTravelOptionIds, setUsedTravelOptionIds] = useState<string[]>([]);\r\n\r\n  // Add reward position state\r\n  const [bigRewardSection, setBigRewardSection] = useState<string>(\"\");\r\n  const [smallRewardSections, setSmallRewardSections] = useState<string[]>([]);\r\n\r\n  const appManager = useAppManager();\r\n  const tagManager = appManager.getTagManager();\r\n  const campaignManager = useCampaignManager();\r\n  const characterManager = useCharacterManager();  const partyManager = appManager.getPartyManager();\r\n\r\n  const [travelOptions] = useState<TravelOption[][]>(\r\n    campaignManager.getTravelOptions()\r\n  );\r\n  const [selectedOption, setSelectedOption] = useState<TravelOption | null>(\r\n    null\r\n  );\r\n  const [selectedTags, setSelectedTags] = useState<Tag[]>([]);\r\n  const [journeyLength, setJourneyLength] = useState<number>(0);\r\n  const [boredomLevel, setBoredomLevel] = useState<number>(0);\r\n  const [travelResultsVisible, setTravelResultsVisible] = useState(false);\r\n  const [travelResultConfig, setTravelResultConfig] = useState<\r\n    TravelResultConfig | undefined\r\n  >();\r\n  const [targetCharacter, setTargetCharacter] = useState<\r\n    Character | Player | null\r\n  >(null);\r\n  const [nbTagClicks, setNbTagClicks] = useState(0);\r\n\r\n  // Add useEffect to set up rewards on mount\r\n  useEffect(() => {\r\n    randomizeRewards();\r\n  }, []);\r\n\r\n  // Function to randomize reward positions\r\n  const randomizeRewards = () => {\r\n    // Possible journey sections (excluding FUTILE)\r\n    const journeySections = [\"SHORT\", \"GOOD\", \"GREAT\", \"EPIC\"];\r\n\r\n    // Choose big reward section (any except FUTILE)\r\n    const bigRewardIndex = Math.floor(Math.random() * journeySections.length);\r\n    const bigReward = journeySections[bigRewardIndex];\r\n\r\n    // Set small reward sections (before and after big reward)\r\n    let smallRewards: string[] = [];\r\n\r\n    if (bigReward === \"EPIC\") {\r\n      // If EPIC is big reward, small rewards go on GOOD and GREAT\r\n      smallRewards = [\"GOOD\", \"GREAT\"];\r\n    } else if (bigReward === \"SHORT\") {\r\n      // If SHORT is big reward, small rewards go on GOOD and FUTILE\r\n      smallRewards = [\"FUTILE\", \"GOOD\"];\r\n    } else {\r\n      // For GOOD or GREAT, take the sections before and after\r\n      const prevIndex = Math.max(0, bigRewardIndex - 1);\r\n      const nextIndex = Math.min(\r\n        journeySections.length - 1,\r\n        bigRewardIndex + 1\r\n      );\r\n      smallRewards = [\r\n        journeySections[prevIndex],\r\n        journeySections[nextIndex],\r\n      ].filter((section) => section !== bigReward);\r\n    }\r\n\r\n    setBigRewardSection(bigReward);\r\n    setSmallRewardSections(smallRewards);\r\n  };\r\n\r\n  const getJourneyDetails = (score: number): JourneyLength => {\r\n    if (score >= 80) return { rating: \"EPIC\", score: 100 };\r\n    if (score >= 60) return { rating: \"GREAT\", score: 75 };\r\n    if (score >= 40) return { rating: \"GOOD\", score: 50 };\r\n    if (score >= 20) return { rating: \"SHORT\", score: 25 };\r\n    return { rating: \"FUTILE\", score: 0 };\r\n  };\r\n\r\n\r\n  const getTensionLevel = (value: number): string => {\r\n    if (value >= 66) return \"ZERO\";\r\n    if (value >= 33) return \"LOW\";\r\n    return \"BASIC\";\r\n  };\r\n\r\n  const handleTravelOption = (option: TravelOption) => {\r\n    // make a copy of the option to avoid mutating the original\r\n    const optionCopy = { ...option };\r\n\r\n    // check for -1s (indicating random) for time or boredom level and randomize here.\r\n    if (optionCopy.time === -1) {\r\n      optionCopy.time = Math.floor(Math.random() * 10) + 1; // Random time between 1 and 10\r\n    }\r\n    if (optionCopy.boredom === -1) {\r\n      optionCopy.boredom = Math.floor(Math.random() * 10) + 1; // Random boredom between 1 and 10\r\n    }\r\n    setBoredomLevel(Math.min(boredomLevel + optionCopy.boredom, 100));\r\n    setJourneyLength(Math.min(journeyLength + optionCopy.time, 100));\r\n\r\n    if (!option.repeatable) {\r\n      setUsedTravelOptionIds((prev) => [...prev, option.id]);\r\n    }\r\n\r\n    const travelOptionResult = campaignManager.selectTravelOption(\r\n      optionCopy,\r\n      boredomLevel\r\n    );\r\n\r\n    // Find the first travel result that has an 'object' property (character or player)\r\n    const travelOptionResultCharacter = travelOptionResult?.travelResults.find(\r\n      (result) => result?.object && result.object !== \"party\"\r\n    )?.object;\r\n    if (\r\n      travelOptionResultCharacter &&\r\n      travelOptionResultCharacter !== \"party\"\r\n    ) {\r\n      setTargetCharacter(travelOptionResultCharacter);\r\n    } else {\r\n      setTargetCharacter(null);\r\n    }\r\n\r\n    const travelResults = travelOptionResult?.travelResults || [];\r\n    const travelTags = travelOptionResult?.travelTags || [];\r\n\r\n    // remove travel tags that we have exposed previously\r\n    const filteredTravelTags = travelTags.filter(\r\n      (tag) => !tagManager.isTagCollected(tag.tag)\r\n    );\r\n\r\n    setSelectedOption(option);\r\n    setTravelResultConfig({\r\n      results: travelResults,\r\n      title: option.name,\r\n      description: option.description,\r\n      tags: filteredTravelTags,\r\n      travelOption: option,\r\n      info: {\r\n        boredom: option.boredom,\r\n        score: option.score,\r\n        time: option.time,\r\n        exhaustion: option.exhaustion || 0,\r\n      },\r\n    });\r\n    setNbTagClicks(option.tags);\r\n    setTravelResultsVisible(true);\r\n  };\r\n\r\n  const handleAcceptJourney = () => {\r\n \r\n    const currentRating = getJourneyDetails(journeyLength).rating;\r\n    \r\n    if (currentRating === bigRewardSection) {\r\n      campaignManager.collectEncounterPoints(LARGE_SCORE);\r\n    } else if (smallRewardSections.includes(currentRating)) {\r\n      campaignManager.collectEncounterPoints(SMALL_SCORE);\r\n    }\r\n\r\n    campaignManager.backToOverview();\r\n  };\r\n\r\n  const handleTagClick = (flavorTag: EncounterFlavorTag) => {\r\n    if (nbTagClicks > 0) {\r\n      setNbTagClicks(nbTagClicks - 1);\r\n    }\r\n\r\n    switch (selectedOption?.travelOptionType) {\r\n      case TRAVEL_OPTION.CHARACTER_BACKSTORY:\r\n        characterManager.assignBackstory(\r\n          targetCharacter as Character,\r\n          flavorTag.tag\r\n        );\r\n        break;\r\n\r\n      default:\r\n        campaignManager.exposeTag(flavorTag);\r\n    }\r\n    setSelectedTags([...selectedTags, flavorTag.tag]);\r\n  };\r\n\r\n  // Create a function to filter out used options\r\n  const getFilteredOptions = (options: TravelOption[], count: number) => {\r\n    const filtered = options\r\n      .filter((option) => !usedTravelOptionIds.includes(option.id))\r\n      .sort(() => 0.5 - Math.random());\r\n\r\n    // If we have enough fresh options, return them\r\n\r\n    return filtered.slice(0, Math.min(count, filtered.length));\r\n  };\r\n  const shortTravelOptions = getFilteredOptions(travelOptions[0], 3);\r\n  const mediumTravelOptions = getFilteredOptions(travelOptions[1], 3);\r\n  const longTravelOptions = getFilteredOptions(travelOptions[2], 3);\r\n  const renderResultInfo = () => {\r\n    if (!travelResultConfig) return null;\r\n    return (\r\n      <>\r\n        <div className=\"travel-result-info-item boredom\">\r\n          <TooltipWrapper content=\"Boredom risk is a measure of player patience and quality of the event.\">\r\n            👁️ Boredom Risk : +{travelResultConfig.info.boredom}\r\n          </TooltipWrapper>\r\n        </div>\r\n        <div className=\"travel-result-info-item time\">\r\n          <TooltipWrapper content=\"Journey Length is an indication of time passing in game.\">\r\n            🕒 Journey Length : +{travelResultConfig.info.time}\r\n          </TooltipWrapper>\r\n        </div>\r\n      </>\r\n    );\r\n  };\r\n\r\n  const renderTravelResults = () => {\r\n    if (!travelResultConfig) return null;\r\n    return (\r\n      <ResultsDisplay\r\n        resultConfig={travelResultConfig}\r\n        renderResultInfo={renderResultInfo}\r\n        onClose={() => setTravelResultsVisible(false)}\r\n        onTagClick={handleTagClick}\r\n        selectedTags={selectedTags}\r\n        remainingClicks={nbTagClicks}\r\n      />\r\n    );\r\n  };\r\n\r\n  const renderTravelOptions = () => {\r\n    return (\r\n      <div className=\"travel-options-panel\">\r\n        <div className=\"travel-options-container short\">\r\n          <div className=\"travel-section-title\">Short Tasks</div>\r\n          <div className=\"travel-options\">\r\n            {shortTravelOptions.map((option) => (\r\n              <TravelOptionDisplay\r\n                key={option.id}\r\n                travelOption={option}\r\n                onClick={() => handleTravelOption(option)}\r\n                length={TRAVEL_LENGTH.SHORT}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"travel-options-container medium\">\r\n          <div className=\"travel-section-title\">Moderate Events</div>\r\n          <div className=\"travel-options\">\r\n            {mediumTravelOptions.map((option) => (\r\n              <TravelOptionDisplay\r\n                key={option.id}\r\n                travelOption={option}\r\n                onClick={() => handleTravelOption(option)}\r\n                length={TRAVEL_LENGTH.MEDIUM}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"travel-options-container long\">\r\n          <div className=\"travel-section-title\">Extensive Travel Options</div>\r\n          <div className=\"travel-options\">\r\n            {longTravelOptions.map((option) => (\r\n              <TravelOptionDisplay\r\n                key={option.id}\r\n                travelOption={option}\r\n                onClick={() => handleTravelOption(option)}\r\n                length={TRAVEL_LENGTH.LONG}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n  return (\r\n    <div className=\"game-encounter-travel-container\">\r\n      <EncounterHeader\r\n        title={`Travel through ${encounter.location.name}`}\r\n        description={campaignManager.getCurrentEvent()?.flavorText || \"\"}\r\n        //leftContent={\r\n          // <InstructionsPanel\r\n          //   instructions={[\r\n          //     \"Every action applies the current Boredom Risk\",\r\n          //     \"Boredom = per-player chance of attention loss\",\r\n          //     \"Some options are locked by their topics\"\r\n          //   ]}\r\n          // />\r\n        //} \r\n        // rightContent={\r\n        //   <InstructionsPanel\r\n        //     instructions={[\r\n        //       \"End the journey to collect the rewards\",\r\n        //       \"next to the highlighted Journey Length\"\r\n        //     ]}\r\n        //   />\r\n        // }\r\n        instructions={[true, true]}\r\n        childClass={\"small-font\"}\r\n      />\r\n\r\n      <div className=\"game-encounter-travel\">\r\n        <TooltipWrapper content=\"Every action applies the current Boredom Risk which may result in loss of attention\">\r\n\r\n        \r\n          <div className=\"travel-meter-container left\">\r\n            <div className=\"travel-meter-label\">Boredom Risk 👁️</div>\r\n            \r\n            <div className=\"travel-meter-container left2\">\r\n\r\n        \r\n            <div className=\"travel-thermometer\">\r\n              \r\n              \r\n              <div className=\"meter-fill\" style={{ height: `${boredomLevel}%` }}>\r\n                <span className=\"meter-value\">{boredomLevel}</span>\r\n              </div>\r\n              <div className=\"meter-markers\">\r\n                {[0, 33, 66, 100].map((mark) => (\r\n                  <div key={mark} className=\"marker\">\r\n                    <span className=\"marker-value\">{mark}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"travel-sections\">\r\n            \r\n              <div\r\n                className={`travel-section zero ${\r\n                  getTensionLevel(boredomLevel) === \"ZERO\" ? \"active\" : \"\"\r\n                }`}\r\n              >\r\n                <span className=\"section-label title\">\r\n                  HIGH\r\n                </span>\r\n                <span className=\"section-label details\">Attention Loss</span>\r\n                <span className=\"section-label details\">15% Attitude Loss</span>\r\n                <span className=\"section-label details\">-10 Tension</span>\r\n              </div>\r\n              <div\r\n                className={`travel-section low ${\r\n                  getTensionLevel(boredomLevel) === \"LOW\" ? \"active\" : \"\"\r\n                }`}\r\n              >\r\n                <span className=\"section-label title\">\r\n                  RISING\r\n                </span>\r\n                <span className=\"section-label details\">50% Attention Loss</span>\r\n                <span className=\"section-label details\">5% Attitude Loss</span>\r\n                <span className=\"section-label details\">-10 Tension</span>\r\n              </div>\r\n              <div\r\n                className={`travel-section basic ${\r\n                  getTensionLevel(boredomLevel) === \"BASIC\" ? \"active\" : \"\"\r\n                }`}\r\n              >\r\n                <span className=\"section-label title\">\r\n                  LOW\r\n                </span>\r\n                <span className=\"section-label details\">\r\n                  20% Chance of Boredom\r\n                </span>\r\n                <span className=\"section-label details\">-5 Tension</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          </div>\r\n        </TooltipWrapper>\r\n        {travelResultsVisible ? renderTravelResults() : renderTravelOptions()}\r\n <TooltipWrapper content=\"Accepting the journey will award any highlighted score\">\r\n\r\n        <div className=\"right-meter-container\">\r\n          <div className=\"travel-meter-label\">Journey Length 🕒</div>\r\n          <div className=\"travel-meter-container\">\r\n            <div className=\"travel-sections\">\r\n              {[\"FUTILE\", \"SHORT\", \"GOOD\", \"GREAT\", \"EPIC\"].map((rating) => (\r\n                <div\r\n                  key={rating}\r\n                  className={`travel-section ${rating.toLowerCase()} ${\r\n                    rating === getJourneyDetails(journeyLength).rating\r\n                      ? \"active\"\r\n                      : \"\"\r\n                  }`}\r\n                >\r\n                  <span className=\"section-label\">\r\n                    {rating}\r\n                    {rating === bigRewardSection && (\r\n                      <span className=\"dm-points reward big-reward\">\r\n                        <DiceScore score={LARGE_SCORE} direction=\"row\" className=\"small\"/>\r\n                      </span>\r\n                    )}\r\n                    {smallRewardSections.includes(rating) && (\r\n                      <span className=\"dm-points reward small-reward\">\r\n                        <DiceScore score={SMALL_SCORE} direction=\"row\" className=\"small\"/>\r\n                      </span>\r\n                    )}\r\n                  </span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n            <div className=\"travel-thermometer journey\">\r\n              <div\r\n                className=\"meter-fill\"\r\n                style={{ height: `${journeyLength}%` }}\r\n              >\r\n                <span className=\"meter-value\">{journeyLength}</span>\r\n              </div>\r\n              <div className=\"meter-markers\">\r\n                {[0, 20, 40, 60, 80, 100].map((mark) => (\r\n                  <div key={mark} className=\"marker\">\r\n                    <span className=\"marker-value\">{mark}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className={`accept-journey-button ${travelResultsVisible ? ' disabled' : ''}`} onClick={handleAcceptJourney}>\r\n            Accept {getJourneyDetails(journeyLength).rating.toUpperCase()}{\" \"}\r\n            journey\r\n            {/* <span className=\"journey-score\">\r\n              +{getJourneyDetails(journeyLength).score} Campaign Score\r\n            </span> */}\r\n          </div>\r\n        </div>\r\n        </TooltipWrapper>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GameEncounterTravel;\r\n","interface TreeShapeProps {\n  size: number;\n  color: string;\n  style: React.CSSProperties;\n}\n\nexport const TreeShape: React.FC<TreeShapeProps> = ({ size, color, style }) => {\n  return (\n    <div style={{ \n      position: 'absolute',\n      width: size,\n      height: size,\n      ...style \n    }}>\n      <div style={{\n        position: 'absolute',\n        width: size * 0.6,\n        height: size * 0.6,\n        borderRadius: '50%',\n        backgroundColor: color,\n        left: '20%',\n        top: '20%'\n      }} />\n    </div>\n  );\n};","import { ThemeConfig } from \"../models\";\r\n\r\nexport const SCENERY_THEME_CONFIGS: Record<string, ThemeConfig> = {\r\n  town: {\r\n    backgroundColor: '#765f4a',\r\n    shapes: [\r\n      {\r\n        type: 'rectangle',\r\n        minSize: 7,\r\n        maxSize: 14,\r\n        count: { min: 10, max: 20 },\r\n        color: '#695a4b',\r\n        rotate: false\r\n      }\r\n    ]\r\n  },\r\n  forest: {\r\n    backgroundColor: '#2F4F2F',\r\n    shapes: [\r\n      {\r\n        type: 'tree',\r\n        minSize: 80,\r\n        maxSize: 200,\r\n        count: { min: 50, max: 100 },\r\n        color: '#1B3B1B'\r\n      }\r\n    ]\r\n  },\r\n  brewery: {\r\n    backgroundColor: '#765f4a',\r\n    shapes: [\r\n      {\r\n        type: 'furniture',\r\n        minSize: 80,\r\n        maxSize: 200,\r\n        count: { min: 50, max: 100 },\r\n        color: '#695a4b'\r\n      }\r\n    ]\r\n  },\r\n  building: {\r\n    backgroundColor: '#765f4a',\r\n    shapes: [\r\n      {\r\n        type: 'furniture',\r\n        minSize: 80,\r\n        maxSize: 200,\r\n        count: { min: 50, max: 100 },\r\n        color: '#695a4b'\r\n      }\r\n    ]\r\n  },\r\n  mountain: {\r\n    backgroundColor: '#6B6B6B',\r\n    shapes: [\r\n      {\r\n        type: 'rectangle',\r\n        minSize: 7,\r\n        maxSize: 10,\r\n        count: { min: 50, max: 100 },\r\n        color: '#787878'\r\n      }\r\n    ]\r\n  },\r\n  cave: {\r\n    backgroundColor: '#6B6B6B',\r\n    shapes: [\r\n      {\r\n        type: 'rectangle',\r\n        minSize: 7,\r\n        maxSize: 10,\r\n        count: { min: 50, max: 100 },\r\n        color: '#787878'\r\n      }\r\n    ]\r\n  },\r\n  dungeon: {\r\n    backgroundColor: '#333',\r\n    shapes: [\r\n      {\r\n        type: 'wall',\r\n        count: { min: 1, max: 1 },\r\n        minSize: 100,\r\n        maxSize: 100,\r\n        rotate: false,\r\n        color: '#2b2b2b'\r\n      }\r\n    ]\r\n  }\r\n};","import { Key, CSSProperties } from 'react';\r\nimport { ShapeConfig } from '../../models';\r\nimport { TreeShape } from './treeShapeProps';\r\nimport { SCENERY_THEME_CONFIGS } from '../../consts/sceneryConsts';\r\nimport './scenery.scss';\r\n\r\ninterface EncounterSceneryProps {\r\n    theme: string;\r\n    regenKey?: string;\r\n}\r\n\r\nconst generateShapes = (config: ShapeConfig) => {\r\n  const shapes = [];\r\n  const count = Math.floor(Math.random() * (config.count.max - config.count.min + 1)) + config.count.min;\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const size = Math.floor(Math.random() * (config.maxSize - config.minSize + 1)) + config.minSize;\r\n    \r\n   \r\n    let left = (Math.random() * 100) + '%';\r\n    let top = (Math.random() * 100) + '%';\r\n    if(config.type === 'wall') {\r\n      left = '0%'; \r\n      top = '0%';\r\n    }\r\n    const style = {\r\n      left,\r\n      top,\r\n      transform: config.rotate ? `rotate(${Math.random() * 360}deg)` : ''\r\n    };\r\n\r\n    shapes.push({\r\n      id: i,\r\n      size,\r\n      style,\r\n      type: config.type,\r\n      color: config.color\r\n    });\r\n  }\r\n\r\n  return shapes;\r\n};\r\n\r\nconst EncounterScenery: React.FC<EncounterSceneryProps> = ({ theme, regenKey }) => {\r\n  const themeConfig = SCENERY_THEME_CONFIGS[theme];\r\n  const shapes = themeConfig.shapes.flatMap(generateShapes);\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div \r\n      className={`encounter-scenery-container ${theme}`}\r\n      style={{ backgroundColor: themeConfig.backgroundColor }}\r\n    >\r\n      <div className=\"encounter-scenery-background\">\r\n        {shapes.map((shape: { type: any; id: Key | null | undefined; size: number; color: any; style: CSSProperties | undefined; }) => {\r\n          switch(shape.type) {\r\n            case 'tree':\r\n              return <TreeShape key={shape.id} {...shape} style={shape.style || {}} />;\r\n            case 'rectangle':\r\n                const width = shape.size + Math.random() * shape.size/2 + '%';\r\n                const height = shape.size + Math.random() * shape.size/2 + '%';\r\n              return (\r\n                <div\r\n                  key={shape.id}\r\n                  style={{\r\n                    position: 'absolute',\r\n                    width: width,\r\n                    height: height,\r\n                    backgroundColor: shape.color,\r\n                    ...shape.style\r\n                  }}\r\n                />\r\n              );\r\n              case 'wall':\r\n                return (\r\n                    <div\r\n                        key={shape.id}\r\n                        className=\"wall-pattern\"\r\n                        style={{\r\n                            position: 'absolute',\r\n                            width: shape.size + '%',\r\n                            height: shape.size + '%',\r\n                            opacity: 0.8,\r\n                            left:  '0%',\r\n                            top:  '0%',\r\n                            ...shape.style\r\n                        }}\r\n                    />\r\n                );\r\n            default:\r\n              return null;\r\n          }\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EncounterScenery;","import React, { useState, useEffect } from \"react\";\r\nimport { Encounter, Player, Character, EncounterFlavorTag, FlavorTagSource, TravelResultConfig, EffectData, ATTRIBUTE_TYPE, Tag } from '../../models';\r\nimport { useAppManager, useCampaignManager, usePlayerManager } from \"../managerContexts\";\r\nimport EncounterHeader from \"./encounterHeader\";\r\nimport { AttributeDisplay } from \"../UI/attributeDisplay\";\r\nimport Cimage from \"../UI/cimage\";\r\nimport \"./gameRoom.scss\";\r\nimport \"./gameEncounterDungeonCrawl.scss\";\r\n\r\ninterface GameEncounterDungeonCrawlProps {\r\n  encounter: Encounter;\r\n}\r\n\r\ninterface DungeonRoom {\r\n  id: string;\r\n  name: string;\r\n  flavorText: string;\r\n  tag?: Tag;\r\n  combat: number;\r\n  magic: number;\r\n  tools: number;\r\n  isCompleted: boolean;\r\n}\r\n\r\ninterface RoomOption {\r\n  id: string;\r\n  type: 'party' | 'character';\r\n  characters: Character[];\r\n  players: Player[];\r\n  combat: number;\r\n  magic: number;\r\n  tools: number;\r\n  dmReward: number;\r\n}\r\n\r\ninterface DungeonTotals {\r\n  combat: number;\r\n  magic: number;\r\n  tools: number;\r\n}\r\n\r\nconst GameEncounterDungeonCrawl: React.FC<GameEncounterDungeonCrawlProps> = ({ encounter }) => {\r\n  // Configuration\r\n  const [totalRooms] = useState(5);\r\n  const [barMaxHeight] = useState(20);\r\n  \r\n  // State management\r\n  const [currentRoomIndex, setCurrentRoomIndex] = useState(0);\r\n  const [dungeonRooms, setDungeonRooms] = useState<DungeonRoom[]>([]);\r\n  const [currentRoomOptions, setCurrentRoomOptions] = useState<RoomOption[]>([]);\r\n  const [selectedOption, setSelectedOption] = useState<RoomOption | null>(null);\r\n  const [dungeonTotals, setDungeonTotals] = useState<DungeonTotals>({ combat: 0, magic: 0, tools: 0 });\r\n  const [hoveredTotals, setHoveredTotals] = useState<DungeonTotals | null>(null);\r\n  const [nextRoomOptions, setNextRoomOptions] = useState<DungeonRoom[]>([]);\r\n  const [showResults, setShowResults] = useState(false);\r\n  const [resultConfig, setResultConfig] = useState<TravelResultConfig | null>(null);\r\n  const [tagActivated, setTagActivated] = useState(false);\r\n\r\n  const appManager = useAppManager();\r\n  const campaignManager = useCampaignManager();\r\n  const playerManager = usePlayerManager();\r\n  const characterManager = appManager.getCharacterManager();\r\n  const tagManager = appManager.getTagManager();\r\n  const partyManager = appManager.getPartyManager();\r\n\r\n  const players = playerManager.getPlayers();\r\n  const allCharacters = players.flatMap(player => \r\n    player.characters.map(char => ({ character: char, player }))\r\n  );\r\n\r\n  // Initialize dungeon\r\n  useEffect(() => {\r\n    initializeDungeon();\r\n  }, []);\r\n\r\n  const initializeDungeon = () => {\r\n    const startingRoom: DungeonRoom = {\r\n      id: 'start',\r\n      name: 'Dungeon Entrance',\r\n      flavorText: 'You stand before the dark entrance to the ancient dungeon. The air is thick with mystery and danger.',\r\n      combat: 0,\r\n      magic: 0,\r\n      tools: 0,\r\n      isCompleted: false\r\n    };\r\n    \r\n    setDungeonRooms([startingRoom]);\r\n    setCurrentRoomIndex(0);\r\n  };\r\n\r\n  const generateRoomOptions = () => {\r\n    const options: RoomOption[] = [];\r\n    \r\n    // Always include party option\r\n    const partyOption: RoomOption = {\r\n      id: 'party',\r\n      type: 'party',\r\n      characters: allCharacters.map(c => c.character),\r\n      players: players,\r\n      combat: calculatePartyCombinedAttribute(ATTRIBUTE_TYPE.COMBAT),\r\n      magic: calculatePartyCombinedAttribute(ATTRIBUTE_TYPE.MAGIC),\r\n      tools: calculatePartyCombinedAttribute(ATTRIBUTE_TYPE.TOOLS),\r\n      dmReward: Math.floor(Math.random() * 3) + 1\r\n    };\r\n    options.push(partyOption);\r\n\r\n    // Generate 3 random character options\r\n    for (let i = 0; i < 3; i++) {\r\n      const numCharacters = Math.floor(Math.random() * 3) + 1; // 1-3 characters\r\n      const selectedCharacters: { character: Character, player: Player }[] = [];\r\n      \r\n      for (let j = 0; j < numCharacters && j < allCharacters.length; j++) {\r\n        const randomChar = allCharacters[Math.floor(Math.random() * allCharacters.length)];\r\n        if (!selectedCharacters.some(sc => sc.character.id === randomChar.character.id)) {\r\n          selectedCharacters.push(randomChar);\r\n        }\r\n      }\r\n\r\n      const option: RoomOption = {\r\n        id: `option_${i}`,\r\n        type: 'character',\r\n        characters: selectedCharacters.map(sc => sc.character),\r\n        players: selectedCharacters.map(sc => sc.player),\r\n        combat: selectedCharacters.reduce((sum, sc) => sum + (characterManager.getRemainingAttributes(sc.character, ATTRIBUTE_TYPE.COMBAT) || 0), 0),\r\n        magic: selectedCharacters.reduce((sum, sc) => sum + (characterManager.getRemainingAttributes(sc.character, ATTRIBUTE_TYPE.MAGIC) || 0), 0),\r\n        tools: selectedCharacters.reduce((sum, sc) => sum + (characterManager.getRemainingAttributes(sc.character, ATTRIBUTE_TYPE.TOOLS) || 0), 0),\r\n        dmReward: Math.floor(Math.random() * 3) + 1\r\n      };\r\n      options.push(option);\r\n    }\r\n\r\n    setCurrentRoomOptions(options);\r\n  };\r\n\r\n  const calculatePartyCombinedAttribute = (attributeType: ATTRIBUTE_TYPE): number => {\r\n    return allCharacters.reduce((sum, { character }) => \r\n      sum + (characterManager.getRemainingAttributes(character, attributeType) || 0), 0\r\n    );\r\n  };\r\n\r\n  const generateNextRoomOptions = () => {\r\n    const roomOptions: DungeonRoom[] = [];\r\n    \r\n    for (let i = 0; i < 3; i++) {\r\n      const room = generateRandomRoom();\r\n      roomOptions.push(room);\r\n    }\r\n    \r\n    setNextRoomOptions(roomOptions);\r\n  };\r\n\r\n  const generateRandomRoom = (): DungeonRoom => {\r\n    // Placeholder room data - this would come from a data file\r\n    const roomTemplates = [\r\n      { name: \"Ancient Library\", flavorText: \"Dusty tomes and forgotten knowledge fill this chamber.\" },\r\n      { name: \"Crystal Cavern\", flavorText: \"Glowing crystals illuminate the rocky walls.\" },\r\n      { name: \"Trapped Corridor\", flavorText: \"Pressure plates and dart holes line this narrow passage.\" },\r\n      { name: \"Throne Room\", flavorText: \"A decaying throne sits atop a dais of cracked marble.\" },\r\n      { name: \"Alchemist's Lab\", flavorText: \"Bubbling cauldrons and strange apparatus fill the room.\" },\r\n      { name: \"Guardian Chamber\", flavorText: \"Ancient statues watch over this circular room.\" },\r\n      { name: \"Treasure Vault\", flavorText: \"Golden glints catch the light in this secured chamber.\" },\r\n      { name: \"Ritual Circle\", flavorText: \"Arcane symbols are carved into the stone floor.\" }\r\n    ];\r\n\r\n    const template = roomTemplates[Math.floor(Math.random() * roomTemplates.length)];\r\n    const useGeneratedTag = Math.random() < 0.7;\r\n    \r\n    return {\r\n      id: `room_${Date.now()}_${Math.random()}`,\r\n      name: template.name,\r\n      flavorText: template.flavorText,\r\n      tag: useGeneratedTag ? tagManager.generateRelevantFlavorTags(1)[0]?.tag : undefined,\r\n      combat: Math.floor(Math.random() * 3), // 0-2\r\n      magic: Math.floor(Math.random() * 3),  // 0-2\r\n      tools: Math.floor(Math.random() * 3),  // 0-2\r\n      isCompleted: false\r\n    };\r\n  };\r\n\r\n  const handleStartingRoomOk = () => {\r\n    const updatedRooms = [...dungeonRooms];\r\n    updatedRooms[0].isCompleted = true;\r\n    setDungeonRooms(updatedRooms);\r\n    generateNextRoomOptions();\r\n  };\r\n\r\n  const handleOptionSelect = (option: RoomOption) => {\r\n    setSelectedOption(option);\r\n  };\r\n\r\n  const handleTagActivate = () => {\r\n    if (!selectedOption) return;\r\n    \r\n    const currentRoom = dungeonRooms[currentRoomIndex];\r\n    if (!currentRoom) return;\r\n\r\n    setTagActivated(true);\r\n\r\n    // Update dungeon totals\r\n    const newTotals = {\r\n      combat: dungeonTotals.combat + selectedOption.combat,\r\n      magic: dungeonTotals.magic + selectedOption.magic,\r\n      tools: dungeonTotals.tools + selectedOption.tools\r\n    };\r\n    setDungeonTotals(newTotals);\r\n\r\n    // Check if this is an encounter tag\r\n    const isEncounterTag = encounter.location.tags.some(tag => \r\n      currentRoom.tag && tag.name === currentRoom.tag.name\r\n    );\r\n\r\n    if (isEncounterTag && currentRoom.tag) {\r\n      // Trigger encounter modal (would integrate with existing encounter system)\r\n      showResultsModal(\"Encounter Triggered\", `You have triggered an encounter: ${currentRoom.tag.name}`, []);\r\n    } else {\r\n      // Calculate results\r\n      const results: EffectData[] = [];\r\n      \r\n      // Add exhaustion to party\r\n      //partyManager.addPartyExhaustion(5);\r\n      results.push({\r\n        object: 'party',\r\n        effects: [{\r\n          effect: \"+5 Exhaustion\",\r\n          class: \"party-exhaustion\"\r\n        }]\r\n      });\r\n\r\n      // Process player effects\r\n      const involvedPlayerIds = selectedOption.players.map(p => p.id);\r\n      \r\n      players.forEach(player => {\r\n        if (involvedPlayerIds.includes(player.id)) {\r\n          // Give experience to involved players\r\n          playerManager.addPlayerExp(player, 1);\r\n          results.push({\r\n            object: player,\r\n            effects: [{\r\n              effect: \"+1 Experience\",\r\n              class: \"player-exp\"\r\n            }]\r\n          });\r\n        } else {\r\n          // Remove attention from uninvolved players\r\n          partyManager.updateAttention(player, -1);\r\n          results.push({\r\n            object: player,\r\n            effects: [{\r\n              effect: \"-1 Attention\",\r\n              class: \"player-attention\"\r\n            }]\r\n          });\r\n        }\r\n      });\r\n\r\n      // Add DM reward if any\r\n      if (selectedOption.dmReward > 0) {\r\n        campaignManager.addDmExp(selectedOption.dmReward);\r\n        results.push({\r\n          object: 'party',\r\n          effects: [{\r\n            effect: `+${selectedOption.dmReward} DM Points`,\r\n            class: \"dm-points\"\r\n          }]\r\n        });\r\n      }\r\n\r\n      // Expose tag if it exists\r\n      if (currentRoom.tag) {\r\n        const flavorTag: EncounterFlavorTag = {\r\n          tag: currentRoom.tag,\r\n          source: FlavorTagSource.LOCATION,\r\n          theme: tagManager.getTheme()\r\n        };\r\n        campaignManager.exposeTag(flavorTag);\r\n      }\r\n\r\n      showResultsModal(\"Room Completed\", `You have successfully navigated ${currentRoom.name}!`, results);\r\n    }\r\n  };\r\n\r\n  const handleRoomComplete = () => {\r\n    const updatedRooms = [...dungeonRooms];\r\n    updatedRooms[currentRoomIndex].isCompleted = true;\r\n    setDungeonRooms(updatedRooms);\r\n    \r\n    if (currentRoomIndex >= totalRooms - 1) {\r\n      // Dungeon complete\r\n      showDungeonCompleteModal();\r\n    } else {\r\n      // Show next room options\r\n      generateNextRoomOptions();\r\n    }\r\n  };\r\n\r\n  const handleNextRoomSelect = (room: DungeonRoom) => {\r\n    const updatedRooms = [...dungeonRooms, room];\r\n    setDungeonRooms(updatedRooms);\r\n    setCurrentRoomIndex(currentRoomIndex + 1);\r\n    setSelectedOption(null);\r\n    setTagActivated(false);\r\n    setNextRoomOptions([]);\r\n    generateRoomOptions();\r\n  };\r\n\r\n  const showDungeonCompleteModal = () => {\r\n    const results: EffectData[] = [{\r\n      object: 'party',\r\n      effects: [{\r\n        effect: \"Dungeon Completed!\",\r\n        class: \"dungeon-complete\"\r\n      }]\r\n    }];\r\n    \r\n    showResultsModal(\"Dungeon Complete\", \"You have successfully navigated the entire dungeon!\", results);\r\n  };\r\n\r\n  const showResultsModal = (title: string, description: string, results: EffectData[]) => {\r\n    const mockTravelOption = {\r\n      id: \"dungeon_result\",\r\n      name: title,\r\n      description: description,\r\n      time: 0,\r\n      tags: 0,\r\n      score: 0,\r\n      boredom: 0,\r\n      exhaustion: 0,\r\n      tagInstructions: \"\",\r\n      repeatable: false\r\n    };\r\n\r\n    const resultConfig: TravelResultConfig = {\r\n      results: results,\r\n      title: title,\r\n      description: description,\r\n      tags: [],\r\n      travelOption: mockTravelOption,\r\n      info: {\r\n        score: 0,\r\n        time: 0,\r\n        boredom: 0,\r\n        exhaustion: 0\r\n      }\r\n    };\r\n\r\n    setResultConfig(resultConfig);\r\n    setShowResults(true);\r\n  };\r\n\r\n  const handleResultsClose = () => {\r\n    setShowResults(false);\r\n    if (currentRoomIndex >= totalRooms - 1) {\r\n      // Exit to encounter overview\r\n      campaignManager.backToOverview();\r\n    } else {\r\n      handleRoomComplete();\r\n    }\r\n  };\r\n\r\n  const renderDungeonTotalsUI = () => {\r\n    const totalsToShow = hoveredTotals || dungeonTotals;\r\n    \r\n    return (\r\n      <div className=\"dungeon-totals-ui\">\r\n        <div className=\"totals-bar combat\">\r\n          <div className=\"bar-fill\" style={{ height: `${(totalsToShow.combat / barMaxHeight) * 100}%` }}>\r\n            <div className=\"dm-reward\" style={{ bottom: '50%' }}>6</div>\r\n          </div>\r\n          {hoveredTotals && (\r\n            <div \r\n              className=\"bar-preview\" \r\n              style={{ \r\n                height: `${((hoveredTotals.combat - dungeonTotals.combat) / barMaxHeight) * 100}%`,\r\n                bottom: `${(dungeonTotals.combat / barMaxHeight) * 100}%`\r\n              }}\r\n            />\r\n          )}\r\n          <div className=\"bar-icon\">⚔️</div>\r\n        </div>\r\n        <div className=\"totals-bar magic\">\r\n          <div className=\"bar-fill\" style={{ height: `${(totalsToShow.magic / barMaxHeight) * 100}%` }}>\r\n            <div className=\"dm-reward\" style={{ bottom: '50%' }}>6</div>\r\n          </div>\r\n          {hoveredTotals && (\r\n            <div \r\n              className=\"bar-preview\" \r\n              style={{ \r\n                height: `${((hoveredTotals.magic - dungeonTotals.magic) / barMaxHeight) * 100}%`,\r\n                bottom: `${(dungeonTotals.magic / barMaxHeight) * 100}%`\r\n              }}\r\n            />\r\n          )}\r\n          <div className=\"bar-icon\">✨</div>\r\n        </div>\r\n        <div className=\"totals-bar tools\">\r\n          <div className=\"bar-fill\" style={{ height: `${(totalsToShow.tools / barMaxHeight) * 100}%` }}>\r\n            <div className=\"dm-reward\" style={{ bottom: '50%' }}>6</div>\r\n          </div>\r\n          {hoveredTotals && (\r\n            <div \r\n              className=\"bar-preview\" \r\n              style={{ \r\n                height: `${((hoveredTotals.tools - dungeonTotals.tools) / barMaxHeight) * 100}%`,\r\n                bottom: `${(dungeonTotals.tools / barMaxHeight) * 100}%`\r\n              }}\r\n            />\r\n          )}\r\n          <div className=\"bar-icon\">🔧</div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderCurrentRoom = () => {\r\n    const currentRoom = dungeonRooms[currentRoomIndex];\r\n    if (!currentRoom) return null;\r\n\r\n    if (currentRoom.id === 'start' && !currentRoom.isCompleted) {\r\n      return (\r\n        <div className=\"dungeon-room starting-room\">\r\n          <div className=\"room-header\">\r\n            <h3>{currentRoom.name}</h3>\r\n          </div>\r\n          <div className=\"room-content\">\r\n            <p>{currentRoom.flavorText}</p>\r\n            <button className=\"start-dungeon-button\" onClick={handleStartingRoomOk}>\r\n              Enter Dungeon\r\n            </button>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (currentRoom.isCompleted) {\r\n      return (\r\n        <div className=\"dungeon-room completed\">\r\n          <div className=\"completed-room-summary\">\r\n            <span className=\"room-name\">{currentRoom.name}</span>\r\n            {currentRoom.tag && <span className=\"room-tag\">{currentRoom.tag.name}</span>}\r\n            <div className=\"room-attributes\">\r\n              <span>⚔️{currentRoom.combat}</span>\r\n              <span>✨{currentRoom.magic}</span>\r\n              <span>🔧{currentRoom.tools}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"dungeon-room active\">\r\n        <div className=\"room-header\">\r\n          <h3>{currentRoom.name}</h3>\r\n          <p>{currentRoom.flavorText}</p>\r\n        </div>\r\n        \r\n        <div className=\"room-main\">\r\n          <div className=\"room-requirements\">\r\n            <div className=\"requirement-item\">\r\n              <span className=\"icon\">⚔️</span>\r\n              <span className=\"value\">{selectedOption?.combat || currentRoom.combat}</span>\r\n            </div>\r\n            <div className=\"requirement-item\">\r\n              <span className=\"icon\">✨</span>\r\n              <span className=\"value\">{selectedOption?.magic || currentRoom.magic}</span>\r\n            </div>\r\n            <div className=\"requirement-item\">\r\n              <span className=\"icon\">🔧</span>\r\n              <span className=\"value\">{selectedOption?.tools || currentRoom.tools}</span>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"room-tag-area\">\r\n            {currentRoom.tag && (\r\n              <div \r\n                className={`room-tag ${tagActivated ? 'activated' : ''} ${selectedOption ? 'highlighted' : ''}`}\r\n                onClick={selectedOption ? handleTagActivate : undefined}\r\n              >\r\n                {currentRoom.tag.name}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"room-options\">\r\n            {currentRoomOptions.map(option => (\r\n              <div \r\n                key={option.id}\r\n                className={`room-option ${selectedOption?.id === option.id ? 'selected' : ''}`}\r\n                onClick={() => handleOptionSelect(option)}\r\n              >\r\n                <div className=\"option-attributes\">\r\n                  <span>⚔️{option.combat}</span>\r\n                  <span>✨{option.magic}</span>\r\n                  <span>🔧{option.tools}</span>\r\n                </div>\r\n                <div className=\"option-characters\">\r\n                  {option.type === 'party' ? (\r\n                    <span>Party</span>\r\n                  ) : (\r\n                    <div className=\"character-icons\">\r\n                      {option.characters.map((character, index) => (\r\n                        <div key={character.id} className=\"character-icon\" style={{ zIndex: option.characters.length - index }}>\r\n                          <Cimage imageId={character.icon} />\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                {option.dmReward > 0 && (\r\n                  <div className=\"dm-reward-indicator\">+{option.dmReward} DM</div>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderNextRoomOptions = () => {\r\n    if (nextRoomOptions.length === 0) return null;\r\n\r\n    return (\r\n      <div className=\"next-room-options\">\r\n        <h4>Choose Next Room:</h4>\r\n        <div className=\"room-options-grid\">\r\n          {nextRoomOptions.map(room => (\r\n            <div \r\n              key={room.id}\r\n              className=\"next-room-option\"\r\n              onClick={() => handleNextRoomSelect(room)}\r\n              onMouseEnter={() => setHoveredTotals({\r\n                combat: dungeonTotals.combat + room.combat,\r\n                magic: dungeonTotals.magic + room.magic,\r\n                tools: dungeonTotals.tools + room.tools\r\n              })}\r\n              onMouseLeave={() => setHoveredTotals(null)}\r\n            >\r\n              <h5>{room.name}</h5>\r\n              <p>{room.flavorText}</p>\r\n              <AttributeDisplay \r\n                attributes={{\r\n                  [ATTRIBUTE_TYPE.COMBAT]: room.combat,\r\n                  [ATTRIBUTE_TYPE.MAGIC]: room.magic,\r\n                  [ATTRIBUTE_TYPE.TOOLS]: room.tools\r\n                }}\r\n                collapsed={true}\r\n              />\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderCompletedRooms = () => {\r\n    return dungeonRooms.filter((room, index) => index < currentRoomIndex && room.isCompleted).map((room, index) => (\r\n      <div key={room.id} className=\"dungeon-room completed\">\r\n        <div className=\"completed-room-summary\">\r\n          <span className=\"room-name\">{room.name}</span>\r\n          {room.tag && <span className=\"room-tag\">{room.tag.name}</span>}\r\n          <div className=\"room-attributes\">\r\n            <span>⚔️{room.combat}</span>\r\n            <span>✨{room.magic}</span>\r\n            <span>🔧{room.tools}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    ));\r\n  };\r\n\r\n  // Generate room options when room changes\r\n  useEffect(() => {\r\n    if (currentRoomIndex > 0 && !dungeonRooms[currentRoomIndex]?.isCompleted) {\r\n      generateRoomOptions();\r\n    }\r\n  }, [currentRoomIndex]);\r\n\r\n  return (\r\n    <div className=\"game-encounter-dungeon-crawl\">\r\n      <EncounterHeader\r\n        title={`Dungeon Crawl - ${encounter.location.name}`}\r\n        description={`Navigate through ${totalRooms} rooms of this ancient dungeon!`}\r\n        childClass=\"small-font\"\r\n      />\r\n      \r\n      <div className=\"dungeon-content\">\r\n        <div className=\"dungeon-main\">\r\n          <div className=\"dungeon-rooms\">\r\n            {renderCompletedRooms()}\r\n            {renderCurrentRoom()}\r\n            {renderNextRoomOptions()}\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"dungeon-sidebar\">\r\n          {renderDungeonTotalsUI()}\r\n          \r\n          <div className=\"dungeon-progress\">\r\n            <h4>Progress</h4>\r\n            <div className=\"progress-indicator\">\r\n              Room {currentRoomIndex + 1} of {totalRooms + 1}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {showResults && resultConfig && (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal-container\">\r\n            <div className=\"modal-header\">\r\n              {resultConfig.title}\r\n              <button className=\"close-button\" onClick={handleResultsClose}>×</button>\r\n            </div>\r\n            <div className=\"modal-description\">{resultConfig.description}</div>\r\n            <div className=\"dungeon-results\">\r\n              {resultConfig.results.map((result, index) => (\r\n                <div key={index} className=\"effect-display\">\r\n                  <div className=\"effect-target\">\r\n                    {typeof result.object === 'string' ? result.object : result.object.name}\r\n                  </div>\r\n                  <div className=\"effect-list\">\r\n                    {result.effects?.map((effect, effectIndex) => (\r\n                      <div key={effectIndex} className={`effect ${effect.class}`}>\r\n                        {effect.effect}\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n            <div className=\"modal-actions\">\r\n              <button onClick={handleResultsClose}>\r\n                {currentRoomIndex >= totalRooms - 1 ? 'Exit Dungeon' : 'Continue'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GameEncounterDungeonCrawl;\r\n","import { useEffect, useState } from \"react\";\r\nimport { Encounter, EncounterEvent, SESSION_STATE } from \"../../models\";\r\nimport { useCampaignManager, useUiManager } from \"../managerContexts\";\r\nimport EncounterEventDisplay from \"./encounterEventDisplay\";\r\n//import GameEncounterIntro from \"./encounterIntro\";\r\nimport GameEncounterOverview from \"./gameEncounterOverview\";\r\nimport { ENCOUNTER_EVENT_TYPE } from \"../../consts/general\";\r\nimport GameEncounterCombat from \"./gameEncounterCombat\";\r\nimport GameEncounterExploration from \"./gameEncounterExploration\";\r\nimport GameEncounterPerception from \"./gameEncounterPerception\";\r\nimport GameEncounterRoleplay from \"./gameEncounterRoleplay\";\r\nimport GameEncounterTown from \"./gameEncounterTown\";\r\nimport GameEncounterTrap from \"./gameEncounterTrap\";\r\nimport GameEncounterSkillChallenge from \"./gameEncounterSkillChallenge\";\r\nimport GameEncounterPuzzle from \"./gameEncounterPuzzle\";\r\nimport GameEncounterStory from \"./gameEncounterStory\";\r\nimport GameEncounterTravel from \"./gameEncounterTravel\";\r\nimport EncounterScenery from \"../UI/encounterScenery\";\r\nimport CImage from \"../UI/cimage\";\r\nimport GameEncounterDungeonCrawl from \"./gameEncounterDungeonCrawl\";\r\n\r\n\r\ninterface GameEncounterProps {\r\n    encounter: Encounter;\r\n    showOverview?: boolean;\r\n}\r\n\r\n\r\nconst GameEncounter: React.FC<GameEncounterProps> = ({encounter, showOverview}) => {\r\n\r\n  const [events, setEvents] = useState<EncounterEvent[]>(encounter.events);\r\n   const [update, setUpdate] = useState(false);\r\n  const campaignManager = useCampaignManager();\r\n  const uiManager = useUiManager();\r\n  const theme = encounter.location.themes[0];   \r\n  const [encounterState, setEncounterState] = useState(campaignManager.getEncounterState());\r\n  const [showImageForEvent, setShowImageForEvent] = useState(uiManager.showImageForEvent());\r\n  const [eventImageOpacity, setEventImageOpacity] = useState(uiManager.getEventImageOpacity());\r\n\r\n\r\n  useEffect(() => {\r\n    const updateEncounterState = () => {\r\n      const newState = campaignManager.getEncounterState();\r\n      if (newState?.sessionState !== undefined && newState.eventIndex !== undefined) {\r\n        setEncounterState({...newState});\r\n      }\r\n    };\r\n\r\n    const updateEvent = () => {\r\n      setShowImageForEvent(uiManager.showImageForEvent());\r\n      setEventImageOpacity(uiManager.getEventImageOpacity());\r\n    };\r\n\r\n\r\n    uiManager.on('updateEncounterState', updateEncounterState);\r\n    uiManager.on('eventUpdated', updateEvent);\r\n    return () => {\r\n      uiManager.off('updateEncounterState', updateEncounterState);\r\n    };\r\n  }, [campaignManager, uiManager]);\r\n\r\n\r\n  const getCurrentEventComponent = (eventIndex: number) => {\r\n    if(!encounterState) {\r\n      return null;\r\n    }\r\n    const events = encounter.events;\r\n    \r\n    const currentEncounterEvent = events[encounterState.eventIndex];\r\n\r\n    switch(currentEncounterEvent.type) {\r\n      case ENCOUNTER_EVENT_TYPE.COMBAT:\r\n        return <GameEncounterCombat encounter={encounter} />;\r\n      case ENCOUNTER_EVENT_TYPE.ROLEPLAY:\r\n        return <GameEncounterRoleplay encounter={encounter} />;\r\n      case ENCOUNTER_EVENT_TYPE.PUZZLE:\r\n        return <GameEncounterPuzzle encounter={encounter} />;\r\n      case ENCOUNTER_EVENT_TYPE.PERCEPTION:\r\n        return <GameEncounterPerception encounter={encounter} />;\r\n      case ENCOUNTER_EVENT_TYPE.TOWN:\r\n        return <GameEncounterTown encounter={encounter} />;\r\n      case ENCOUNTER_EVENT_TYPE.TRAVEL:\r\n        return <GameEncounterTravel encounter={encounter} />;\r\n      case ENCOUNTER_EVENT_TYPE.CHALLENGE:\r\n        return <GameEncounterSkillChallenge encounter={encounter} />;\r\n      case ENCOUNTER_EVENT_TYPE.TRAP:\r\n        return <GameEncounterTrap encounter={encounter} />;\r\n      case ENCOUNTER_EVENT_TYPE.STORY:\r\n        return <GameEncounterStory encounter={encounter} />;\r\n      case ENCOUNTER_EVENT_TYPE.EXPLORATION:\r\n        return <GameEncounterExploration encounter={encounter} />;\r\ncase ENCOUNTER_EVENT_TYPE.DUNGEON:\r\n      return <GameEncounterDungeonCrawl encounter={encounter} />;\r\n      \r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  const getCurrentEventComponentParent = () => {\r\n   \r\n    if(!encounterState) {\r\n      return null;\r\n    }\r\n    \r\n    switch(encounterState.sessionState) {\r\n      // case SESSION_STATE.LOCATION_INTRO:\r\n      //     return (\r\n      //     <GameEncounterIntro\r\n      //       encounter={encounter} />\r\n      //     );\r\n      case SESSION_STATE.INTRO_EVENTS:\r\n         return getCurrentEventComponent(0);\r\n      case SESSION_STATE.INTRO_MAIN:\r\n          return <div>Intro Main</div>;\r\n      case SESSION_STATE.MAIN_EVENTS:\r\n        return getCurrentEventComponent(1);\r\n      case SESSION_STATE.INTRO_EXIT:\r\n          return <div>Intro Exit</div>;\r\n      case SESSION_STATE.EXIT_EVENTS:\r\n        return getCurrentEventComponent(2);\r\n      case SESSION_STATE.EXIT:\r\n          return <div>Exit</div>;\r\n      default:\r\n        break;  \r\n      }\r\n  }\r\n\r\n  return (\r\n    <div className={`table-encounter-container ${theme}`}>\r\n       {showOverview ? (\r\n        <GameEncounterOverview encounter={encounter} />\r\n      ): (\r\n        <div className='table-encounter-scene'>\r\n          <div className=\"scenery-opacity-container\" style={{opacity: showImageForEvent ? 1 - eventImageOpacity : 1}}>\r\n            <EncounterScenery theme={theme} />\r\n          </div>\r\n          {showImageForEvent && (\r\n            <div className=\"encounter-icon-container\" style={{ opacity: eventImageOpacity }}>\r\n              <CImage imageId={encounter.location.icon}  />\r\n            </div>\r\n          )}\r\n        \r\n        \r\n          <div className='table-encounter-title'>\r\n            {encounter.name}\r\n          </div>\r\n          <div className='table-encounter-session'>\r\n            {getCurrentEventComponentParent()}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GameEncounter;","import { REWARD_TYPE, RewardItem } from \"../models\";\n\nexport const REWARD_ITEMS: RewardItem[] = [\n    { name: \"Gold\", value: 1, type: REWARD_TYPE.TREASURE, cost: 1, description: \"Increase all players happiness by one\" },\n    \n    { name: \"Gear\", value: 1, type: REWARD_TYPE.TOOLS, cost: 1, description: \"Replenish all tools for all players\" },\n    { name: \"Healing\", value: 1, type: REWARD_TYPE.HEALING, cost: 1, description: \"Remove wounded state from all characters\" },\n   // { name: \"Backstory\", value: 1, type: REWARD_TYPE.BACKSTORY, cost: 1, description: \"Complete a character backstory\" },\n    { name: \"Plot Hook\", value: 1, type: REWARD_TYPE.PLOT_HOOK, cost: 1, description: \"Reveal information about the plot. Restore full attention\" },\n  //  { name: \"Item\", value: 2, type: REWARD_TYPE.ITEM, cost: 1, description: \"Give a Magic Item to the party\" },\n    { name: \"Replenish Magic\", value: 2, type: REWARD_TYPE.MAGIC, cost: 2, description: \"Replenish all Magic for all characters\"},\n    { name: \"Raise Dead\", value: 2, type: REWARD_TYPE.HEALING, cost: 2, description: \"Raise a dead character\" },\n    { name: \"Treasure Chest\", value: 2, type: REWARD_TYPE.TREASURE, cost: 3, description: \"Increase all player happiness by two\" },\n    { name: \"Level Up\", value: 1, type: REWARD_TYPE.XP, cost: 3, description: \"Level up the lowest level Character\" },\n  ];","import React, { useEffect, useState } from 'react';\r\nimport './rewardModal.scss';\r\nimport { useAppManager, useCampaignManager, usePartyManager, useUiManager } from '../managerContexts';\r\nimport { ATTRIBUTE_CONTRIBUTOR, HeroCombatant, REWARD_TYPE, RewardItem } from '../../models';\r\nimport { REWARD_ITEMS } from '../../consts/rewards';\r\nimport CImage from '../UI/cimage';\r\nimport AttributeDisplay from '../UI/attributeDisplay';\r\n\r\n\r\n\r\ninterface RewardModalProps {\r\n    rewardsAcceptedCallback: (acceptedRewards: RewardItem[], rewardDifference: number, advanceEvent: boolean) => void;\r\n}\r\n\r\n  //const REWARDS_PER_RESULT = [2,3,4,5,6,6,6,6]\r\n  \r\n\r\n\r\n  const RewardModal: React.FC<RewardModalProps> = ({rewardsAcceptedCallback}) => {\r\n    \r\n    const uiManager = useUiManager();\r\n    const partyManager = usePartyManager();\r\n    const campaignManager = useCampaignManager();\r\n    const appManager= useAppManager();\r\n    const tagManager = appManager.getTagManager();\r\n\r\n\r\n    const [visible, setVisible] = React.useState(false);\r\n    const [rewardTotal, setRewardTotal] = React.useState(0);\r\n    const [selectedItems, setSelectedItems] = useState<RewardItem[]>([]);\r\n    const currentTotal = selectedItems.reduce((sum: any, item: { cost: any; }) => sum + item.cost, 0);\r\n    const [currentAvailableRewards, setCurrentAvailableRewards] = useState<RewardItem[]>([]);\r\n    const [heroCombatants, setHeroCombatants] = useState<HeroCombatant[]>(partyManager.generateHeroes([]));\r\n    const [nextEventOnAccept, setNextEventOnAccept] = useState(false);\r\n   const getPanelState = () => {\r\n    if (currentTotal < rewardTotal) return 'low';\r\n    if (currentTotal === rewardTotal) return 'match';\r\n    return 'high';\r\n  };\r\n  const toggleItem = (item: RewardItem) => {\r\n\r\n\r\n\r\n\r\n    if (selectedItems.includes(item)) {\r\n      setSelectedItems(selectedItems.filter(i => i !== item));\r\n    } else {\r\n        if (currentTotal + item.cost > rewardTotal + 2) {\r\n            return; // Don't allow selection if it exceeds the total\r\n        }\r\n      setSelectedItems([...selectedItems, item]);\r\n    }\r\n  };\r\n\r\n    useEffect(() => {\r\n        if(visible) {\r\n            const availableRewards = [...REWARD_ITEMS]\r\n            const expectedGear = tagManager.magicItemRumors;\r\n            setSelectedItems([]);\r\n          \r\n            // for XP, add a reward for a random player (lowest level) to level up\r\n            // or an expensive one for all characters to level up.\r\n            if(expectedGear.length > 0) {\r\n                availableRewards.push({\r\n                    name: \"Magic Item\",\r\n                    value: 1,\r\n                    type: REWARD_TYPE.ITEM,\r\n                    cost: 2,\r\n                    description: expectedGear[0].name,\r\n                    tag: expectedGear[0],\r\n                })\r\n            }\r\n\r\n            setCurrentAvailableRewards(availableRewards);\r\n        }\r\n    }, [campaignManager, visible]);\r\n \r\n\r\n    useEffect(() => {\r\n\r\n        const handleShowRewards = (rewardTotal: number, advanceEvent: boolean) => {\r\n            if (rewardTotal > 0) {\r\n                setVisible(true);\r\n                setRewardTotal(rewardTotal);\r\n                setNextEventOnAccept(advanceEvent);\r\n            } else {\r\n                setVisible(false);\r\n            }\r\n        }\r\n        uiManager.on('showRewardModal', handleShowRewards);\r\n\r\n        return () => {\r\n            uiManager.off('showRewardModal', handleShowRewards);\r\n        };\r\n    }, [uiManager]);\r\n\r\n  const handleCloseCallback = () => {\r\n    // Handle the close callback here if needed\r\n    rewardsAcceptedCallback(selectedItems, currentTotal - rewardTotal, nextEventOnAccept); \r\n    setVisible(false);\r\n   \r\n}\r\n  const getPanelLowText = (rewardTotal: number, currentTotal: number) => {\r\n    if (rewardTotal - currentTotal === 1) {\r\n        return `All players 😞`;\r\n    }\r\n    return `All players 😞😞`;\r\n  }\r\n  const getPanelHighText = (rewardTotal: number, currentTotal: number) => {\r\n    if (currentTotal - rewardTotal   === 1) {\r\n        return `-50% Intensity`;\r\n    }\r\n    return `-100% Intensity`;\r\n  }\r\n\r\n    if(!visible) {\r\n        return null;\r\n    }\r\n    return (\r\n        <div className=\"reward-modal-container\">\r\n            <div className=\"reward-modal-body\">\r\n                <div className = \"reward-modal-title\">\r\n                    <div className=\"reward-modal-title-text\">Reward your players</div>\r\n                    <div className=\"reward-modal-instructions\">Based on the diffifculty of the event, they expect the equivalent of {rewardTotal} rewards.</div>\r\n                </div>\r\n                <div className=\"reward-panels\">\r\n                    <div className={`panel too-low ${getPanelState() === 'low' ? 'active' : ''}`}>\r\n                    <div className=\"panel-title\">Too Low</div>\r\n                    {getPanelState() === 'low' && \r\n                        <div className=\"panel-contents\">\r\n                            <div className=\"panel-value\">{currentTotal}</div>\r\n                            <div className=\"panel-low-text\">{getPanelLowText(rewardTotal, currentTotal)}</div>\r\n                            <button className=\"accept-button\" onClick={() => handleCloseCallback()}>ACCEPT</button>\r\n                        </div>\r\n                        \r\n                    }\r\n                    </div>\r\n                    <div className={`panel match ${getPanelState() === 'match' ? 'active' : ''}`}>\r\n                    <div className=\"panel-title\">Expected</div>\r\n                    <div className=\"panel-value expected\">{rewardTotal}</div>\r\n                    {getPanelState() === 'match' && \r\n                        <button className=\"accept-button\" onClick={() => handleCloseCallback()}>ACCEPT</button>\r\n                    }\r\n                    </div>\r\n                    <div className={`panel too-high ${getPanelState() === 'high' ? 'active' : ''}`}>\r\n                    <div className=\"panel-title\">Too High</div>\r\n                    {getPanelState() === 'high' && \r\n                     <div className=\"panel-contents\">\r\n                            <div className=\"panel-value\">{currentTotal}</div>\r\n                            <div className=\"panel-high-text\">{getPanelHighText(rewardTotal, currentTotal)}</div>\r\n                            <button className=\"accept-button\" onClick={() => handleCloseCallback()}>ACCEPT</button>\r\n                        </div>\r\n                    }\r\n                    </div>\r\n                </div>\r\n            \r\n                <div className=\"reward-items-list\">\r\n                    {currentAvailableRewards.map(item => (\r\n                    <div \r\n                        key={item.name}\r\n                        className={`reward-item ${selectedItems.includes(item) ? 'selected' : ''}`}\r\n                        onClick={() => toggleItem(item)}\r\n                    >\r\n                        <div className=\"item-header\">\r\n                        <span className=\"item-name\">{item.name}</span>\r\n                        <span className=\"item-cost\">{item.cost}</span>\r\n                        </div>\r\n                        <div className=\"item-description\">{item.description}</div>\r\n                    </div>\r\n                    ))}\r\n                </div>\r\n                <div className=\"reward-modal-heroes\">\r\n\r\n                \r\n                    {heroCombatants && heroCombatants.map((hero, index) => {\r\n                        return (\r\n                            <div key={hero.name} className=\"reward-modal-hero-row\">\r\n                                <div className = \"reward-modal-hero-container\">\r\n                                    <div className=\"reward-modal-hero\">\r\n                                        <div className=\"reward-modal-hero-name\">{hero.name}</div>\r\n                                        <div className=\"combat-character-icon\">\r\n                                            <CImage imageId={hero.icon} />\r\n                                        </div>\r\n                                        { hero.character && hero.character.injury === 'injured' && (\r\n                                            <div className=\"reward-modal-hero-injury\"></div>\r\n                                        )}\r\n                                        { hero.character && hero.character.injury === 'dead' && (\r\n                                            <div className=\"reward-modal-hero-injury dead\"></div>\r\n                                        )}\r\n                                    </div>\r\n                                    <div className=\"reward-modal-hero-attributes\">\r\n                                        <AttributeDisplay hero={hero} category={ATTRIBUTE_CONTRIBUTOR.ALL} showAttributeLoss={true} />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        )})}\t\r\n                    </div>\r\n            </div>\r\n        </div>\r\n      );\r\n}\r\n  export default RewardModal;","import React from \"react\";\r\nimport { APP_STATE } from \"../../consts/states\";\r\nimport { useAppManager, useCampaignManager, useUiManager } from \"../managerContexts\";\r\nimport GameEncounter from \"./gameEncounter\";\r\nimport RewardModal from \"./rewardModal\";\r\n\r\ninterface GameTableProps {\r\n\r\n}\r\n\r\n\r\n\r\n\r\nconst GameTable: React.FC<GameTableProps> = () => {\r\n\r\n  const campaignManager = useCampaignManager();\r\n  const encounter = campaignManager.getCurrentEncounter();\r\n  const appManager = useAppManager();\r\n\r\n\r\n\r\n  if(!encounter) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n\t \r\n        <div className = \"game-table-slab\">\r\n         \r\n          <GameEncounter \r\n            encounter = {encounter}\r\n            showOverview = {appManager.state === APP_STATE.SESSION_OVERVIEW}\r\n          />\r\n          <RewardModal\r\n            rewardsAcceptedCallback={campaignManager.rewardsAccepted}         \r\n          />\r\n        </div>\r\n\t\r\n  );\r\n}\r\n\r\nexport default GameTable;\r\n","import React from 'react';\n\ninterface NeedleGaugeProps {\n    value: number;\n    max: number;\n    segments?: number;\n    colors?: string[];\n    descriptions?: string[]; // Optional descriptions for tooltips/debugging\n    segmentRanges?: number[]; // Array of max values for each segment (e.g., [20, 30, 60, 70, 90, 100])\n  }\n  \n  const NeedleGauge: React.FC<NeedleGaugeProps> = ({ \n    value, \n    max, \n    segments = 10,\n    colors = ['#FFA500', '#FFD700','#FFD700', '#ADFF2F', '#ADFF2F', '#ADFF2F', '#32CD32','#eF4500', '#eF4500','#FF0000'],\n    descriptions,\n    segmentRanges\n  }) => {\n    const radius = 100;\n    const tickLength = 20;\n    const colorLength = 20;\n    const angleRange = 180; // Half circle\n    let currentAngle = (value / max) * angleRange;\n    \n    const generateArcs = () => {\n      const arcs = [];\n      \n      if (segmentRanges && segmentRanges.length > 0) {\n        // Use proportional segments based on segmentRanges\n        let previousMax = 0;\n        \n        // Only process as many segments as we have ranges for\n        const segmentsToProcess = Math.min(colors.length, segmentRanges.length);\n        \n        for (let i = 0; i < segmentsToProcess; i++) {\n          const segmentMax = Math.min(segmentRanges[i], max);\n          \n          // Skip segments with no width\n          if (segmentMax <= previousMax) {\n            continue;\n          }\n          \n          const startAngle = -90 + (previousMax / max) * angleRange;\n          const endAngle = -90 + (segmentMax / max) * angleRange;\n          \n          const pathData = describeArc(radius, radius, radius - colorLength/2, startAngle, endAngle);\n          arcs.push(\n            <path\n              key={i}\n              d={pathData}\n              fill=\"none\"\n              stroke={colors[i]}\n              strokeWidth={colorLength}\n            />\n          );\n          \n          previousMax = segmentMax;\n          if (segmentMax >= max) break;\n        }\n      } else {\n        // Fall back to equal segments\n        const segmentAngle = angleRange / colors.length;\n        \n        for (let i = 0; i < colors.length; i++) {\n          const startAngle = -90 + (i * segmentAngle);\n          const endAngle = startAngle + segmentAngle;\n          \n          const pathData = describeArc(radius, radius, radius - colorLength/2, startAngle, endAngle);\n          arcs.push(\n            <path\n              key={i}\n              d={pathData}\n              fill=\"none\"\n              stroke={colors[i]}\n              strokeWidth={colorLength}\n            />\n          );\n        }\n      }\n      return arcs;\n    };\n  \n    const needleStyle = {\n      transform: `rotate(${currentAngle - 180}deg)`,\n      transformOrigin: '100px 100px'\n    };\n  \n    return (\n        <div className=\"needle-gauge\">\n        <svg viewBox=\"20 50 1 160\" preserveAspectRatio=\"xMidYMid meet\">\n          {generateArcs()}\n        \n         \n          <line\n            x1={radius}\n            y1={radius}\n            x2={radius * 2}\n            y2={radius}\n            stroke=\"#000000bb\"\n            strokeWidth=\"5\"\n            style={needleStyle}\n          />\n          <circle\n            cx={radius}\n            cy={radius}\n            r=\"5\"\n            fill=\"white\"\n          />\n        </svg>\n      </div>\n    );\n  };\n  \n  // Helper function to generate SVG arc path\n  const describeArc = (x: number, y: number, radius: number, startAngle: number, endAngle: number) => {\n    const start = polarToCartesian(x, y, radius, endAngle);\n    const end = polarToCartesian(x, y, radius, startAngle);\n    const largeArcFlag = endAngle - startAngle <= 180 ? \"0\" : \"1\";\n    \n    return [\n      \"M\", start.x, start.y,\n      \"A\", radius, radius, 0, largeArcFlag, 0, end.x, end.y\n    ].join(\" \");\n  };\n  \n  const polarToCartesian = (centerX: number, centerY: number, radius: number, angleInDegrees: number) => {\n    const angleInRadians = (angleInDegrees - 90) * Math.PI / 180.0;\n    return {\n      x: centerX + (radius * Math.cos(angleInRadians)),\n      y: centerY + (radius * Math.sin(angleInRadians))\n    };\n  };\n  \n  export default NeedleGauge;","import React from 'react';\nimport './gameRoom.scss';\nimport { useCampaignManager, usePartyManager } from '../managerContexts';\n\ninterface StressInfoProps {\n  stress: number;\n  displayNumber?: boolean;\n}\n\nconst StressInfo: React.FC<StressInfoProps> = ({ stress, displayNumber }) => {\n \n  const partyManager = usePartyManager();\n  const campaignManager = useCampaignManager();\n\n  \n\n  const backgroundColor = campaignManager.getTensionColor(stress);\n\n\n  const getStressDescription = (value: number): string => {\n    return partyManager.getTensionDescription(value);\n  };\n\n  return (\n    <div \n      className={`stress-info ${displayNumber ? 'number' : 'description'}`}\n      style={{ \n        backgroundColor,\n        transition: 'background-color 0.3s ease'\n      }}\n    >{displayNumber &&\n      <div className=\"stress-value\">{stress}</div>\n    }\n      {\n        !displayNumber &&\n        <div className=\"stress-description\">\n        {getStressDescription(stress)}\n      </div>\n      }\n      \n    </div>\n  );\n};\n\nexport default StressInfo;","import React, { useEffect, useState } from 'react';\r\nimport { useAppManager, useCampaignManager } from \"../managerContexts\";\r\nimport { APP_STATE } from \"../../consts/states\";\r\nimport { Tag, FlavorTagSource, FlavorTagTheme } from '../../models';\r\nimport TooltipWrapper from '../UI/TooltipWrapper';\r\nimport TagPill from '../UI/TagPill';\r\nimport DiceScore from '../UI/DiceScore';\r\nimport NeedleGauge from '../UI/needleGauge';\r\nimport StressInfo from './stressInfo';\r\n\r\ninterface BottomBarProps {\r\n    \r\n}\r\n\r\n\r\nconst BottomBar: React.FC<BottomBarProps> = () => {\r\n    const appManager = useAppManager();\r\n    const campaignManager = useCampaignManager();\r\n    const tagManager = appManager.getTagManager();\r\n\r\n    const uiManager = appManager.getUiManager();\r\n\r\n    const encounter = campaignManager.getCurrentEncounter();\r\n    const campaignScore = campaignManager.getCampaignScore();\r\n    const partyManager = appManager.getPartyManager();\r\n    // State for encounter score that updates when it changes\r\n    const [encounterScore, setEncounterScore] = useState(campaignManager.getEncounterPoints());\r\n      const [needleGaugeUpdate, setNeedleGaugeUpdate] = useState(0); // Force needle gauge re-render\r\n      const [partyTension, setPartyTension] = useState(\r\n        partyManager.getPartyTension()\r\n      );\r\n\r\n    // Listen for encounter score updates\r\n    useEffect(() => {\r\n        const updateEncounterScore = () => {\r\n            setEncounterScore(campaignManager.getEncounterPoints());\r\n        };\r\n\r\n        // Listen to campaign manager events that might change the encounter score\r\n        campaignManager.on('dmScreenUpdated', updateEncounterScore);\r\n        campaignManager.on('encounterScoreUpdated', updateEncounterScore);\r\n        \r\n        return () => {\r\n            campaignManager.off('dmScreenUpdated', updateEncounterScore);\r\n            campaignManager.off('encounterScoreUpdated', updateEncounterScore);\r\n        };\r\n    }, [campaignManager]);\r\n\r\n     useEffect(() => {\r\n        const updateNeedleGauge = () => {\r\n          setNeedleGaugeUpdate((prev) => prev + 1); // Force needle gauge re-render\r\n        };\r\n        campaignManager.on(\"tensionDescriptionsUpdated\", updateNeedleGauge);\r\n        return () => {\r\n          campaignManager.off(\"tensionDescriptionsUpdated\", updateNeedleGauge);\r\n        };\r\n      }, [campaignManager]);\r\n\r\n\r\n  useEffect(() => {\r\n    const forceUpdate = () => {\r\n      setPartyTension(partyManager.getPartyTension());\r\n    };\r\n    uiManager.on(\"playerUpdate\", forceUpdate);\r\n    return () => {\r\n      uiManager.off(\"playerUpdate\", forceUpdate);\r\n    };\r\n  }, [uiManager, partyManager]);\r\n    // Get tag data for current encounter\r\n    const establishedEncounterTags: Tag[] = encounter \r\n        ? tagManager.encounterTagsCollected[encounter.name || \"\"] || []\r\n        : [];\r\n    const expectedEncounterTags: Tag[] = encounter \r\n        ? tagManager.encounterTagsExpected[encounter.name || \"\"]?.filter(\r\n            (tag: Tag) => !establishedEncounterTags.includes(tag)\r\n          ) || []\r\n        : [];\r\n\r\n    // Get location tag data\r\n    const locationTags: Tag[] = encounter \r\n        ? campaignManager.getEncounterLocationTags()\r\n        : [];\r\n    const establishedLocationTags: Tag[] = encounter \r\n        ? tagManager.locationTagsCollected || []\r\n        : [];\r\n\r\n    if (!encounter || appManager.state !== APP_STATE.SESSION) {\r\n        return <></>;\r\n    }\r\n\r\n    const encounterBranches = encounter?.branches;\r\n\r\n    // Calculate progress for current encounter\r\n    const totalEncounterTags = (establishedEncounterTags.length + expectedEncounterTags.length);\r\n    const totalLocationTags = locationTags.length;\r\n    const collectedEncounterTags = establishedEncounterTags.length;\r\n    const collectedLocationTags = establishedLocationTags.length;\r\n    const totalTags = totalEncounterTags + totalLocationTags;\r\n    const collectedTags = collectedEncounterTags + collectedLocationTags;\r\n    const percentComplete = totalTags > 0 ? Math.round((collectedTags / totalTags) * 100) : 0;\r\n\r\n    // Render checkboxes (dots)\r\n    const renderTagDots = (total: number, collected: number, className: string) => {\r\n        const dots = [];\r\n        for (let i = 0; i < total; i++) {\r\n            dots.push(\r\n                <div \r\n                    key={i} \r\n                    className={`tag-dot ${i < collected ? 'filled' : 'hollow'} ${className}`} \r\n                />\r\n            );\r\n        }\r\n        return dots;\r\n    };\r\n\r\n    \r\n    // Get campaign name\r\n    const campaignName = campaignManager.getCampaignName() || \"Campaign\";\r\n\r\n    // Render encounter section with tooltip\r\n    const renderEncounterSection = () => {\r\n        return (\r\n            <TooltipWrapper\r\n                content={\r\n                    <div className=\"encounter-tooltip-content\">\r\n                        <div className=\"tooltip-section\">\r\n                            <h4>Encounter Tags ({collectedEncounterTags}/{totalEncounterTags})</h4>\r\n                            <div className=\"tooltip-tags\">\r\n                                {establishedEncounterTags.map((tag, index) => (\r\n                                    <TagPill\r\n                                        key={index}\r\n                                        tag={tag}\r\n                                        source={FlavorTagSource.ENCOUNTER}\r\n                                        theme={encounter?.location.themes[0] as FlavorTagTheme}\r\n                                        tooltipClassName={\"info-tooltip\"}\r\n                                        tooltipText=\"Expectation fulfilled\"\r\n                                    />\r\n                                ))}\r\n                                {expectedEncounterTags.map((tag, index) => (\r\n                                    <TagPill\r\n                                        key={index}\r\n                                        tag={tag}\r\n                                        source={FlavorTagSource.ENCOUNTER_EXPECTED}\r\n                                        theme={encounter?.location.themes[0] as FlavorTagTheme}\r\n                                        tooltipClassName={\"info-tooltip\"}\r\n                                        tooltipText=\"Players still expect to encounter this\"\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"tooltip-section\">\r\n                            <h4>Location Tags ({collectedLocationTags}/{totalLocationTags})</h4>\r\n                            <div className=\"tooltip-tags\">\r\n                                {locationTags.map((tag, index) => (\r\n                                    <TagPill\r\n                                        key={index}\r\n                                        tag={tag}\r\n                                        source={\r\n                                            establishedLocationTags.includes(tag)\r\n                                                ? FlavorTagSource.LOCATION\r\n                                                : FlavorTagSource.LOCATION_EXPECTED\r\n                                        }\r\n                                        theme={encounter?.location.themes[0] as FlavorTagTheme}\r\n                                        tooltipClassName={\"info-tooltip\"}\r\n                                        tooltipText={\r\n                                            establishedLocationTags.includes(tag)\r\n                                                ? \"This location element has been established.\"\r\n                                                : \"Describe the location using these elements.\"\r\n                                        }\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                }\r\n            >\r\n                <div className=\"bottom-bar-encounter\">\r\n                    <div className=\"encounter-header-row\">\r\n                        <span className=\"encounter-name\">{encounter?.name}</span>\r\n                        <span className=\"encounter-percent\">{percentComplete}%</span>\r\n                    </div>\r\n                    <div className=\"encounter-dots-row\">\r\n                        <div className=\"encounter-dots-section\">\r\n                            <span className=\"dots-label\">Encounter Topics:</span>\r\n                            <div className=\"dots-container\">\r\n                                {renderTagDots(totalEncounterTags, collectedEncounterTags, 'encounter-dot')}\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"location-dots-section\">\r\n                            <span className=\"dots-label\">{encounter.location.name}:</span>\r\n                            <div className=\"dots-container\">\r\n                                {renderTagDots(totalLocationTags, collectedLocationTags, 'location-dot')}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </TooltipWrapper>\r\n        );\r\n    };\r\n\r\n    // Render next encounters section with tooltip\r\n    const renderNextEncountersSection = () => {\r\n        if (!encounterBranches || encounterBranches.length === 0) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <TooltipWrapper\r\n                content={\r\n                    <div className=\"next-encounters-tooltip-content\">\r\n                        <h4>Upcoming Encounters</h4>\r\n                        {encounterBranches.map((branch, index) => {\r\n                            const branchCollectedTags = tagManager.encounterTagsCollected[branch.name || \"\"] || [];\r\n                            const branchExpectedTags = tagManager.encounterTagsExpected[branch.name || \"\"] || [];\r\n                            \r\n                            return (\r\n                                <div key={index} className=\"tooltip-branch\">\r\n                                    <h5>{branch.name} ({branchCollectedTags.length} exposed)</h5>\r\n                                    <div className=\"tooltip-tags\">\r\n                                        {branchCollectedTags.map((tag: Tag, tagIndex: number) => (\r\n                                            <TagPill\r\n                                                key={`collected-${tagIndex}`}\r\n                                                tag={tag}\r\n                                                source={FlavorTagSource.FORESHADOWING}\r\n                                                theme={branch.location.themes[0] as FlavorTagTheme}\r\n                                                tooltipClassName={\"info-tooltip\"}\r\n                                                tooltipText=\"Players have been led to expect this if/when they get to this encounter.\"\r\n                                            />\r\n                                        ))}\r\n                                        {branchExpectedTags.filter((tag: Tag) => !branchCollectedTags.some(ct => ct.name === tag.name)).map((tag: Tag, tagIndex: number) => (\r\n                                            <TagPill\r\n                                                key={`expected-${tagIndex}`}\r\n                                                tag={tag}\r\n                                                source={FlavorTagSource.FORESHADOWING_EXPECTED}\r\n                                                theme={branch.location.themes[0] as FlavorTagTheme}\r\n                                                tooltipClassName={\"info-tooltip\"}\r\n                                                tooltipText=\"This topic can still be exposed to the players to inform them of the upcoming encounter\"\r\n                                            />\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                }\r\n            >\r\n                <div className=\"bottom-bar-next-encounters\">\r\n                    <div className=\"next-encounters-header\">\r\n                        <span className=\"next-encounters-title\">Upcoming Encounters</span>\r\n                    </div>\r\n                    <div className=\"next-encounters-row\">\r\n                        {encounterBranches.map((branch, index) => {\r\n                            const branchCollectedTags = tagManager.encounterTagsCollected[branch.name || \"\"]?.length || 0;\r\n                            const branchExpectedTags = tagManager.encounterTagsExpected[branch.name || \"\"]?.length || 0;\r\n                            const branchTotalTags = Math.max(4, branchCollectedTags + branchExpectedTags); // Minimum 4 slots\r\n                            \r\n                            return (\r\n                                <div key={index} className=\"next-encounter-item\">\r\n                                    <span className=\"next-encounter-name\">{branch.name}</span>\r\n                                    <div className=\"dots-container\">\r\n                                        {renderTagDots(branchTotalTags, branchCollectedTags, 'next-encounter-dot')}\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </div>\r\n            </TooltipWrapper>\r\n        );\r\n    };\r\n\r\n    // Render combined scoring section with event, tension, and campaign scores\r\n    const renderScoringSection = () => {\r\n        const event = campaignManager.getCurrentEvent();\r\n        \r\n        return (\r\n            <div className=\"bottom-bar-scoring\">\r\n                {/* Event Scoring - Left Side */}\r\n                {event && (\r\n                    <div className=\"scoring-event-side\">\r\n                        <div className=\"event-header-row\">\r\n                            <span className=\"event-name\">ENCOUNTER SCORE</span>\r\n                        </div>\r\n                        <div className=\"event-score-row\">\r\n                            \r\n                            <DiceScore score={encounterScore}/>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n                \r\n                {/* Tension Gauge - Middle */}\r\n                <div className=\"scoring-tension-side\">\r\n                    <div className=\"tension-header-row\">\r\n                        <span className=\"tension-name\">TENSION</span>\r\n                    </div>\r\n                    <div className=\"tension-gauge-container\">\r\n                        <div className=\"bottom-bar-stress-needle\">\r\n                             <StressInfo stress={partyTension} />\r\n                            <NeedleGauge\r\n                                key={needleGaugeUpdate}\r\n                                value={partyTension / 10}\r\n                                max={10}\r\n                                colors={campaignManager.getTensionColors()}\r\n                                descriptions={campaignManager\r\n                                    .getTensionDescriptions()\r\n                                    .map((desc) => desc.description)}\r\n                                segmentRanges={campaignManager\r\n                                    .getTensionRanges()\r\n                                    .map((range) => range / 10)}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                \r\n                {/* Campaign Scoring - Right Side */}\r\n                <div className=\"scoring-campaign-side\">\r\n                    <div className=\"campaign-header-row\">\r\n                        <span className=\"campaign-name\">QUEST SCORE</span>\r\n                    </div>\r\n                    <div className=\"campaign-score-row\">\r\n                        <DiceScore score={campaignScore}/>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n\r\n\r\n    return (\r\n        <div className=\"bottom-bar-container\">\r\n            <div className=\"bottom-bar-content\">\r\n                {renderEncounterSection()}\r\n                {renderScoringSection()}\r\n                {renderNextEncountersSection()}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\nexport default BottomBar; ","import React from 'react';\r\nimport CImage from './cimage';\r\nimport { ChatMessage } from '../../models';\r\nimport { useUiManager } from '../managerContexts';\r\n\r\ninterface ChatMessageDisplayProps {\r\n  chatMessage: ChatMessage;\r\n  newMessage?: boolean;\r\n}\r\n\r\nconst ChatMessageDisplay: React.FC<ChatMessageDisplayProps> = ({chatMessage, newMessage}) => {\r\n\r\n  const uiManager = useUiManager();\r\n\r\n  const message = chatMessage.message;\r\n  const iconId = uiManager.getMessageIconId(chatMessage.speaker);\r\n  \r\n  let speakerName = uiManager.getMessageSpeakerName(chatMessage.speaker);\r\n\r\n\r\n  return (\r\n    <div className={`chat-message-display ${chatMessage.speaker.type}`}>\r\n      <div className='chat-message-speaker-container'>\r\n        <div className=\"chat-message-speaker under-icon\">\r\n            {speakerName}\r\n          </div>\r\n        <div className=\"chat-message-icon\">\r\n          <CImage imageId={iconId} />\r\n        </div>\r\n      </div>\r\n      <div className = 'chat-messager-content'>\r\n        <div className=\"chat-message-speaker  over-message\">\r\n          {speakerName}\r\n        </div>\r\n        <div className = {`chat-message-text ${chatMessage.speaker.type}`}>\r\n          <div \r\n            className=\"chat-message-words\"\r\n            dangerouslySetInnerHTML={{ __html: message }}\r\n          />\r\n         \r\n        </div>\r\n      </div>\r\n    </div> \r\n  );\r\n}\r\n\r\nexport default ChatMessageDisplay;","import React from 'react';\r\nimport { ChatEvent, CHAT_EVENT_TYPE } from '../../models';\r\nimport { ENCOUNTER_EVENT_TYPE } from '../../consts/general';\r\nimport './chatEventTile.scss';\r\n\r\ninterface ChatEventTileProps {\r\n  event: ChatEvent;\r\n}\r\n\r\nconst ChatEventTile: React.FC<ChatEventTileProps> = ({ event }) => {\r\n  const getEventTypeClass = (): string => {\r\n    switch (event.type) {\r\n      case CHAT_EVENT_TYPE.CAMPAIGN_START:\r\n        return 'campaign-start';\r\n      case CHAT_EVENT_TYPE.ENCOUNTER_EVENT:\r\n        // Use the encounter event type for styling\r\n        const encounterType = event.data?.eventType as ENCOUNTER_EVENT_TYPE;\r\n        return `encounter-event ${encounterType || 'unknown'}`;\r\n      case CHAT_EVENT_TYPE.LOCATION_CHANGE:\r\n        return 'location-change';\r\n      case CHAT_EVENT_TYPE.COMBAT_START:\r\n        return 'combat-start';\r\n      case CHAT_EVENT_TYPE.COMBAT_END:\r\n        return 'combat-end';\r\n      default:\r\n        return 'generic';\r\n    }\r\n  };\r\n\r\n\r\n\r\n  return (\r\n    <div className={`chat-event-tile ${getEventTypeClass()}`}>\r\n     \r\n      <div className=\"event-content\">\r\n        <div className=\"event-title\">\r\n        {event.subtitle || event.title}\r\n        </div>\r\n        {event.subtitle && (\r\n          <div className=\"event-subtitle\"> \r\n             {event.title}\r\n          </div>\r\n        )}\r\n      </div>\r\n      \r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatEventTile;","import React, { useEffect, useRef, useState } from 'react';\r\nimport './chat.scss';\r\nimport CImage from './cimage';\r\nimport { CHAT_TYPE, ChatMessage, ChatEvent } from '../../models';\r\nimport ChatMessageDisplay from './chatmessagedisplay';\r\nimport ChatEventTile from './chatEventTile';\r\nimport { useAppManager } from '../managerContexts';\r\n\r\ninterface ChatProps {\r\n // expanded: boolean; \r\n}\r\n\r\nconst Chat: React.FC<ChatProps> = () => {\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const animationIntervalRef = useRef<NodeJS.Timeout | null>(null);\r\n  const appManager = useAppManager();\r\n  const chatManager = appManager.getChatManager();\r\n  const chatEventManager = appManager.getChatEventManager();\r\n  \r\n  // Initialize with existing message history from ChatManager\r\n  const [messages, setMessages] = useState<ChatMessage[]>(() => chatManager.getRecentMessages());\r\n  const [chatEvents, setChatEvents] = useState<ChatEvent[]>(() => chatEventManager.getEventHistory());\r\n  const [currentMessage, setCurrentMessage] = useState<ChatMessage | null>(null);\r\n  const [displayedText, setDisplayedText] = useState('');\r\n  const [isAnimating, setIsAnimating] = useState(false);\r\n  const [hasMoreMessages, setHasMoreMessages] = useState(false);\r\n  const [highlightedMessages, setHighlightedMessages] = useState<Record<string, { highlighted: boolean; pulsing: boolean }>>({});\r\n  const [isUserScrolling, setIsUserScrolling] = useState(false);\r\n  const scrollTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  // Handle new incoming messages\r\n  useEffect(() => {\r\n    const handleNewMessage = (message: ChatMessage & { \r\n      hasMoreMessages?: boolean;\r\n      messageId?: string;\r\n      conversationIds?: string[];\r\n      isLastInConversation?: boolean;\r\n    }) => {\r\n      // Sync with ChatManager's recent messages to maintain persistence\r\n      setMessages(chatManager.getRecentMessages());\r\n      setCurrentMessage(message);\r\n      setHasMoreMessages(!!message.hasMoreMessages);\r\n      \r\n      // Handle highlighting logic - only highlight the latest message\r\n      const currentMessages = chatManager.getRecentMessages();\r\n      const messageIndex = currentMessages.length - 1; // Latest message index\r\n      \r\n      // Always highlight only the latest message with pulsing glow\r\n      const msgId = `message-${messageIndex}`;\r\n      setHighlightedMessages(prev => ({ ...prev, [msgId]: { highlighted: true, pulsing: true } }));\r\n      \r\n      // Clear highlight after 3 seconds\r\n      setTimeout(() => {\r\n        setHighlightedMessages(prev => {\r\n          const newState = { ...prev };\r\n          delete newState[msgId];\r\n          return newState;\r\n        });\r\n      }, 3000);\r\n      \r\n      animateMessage(message.message);\r\n    };\r\n\r\n    chatManager.on('chat-message', handleNewMessage);\r\n    return () => {\r\n      chatManager.off('chat-message', handleNewMessage);\r\n    };\r\n  }, [chatManager]);\r\n\r\n  // Handle new chat events\r\n  useEffect(() => {\r\n    const handleNewEvent = (event: ChatEvent) => {\r\n      setChatEvents(prev => [...prev, event]);\r\n    };\r\n\r\n    chatEventManager.on('chat-event', handleNewEvent);\r\n    return () => {\r\n      chatEventManager.off('chat-event', handleNewEvent);\r\n    };\r\n  }, [chatEventManager]);\r\n\r\n  // Detect user scrolling to prevent auto-scroll interference\r\n  useEffect(() => {\r\n    const container = containerRef.current;\r\n    if (!container) return;\r\n\r\n    const handleScroll = () => {\r\n      const isAtBottom = container.scrollHeight - container.scrollTop - container.clientHeight < 10;\r\n      \r\n      if (!isAtBottom) {\r\n        setIsUserScrolling(true);\r\n        \r\n        // Clear existing timeout\r\n        if (scrollTimeoutRef.current) {\r\n          clearTimeout(scrollTimeoutRef.current);\r\n        }\r\n        \r\n        // Reset user scrolling state after 2 seconds of no scrolling\r\n        scrollTimeoutRef.current = setTimeout(() => {\r\n          setIsUserScrolling(false);\r\n        }, 2000);\r\n      } else {\r\n        setIsUserScrolling(false);\r\n      }\r\n    };\r\n\r\n    container.addEventListener('scroll', handleScroll);\r\n    \r\n    return () => {\r\n      container.removeEventListener('scroll', handleScroll);\r\n      if (scrollTimeoutRef.current) {\r\n        clearTimeout(scrollTimeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Sync with ChatManager history on mount and periodically\r\n  useEffect(() => {\r\n    const syncMessages = () => {\r\n      const managerMessages = chatManager.getRecentMessages();\r\n      setMessages(managerMessages);\r\n    };\r\n    \r\n    // Initial sync\r\n    syncMessages();\r\n    \r\n    // Optional: Periodic sync to catch any missed updates\r\n    const syncInterval = setInterval(syncMessages, 1000);\r\n    \r\n    return () => {\r\n      clearInterval(syncInterval);\r\n    };\r\n  }, [chatManager]);\r\n  \r\n  // Smart auto-scroll - only scroll to bottom if user is already at or near bottom\r\n  useEffect(() => {\r\n    if (containerRef.current && !isUserScrolling) {\r\n      const container = containerRef.current;\r\n      const isNearBottom = container.scrollHeight - container.scrollTop - container.clientHeight < 50;\r\n      \r\n      if (isNearBottom) {\r\n        // Use setTimeout to ensure DOM has updated before scrolling\r\n        setTimeout(() => {\r\n          if (containerRef.current) {\r\n            containerRef.current.scrollTop = containerRef.current.scrollHeight;\r\n          }\r\n        }, 10);\r\n      }\r\n    }\r\n  }, [messages, chatEvents, isUserScrolling]);\r\n\r\n  // Message animation logic\r\n  const animateMessage = (text: string) => {\r\n    setIsAnimating(true);\r\n    setDisplayedText('');\r\n    \r\n    // Clear any existing animation\r\n    if (animationIntervalRef.current) {\r\n      clearInterval(animationIntervalRef.current);\r\n    }\r\n    \r\n    // Split text into words while preserving spaces\r\n    const words = text.split(/(?<=\\s)|(?=\\s)/);\r\n    let wordIndex = 0;\r\n    let visibleWords = words.map(word => ({ word, visible: false }));\r\n    \r\n    animationIntervalRef.current = setInterval(() => {\r\n      if (!visibleWords[wordIndex].word.match(/^\\s+$/)) {\r\n        visibleWords[wordIndex].visible = true;\r\n        setDisplayedText(\r\n          visibleWords\r\n            .map(({ word, visible }) => \r\n              word.match(/^\\s+$/) ? word :\r\n              `<span class=\"chat-word ${visible ? 'visible' : ''}\">${word}</span>`\r\n            )\r\n            .join('')\r\n        );\r\n      }\r\n      wordIndex++;\r\n      \r\n      if (wordIndex >= words.length) {\r\n        if (animationIntervalRef.current) {\r\n          clearInterval(animationIntervalRef.current);\r\n          animationIntervalRef.current = null;\r\n        }\r\n        setIsAnimating(false);\r\n        \r\n        // Scroll to bottom when animation completes\r\n        setTimeout(() => {\r\n          if (containerRef.current) {\r\n            containerRef.current.scrollTop = containerRef.current.scrollHeight;\r\n          }\r\n        }, 50);\r\n      }\r\n    }, 10); // Slightly faster interval to account for animation duration\r\n  };\r\n\r\n  // Handle message box click\r\n  const handleMessageClick = () => {\r\n    if (isAnimating) {\r\n      // Complete current message animation immediately\r\n      if (animationIntervalRef.current) {\r\n        clearInterval(animationIntervalRef.current);\r\n        animationIntervalRef.current = null;\r\n      }\r\n      setIsAnimating(false);\r\n      setDisplayedText(currentMessage?.message || '');\r\n    } else if (hasMoreMessages) {\r\n      // Advance to next message\r\n     chatManager.advanceQueue();\r\n    }\r\n  };\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst renderMessage = (chatMessage: ChatMessage, index: number, isCurrentMessage: boolean = false, isLastMessage: boolean = false) => {\r\n  // Show animated text for current message, full text for completed messages\r\n  const messageToDisplay = isCurrentMessage && isAnimating ? {\r\n    ...chatMessage,\r\n    message: displayedText\r\n  } : chatMessage;\r\n  \r\n  // Generate consistent message ID for highlighting\r\n  const messageId = `message-${index}`;\r\n  const highlightState = highlightedMessages[messageId];\r\n  \r\n  // Build CSS classes for highlighting\r\n  const cssClasses = [\r\n    'chat-new-message',\r\n    isCurrentMessage && isAnimating ? 'animating' : '',\r\n    highlightState?.highlighted ? 'highlighted' : '',\r\n    highlightState?.pulsing ? 'pulsing' : ''\r\n  ].filter(Boolean).join(' ');\r\n  \r\n  // Determine if we should show the ellipsis (only on the most recent message if more are coming)\r\n  const showEllipsis = isLastMessage && hasMoreMessages;\r\n  \r\n  // Determine ellipsis position based on message type\r\n  const isPlayerOrCharacter = chatMessage.speaker.type === CHAT_TYPE.PLAYER || chatMessage.speaker.type === CHAT_TYPE.CHARACTER;\r\n  const ellipsisClass = isPlayerOrCharacter ? 'chat-queue-indicator-right' : 'chat-queue-indicator';\r\n  \r\n  return (\r\n    <div \r\n      key={messageId}\r\n      className={cssClasses}\r\n      onClick={isCurrentMessage ? handleMessageClick : undefined}\r\n      style={{ cursor: isCurrentMessage && (isAnimating || hasMoreMessages) ? 'pointer' : 'default' }}\r\n    >\r\n      <ChatMessageDisplay \r\n        chatMessage={messageToDisplay}\r\n        newMessage={isCurrentMessage}\r\n      />\r\n      {showEllipsis && (\r\n        <div className={`${ellipsisClass} ${showEllipsis ? 'visible' : ''}`}>\r\n          ...\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\n\r\n\r\n\r\n  // Combine messages and events in chronological order\r\n  const renderChatContent = () => {\r\n    const allItems: Array<{ type: 'message' | 'event'; data: ChatMessage | ChatEvent; timestamp: number; originalIndex?: number }> = [\r\n      ...messages.map((msg, index) => ({ \r\n        type: 'message' as const, \r\n        data: msg, \r\n        timestamp: msg.timestamp || Date.now() - (messages.length - index) * 1000, // Fallback timestamps for older messages\r\n        originalIndex: index\r\n      })),\r\n      ...chatEvents.map(event => ({ \r\n        type: 'event' as const, \r\n        data: event, \r\n        timestamp: event.timestamp \r\n      }))\r\n    ];\r\n    \r\n    // Sort by timestamp - true chronological order\r\n    allItems.sort((a, b) => a.timestamp - b.timestamp);\r\n    \r\n    return allItems.map((item, index) => {\r\n      if (item.type === 'event') {\r\n        return (\r\n          <ChatEventTile \r\n            key={`event-${item.timestamp}`}\r\n            event={item.data as ChatEvent}\r\n          />\r\n        );\r\n      } else {\r\n        const message = item.data as ChatMessage;\r\n        const messageIndex = item.originalIndex!;\r\n        const isCurrentMessage = !!currentMessage && message === currentMessage;\r\n        // Check if this is the last message in the entire flow (not just messages)\r\n        const isLastInFlow = index === allItems.length - 1 && item.type === 'message';\r\n        return renderMessage(message, messageIndex, isCurrentMessage, isLastInFlow);\r\n      }\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"chat-exterior\">\r\n      <div className=\"chat-messages-container\" ref={containerRef}>\r\n        {renderChatContent()}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chat;\r\n\r\n","import React from 'react';\r\nimport { FlavorTagTheme } from '../../models';\r\nimport TooltipWrapper from '../UI/TooltipWrapper';\r\nimport { ConditionalTooltip } from '../UI/tooltip';\r\n\r\ninterface ToneTrackerProps {\r\n  themes: Record<string, number>;\r\n  maxSegments: number;\r\n  onRedeem: (theme: string) => void;\r\n}\r\n\r\nconst ToneTracker: React.FC<ToneTrackerProps> = ({ themes, maxSegments, onRedeem }) => {\r\n\r\n\r\n  const getTooltipForTone = (theme: string, count: number) => {\r\n\r\n    if(count < maxSegments) {\r\n      \r\n    switch (theme) {\r\n     case FlavorTagTheme.COMEDIC:\r\n      return \"When filled: All players gain +1 attitude.\";\r\n     case FlavorTagTheme.DRAMATIC:\r\n      return \"When filled: All players gain full attention.\";\r\n     case FlavorTagTheme.HEROIC: \r\n   \r\n      return \"When filled: Set Tension to 50\"\r\n     case FlavorTagTheme.GRIM  : \r\n     return \"When filled: High-tension rewards increased\";\r\n     case FlavorTagTheme.ROMANTIC : \r\n     return \"When filled: Low-tension rewards increased\";\r\n     \r\n     case FlavorTagTheme.NONE: \r\n     default:\r\n      return `defaultTooltip`;\r\n    }\r\n    }\r\n\r\n\r\n    switch (theme) {\r\n     case FlavorTagTheme.COMEDIC:\r\n      return \"Click: All players gain +1 attitude.\";\r\n     case FlavorTagTheme.DRAMATIC:\r\n      return \"Click: All players gain full attention.\";\r\n     case FlavorTagTheme.FANTASY: \r\n     case FlavorTagTheme.HEROIC: \r\n      return \"Click: Set Tension to 50\"\r\n     case FlavorTagTheme.GRIM  : \r\n     return \"Click: Adjust high-tension rewards\";\r\n     case FlavorTagTheme.ROMANTIC : \r\n     return \"Click: Adjust low-tension rewards\";\r\n     case FlavorTagTheme.HORROR : \r\n     case FlavorTagTheme.NONE: \r\n     default:\r\n      return `defaultTooltip`;\r\n    }\r\n\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"tone-tracker\">\r\n      <div className=\"tone-header\">\r\n        <TooltipWrapper\r\n          content=\"Once a tone is established, it will generate party points. Tones can also be redeemed for unique effects once established.\"\r\n          position=\"top\"\r\n          \r\n          >\r\n        <span className=\"tone-title\">Session Tones</span>\r\n       </TooltipWrapper>\r\n      </div>\r\n      <div className=\"tone-grid\">\r\n        {Object.entries(themes).map(([theme, count]) => (\r\n          <TooltipWrapper\r\n\r\n            key={theme}\r\n            content={getTooltipForTone(theme, count)}\r\n            translate={[-100, -10]}\r\n         \r\n          >\r\n          <div \r\n            key={theme} \r\n            className={`tone-item theme-${theme} muted ${count >= maxSegments ? 'active' : ''}`} \r\n            onClick={count >= maxSegments ? () => onRedeem(theme) : undefined}\r\n          >\r\n            <div className=\"tone-item-header\">\r\n              <span className=\"tone-name\">{theme}</span>\r\n              {count < maxSegments && (\r\n                <span className=\"tone-count\">{count}/{maxSegments}</span>\r\n                )}\r\n              \r\n            </div>\r\n            <div className=\"tone-progress-container\">\r\n              <div \r\n                className={`tone-progress-bar theme-${theme}`}\r\n                style={{ width: `${(count / maxSegments) * 100}%` }}\r\n              />\r\n            </div>\r\n          </div>\r\n          </TooltipWrapper>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ToneTracker;","import React, { useEffect, useState } from \"react\";\r\nimport { useCampaignManager, useAppManager } from \"../managerContexts\";\r\nimport { TAG_COLLECTIONS } from \"../../consts/tagCollections\";\r\nimport { FlavorTagSource, Tag, TAG_TYPE } from \"../../models\";\r\nimport FlavorTagPill from \"./FlavorTagPill\";\r\nimport \"../../styles/tagCollections.scss\";\r\n\r\ntype FilterType = \"all\" | \"npc_races\" | \"enemies\" | \"travel\" | \"magic_item\";\r\n\r\ninterface TagCollectionsScreenProps {\r\n\tonClose: () => void;\r\n\tisEmbedded?: boolean;\r\n}\r\n\r\nconst TagCollectionsScreen: React.FC<TagCollectionsScreenProps> = ({\r\n\tonClose,\r\n\tisEmbedded = false,\r\n}) => {\r\n\tconst campaignManager = useCampaignManager();\r\n\tconst appManager = useAppManager();\r\n\tconst chatManager = appManager.getChatManager();\r\n\tconst tagManager = appManager.getTagManager();\r\n\tconst [activeFilter, setActiveFilter] = useState<FilterType>(\"all\");\r\n\r\n\tconst collectedTags = tagManager.getCollectedTags();\r\n\tconst completedCollections = TAG_COLLECTIONS.filter((c) =>\r\n\t\tc.tags.every((t) => collectedTags.some((ct) => ct.name === t.name))\r\n\t);\r\n\tconst incompleteCollections = TAG_COLLECTIONS.filter(\r\n\t\t(c) =>\r\n\t\t\tc.tags.some((t) => collectedTags.some((ct) => ct.name === t.name)) &&\r\n\t\t\t!c.tags.every((t) => collectedTags.some((ct) => ct.name === t.name))\r\n\t);\r\n\r\n\tconst [tagSortAsc, setTagSortAsc] = useState(true);\r\n\tconst [collectionSortAsc, setCollectionSortAsc] = useState(true);\r\n\tconst [showIntroduced, setShowIncomplete] = useState(true);\r\n\r\n\tconst filterTag = (tag: Tag): boolean => {\r\n\t\tswitch (activeFilter) {\r\n\t\t\tcase \"npc_races\":\r\n\t\t\t\treturn !!tag.friendly;\r\n\t\t\tcase \"enemies\":\r\n\t\t\t\treturn !!tag.enemy || !!tag.friendly;\r\n\t\t\tcase \"travel\":\r\n\t\t\t\treturn !!tag.travel;\r\n\t\t\tcase \"magic_item\":\r\n\t\t\t\treturn tag.type === TAG_TYPE.GEAR;\r\n\t\t\tcase \"all\":\r\n\t\t\t\t// We show these on the left\r\n\t\t\t\treturn tag.type !== TAG_TYPE.GEAR;\r\n\t\t\tdefault:\r\n\t\t\t\treturn true;\r\n\t\t}\r\n\t};\r\n\r\n\t// // Notify DM via chat for newly completed collections\r\n\t// useEffect(() => {\r\n\t// \tcompletedCollections.forEach((c) => {\r\n\t// \t\tchatManager.dmMessage(c.chat);\r\n\t// \t});\r\n\t// }, [chatManager, completedCollections]);\r\n\r\n\t// Prepare sorted data\r\n\tconst sortedTags = [...collectedTags].sort((a, b) =>\r\n\t\ttagSortAsc ? a.name.localeCompare(b.name) : b.name.localeCompare(a.name)\r\n\t);\r\n\tconst sortedCompleted = [...completedCollections].sort((a, b) =>\r\n\t\tcollectionSortAsc\r\n\t\t\t? a.name.localeCompare(b.name)\r\n\t\t\t: b.name.localeCompare(a.name)\r\n\t);\r\n\tconst sortedIntroduced = [...incompleteCollections].sort((a, b) =>\r\n\t\tcollectionSortAsc\r\n\t\t\t? a.name.localeCompare(b.name)\r\n\t\t\t: b.name.localeCompare(a.name)\r\n\t);\r\n\r\n\tconst expectedBackstoryTags = tagManager.getOutstandingBackstoryTags();\r\n\tconst expectedMagicItemTags = tagManager.magicItemRumors;\r\n\tconst discoveredMagicItemTags = tagManager.collectedTags.filter(\r\n\t\t(tag) => tag.type === TAG_TYPE.GEAR && !expectedMagicItemTags.includes(tag)\r\n\t);\r\n\r\n\t// Cash-in functionality\r\n\tconst handleCashInCollection = (collectionName: string) => {\r\n\t\t// Mark collection as cashed in\r\n\t\ttagManager.cashInCollection(collectionName);\r\n\t\t\r\n\t\t// Add +1 DM ability point\r\n\t\tcampaignManager.spendDMAbilityPoints(-1); // Negative to add points\r\n\t\t\r\n\t\t// Notify DM screen update so button counter refreshes\r\n\t\tcampaignManager.emit('dmScreenUpdated');\r\n\t\tcampaignManager.emit('dmAbilitiesUpdated', campaignManager.getDMAbilityPoints());\r\n\r\n\t\tconsole.log(`Cashed in collection: ${collectionName}, added +1 DM ability point`);\r\n\t};\r\n\r\n\t// Render functions for different sections\r\n\tconst renderBackstoryLeads = () => {\r\n\t\tif (expectedBackstoryTags.length === 0) return null;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div className=\"minor-tag-collection\">\r\n\t\t\t\t<div className=\"tag-collections-header\">\r\n\t\t\t\t\tBackstory Leads\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"small-tags-container\">\r\n\t\t\t\t\t<div className=\"tag-list\">\r\n\t\t\t\t\t\t{expectedBackstoryTags.map((tag) => {\r\n\t\t\t\t\t\t\tconst flavorTag = appManager\r\n\t\t\t\t\t\t\t\t.getTagManager()\r\n\t\t\t\t\t\t\t\t.tagToEncounterFlavorTag(tag);\r\n\t\t\t\t\t\t\tflavorTag.source = FlavorTagSource.BACKSTORY;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<FlavorTagPill\r\n\t\t\t\t\t\t\t\t\tkey={tag.name}\r\n\t\t\t\t\t\t\t\t\ttag={flavorTag}\r\n\t\t\t\t\t\t\t\t\tshowTooltip={false}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tconst renderRumoredMagicItems = () => {\r\n\t\tif (expectedMagicItemTags.length === 0) return null;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div className=\"minor-tag-collection\">\r\n\t\t\t\t<div className=\"tag-collections-header\">\r\n\t\t\t\t\tRumored Magic Items\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"small-tags-container\">\r\n\t\t\t\t\t<div className=\"tag-list\">\r\n\t\t\t\t\t\t{expectedMagicItemTags.map((tag) => {\r\n\t\t\t\t\t\t\tconst flavorTag = appManager\r\n\t\t\t\t\t\t\t\t.getTagManager()\r\n\t\t\t\t\t\t\t\t.tagToEncounterFlavorTag(tag);\r\n\t\t\t\t\t\t\tflavorTag.source = FlavorTagSource.MAGIC_ITEM_EXPECTED;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<FlavorTagPill\r\n\t\t\t\t\t\t\t\t\tkey={tag.name}\r\n\t\t\t\t\t\t\t\t\ttag={flavorTag}\r\n\t\t\t\t\t\t\t\t\tshowTooltip={false}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tconst renderQuestClues = () => {\r\n\t\tconst outstandingQuestTags = appManager.getQuestManager().getOutstandingQuestTags();\r\n\t\tif (outstandingQuestTags.length === 0) return null;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div className=\"minor-tag-collection\">\r\n\t\t\t\t<div className=\"tag-collections-header\">\r\n\t\t\t\t\tUpcoming Quest Clues\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"small-tags-container\">\r\n\t\t\t\t\t<div className=\"tag-list\">\r\n\t\t\t\t\t\t{outstandingQuestTags.map((tag) => {\r\n\t\t\t\t\t\t\tconst flavorTag = appManager\r\n\t\t\t\t\t\t\t\t.getTagManager()\r\n\t\t\t\t\t\t\t\t.tagToEncounterFlavorTag(tag);\r\n\t\t\t\t\t\t\tflavorTag.source = FlavorTagSource.QUEST;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<FlavorTagPill\r\n\t\t\t\t\t\t\t\t\tkey={tag.name}\r\n\t\t\t\t\t\t\t\t\ttag={flavorTag}\r\n\t\t\t\t\t\t\t\t\tshowTooltip={false}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tconst renderDiscoveredMagicItems = () => {\r\n\t\tif (discoveredMagicItemTags.length === 0) return null;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<div className=\"minor-tag-collection\">\r\n\t\t\t\t<div className=\"tag-collections-header\">\r\n\t\t\t\t\tDiscovered Magic Items\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"small-tags-container\">\r\n\t\t\t\t\t<div className=\"tag-list\">\r\n\t\t\t\t\t\t{discoveredMagicItemTags.map((tag) => {\r\n\t\t\t\t\t\t\tconst flavorTag = appManager\r\n\t\t\t\t\t\t\t\t.getTagManager()\r\n\t\t\t\t\t\t\t\t.tagToEncounterFlavorTag(tag);\r\n\t\t\t\t\t\t\tflavorTag.source = FlavorTagSource.MAGIC_ITEM;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<FlavorTagPill\r\n\t\t\t\t\t\t\t\t\tkey={tag.name}\r\n\t\t\t\t\t\t\t\t\ttag={flavorTag}\r\n\t\t\t\t\t\t\t\t\tshowTooltip={false}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tconst renderSidePanel = () => {\r\n\t\tconst hasContent =\r\n\t\t\tsortedCompleted.length > 0 ||\r\n\t\t\tsortedIntroduced.length > 0;\r\n\t\t\t\r\n\t\tif (!hasContent) return null;\r\n\t\t\r\n\r\n\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"tag-collections-container narrow\">\r\n\t\t\t\t<div className=\"side-panel\">\r\n\t\t\t\t\t{sortedCompleted.length > 0 && renderEstablishedThemes()}\r\n\t\t\t\t\t{sortedIntroduced.length > 0 && renderIntroducedThemes()}\r\n\t\t\t\t\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\t\tconst renderMainContent = () => {\r\n\t\treturn (\r\n\t\t\t<div className=\"tag-collections-container\">\r\n\t\t\t\t{!isEmbedded && (\r\n\t\t\t\t\t<div className=\"close-button\" onClick={onClose}>\r\n\t\t\t\t\t\t×\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<div className=\"main-content\">\r\n\t\t\t\t\t{renderEstablishedTopics()}\r\n\t\t\t\t\t<div className=\"minor-tag-containers\">\r\n\t\t\t\t\t\t{renderBackstoryLeads()}\r\n\t\t\t\t\t\t{renderRumoredMagicItems()}\r\n\t\t\t\t\t\t{renderQuestClues()}\r\n\t\t\t\t\t\t{renderDiscoveredMagicItems()}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tconst renderFilterControls = () => {\r\n\t\treturn (\r\n\t\t\t<div className=\"collections-controls\">\r\n\t\t\t\t<div className=\"control-group\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName={`filter-controls ${\r\n\t\t\t\t\t\t\tactiveFilter === \"all\" ? \"active\" : \"\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\tonClick={() => setActiveFilter(\"all\")}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tALL\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName={`filter-controls ${\r\n\t\t\t\t\t\t\tactiveFilter === \"npc_races\" ? \"active\" : \"\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\tonClick={() => setActiveFilter(\"npc_races\")}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tNPC\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName={`filter-controls ${\r\n\t\t\t\t\t\t\tactiveFilter === \"enemies\" ? \"active\" : \"\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\tonClick={() => setActiveFilter(\"enemies\")}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tCOMBATANT\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName={`filter-controls ${\r\n\t\t\t\t\t\t\tactiveFilter === \"travel\" ? \"active\" : \"\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\tonClick={() => setActiveFilter(\"travel\")}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tTRAVEL\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tconst renderEstablishedTopics = () => {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<div className=\"tag-collections-header\">Established Topics</div>\r\n\t\t\t\t<div className=\"collected-tags-container\">\r\n\t\t\t\t\t{renderFilterControls()}\r\n\t\t\t\t\t<div className=\"tag-list\">\r\n\t\t\t\t\t\t{sortedTags.filter(filterTag).map((tag) => {\r\n\t\t\t\t\t\t\tconst flavorTag = appManager\r\n\t\t\t\t\t\t\t\t.getTagManager()\r\n\t\t\t\t\t\t\t\t.tagToEncounterFlavorTag(tag);\r\n\t\t\t\t\t\t\tflavorTag.source = FlavorTagSource.COLLECTION_COLLECTED;\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<FlavorTagPill\r\n\t\t\t\t\t\t\t\t\tkey={tag.name}\r\n\t\t\t\t\t\t\t\t\ttag={flavorTag}\r\n\t\t\t\t\t\t\t\t\tshowTooltip={false}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</>\r\n\t\t);\r\n\t};\r\n\r\n\tconst renderEstablishedThemes = () => {\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<div className=\"tag-collections-header\">Established Themes</div>\r\n\t\t\t\t<div className=\"collections-list\">\r\n\t\t\t\t\t{sortedCompleted.map((c) => (\r\n\t\t\t\t\t\t<div key={c.name} className=\"collection-item complete\">\r\n\t\t\t\t\t\t\t<div className=\"collection-header\">\r\n\t\t\t\t\t\t\t\t<div className=\"collection-name completed\">{c.name}</div>\r\n\t\t\t\t\t\t\t\t{!tagManager.isCollectionCashedIn(c.name) && (\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"cash-in-button\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => handleCashInCollection(c.name)}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tCash In\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t{tagManager.isCollectionCashedIn(c.name) && (\r\n\t\t\t\t\t\t\t\t\t<span className=\"cashed-in-label\">Cashed In</span>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"tag-list\">\r\n\t\t\t\t\t\t\t\t{c.tags.map((t) => {\r\n\t\t\t\t\t\t\t\t\tconst owned = collectedTags.some(\r\n\t\t\t\t\t\t\t\t\t\t(ct) => ct.name === t.name\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\tconst flavorTag = appManager\r\n\t\t\t\t\t\t\t\t\t\t.getTagManager()\r\n\t\t\t\t\t\t\t\t\t\t.tagToEncounterFlavorTag(t);\r\n\t\t\t\t\t\t\t\t\tflavorTag.source = owned\r\n\t\t\t\t\t\t\t\t\t\t? FlavorTagSource.COLLECTION_COLLECTED\r\n\t\t\t\t\t\t\t\t\t\t: FlavorTagSource.COLLECTION;\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<FlavorTagPill\r\n\t\t\t\t\t\t\t\t\t\t\tkey={t.name}\r\n\t\t\t\t\t\t\t\t\t\t\ttag={flavorTag}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={owned ? \"collected\" : \"uncollected\"}\r\n\t\t\t\t\t\t\t\t\t\t\tshowTooltip={false}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t</>\r\n\t\t);\r\n\t};\r\n\r\n\tconst renderIntroducedThemes = () => {\r\n\t\tif (!showIntroduced) return null;\r\n\t\t\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<div className=\"tag-collections-header\">Introduced Themes</div>\r\n\t\t\t\t<div className=\"collections-list\">\r\n\t\t\t\t\t{sortedIntroduced.map((c) => (\r\n\t\t\t\t\t\t<div key={c.name}>\r\n\t\t\t\t\t\t\t<div className=\"collection-name\">{c.name}</div>\r\n\t\t\t\t\t\t\t<div className=\"collection-item\">\r\n\t\t\t\t\t\t\t\t<div className=\"tag-list\">\r\n\t\t\t\t\t\t\t\t\t{c.tags.map((t) => {\r\n\t\t\t\t\t\t\t\t\t\tconst owned = collectedTags.some(\r\n\t\t\t\t\t\t\t\t\t\t\t(ct) => ct.name === t.name\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\tconst flavorTag = appManager\r\n\t\t\t\t\t\t\t\t\t\t\t.getTagManager()\r\n\t\t\t\t\t\t\t\t\t\t\t.tagToEncounterFlavorTag(t);\r\n\t\t\t\t\t\t\t\t\t\tflavorTag.source = owned\r\n\t\t\t\t\t\t\t\t\t\t\t? FlavorTagSource.COLLECTION_COLLECTED\r\n\t\t\t\t\t\t\t\t\t\t\t: FlavorTagSource.COLLECTION;\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<FlavorTagPill\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={t.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttag={flavorTag}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={owned ? \"collected\" : \"uncollected\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowTooltip={false}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t</>\r\n\t\t);\r\n\t};\r\n\r\n\r\n\r\n\treturn (\r\n\t\t<div className=\"tag-collections-overlay green-theme\">\r\n\t\t\t{renderMainContent()}\r\n\t\t\t{renderSidePanel()}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default TagCollectionsScreen;\r\n","import React from 'react';\r\nimport './ComingSoon.scss';\r\n\r\ninterface ComingSoonProps {\r\n  /** The main label text (default: \"LOCKED\") */\r\n  label?: string;\r\n  /** The subtitle text (default: \"Coming Soon\") */\r\n  subtitle?: string;\r\n  /** Optional custom styling */\r\n  className?: string;\r\n  /** Whether to show the overlay (default: true) */\r\n  visible?: boolean;\r\n}\r\n\r\n/**\r\n * ComingSoon Overlay Component\r\n * \r\n * A reusable semi-transparent overlay that can be placed over any UI element\r\n * to indicate it's locked, disabled, or coming soon.\r\n * \r\n * Usage Examples:\r\n * \r\n * Basic usage:\r\n * <div style={{ position: 'relative' }}>\r\n *   <YourComponent />\r\n *   <ComingSoon />\r\n * </div>\r\n * \r\n * Custom labels:\r\n * <ComingSoon label=\"DISABLED\" subtitle=\"Feature in development\" />\r\n * \r\n * Conditional display:\r\n * <ComingSoon visible={!isUnlocked} />\r\n */\r\nconst ComingSoon: React.FC<ComingSoonProps> = ({\r\n  label = \"LOCKED\",\r\n  subtitle = \"Coming Soon\",\r\n  className = \"\",\r\n  visible = true\r\n}) => {\r\n  if (!visible) return null;\r\n\r\n  return (\r\n    <div className={`coming-soon-overlay ${className}`}>\r\n      <div className=\"coming-soon-content\">\r\n        <div className=\"coming-soon-label\">{label}</div>\r\n        <div className=\"coming-soon-subtitle\">{subtitle}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ComingSoon;","export const SCORE = {\r\n    COMPLETE_BACKSTORY: 25,\r\n    SKILL_CHALLENGE_ELEMENT: 10,\r\n}\r\n\r\n// Props and Comfort bonuses\r\nexport const PROPS_SCORES = [1, 2, 3, 4]; // General props bonus points per level\r\nexport const PROPS_ENCOUNTER_SCORES = [3, 6, 9, 15]; // Encounter score bonus per props level\r\nexport const COMFORT_EXHAUSTION_BONUS = [10, 20, 30, 40]; // Additional exhaustion capacity per comfort level\r\n\r\nexport const COST = {\r\n    EXHAUSTION: {\r\n        CHALLENGE_PER_HERO: 5\r\n    },\r\n    PARTY_SCORE: {\r\n        BACKSTORY_ASSIGNED: 10,\r\n        MAGIC_ITEM_INTRODUCED: 5,\r\n        MAGIC_ITEM_FOUND: 15,\r\n        BACKSTORY_FULFILLED: 20,\r\n       \r\n    },\r\n    CAMPAIGN_SCORE: {\r\n         LOCATION_DESCRIBED: 1,\r\n        FORESHADOWED_ENCOUNTER: 5,\r\n        ENCOUNTER_TAG_RESOLVED: 10,\r\n        }\r\n}\r\n\r\nexport interface TensionDescription {\r\n    max: number;\r\n    description: string;\r\n    scoreMultiplier: number;\r\n    stressIncrease: number;\r\n    color: string;\r\n}\r\n\r\nexport const TENSION_DESCRIPTIONS: TensionDescription[] = [\r\n    { max: 15, description: \"Too Low\", scoreMultiplier: 0, stressIncrease: 0, color: \"#efd50dda\" },\r\n    { max: 30, description: \"Very Low\", scoreMultiplier: 0.5, stressIncrease: 0, color: \"#FFA500da\" },\r\n    { max: 60, description: \"Good\", scoreMultiplier: 1, stressIncrease: 0, color: \"#32CD32da\" },\r\n    { max: 70, description: \"Perfect!\", scoreMultiplier: 2, stressIncrease: 0, color: \"#009900da\" },\r\n    { max: 90, description: \"Stressfull\", scoreMultiplier: 1.5, stressIncrease: 5, color: \"#FF4500da\" },\r\n    { max: 100, description: \"High Stress\", scoreMultiplier: 1.5, stressIncrease: 10, color: \"#FF0000da\" },\r\n    { max: Infinity, description: \"Impossible\", scoreMultiplier: 0, stressIncrease: 20, color: \"#222222da\" }\r\n];","import React, { useState, useEffect } from 'react';\r\nimport { useCampaignManager } from '../managerContexts';\r\nimport { ConditionalTooltip } from './tooltip';\r\nimport ComingSoon from './ComingSoon';\r\nimport './DMAbilitiesScreen.scss';\r\nimport { DMUpgrade, FlavorTagTheme, GameMastery } from '../../models';\r\nimport { PROPS_ENCOUNTER_SCORES, COMFORT_EXHAUSTION_BONUS } from '../../consts/score';\r\n\r\n// Define the ability meter structure\r\ninterface AbilityMeter {\r\n  id: string;\r\n  name: string;\r\n  color: string;\r\n  maxLevel: number;\r\n  currentLevel: number;\r\n  abilities: string[];\r\n  pointsPerLevel: number;\r\n  themes?: FlavorTagTheme[]; // Optional themes for the meter\r\n  hoverText?: string[]; // Optional hover text for each ability\r\n}\r\n\r\n\r\n\r\n\r\nconst DMAbilitiesScreen: React.FC = () => {\r\n  const campaignManager = useCampaignManager();\r\n  const [availablePoints, setAvailablePoints] = useState(0);\r\n  const [abilityMeters, setAbilityMeters] = useState<AbilityMeter[]>([]);\r\n  const [consumables, setConsumables] = useState<DMUpgrade[]>([]);\r\n  const [gameMasteries, setGameMasteries] = useState<GameMastery[]>([]);\r\n\r\n  // Initialize ability meters\r\n  useEffect(() => {\r\n    const initialMeters: AbilityMeter[] = [\r\n      {\r\n        id: 'tones',\r\n        name: 'Tones',\r\n        color: '#9123a1',\r\n        maxLevel: 5,\r\n        currentLevel: campaignManager.getDMAbilityMeterLevel('tones'),\r\n        abilities: [\"Comedic\", \"Dramatic\", \"Heroic\", \"Romantic\", \"Grim\"],\r\n        themes: [FlavorTagTheme.COMEDIC, FlavorTagTheme.DRAMATIC, FlavorTagTheme.HEROIC, FlavorTagTheme.ROMANTIC, FlavorTagTheme.GRIM],\r\n        hoverText: [\"Unlock the Comedy Tone\", \"Unlock the Dramatic Tone\", \"Unlock the Heroic Tone\", \"Unlock the Romantic Tone\", \"Unlock the Grim Tone\"],\r\n        pointsPerLevel: 1\r\n      },\r\n      {\r\n        id: 'hosting',\r\n        name: 'Hosting',\r\n        color: '#DC143C',\r\n        maxLevel: 4,\r\n        currentLevel: campaignManager.getDMAbilityMeterLevel('hosting'),\r\n        abilities: ['Snacks', 'Breaks', 'Props', 'Comfort'],\r\n        hoverText: [\r\n          'Use snacks to improve party attitude.',\r\n          'Breaks reduce tension, stress, and exhaustion.',\r\n          'Props provide a bonus Encounter Score per Level',\r\n          'Comfort levels increase maximum Party Exhaustion'\r\n        ],\r\n        pointsPerLevel: 1\r\n      },\r\n      {\r\n        id: 'storytelling',\r\n        name: 'Storytelling',\r\n        color: '#4682B4',\r\n        maxLevel: 3,\r\n        currentLevel: campaignManager.getDMAbilityMeterLevel('storytelling'),\r\n        abilities: ['Preparation', 'Living World', 'Dramatic Narration'],\r\n        hoverText: [\r\n          'Describe 1 location and 1 upcoming encounter element at the start of each campaign, +1 score bonus for those prep thingers.',\r\n          'Players gain 1 Attention at the beginning of each event.',\r\n          'Widen the x2 area on the Tension Meter',\r\n        ],\r\n        pointsPerLevel: 1\r\n      },\r\n    ];\r\n\r\n    setAbilityMeters(initialMeters);\r\n  }, [campaignManager]);\r\n\r\n  // Initialize game masteries\r\n  useEffect(() => {\r\n    const initialGameMasteries: GameMastery[] = [\r\n      {\r\n        id: 'roleplaying',\r\n        name: 'Roleplaying',\r\n        currentLevel: campaignManager.getDMGameMasteryLevel('roleplaying'),\r\n        maxLevel: 3,\r\n        color: '#9d7020',\r\n        rankLabels: ['Novice', 'Adept', 'Expert']\r\n      },\r\n      {\r\n        id: 'combat',\r\n        name: 'Combat',\r\n        currentLevel: campaignManager.getDMGameMasteryLevel('combat'),\r\n        maxLevel: 3,\r\n        color: '#9d7020',\r\n        rankLabels: ['Novice', 'Adept', 'Expert']\r\n      },\r\n      {\r\n        id: 'travel',\r\n        name: 'Travel',\r\n        currentLevel: campaignManager.getDMGameMasteryLevel('travel'),\r\n        maxLevel: 3,\r\n        color: '#9d7020',\r\n        rankLabels: ['Novice', 'Adept', 'Expert']\r\n      }\r\n    ];\r\n\r\n    setGameMasteries(initialGameMasteries);\r\n  }, [campaignManager]);\r\n\r\n  // Initialize consumables\r\n  useEffect(() => {\r\n    const initialConsumables: DMUpgrade[] = [\r\n      {\r\n        id: 'snacks',\r\n        name: 'Snacks',\r\n        value: campaignManager.getMaxSnacks(),\r\n        cost: 1,\r\n        color: '#FF6347',\r\n        icon: '🔒',\r\n        unlockedBy: 'hosting',\r\n        unlockLevel: 1\r\n      },\r\n      {\r\n        id: 'breaks',\r\n        name: 'Breaks',\r\n        value: campaignManager.getMaxBreaks(),\r\n        cost: 1,\r\n        color: '#32CD32',\r\n        icon: '🔒',\r\n        unlockedBy: 'hosting',\r\n        unlockLevel: 2\r\n      },\r\n      {\r\n        id: 'props',\r\n        name: 'Props',\r\n        value: campaignManager.getCurrentProps(),\r\n        cost: 1,\r\n        color: '#FFD700',\r\n        icon: '🔒',\r\n        unlockedBy: 'hosting',\r\n        unlockLevel: 3\r\n      },\r\n      {\r\n        id: 'comfort',\r\n        name: 'Venue',\r\n        value: campaignManager.getCurrentVenue(),\r\n        cost: 1,\r\n        color: '#FFD700',\r\n        icon: '🔒',\r\n        unlockedBy: 'hosting',\r\n        unlockLevel: 4\r\n      },\r\n    ];\r\n\r\n    setConsumables(initialConsumables);\r\n  }, [campaignManager]);\r\n\r\n\r\n\r\n  const isUnlocked = (consumable: DMUpgrade): boolean => {\r\n    // Check if the consumable is unlocked by an ability\r\n    if (consumable.unlockedBy) {\r\n      return campaignManager.isDMUpgradeUnlocked(consumable.id, consumable.unlockedBy, consumable.unlockLevel || 1);\r\n    }\r\n    return true; // If no unlock condition, it's always available\r\n  }\r\n\r\n  // Update available points and consumables when abilities change\r\n  useEffect(() => {\r\n    setAvailablePoints(campaignManager.getDMAbilityPoints());\r\n\r\n    const handleAbilitiesUpdate = (points: number) => {\r\n      setAvailablePoints(points);\r\n      \r\n      // Also update consumable values when abilities change\r\n      setConsumables(prev => prev.map(consumable => {\r\n        let newValue;\r\n        switch (consumable.id) {\r\n          case 'snacks':\r\n            newValue = campaignManager.getMaxSnacks();\r\n            break;\r\n          case 'breaks':\r\n            newValue = campaignManager.getMaxBreaks();\r\n            break;\r\n          case 'props':\r\n            newValue = campaignManager.getCurrentProps();\r\n            break;\r\n          case 'comfort':\r\n            newValue = campaignManager.getCurrentVenue();\r\n            break;\r\n          default:\r\n            newValue = consumable.value;\r\n        }\r\n        return { ...consumable, value: newValue };\r\n      }));\r\n    };\r\n\r\n    campaignManager.on('dmAbilitiesUpdated', handleAbilitiesUpdate);\r\n\r\n    return () => {\r\n      campaignManager.off('dmAbilitiesUpdated', handleAbilitiesUpdate);\r\n    };\r\n  }, [campaignManager]);\r\n\r\n  const handleAbilityUpgrade = (meterId: string) => {\r\n    const meter = abilityMeters.find(m => m.id === meterId);\r\n    if (!meter || meter.currentLevel >= meter.maxLevel) return;\r\n\r\n    const cost = meter.pointsPerLevel;\r\n    if (campaignManager.upgradeDMAbilityMeter(meterId, cost)) {\r\n      setAbilityMeters(prev => \r\n        prev.map(m => \r\n          m.id === meterId \r\n            ? { ...m, currentLevel: m.currentLevel + 1 }\r\n            : m\r\n        )\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleConsumablePurchase = (consumableId: string) => {\r\n    const consumable = consumables.find(c => c.id === consumableId);\r\n    if (!consumable) return;\r\n\r\n    if (campaignManager.purchaseDMConsumable(consumableId, consumable.cost)) {\r\n      // Update local state with new values\r\n      let newValue;\r\n      switch (consumableId) {\r\n        case 'snacks':\r\n          newValue = campaignManager.getMaxSnacks();\r\n          break;\r\n        case 'breaks':\r\n          newValue = campaignManager.getMaxBreaks();\r\n          break;\r\n        case 'props':\r\n          newValue = campaignManager.getCurrentProps();\r\n          break;\r\n        case 'comfort':\r\n          newValue = campaignManager.getCurrentVenue();\r\n          break;\r\n        default:\r\n          newValue = 0;\r\n      }\r\n\r\n      // Update local state\r\n      setConsumables(prev => \r\n        prev.map(c => \r\n          c.id === consumableId \r\n            ? { ...c, value: newValue }\r\n            : c\r\n        )\r\n      );\r\n    }\r\n  };\r\n\r\n  const handleGameMasteryUpgrade = (masteryId: string) => {\r\n    const mastery = gameMasteries.find(m => m.id === masteryId);\r\n    if (!mastery || mastery.currentLevel >= mastery.maxLevel) return;\r\n\r\n    const cost = 1; // Each game mastery level costs 1 point\r\n    if (campaignManager.upgradeDMGameMastery(masteryId, cost)) {\r\n      setGameMasteries(prev => \r\n        prev.map(m => \r\n          m.id === masteryId \r\n            ? { ...m, currentLevel: m.currentLevel + 1 }\r\n            : m\r\n        )\r\n      );\r\n    }\r\n  };\r\n\r\n  const renderAbilityMeter = (meter: AbilityMeter) => {\r\n    const progress = (meter.currentLevel / meter.maxLevel) * 100;\r\n    const canUpgrade = meter.currentLevel < meter.maxLevel && availablePoints >= meter.pointsPerLevel;\r\n\r\n    return (\r\n      <div key={meter.id} className=\"ability-meter\">\r\n        <button \r\n          className={`ability-button ${canUpgrade ? 'can-upgrade' : ''}`}\r\n          onClick={() => handleAbilityUpgrade(meter.id)}\r\n          disabled={!canUpgrade}\r\n          style={{ backgroundColor: meter.color }}\r\n        >\r\n          <span className=\"ability-name\">{meter.name}</span>\r\n          {/* <span className=\"ability-cost\">{meter.pointsPerLevel}pt</span> */}\r\n        </button>\r\n        \r\n        <div className=\"ability-track\">\r\n           <div className=\"ability-circles\">\r\n             <div \r\n                className={`ability-circle-spacer`}\r\n              \r\n              />\r\n            {Array.from({ length: meter.maxLevel }, (_, i) => (\r\n              <div \r\n                key={`background-${i}`}\r\n                className={`ability-circle background`}\r\n                style={{ backgroundColor: \"black\"}}\r\n              />\r\n            ))}\r\n          </div>\r\n           <div className=\"ability-circles names\">\r\n             <div \r\n                className={`ability-circle-spacer`}\r\n              />\r\n            {Array.from({ length: meter.maxLevel }, (_, i) => (\r\n              <ConditionalTooltip \r\n                key={`name-${i}`}\r\n                tooltip={meter.hoverText?.[i] || meter.abilities[i]}\r\n                visible={true}\r\n              >\r\n                <div \r\n                  className={`ability-circle-name ${i < meter.currentLevel ? 'highlighted' : ''}`}\r\n                >\r\n                  <div className=\"ability-circle-name-text\">\r\n                    {meter.abilities[i]}\r\n                  </div>  \r\n                </div>\r\n              </ConditionalTooltip>\r\n            ))}\r\n          </div>\r\n          <div className=\"ability-progress\" style={{ width: `100%`, backgroundColor: '#000000' }}>\r\n          </div>\r\n          \r\n          <div className=\"ability-circles foreground\">\r\n             <div \r\n                className={`ability-circle-spacer`}\r\n              \r\n              />\r\n            {Array.from({ length: meter.maxLevel }, (_, i) => (\r\n                <div \r\n                  key={`foreground-${i}`}\r\n                  className={`ability-circle ${i < meter.currentLevel ? 'filled' : ''}`}\r\n                  style={{ backgroundColor: i < meter.currentLevel ? meter.color : 'transparent' }}\r\n                />\r\n            ))}\r\n          </div>\r\n\r\n          \r\n\r\n          <div className=\"ability-progress filled\" style={{ width: `${progress}%`, backgroundColor: meter.color }}>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"ability-info\">\r\n          <span className=\"ability-level\">{meter.currentLevel}/{meter.maxLevel}</span>\r\n          {meter.currentLevel > 0 && (\r\n            <span className=\"ability-unlock\">{meter.abilities[meter.currentLevel - 1]}</span>\r\n          )}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Define level descriptions for each consumable type\r\n  const getConsumableInfo = (consumable: DMUpgrade) => {\r\n    const propsArray = [\"Battlemaps\", \"Cardboard Buildings\", \"Miniatures\", \"3D Printed Everything\"];\r\n    const comfortArray = [\"Background Music\", \"Nice Chairs\", \"Gaming Table\", \"Custom Game Room\"];\r\n\r\n    switch (consumable.id) {\r\n      case 'snacks':\r\n        return {\r\n          displayName: 'Snacks',\r\n          currentDescription: consumable.value > 0 ? `${consumable.value} per Encounter ` : 'None',\r\n          currentEffect: 'increases attitude by 1',\r\n          upgradeButtonText: `+1 Snacks`,\r\n          maxLevel: 10 // Arbitrary high number for consumables\r\n        };\r\n      \r\n      case 'breaks':\r\n        return {\r\n          displayName: 'Breaks',\r\n          currentDescription: consumable.value > 0 ? `${consumable.value} per Encounter` : 'None',\r\n          currentEffect: 'decreases tension, stress, exhastion',\r\n          upgradeButtonText: `+1 Breaks`,\r\n          maxLevel: 10\r\n        };\r\n      \r\n      case 'props':\r\n        return {\r\n          displayName: 'Props',\r\n          currentDescription: consumable.value > 0 ? (propsArray[consumable.value - 1] || 'Max Level') : 'None',\r\n          upgradeButtonText: (consumable.value > 0 && consumable.value < propsArray.length) ? `Upgrade to ${propsArray[consumable.value]}` : consumable.value === 0 ? 'Unlock Props' : 'Max Level',\r\n          currentEffect: consumable.value > 0 ? `+${PROPS_ENCOUNTER_SCORES[consumable.value - 1]} Encounter Score` : '',\r\n          maxLevel: propsArray.length\r\n        };\r\n      \r\n      case 'comfort':\r\n        return {\r\n          displayName: 'Venue',\r\n          currentDescription: consumable.value > 0 ? (comfortArray[consumable.value - 1] || 'Max Level') : 'Basic Setup',\r\n          upgradeButtonText: (consumable.value > 0 && consumable.value < comfortArray.length) ? `Upgrade to ${comfortArray[consumable.value]}` : consumable.value === 0 ? 'Unlock Venue' : 'Max Level',\r\n          currentEffect: consumable.value > 0 ? `+${COMFORT_EXHAUSTION_BONUS[consumable.value - 1]} Max Exhaustion` : '',\r\n          maxLevel: comfortArray.length\r\n        };\r\n      \r\n      default:\r\n        return {\r\n          displayName: consumable.name,\r\n          currentDescription: consumable.value > 0 ? `Level ${consumable.value}` : 'None',\r\n          upgradeButtonText: `+1 ${consumable.name}`,\r\n          currentEffect: '',\r\n          maxLevel: 10\r\n        };\r\n    }\r\n  };\r\n\r\n  const renderConsumableRow = () => {\r\n    return (\r\n      <div className=\"consumable-row\">\r\n        <div className=\"consumable-header\">\r\n          <span className=\"section-title\">HOSTING UPGRADES</span>\r\n        </div>\r\n        \r\n        <div className=\"consumable-grid\">\r\n          {consumables.map(consumable => {\r\n            const info = getConsumableInfo(consumable);\r\n            const unlocked = isUnlocked(consumable);\r\n            const canPurchase = availablePoints >= consumable.cost && unlocked;\r\n            const isAtMaxLevel = consumable.value >= info.maxLevel;\r\n            \r\n            return (\r\n              <div key={consumable.id} className=\"consumable-item\">\r\n                {/* Category Label */}\r\n                <div className=\"consumable-category-label\">\r\n                  {info.displayName}\r\n                </div>\r\n                \r\n                {/* Current Level/Status */}\r\n                <div className=\"consumable-current-status\">\r\n                  {unlocked ? (\r\n                    <div className=\"current-info\">\r\n                      <span className=\"current-level\">{info.currentDescription}</span>\r\n                      <span className=\"current-effect\">{info.currentEffect}</span>\r\n                    </div>\r\n                  ) : (\r\n                    <span className=\"locked-status\">🔒 Locked</span>\r\n                  )}\r\n                </div>\r\n                \r\n                {/* Upgrade Button or Lock Icon */}\r\n                {unlocked ? (\r\n                  <button\r\n                    className={`consumable-upgrade-button ${canPurchase && !isAtMaxLevel ? 'can-upgrade' : 'disabled'}`}\r\n                    onClick={() => handleConsumablePurchase(consumable.id)}\r\n                    disabled={!canPurchase || isAtMaxLevel}\r\n                   \r\n                  >\r\n                    {isAtMaxLevel ? 'Max Level' : info.upgradeButtonText}\r\n                  </button>\r\n                ) : (\r\n                  <div className=\"locked-indicator\">\r\n                    <span className=\"lock-icon\">🔒</span>\r\n                    <span className=\"unlock-requirement\">Hosting Level {consumable.unlockLevel}</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderGameMasteryRow = () => {\r\n    return (\r\n      <div className=\"game-mastery-row\">\r\n        <div className=\"game-mastery-label\">\r\n          <span className=\"ability-name\">Game Mastery</span>\r\n        </div>\r\n        \r\n          {gameMasteries.map(mastery => {\r\n            const canUpgrade = mastery.currentLevel < mastery.maxLevel && availablePoints >= 1;\r\n            const currentRank = mastery.currentLevel > 0 ? mastery.rankLabels[mastery.currentLevel - 1] : 'Untrained';\r\n            \r\n            return (\r\n              <div key={mastery.id} className=\"mastery-container\">\r\n                <div className=\"mastery-label-top\">\r\n                  <span className=\"mastery-name\">{mastery.name}</span>\r\n                  <span className=\"mastery-level\">Level {mastery.currentLevel}/{mastery.maxLevel}</span>\r\n                </div>\r\n                <button\r\n                  className={`ability-button ${canUpgrade ? 'can-upgrade' : ''}`}\r\n                  onClick={() => handleGameMasteryUpgrade(mastery.id)}\r\n                  disabled={!canUpgrade}\r\n                  style={{ backgroundColor: mastery.color }}\r\n                >\r\n                  <span className=\"mastery-rank\">{currentRank}</span>\r\n                </button>\r\n              </div>\r\n            );\r\n          })}\r\n        \r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"dm-abilities-screen\">\r\n      {/* Header with points and info */}\r\n      <div className=\"abilities-header\">\r\n        <div className=\"available-points\">\r\n          <span className=\"points-label\">Available Points:</span>\r\n          <span className=\"points-value\">{availablePoints}</span>\r\n        </div>\r\n       \r\n      </div>\r\n\r\n      {/* Ability Meters */}\r\n      <div className=\"abilities-meters\">\r\n        {abilityMeters.map(meter => {\r\n          // Apply ComingSoon overlay to storytelling meter\r\n          if (meter.id === 'storytelling') {\r\n            return (\r\n              <div key={meter.id} style={{ position: 'relative' }}>\r\n                {renderAbilityMeter(meter)}\r\n                <ComingSoon />\r\n              </div>\r\n            );\r\n          }\r\n          return renderAbilityMeter(meter);\r\n        })}\r\n      </div>\r\n\r\n      {/* Game Mastery Row */}\r\n      <div className=\"game-mastery-section\" style={{ position: 'relative' }}>\r\n        {renderGameMasteryRow()}\r\n        <ComingSoon />\r\n      </div>\r\n\r\n      {/* Consumables Row */}\r\n      <div className=\"consumables-section\">\r\n        {renderConsumableRow()}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DMAbilitiesScreen;\r\n","import React, { useState } from 'react';\r\nimport TagCollectionsScreen from './TagCollectionsScreen';\r\nimport DMAbilitiesScreen from './DMAbilitiesScreen';\r\nimport './DMCollectionsModal.scss';\r\n\r\ninterface DMCollectionsModalProps {\r\n  onClose: () => void;\r\n  initialView?: 'collections' | 'abilities';\r\n}\r\n\r\nconst DMCollectionsModal: React.FC<DMCollectionsModalProps> = ({\r\n  onClose,\r\n  initialView = 'collections'\r\n}) => {\r\n  const [activeView, setActiveView] = useState<'collections' | 'abilities'>(initialView);\r\n\r\n  const handleBackdropClick = (e: React.MouseEvent) => {\r\n    if (e.target === e.currentTarget) {\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const renderContent = () => {\r\n    switch (activeView) {\r\n      case 'collections':\r\n        return (\r\n          <div className=\"collections-content\">\r\n            <TagCollectionsScreen onClose={() => {}} isEmbedded={true} />\r\n          </div>\r\n        );\r\n      case 'abilities':\r\n        return (\r\n          <div className=\"abilities-content\">\r\n            <DMAbilitiesScreen />\r\n          </div>\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"dm-collections-modal-overlay\" onClick={handleBackdropClick}>\r\n      <div className={`dm-collections-modal-container ${activeView === 'collections' ? 'green-theme' : 'blue-theme'}`}>\r\n        {/* Header */}\r\n        <div className=\"dm-collections-modal-header\">\r\n          <h2>{activeView === 'collections' ? 'Topics & Themes' : 'DM Abilities'}</h2>\r\n          <button className=\"close-button\" onClick={onClose}>×</button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"dm-collections-modal-content\">\r\n          {renderContent()}\r\n        </div>\r\n\r\n        {/* Footer Navigation */}\r\n        {/* <div className=\"dm-collections-modal-footer\">\r\n          <button\r\n            className={`footer-tab green-theme ${activeView === 'collections' ? 'active' : ''}`}\r\n            onClick={() => setActiveView('collections')}\r\n          >\r\n            Topics and Themes\r\n          </button>\r\n          <button\r\n            className={`footer-tab blue-theme ${activeView === 'abilities' ? 'active' : ''}`}\r\n            onClick={() => setActiveView('abilities')}\r\n          >\r\n            DM Abilities\r\n          </button>\r\n        </div> */}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DMCollectionsModal;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useAppManager } from '../managerContexts';\r\nimport './LLMConfigModal.scss';\r\n\r\ninterface LLMConfigModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nconst LLMConfigModal: React.FC<LLMConfigModalProps> = ({ isOpen, onClose }) => {\r\n  const appManager = useAppManager();\r\n  const chatManager = appManager.getChatManager();\r\n  const llmService = chatManager.getLLMService();\r\n\r\n  const [apiKey, setApiKey] = useState('');\r\n  const [baseUrl, setBaseUrl] = useState('https://api.openai.com/v1');\r\n  const [model, setModel] = useState('gpt-3.5-turbo');\r\n  const [testStatus, setTestStatus] = useState<'idle' | 'testing' | 'success' | 'error'>('idle');\r\n  const [testMessage, setTestMessage] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      // Load existing configuration\r\n      const savedApiKey = localStorage.getItem('llm_api_key') || '';\r\n      const savedBaseUrl = localStorage.getItem('llm_base_url') || 'https://api.openai.com/v1';\r\n      const savedModel = localStorage.getItem('llm_model') || 'gpt-3.5-turbo';\r\n      \r\n      setApiKey(savedApiKey);\r\n      setBaseUrl(savedBaseUrl);\r\n      setModel(savedModel);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const handleSave = () => {\r\n    if (apiKey.trim()) {\r\n      llmService.setApiKey(apiKey.trim());\r\n      llmService.setConfiguration({ baseUrl, model });\r\n      \r\n      // Save to localStorage\r\n      localStorage.setItem('llm_base_url', baseUrl);\r\n      localStorage.setItem('llm_model', model);\r\n      \r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const handleTest = async () => {\r\n    if (!apiKey.trim()) {\r\n      setTestStatus('error');\r\n      setTestMessage('Please enter an API key first');\r\n      return;\r\n    }\r\n\r\n    setTestStatus('testing');\r\n    setTestMessage('Testing connection...');\r\n\r\n    try {\r\n      // Temporarily set the configuration for testing\r\n      llmService.setApiKey(apiKey.trim());\r\n      llmService.setConfiguration({ baseUrl, model });\r\n\r\n      const testResponse = await llmService.generateContextualResponse({\r\n        tag: { name: 'magic sword' },\r\n       gameContext: {},\r\n        partyTension: 0.5,\r\n      });\r\n\r\n      if (testResponse) {\r\n        setTestStatus('success');\r\n        setTestMessage(`Success! Response: \"${testResponse.message}\"`);\r\n      } else {\r\n        setTestStatus('error');\r\n        setTestMessage('Failed to get response from LLM service');\r\n      }\r\n    } catch (error) {\r\n      setTestStatus('error');\r\n      setTestMessage(`Error: ${error instanceof Error ? error.message : 'Unknown error'}`);\r\n    }\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"llm-config-modal-overlay\">\r\n      <div className=\"llm-config-modal\">\r\n        <div className=\"modal-header\">\r\n          <h2>LLM Configuration</h2>\r\n          <button className=\"close-button\" onClick={onClose}>×</button>\r\n        </div>\r\n\r\n        <div className=\"modal-content\">\r\n          <div className=\"config-section\">\r\n            <h3>API Configuration</h3>\r\n           \r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"apiKey\">API Key *</label>\r\n              <input\r\n                id=\"apiKey\"\r\n                type=\"password\"\r\n                value={apiKey}\r\n                onChange={(e) => setApiKey(e.target.value)}\r\n                placeholder=\"Enter your OpenAI API key\"\r\n                className=\"form-control\"\r\n              />\r\n              <small className=\"form-text\">\r\n                Get your API key from <a href=\"https://platform.openai.com/api-keys\" target=\"_blank\" rel=\"noopener noreferrer\">OpenAI Platform</a>\r\n              </small>\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"baseUrl\">Base URL</label>\r\n              <input\r\n                id=\"baseUrl\"\r\n                type=\"url\"\r\n                value={baseUrl}\r\n                onChange={(e) => setBaseUrl(e.target.value)}\r\n                placeholder=\"https://api.openai.com/v1\"\r\n                className=\"form-control\"\r\n              />\r\n              {/* <small className=\"form-text\">\r\n                Use a different URL for OpenAI-compatible services\r\n              </small> */}\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label htmlFor=\"model\">Model</label>\r\n              <select\r\n                id=\"model\"\r\n                value={model}\r\n                onChange={(e) => setModel(e.target.value)}\r\n                className=\"form-control\"\r\n              >\r\n                <option value=\"gpt-3.5-turbo\">GPT-3.5 Turbo (Recommended)</option>\r\n                <option value=\"gpt-4\">GPT-4</option>\r\n                <option value=\"gpt-4-turbo\">GPT-4 Turbo</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div className=\"test-section\">\r\n              <button \r\n                onClick={handleTest} \r\n                disabled={testStatus === 'testing'}\r\n                className={`test-button ${testStatus}`}\r\n              >\r\n                {testStatus === 'testing' ? 'Testing...' : 'Test Connection'}\r\n              </button>\r\n              \r\n              {testMessage && (\r\n                <div className={`test-result ${testStatus}`}>\r\n                  {testMessage}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n{/* \r\n          <div className=\"features-section\">\r\n            <h3>Features</h3>\r\n            <ul>\r\n              <li>🎯 <strong>Contextual Responses:</strong> Chat messages that reflect current game state</li>\r\n              <li>🌍 <strong>Location Awareness:</strong> Dialogue that considers your current location</li>\r\n              <li>⚔️ <strong>Mood Adaptation:</strong> Responses that match the current game mood</li>\r\n              <li>📚 <strong>Memory:</strong> References to recent events and discoveries</li>\r\n              <li>🎭 <strong>Character Voice:</strong> Different speaking styles for DM, players, and characters</li>\r\n            </ul>\r\n          </div> */}\r\n        </div>\r\n\r\n        <div className=\"modal-footer\">\r\n          <button onClick={onClose} className=\"btn btn-secondary\">\r\n            Cancel\r\n          </button>\r\n          <button \r\n            onClick={handleSave} \r\n            className=\"btn btn-primary\"\r\n            disabled={!apiKey.trim()}\r\n          >\r\n            Save Configuration\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LLMConfigModal;\r\n","import { Tag, ATTITUDE } from \"../models\";\r\n\r\nexport interface ChatRule {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  condition: ChatRuleCondition;\r\n  action: ChatRuleAction;\r\n  priority: number; // Higher number = higher priority\r\n  enabled: boolean;\r\n}\r\n\r\nexport interface ChatRuleCondition {\r\n  type: 'always' | 'chance' | 'attitude' | 'theme' | 'mood' | 'context' | 'speaker_type' | 'tag_type';\r\n  value?: any; // Specific value to check against\r\n  chance?: number; // For chance-based rules (0-100)\r\n  operator?: 'equals' | 'contains' | 'not_equals' | 'greater_than' | 'less_than';\r\n}\r\n\r\nexport interface ChatRuleAction {\r\n  type: 'modify_prompt' | 'set_speaker_preference' | 'add_instruction' | 'set_style';\r\n  instruction: string; // The instruction to add to the prompt\r\n  weight?: number; // How strongly to apply this rule (0-1)\r\n}\r\n\r\n// // Predefined rule templates\r\n// export const DEFAULT_CHAT_RULES: ChatRule[] = [\r\n//   // Character behavior rules\r\n//   {\r\n//     id: 'character_third_person',\r\n//     name: 'Characters Speak in Third Person',\r\n//     description: 'Characters sometimes refer to themselves in third person when speaking',\r\n//     condition: { \r\n//       type: 'speaker_type', \r\n//       value: 'character',\r\n//       chance: 30 \r\n//     },\r\n//     action: {\r\n//       type: 'add_instruction',\r\n//       instruction: 'The character should speak in third person (e.g., \"Thorin thinks this is suspicious\" instead of \"I think this is suspicious\")',\r\n//       weight: 0.7\r\n//     },\r\n//     priority: 5,\r\n//     enabled: true\r\n//   },\r\n\r\n//   // Player narration rules\r\n//   {\r\n//     id: 'player_narrates_character',\r\n//     name: 'Player Narrates Character Actions',\r\n//     description: 'Players sometimes describe what their character is doing instead of speaking as the character',\r\n//     condition: { \r\n//       type: 'speaker_type', \r\n//       value: 'player',\r\n//       chance: 25 \r\n//     },\r\n//     action: {\r\n//       type: 'add_instruction',\r\n//       instruction: 'The player should narrate their character\\'s actions or thoughts (e.g., \"My character Thorin examines the sword carefully\" or \"Thorin would be excited about this\")',\r\n//       weight: 0.6\r\n//     },\r\n//     priority: 4,\r\n//     enabled: true\r\n//   },\r\n\r\n//   // Attitude-based rules\r\n//   {\r\n//     id: 'like_attitude_enthusiasm',\r\n//     name: 'Players Express Enthusiasm for Liked Things',\r\n//     description: 'When a player likes something, they have a chance to express enthusiasm',\r\n//     condition: { \r\n//       type: 'attitude', \r\n//       value: ATTITUDE.LIKE,\r\n//       chance: 50 \r\n//     },\r\n//     action: {\r\n//       type: 'add_instruction',\r\n//       instruction: 'This player really likes this topic, so they should express enthusiasm, excitement, or positive commentary about it',\r\n//       weight: 0.8\r\n//     },\r\n//     priority: 7,\r\n//     enabled: true\r\n//   },\r\n\r\n//   {\r\n//     id: 'hate_attitude_disgust',\r\n//     name: 'Players Express Dislike for Hated Things',\r\n//     description: 'When a player hates something, they might express disgust or reluctance',\r\n//     condition: { \r\n//       type: 'attitude', \r\n//       value: ATTITUDE.HATE,\r\n//       chance: 40 \r\n//     },\r\n//     action: {\r\n//       type: 'add_instruction',\r\n//       instruction: 'This player dislikes this topic, so they might express reluctance, disgust, or negative commentary, but still participate',\r\n//       weight: 0.8\r\n//     },\r\n//     priority: 7,\r\n//     enabled: true\r\n//   },\r\n\r\n//   // Mood-based rules\r\n//   {\r\n//     id: 'tense_mood_short_responses',\r\n//     name: 'Tense Situations Get Short Responses',\r\n//     description: 'In tense situations, responses should be more concise and urgent',\r\n//     condition: { \r\n//       type: 'mood', \r\n//       value: 'tense' \r\n//     },\r\n//     action: {\r\n//       type: 'add_instruction',\r\n//       instruction: 'The situation is tense, so keep responses short, urgent, and focused. Characters should sound alert or concerned.',\r\n//       weight: 0.6\r\n//     },\r\n//     priority: 6,\r\n//     enabled: true\r\n//   },\r\n\r\n//   {\r\n//     id: 'relaxed_mood_casual',\r\n//     name: 'Relaxed Situations Allow Casual Chat',\r\n//     description: 'In relaxed situations, allow more casual, meandering conversation',\r\n//     condition: { \r\n//       type: 'mood', \r\n//       value: 'relaxed' \r\n//     },\r\n//     action: {\r\n//       type: 'add_instruction',\r\n//       instruction: 'The mood is relaxed, so responses can be more casual, thoughtful, or even tangential to the main topic.',\r\n//       weight: 0.5\r\n//     },\r\n//     priority: 3,\r\n//     enabled: true\r\n//   },\r\n\r\n//   // Theme-based rules\r\n//   {\r\n//     id: 'horror_theme_unease',\r\n//     name: 'Horror Themes Create Unease',\r\n//     description: 'Horror-themed content should make characters uncomfortable',\r\n//     condition: { \r\n//       type: 'theme', \r\n//       value: 'horror' \r\n//     },\r\n//     action: {\r\n//       type: 'add_instruction',\r\n//       instruction: 'The theme is horror, so responses should hint at unease, fear, or supernatural dread. Characters might be nervous or spooked.',\r\n//       weight: 0.7\r\n//     },\r\n//     priority: 6,\r\n//     enabled: true\r\n//   },\r\n\r\n//   {\r\n//     id: 'comedic_theme_humor',\r\n//     name: 'Comedic Themes Encourage Humor',\r\n//     description: 'Comedic content should bring out playful responses',\r\n//     condition: { \r\n//       type: 'theme', \r\n//       value: 'comedic' \r\n//     },\r\n//     action: {\r\n//       type: 'add_instruction',\r\n//       instruction: 'The theme is comedic, so responses can be playful, silly, or include light humor and jokes.',\r\n//       weight: 0.6\r\n//     },\r\n//     priority: 4,\r\n//     enabled: true\r\n//   },\r\n\r\n//   // Context-based rules\r\n//   {\r\n//     id: 'combat_context_tactical',\r\n//     name: 'Combat Context Gets Tactical Talk',\r\n//     description: 'During or after combat, characters think tactically',\r\n//     condition: { \r\n//       type: 'context', \r\n//       value: 'combat',\r\n//       operator: 'contains' \r\n//     },\r\n//     action: {\r\n//       type: 'add_instruction',\r\n//       instruction: 'Combat is happening or recently happened, so responses should be tactical, adrenaline-fueled, or reflect on the fight.',\r\n//       weight: 0.7\r\n//     },\r\n//     priority: 8,\r\n//     enabled: true\r\n//   },\r\n\r\n//   {\r\n//     id: 'discovery_context_wonder',\r\n//     name: 'Discoveries Create Wonder',\r\n//     description: 'When discovering new things, characters should express curiosity',\r\n//     condition: { \r\n//       type: 'context', \r\n//       value: 'discover',\r\n//       operator: 'contains' \r\n//     },\r\n//     action: {\r\n//       type: 'add_instruction',\r\n//       instruction: 'Something is being discovered, so responses should show curiosity, wonder, or analytical thinking about the find.',\r\n//       weight: 0.6\r\n//     },\r\n//     priority: 5,\r\n//     enabled: true\r\n//   },\r\n\r\n//   // Meta-gaming rules\r\n//   {\r\n//     id: 'player_meta_knowledge',\r\n//     name: 'Players Occasionally Break Character',\r\n//     description: 'Players sometimes make meta-commentary about the game',\r\n//     condition: { \r\n//       type: 'speaker_type', \r\n//       value: 'player',\r\n//       chance: 15 \r\n//     },\r\n//     action: {\r\n//       type: 'add_instruction',\r\n//       instruction: 'The player might make a brief meta-comment about the game, rules, or situation from a player\\'s perspective rather than character perspective.',\r\n//       weight: 0.4\r\n//     },\r\n//     priority: 2,\r\n//     enabled: true\r\n//   },\r\n\r\n//   // DM style rules\r\n//   {\r\n//     id: 'dm_narrative_style',\r\n//     name: 'DM Uses Descriptive Language',\r\n//     description: 'DM responses should be more descriptive and atmospheric',\r\n//     condition: { \r\n//       type: 'speaker_type', \r\n//       value: 'dm' \r\n//     },\r\n//     action: {\r\n//       type: 'add_instruction',\r\n//       instruction: 'As the DM, use descriptive, atmospheric language that sets the scene and guides the narrative. You can describe what characters see, feel, or notice.',\r\n//       weight: 0.8\r\n//     },\r\n//     priority: 6,\r\n//     enabled: true\r\n//   }\r\n// ];\r\n\r\nexport class ChatRuleEngine {\r\n  private rules: ChatRule[] = [];\r\n  private debugMode: boolean = true; // Set to true to see which rules are applied\r\n\r\n  constructor(rules: ChatRule[] = []){//DEFAULT_CHAT_RULES) {\r\n    this.rules = [...rules];\r\n  }\r\n\r\n  // Enable/disable debug mode\r\n  setDebugMode(enabled: boolean): void {\r\n    this.debugMode = enabled;\r\n  }\r\n\r\n  isDebugMode(): boolean {\r\n    return this.debugMode;\r\n  }\r\n\r\n}\r\n","import React, { useState } from 'react';\r\nimport { ChatRuleEngine } from '../services/chatRuleEngine';\r\nimport './ChatRuleTestPanel.scss';\r\n\r\ninterface ChatRuleTestPanelProps {\r\n  onClose: () => void;\r\n}\r\n\r\nexport const ChatRuleTestPanel: React.FC<ChatRuleTestPanelProps> = ({ onClose }) => {\r\n  const [testContext, setTestContext] = useState({\r\n    speakerType: 'character' as 'player' | 'character' | 'dm',\r\n    playerAttitude: 5,\r\n    mood: 'neutral' as 'positive' | 'negative' | 'neutral',\r\n    theme: 'adventure' as string\r\n  });\r\n  const [testResults, setTestResults] = useState<string[]>([]);\r\n  const [debugMode, setDebugMode] = useState(true);\r\n\r\n  const runTest = () => {\r\n    const ruleEngine = new ChatRuleEngine();\r\n    ruleEngine.setDebugMode(debugMode);\r\n    const applicableRules: any = [];\r\n    \r\n    const results = applicableRules.map((rule: any) => \r\n      `${rule.name}: ${rule.action.instruction}`\r\n    );\r\n    \r\n    setTestResults(results);\r\n  };\r\n\r\n  const resetRules = () => {\r\n    const ruleEngine = new ChatRuleEngine();\r\n    ruleEngine.setDebugMode(debugMode);\r\n    const allRules: any = [];\r\n    setTestResults([`Rules loaded: ${allRules.length} total rules`]);\r\n  };\r\n\r\n  return (\r\n    <div className=\"chat-rule-test-panel\">\r\n      <div className=\"panel-header\">\r\n        <h3>Chat Rule Test Panel</h3>\r\n        <button onClick={onClose} className=\"close-btn\">×</button>\r\n      </div>\r\n      \r\n      <div className=\"test-controls\">\r\n        <div className=\"control-group\">\r\n          <label>Speaker Type:</label>\r\n          <select \r\n            value={testContext.speakerType} \r\n            onChange={(e) => setTestContext({...testContext, speakerType: e.target.value as any})}\r\n          >\r\n            <option value=\"player\">Player</option>\r\n            <option value=\"character\">Character</option>\r\n            <option value=\"dm\">DM</option>\r\n          </select>\r\n        </div>\r\n        \r\n        <div className=\"control-group\">\r\n          <label>Player Attitude (1-10):</label>\r\n          <input \r\n            type=\"range\" \r\n            min=\"1\" \r\n            max=\"10\" \r\n            value={testContext.playerAttitude}\r\n            onChange={(e) => setTestContext({...testContext, playerAttitude: parseInt(e.target.value)})}\r\n          />\r\n          <span>{testContext.playerAttitude}</span>\r\n        </div>\r\n        \r\n        <div className=\"control-group\">\r\n          <label>Mood:</label>\r\n          <select \r\n            value={testContext.mood} \r\n            onChange={(e) => setTestContext({...testContext, mood: e.target.value as any})}\r\n          >\r\n            <option value=\"positive\">Positive</option>\r\n            <option value=\"negative\">Negative</option>\r\n            <option value=\"neutral\">Neutral</option>\r\n          </select>\r\n        </div>\r\n        \r\n        <div className=\"control-group\">\r\n          <label>Theme:</label>\r\n          <select \r\n            value={testContext.theme} \r\n            onChange={(e) => setTestContext({...testContext, theme: e.target.value})}\r\n          >\r\n            <option value=\"adventure\">Adventure</option>\r\n            <option value=\"combat\">Combat</option>\r\n            <option value=\"social\">Social</option>\r\n            <option value=\"mystery\">Mystery</option>\r\n            <option value=\"exploration\">Exploration</option>\r\n          </select>\r\n        </div>\r\n        \r\n        <div className=\"control-group\">\r\n          <label>Debug Mode:</label>\r\n          <input \r\n            type=\"checkbox\" \r\n            checked={debugMode}\r\n            onChange={(e) => setDebugMode(e.target.checked)}\r\n          />\r\n          <span>{debugMode ? 'Enabled' : 'Disabled'}</span>\r\n        </div>\r\n        \r\n        <div className=\"button-group\">\r\n          <button onClick={runTest} className=\"test-btn\">Test Rules</button>\r\n          <button onClick={resetRules} className=\"reset-btn\">Reset Rules</button>\r\n        </div>\r\n      </div>\r\n      \r\n      <div className=\"test-results\">\r\n        <h4>Active Rule Effects:</h4>\r\n        {testResults.length > 0 ? (\r\n          <ul>\r\n            {testResults.map((result, index) => (\r\n              <li key={index}>{result}</li>\r\n            ))}\r\n          </ul>\r\n        ) : (\r\n          <p>Run a test to see which rules apply...</p>\r\n        )}\r\n      </div>\r\n      \r\n      <div className=\"rule-examples\">\r\n        <h4>Example Rule Behaviors:</h4>\r\n        <ul>\r\n          <li><strong>Third Person Speech:</strong> Characters sometimes speak in third person when attitude is high</li>\r\n          <li><strong>Player Narration:</strong> Players describe actions narratively based on mood</li>\r\n          <li><strong>Attitude Responses:</strong> High attitude = enthusiastic, Low attitude = reluctant</li>\r\n          <li><strong>Mood Adaptation:</strong> Positive mood adds optimistic language</li>\r\n          <li><strong>Theme Matching:</strong> Combat themes use action words, social themes use diplomatic language</li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { useEffect } from 'react';\r\nimport { Tag, FlavorTagSource, FlavorTagTheme } from '../../models';\r\nimport FlavorTagPill from './FlavorTagPill';\r\nimport './GameToast.scss';\r\n\r\nexport interface GameToastData {\r\n  id: string;\r\n  type: 'collection' | 'quest';\r\n  title: string;\r\n  subtitle?: string;\r\n  tags: Tag[];\r\n  newTag: Tag;\r\n  isComplete?: boolean;\r\n  isTagCollected: (tag: Tag) => boolean;\r\n  getTagSource: (tag: Tag, isCollected: boolean) => FlavorTagSource;\r\n  getTagTheme: (tag: Tag, isCollected: boolean) => FlavorTagTheme;\r\n}\r\n\r\ninterface GameToastProps {\r\n  data: GameToastData;\r\n  onComplete: () => void;\r\n  duration?: number;\r\n}\r\n\r\nconst GameToast: React.FC<GameToastProps> = ({\r\n  data,\r\n  onComplete,\r\n  duration = 5000\r\n}) => {\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      onComplete();\r\n    }, duration);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, [onComplete, duration]);\r\n\r\n  return (\r\n    <div className={`game-toast ${data.type}-toast ${data.isComplete ? 'complete' : ''}`}>\r\n      <div className=\"toast-header\">\r\n        <div className=\"toast-title\">{data.title}</div>\r\n        {data.subtitle && <div className=\"toast-subtitle\">{data.subtitle}</div>}\r\n      </div>\r\n      <div className=\"tag-list\">\r\n        {data.tags.map((tag) => {\r\n          const isCollected = data.isTagCollected(tag);\r\n          return (\r\n            <FlavorTagPill\r\n              key={tag.name}\r\n              tag={{\r\n                tag,\r\n                source: data.getTagSource(tag, isCollected),\r\n                theme: data.getTagTheme(tag, isCollected)\r\n              }}\r\n              className={`\r\n                ${tag.name === data.newTag.name ? 'pulse' : ''} \r\n                ${data.isComplete ? 'glow' : ''} \r\n                ${isCollected ? 'collected' : 'uncollected'}\r\n              `.trim()}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GameToast;\r\n","import React, { useEffect, useState, useRef } from \"react\";\r\nimport Chat from \"../UI/chat\";\r\nimport {\r\n  useAppManager,\r\n  useCampaignManager,\r\n  useUiManager,\r\n} from \"../managerContexts\";\r\nimport ToneTracker from \"./toneTracker\";\r\nimport DMCollectionsModal from \"../UI/DMCollectionsModal\";\r\nimport LLMConfigModal from \"../UI/LLMConfigModal\";\r\nimport { ChatRuleTestPanel } from \"../ChatRuleTestPanel\";\r\nimport { THEME_FILLED_REQ } from \"../../consts/general\";\r\nimport { TAG_COLLECTIONS } from \"../../consts/tagCollections\";\r\nimport GameToast, { GameToastData } from \"../UI/GameToast\";\r\nimport { Tag, FlavorTagSource, FlavorTagTheme } from \"../../models\";\r\nimport FillBar from \"../UI/fillBar\";\r\nimport NeedleGauge from \"../UI/needleGauge\";\r\nimport StressInfo from \"./stressInfo\";\r\nimport \"./rightSidebar.scss\";\r\nimport \"./dmScreen.scss\"; // Import for toast container styles\r\n\r\ninterface RightSidebarProps {}\r\n\r\nconst RightSidebar: React.FC<RightSidebarProps> = () => {\r\n  const appManager = useAppManager();\r\n  const campaignManager = useCampaignManager();\r\n  const uiManager = useUiManager();\r\n  const questManager = appManager.getQuestManager();\r\n  const tagManager = appManager.getTagManager();\r\n  const partyManager = appManager.getPartyManager();\r\n  const [flavorTagThemes, setFlavorTagThemes] = useState(\r\n    campaignManager.getCollectedTones()\r\n  );\r\n\r\n  // Player tension and exhaustion state\r\n  const [partyExhaustion, setPartyExhaustion] = useState(\r\n    partyManager.getPartyExhaustion()\r\n  );\r\n  const [partyTension, setPartyTension] = useState(\r\n    partyManager.getPartyTension()\r\n  );\r\n  const [needleGaugeUpdate, setNeedleGaugeUpdate] = useState(0); // Force needle gauge re-render\r\n\r\n  // State for modals\r\n  const [showDMCollectionsModal, setShowDMCollectionsModal] = useState(false);\r\n  const [dmModalInitialView, setDMModalInitialView] = useState<\r\n    \"collections\" | \"abilities\"\r\n  >(\"collections\");\r\n  const [showLLMConfig, setShowLLMConfig] = useState(false);\r\n  const [showChatRuleTest, setShowChatRuleTest] = useState(false);\r\n\r\n  // Track DM ability points for badge updates\r\n  const [dmAbilityPoints, setDMAbilityPoints] = useState(\r\n    campaignManager.getDMAbilityPoints()\r\n  );\r\n\r\n  // Toast functionality\r\n  const [gameToasts, setGameToasts] = useState<GameToastData[]>([]);\r\n  const processedTagsRef = useRef<Set<string>>(new Set());\r\n\r\n  // Effects for player tension and exhaustion updates\r\n  useEffect(() => {\r\n    const updateGameInfo = () => {\r\n      setPartyExhaustion(partyManager.getPartyExhaustion());\r\n    };\r\n    partyManager.on(\"dmScreenUpdated\", updateGameInfo);\r\n    return () => {\r\n      partyManager.off(\"dmScreenUpdated\", updateGameInfo);\r\n    };\r\n  }, [partyManager]);\r\n\r\n  useEffect(() => {\r\n    const forceUpdate = () => {\r\n      setPartyTension(partyManager.getPartyTension());\r\n    };\r\n    uiManager.on(\"playerUpdate\", forceUpdate);\r\n    return () => {\r\n      uiManager.off(\"playerUpdate\", forceUpdate);\r\n    };\r\n  }, [uiManager, partyManager]);\r\n\r\n  // Listen for tension descriptions updates to refresh needle gauge\r\n  useEffect(() => {\r\n    const updateNeedleGauge = () => {\r\n      setNeedleGaugeUpdate((prev) => prev + 1); // Force needle gauge re-render\r\n    };\r\n    campaignManager.on(\"tensionDescriptionsUpdated\", updateNeedleGauge);\r\n    return () => {\r\n      campaignManager.off(\"tensionDescriptionsUpdated\", updateNeedleGauge);\r\n    };\r\n  }, [campaignManager]);\r\n\r\n  // Helper function to create collection toast data\r\n  const createCollectionToastData = (\r\n    collection: string,\r\n    newTag: Tag,\r\n    isComplete: boolean,\r\n    tagManager: any\r\n  ): GameToastData => {\r\n    const collectionData = TAG_COLLECTIONS.find((c) => c.name === collection);\r\n    if (!collectionData) throw new Error(`Collection not found: ${collection}`);\r\n\r\n    const isTagCollected = (tag: Tag): boolean =>\r\n      tagManager\r\n        .getCollectedTags()\r\n        .some((collectedTag: Tag) => tag.name === collectedTag.name);\r\n\r\n    return {\r\n      id: `collection-${collection}-${newTag.name}`,\r\n      type: \"collection\",\r\n      title: collection,\r\n      subtitle: isComplete ? \"Collection Complete!\" : \"New Topic Collected\",\r\n      tags: collectionData.tags,\r\n      newTag,\r\n      isComplete,\r\n      isTagCollected,\r\n      getTagSource: (tag: Tag, isCollected: boolean) =>\r\n        isCollected\r\n          ? FlavorTagSource.COLLECTION_COLLECTED\r\n          : FlavorTagSource.COLLECTION,\r\n      getTagTheme: (tag: Tag, isCollected: boolean) =>\r\n        isComplete ? FlavorTagTheme.GLOW : FlavorTagTheme.NONE,\r\n    };\r\n  };\r\n\r\n  // Helper function to create quest toast data\r\n  const createQuestToastData = (questData: {\r\n    quest: any;\r\n    newTag: any;\r\n    completedTags: string[];\r\n    currentNode: any;\r\n  }): GameToastData => {\r\n    const { quest, newTag, completedTags, currentNode } = questData;\r\n\r\n    const isTagCollected = (tag: Tag): boolean => {\r\n      return completedTags.includes(tag.name);\r\n    };\r\n\r\n    const getAllQuestTags = (): Tag[] => {\r\n      const allTags: Tag[] = [];\r\n      for (const child of currentNode.children) {\r\n        allTags.push(child.tag);\r\n      }\r\n      return allTags;\r\n    };\r\n\r\n    const isQuestComplete = currentNode.children.length === 0;\r\n\r\n    return {\r\n      id: `quest-${quest.id}-${newTag.name}`,\r\n      type: \"quest\",\r\n      title: quest.name,\r\n      subtitle: isQuestComplete ? \"Quest Complete!\" : \"Quest Progress\",\r\n      tags: getAllQuestTags(),\r\n      newTag,\r\n      isComplete: isQuestComplete,\r\n      isTagCollected,\r\n      getTagSource: (tag: Tag, isCollected: boolean) => FlavorTagSource.QUEST,\r\n      getTagTheme: (tag: Tag, isCollected: boolean) => FlavorTagTheme.NONE,\r\n    };\r\n  };\r\n\r\n  const handleToastComplete = () => {\r\n    setGameToasts((prev) => prev.slice(1));\r\n  };\r\n  useEffect(() => {\r\n    const updateFlavorTags = () => {\r\n      setFlavorTagThemes({ ...campaignManager.getCollectedTones() });\r\n    };\r\n\r\n    const updateDMAbilityPoints = (points: number) => {\r\n      setDMAbilityPoints(points);\r\n    };\r\n\r\n    campaignManager.on(\"dmScreenUpdated\", updateFlavorTags);\r\n    campaignManager.on(\"dmAbilitiesUpdated\", updateDMAbilityPoints);\r\n\r\n    return () => {\r\n      campaignManager.off(\"dmScreenUpdated\", updateFlavorTags);\r\n      campaignManager.off(\"dmAbilitiesUpdated\", updateDMAbilityPoints);\r\n    };\r\n  }, [campaignManager, questManager]);\r\n\r\n  // Collection toast handling - listen to dmScreenUpdated events\r\n  useEffect(() => {\r\n    const handleTagUpdate = () => {\r\n      const currentCollectedTags = tagManager.getCollectedTags();\r\n\r\n      const currentTagCount = currentCollectedTags.length;\r\n      const lastKnownCount = processedTagsRef.current.size;\r\n\r\n      console.log('RightSidebar: Collection toast check triggered', {\r\n        currentTagCount,\r\n        lastKnownCount,\r\n        processedTagsList: Array.from(processedTagsRef.current)\r\n      });\r\n\r\n      // Only process if we actually have more tags than we've processed before\r\n      if (currentTagCount <= lastKnownCount) {\r\n        console.log('RightSidebar: No new tags detected, skipping toast logic');\r\n        return;\r\n      }\r\n\r\n      // Find new tags that haven't been processed yet\r\n      const newlyCollectedTags = currentCollectedTags.filter(\r\n        (tag) => !processedTagsRef.current.has(tag.name)\r\n      );\r\n\r\n      console.log('RightSidebar: Newly collected tags:', newlyCollectedTags.map(t => t.name));\r\n\r\n      if (newlyCollectedTags.length > 0) {\r\n        // Process each new tag\r\n        newlyCollectedTags.forEach((newTag) => {\r\n          // Check which collections this tag contributes to\r\n          TAG_COLLECTIONS.forEach((collection) => {\r\n            const hasTag = collection.tags.some((t) => t.name === newTag.name);\r\n            if (hasTag) {\r\n              const isComplete = collection.tags.every((t) =>\r\n                currentCollectedTags.some((ct) => ct.name === t.name)\r\n              );\r\n\r\n              const toastData = createCollectionToastData(\r\n                collection.name,\r\n                newTag,\r\n                isComplete,\r\n                tagManager\r\n              );\r\n              setGameToasts((prev) => [...prev, toastData]);\r\n            }\r\n          });\r\n\r\n          // Add to processed tags set\r\n          processedTagsRef.current.add(newTag.name);\r\n        });\r\n      }\r\n    };\r\n\r\n    // Listen to the same event that updates other DM screen elements\r\n    campaignManager.on(\"dmScreenUpdated\", handleTagUpdate);\r\n\r\n    return () => {\r\n      campaignManager.off(\"dmScreenUpdated\", handleTagUpdate);\r\n    };\r\n  }, [campaignManager, tagManager]);\r\n\r\n  // Quest toast handling\r\n  useEffect(() => {\r\n    const handleShowQuestToast = (questData: {\r\n      quest: any;\r\n      newTag: any;\r\n      completedTags: string[];\r\n      currentNode: any;\r\n    }) => {\r\n      const toastData = createQuestToastData(questData);\r\n      setGameToasts((prev) => [...prev, toastData]);\r\n    };\r\n\r\n    campaignManager.on(\"showQuestToast\", handleShowQuestToast);\r\n\r\n    return () => {\r\n      campaignManager.off(\"showQuestToast\", handleShowQuestToast);\r\n    };\r\n  }, [campaignManager]);\r\n\r\n  const redeemTheme = (theme: string) => {\r\n    campaignManager.redeemTheme(theme);\r\n  };\r\n\r\n  const backgroundColor = campaignManager.getTensionColor(partyTension);\r\n\r\n  return (\r\n    <div className=\"right-sidebar\">\r\n      <div className=\"right-sidebar-content\">\r\n        {/* DM Control Panel */}\r\n        {/* Tone Tracker */}\r\n       \r\n        {/* Player Tension */}\r\n        <div className=\"player-tension-holder\">\r\n          <div\r\n            className=\"stress-needle\"\r\n            onClick={() => partyManager.setPartyTension(partyTension + 4)}\r\n            style={{\r\n              borderColor: backgroundColor,\r\n              transition: \"background-color 0.3s ease\",\r\n            }}\r\n          >\r\n            <StressInfo stress={partyTension} />\r\n            <NeedleGauge\r\n              key={needleGaugeUpdate}\r\n              value={partyTension / 10}\r\n              max={10}\r\n              colors={campaignManager.getTensionColors()}\r\n              descriptions={campaignManager\r\n                .getTensionDescriptions()\r\n                .map((desc) => desc.description)}\r\n              segmentRanges={campaignManager\r\n                .getTensionRanges()\r\n                .map((range) => range / 10)}\r\n            />\r\n            <div className=\"stress-label-containers\">\r\n              <div className=\"stress-labels\">\r\n                <div className=\"stress-label title\">PARTY TENSION</div>\r\n                <StressInfo stress={partyTension} displayNumber />\r\n              </div>\r\n              <div className=\"stress-labels bottom\">\r\n                <div className=\"stress-label\">\r\n                  {partyManager.getTensionDescription2(partyTension)}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {/* Player Exhaustion */}\r\n        <div className=\"player-row-exhaustion\">\r\n          <div className=\"party-exhaustion\">\r\n            <div className=\"party-exhaustion-label-row\">\r\n              <div className=\"party-exhaustion-label\">0</div>\r\n              <div className=\"party-exhaustion-label\">EXHAUSTION</div>\r\n              <div className=\"party-exhaustion-label\">\r\n                {partyManager.getMaxPartyExhaustion()}\r\n              </div>\r\n            </div>\r\n\r\n            <FillBar\r\n              totalSegments={20}\r\n              filledSegments={partyExhaustion / 5}\r\n              theme=\"exhaustion\"\r\n              label=\"\"\r\n            />\r\n            <div className=\"party-exhaustion-label number\">\r\n              {partyExhaustion}\r\n            </div>\r\n          </div>\r\n        </div>\r\n         {Object.entries(flavorTagThemes).length > 0 && (\r\n          <ToneTracker\r\n            themes={flavorTagThemes}\r\n            maxSegments={THEME_FILLED_REQ}\r\n            onRedeem={redeemTheme}\r\n          />\r\n        )}\r\n        {/* Chat - Main content area */}\r\n        <div className=\"chat-container\">\r\n          <Chat />\r\n        </div>{\" \"}\r\n        <div className=\"dm-control-panel\">\r\n          <button\r\n            className=\"dm-control-button collections-button\"\r\n            onClick={() => {\r\n              setDMModalInitialView(\"collections\");\r\n              setShowDMCollectionsModal(true);\r\n            }}\r\n           \r\n          >\r\n            <span>TOPICS</span>\r\n            {tagManager.getAvailableCollectionRewards() > 0 && (\r\n              <div className=\"reward-count\">\r\n                {tagManager.getAvailableCollectionRewards()}\r\n              </div>\r\n            )}\r\n          </button>\r\n\r\n          <button\r\n            className=\"dm-control-button skill-button\"\r\n            onClick={() => {\r\n              setDMModalInitialView(\"abilities\");\r\n              setShowDMCollectionsModal(true);\r\n            }}\r\n           \r\n          >\r\n            <span>SKILLS</span>\r\n            {dmAbilityPoints > 0 && (\r\n              <div className=\"reward-count\">{dmAbilityPoints}</div>\r\n            )}\r\n          </button>\r\n             <button\r\n            className=\"dm-control-button quest-button\"\r\n            onClick={() => {\r\n              questManager.activateQuest.length && uiManager.showActiveQuestsModal();\r\n            }}\r\n           \r\n          >\r\n            <span>QUESTS</span>\r\n            {questManager.getActiveQuests().length > 0 && (\r\n              <div className=\"reward-count\">{questManager.getActiveQuests().length}</div>\r\n            )}\r\n          </button>\r\n        </div>\r\n        {/* Settings Panel */}\r\n        <div className=\"settings-panel\">\r\n          <button\r\n            className=\"settings-button llm-button\"\r\n            onClick={() => setShowLLMConfig(true)}\r\n            title=\"Configure AI-powered contextual chat responses\"\r\n          >\r\n            <span>🤖 LLM</span>\r\n            {appManager.getChatManager().getLLMService().isEnabled() && (\r\n              <div className=\"status-indicator enabled\"></div>\r\n            )}\r\n          </button>\r\n\r\n          {/* <button\r\n            className=\"settings-button chat-rules-button\"\r\n            onClick={() => setShowChatRuleTest(true)}\r\n            title=\"Test and configure chat behavior rules\"\r\n          >\r\n            <span>⚙️ Rules</span>\r\n          </button> */}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Modals */}\r\n      {showDMCollectionsModal && (\r\n        <DMCollectionsModal\r\n          initialView={dmModalInitialView}\r\n          onClose={() => setShowDMCollectionsModal(false)}\r\n        />\r\n      )}\r\n\r\n      {showLLMConfig && (\r\n        <LLMConfigModal\r\n          isOpen={showLLMConfig}\r\n          onClose={() => setShowLLMConfig(false)}\r\n        />\r\n      )}\r\n\r\n      {showChatRuleTest && (\r\n        <ChatRuleTestPanel onClose={() => setShowChatRuleTest(false)} />\r\n      )}\r\n\r\n      {/* Toast container - positioned near TOPICS button */}\r\n      <div className=\"game-toasts-container\">\r\n        {gameToasts.map((toastData, index) => (\r\n          <div key={toastData.id}>\r\n            <GameToast data={toastData} onComplete={handleToastComplete} />\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RightSidebar;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  Player,\r\n  Character,\r\n  NOTEBOOK_CATEGORY,\r\n  ATTRIBUTE_CONTRIBUTOR,\r\n} from \"../../models\";\r\nimport CImage from \"../UI/cimage\";\r\nimport CharacterManager from \"../../managers/characterManager\";\r\nimport { useCharacterManager, useUiManager } from \"../managerContexts\";\r\nimport AttributeDisplay from \"../UI/attributeDisplay\";\r\nimport FillBar from \"../UI/fillBar\";\r\nimport { PLAYER_EXP_LEVEL } from \"../../consts/general\";\r\n\r\ninterface PlayerDisplayProps {\r\n  player: Player;\r\n}\r\nconst delightColors = [\"#CC0000\", \"#CC6600\", \"#CCCC00\", \"#66CC00\", \"#00CC00\"];\r\nconst delightBorderColors = [\r\n  \"#990000\",\r\n  \"#994C00\",\r\n  \"#999900\",\r\n  \"#4C9900\",\r\n  \"#009900\",\r\n];\r\n\r\nconst delightColors2 = [\r\n  \"#FFCCCC\",\r\n  \"#FFDDCC\",\r\n  \"#FFFFCC\",\r\n  \"#DDFFCC\",\r\n  \"#CCFFCC\",\r\n  \"#aaFFaa\",\r\n];\r\nconst delightBorderColors2 = [\r\n  \"#AA0000\",\r\n  \"#663300\",\r\n  \"#666600\",\r\n  \"#336600\",\r\n  \"#006600\",\r\n  \"#008800\",\r\n];\r\nconst PlayerDisplay: React.FC<PlayerDisplayProps> = ({ player }) => {\r\n  const characterManager = useCharacterManager();\r\n  const [showPlayerTooltip, setShowPlayerTooltip] = useState(false);\r\n  const [showCharacterTooltip, setShowCharacterTooltip] = useState<\r\n    number | null\r\n  >(null);\r\n  const [characters, setCharacters] = useState<Character[]>(player.characters);\r\n  const uiManager = useUiManager();\r\n  const [enjoyment, setEnjoyment] = useState(player.playerStats.enjoyment);\r\n  const [attention, setAttention] = useState(player.playerStats.involvement);\r\n  const [stress, setStress] = useState(player.playerStats.stress);\r\n\r\n  const getStatColor = (value: number, isStress: boolean = false) => {\r\n    if (isStress) {\r\n      // Stress: yellow -> orange -> red\r\n      if (value < 30) return \"#4CAF50\";\r\n      if (value < 60) return \"#ffff00\";\r\n      return \"#ff4d4d\";\r\n    } else {\r\n      // Regular stats: red -> orange -> green\r\n      if (value < 0.3) return \"#ff4d4d\";\r\n      if (value < 0.6) return \"#ffa500\";\r\n      return \"#4CAF50\";\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const updateStats = () => {\r\n      setEnjoyment(player.playerStats.enjoyment);\r\n      setAttention(player.playerStats.involvement);\r\n      setStress(player.playerStats.stress);\r\n      setCharacters(player.characters);\r\n      console.log(\"player updated \" + player.name);\r\n      console.log(player.playerStats);\r\n    };\r\n\r\n    uiManager.on(\"playerUpdate\", updateStats);\r\n\r\n    // Cleanup listener on unmount to avoid memory leaks\r\n    return () => {\r\n      uiManager.off(\"playerUpdate\", updateStats);\r\n    };\r\n  }, [uiManager, player.playerStats, player.characters, player.name]);\r\n\r\n  const playerLikes = player.preferences.filter((pref) => pref[1] > 0);\r\n  const playerHates = player.preferences.filter((pref) => pref[1] < 0);\r\n  const playerTraits = player.traits;\r\n\r\n  return (\r\n    <div\r\n      className=\"player-display\"\r\n      onMouseEnter={() => setShowPlayerTooltip(true)}\r\n      onMouseLeave={() => setShowPlayerTooltip(false)}\r\n      onClick={() =>\r\n        uiManager.showBasicNotebook(NOTEBOOK_CATEGORY.PLAYER, player)\r\n      }\r\n    >\r\n      <div className=\"character-level-icon-column\">\r\n        <div className=\"player-diamond-holder\">\r\n          <div\r\n            className=\"player-diamond\"\r\n            style={{\r\n              backgroundColor: delightColors2[player.playerStats.enjoyment],\r\n              borderColor: delightBorderColors2[player.playerStats.enjoyment],\r\n            }}\r\n          ></div>\r\n        </div>\r\n        <div className=\"player-icon-container\">\r\n          <CImage imageId={player.icon} />\r\n        </div>\r\n        <div className=\"character-level\">\r\n          <FillBar\r\n            filledSegments={player.playerStats.experience}\r\n            totalSegments={PLAYER_EXP_LEVEL[player.playerStats.level]}\r\n            theme=\"player-level\"\r\n            label={`LEVEL ${player.playerStats.level}`}\r\n          />\r\n        </div>\r\n      </div>\r\n      <div className=\"character-icons\">\r\n        {characters.map((char, index) => (\r\n          <div key={char.id} className=\"character-icon-container\">\r\n            {showCharacterTooltip === index && (\r\n              <div className=\"character-tooltip\">\r\n                <div className=\"tooltip-header\">{char.name}</div>\r\n                <div className=\"tooltip-content\">\r\n                  <AttributeDisplay\r\n                    hero={char}\r\n                    category={ATTRIBUTE_CONTRIBUTOR.ALL}\r\n                    showAttributeLoss={true}\r\n                    overviewDisplay={true}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div\r\n              className=\"character-icon\"\r\n              onMouseEnter={() => setShowCharacterTooltip(index)}\r\n              onMouseLeave={() => setShowCharacterTooltip(null)}\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                uiManager.showBasicNotebook(NOTEBOOK_CATEGORY.CHARACTER, char);\r\n              }}\r\n            >\r\n              <CImage imageId={char.icon} />\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"player-stats\">\r\n        <div className=\"player-stat-label name\">{player.name}</div>\r\n        <div\r\n          className=\"player-stat-label\"\r\n          style={{\r\n            color: getStatColor(enjoyment / player.playerStats.maxEnjoyment),\r\n          }}\r\n        >\r\n          attitude\r\n        </div>\r\n        <div className=\"stat-bar\">\r\n          <div\r\n            className=\"fill happiness\"\r\n            style={{\r\n              width: `${(enjoyment / 5) * 100}%`,\r\n              backgroundColor: getStatColor(\r\n                enjoyment / player.playerStats.maxEnjoyment\r\n              ),\r\n            }}\r\n          />\r\n        </div>\r\n        <div\r\n          className=\"player-stat-label\"\r\n          style={{\r\n            color: getStatColor(attention / player.playerStats.maxInvolvement),\r\n          }}\r\n        >\r\n          attention\r\n        </div>\r\n        <div className=\"stat-bar\">\r\n          <div\r\n            className=\"fill attention\"\r\n            style={{\r\n              width: `${(attention / 5) * 100}%`,\r\n              backgroundColor: getStatColor(\r\n                attention / player.playerStats.maxInvolvement\r\n              ),\r\n            }}\r\n          />\r\n        </div>\r\n        <div\r\n          className=\"player-stat-label\"\r\n          style={{\r\n            color: getStatColor(\r\n              Math.max(0, stress - player.playerStats.stressBuffer),\r\n              true\r\n            ),\r\n          }}\r\n        >\r\n          stress\r\n        </div>\r\n        <div>\r\n          <div className=\"stat-item stress\">\r\n            <div\r\n              className=\"stress-value\"\r\n              style={{\r\n                color: getStatColor(\r\n                  Math.max(0, stress - player.playerStats.stressBuffer),\r\n                  true\r\n                ),\r\n              }}\r\n            >\r\n              {Math.max(\r\n                0,\r\n                player.playerStats.stress - player.playerStats.stressBuffer\r\n              )}\r\n              %\r\n            </div>\r\n            <div className=\"stress-buffer\">\r\n              {player.playerStats.stress < player.playerStats.stressBuffer && (\r\n                <div className=\"stress-buffer-value\">\r\n                  {\"[\"}\r\n                  {Math.max(\r\n                    0,\r\n                    player.playerStats.stressBuffer - player.playerStats.stress\r\n                  )}\r\n                  {\"]\"}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {showPlayerTooltip && showCharacterTooltip === null && (\r\n        <div className=\"player-tooltip\">\r\n          <div className=\"tooltip-header\">{player.name}</div>\r\n          <div className=\"tooltip-content\">\r\n            Likes:\r\n            <div className=\"preference-list\">\r\n              {playerLikes.map((like, index) => (\r\n                <div key={index} className=\"text-pill preference-item like\">\r\n                  {like[0].name}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n          <div className=\"tooltip-content\">\r\n            Hates:\r\n            <div className=\"preference-list\">\r\n              {playerHates.map((hate, index) => (\r\n                <div key={index} className=\"text-pill preference-item hate\">\r\n                  {hate[0].name}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n          {playerTraits.length > 0 && (\r\n            <div className=\"tooltip-content\">\r\n              Player Traits:\r\n              <div className=\"preference-list\">\r\n                {playerTraits.map((trait, index) => (\r\n                  <div key={index} className=\"preference-item trait \">\r\n                    {trait.name}:<div>{trait.description}</div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PlayerDisplay;\r\n","import React, { useState } from 'react';\r\nimport { useCharacterManager, useAppManager, useCampaignManager } from '../managerContexts';\r\nimport FillBar from './fillBar';\r\nimport { ATTRIBUTE_TYPE } from '../../models';\r\nimport DiceScore from './DiceScore';\r\n\r\ninterface TreasureDisplayProps {\r\n  treasureLevel: number;\r\n  treasurePoints: number;\r\n}\r\n\r\n\r\n\r\nconst TreasureDisplay: React.FC<TreasureDisplayProps> = ({treasureLevel, treasurePoints}) => {\r\n   const appManager = useAppManager();\r\n    const partyManager = appManager.getPartyManager();\r\n   // const campaignManager = useCampaignManager();\r\n\r\n  // Calculate current level and next threshold\r\n  while (partyManager.getTreasureThreshold(treasureLevel + 1) <= treasurePoints) {\r\n    treasureLevel++;\r\n  }\r\n  \r\n  const nextThreshold = partyManager.getTreasureThreshold(treasureLevel + 1);\r\n  const previousThreshold = partyManager.getTreasureThreshold(treasureLevel);\r\n  const progressToNext = (treasurePoints - previousThreshold) / (nextThreshold - previousThreshold);\r\n  \r\n  const nextReward = partyManager.getTreasureReward(treasureLevel);\r\n\r\n  return (\r\n    <div className=\"treasure-display-container\">\r\n      <div className=\"treasure-header\">\r\n        <span className=\"treasure-title\">TREASURE</span>\r\n      </div>\r\n      \r\n      <div className=\"treasure-reward\">\r\n       \r\n        <span className=\"reward-value\">\r\n          {nextReward.type === 'score' ? (\r\n            <DiceScore\r\n              score={nextReward.value}\r\n             />\r\n          ): (\r\n            <span>+{nextReward.value} Attitude</span>)}\r\n          \r\n        </span>\r\n      </div>\r\n      \r\n      <div className=\"treasure-progress\">\r\n        <span className=\"progress-text\">\r\n          {treasurePoints}/{nextThreshold}\r\n        </span>\r\n        <FillBar \r\n          totalSegments={nextThreshold}\r\n          filledSegments={treasurePoints}\r\n          theme={\"treasure\"}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TreasureDisplay;","import React from \"react\";\r\nimport { Character } from \"../../models\";\r\nimport {\r\n\tgetCharacterReadinessLevel,\r\n\tgetCharacterReadinessSymbol,\r\n\tCHARACTER_READINESS_LEVEL,\r\n} from \"../../consts/characterConsts\";\r\nimport \"./LevelUpButton.scss\";\r\n\r\ninterface LevelUpButtonProps {\r\n\tcharacters: Character[];\r\n\tonClick: () => void;\r\n}\r\n\r\nconst LevelUpButton: React.FC<LevelUpButtonProps> = ({\r\n\tcharacters,\r\n\tonClick,\r\n}) => {\r\n\tconst getReadinessClass = (experience: number): string => {\r\n\t\tconst level = getCharacterReadinessLevel(experience);\r\n\t\tswitch (level) {\r\n\t\t\tcase CHARACTER_READINESS_LEVEL.VERY_UNREADY:\r\n\t\t\t\treturn \"unready2\";\r\n\t\t\tcase CHARACTER_READINESS_LEVEL.UNREADY:\r\n\t\t\t\treturn \"unready1\";\r\n\t\t\tcase CHARACTER_READINESS_LEVEL.READY:\r\n\t\t\t\treturn \"ready\";\r\n\t\t\tcase CHARACTER_READINESS_LEVEL.PERFECT:\r\n\t\t\t\treturn \"perfect\";\r\n\t\t\tcase CHARACTER_READINESS_LEVEL.OVERREADY:\r\n\t\t\t\treturn \"overready\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"unknown\";\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"level-up-button\" onClick={onClick}>\r\n\t\t\t<div className=\"inner-content\">\r\n\t\t\t\t<div className=\"level-up-label\">Level Up!</div>\r\n\t\t\t\t<div className=\"character-readiness-row\">\r\n\t\t\t\t\t{characters.map((character, index) => (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tkey={character.id}\r\n\t\t\t\t\t\t\tclassName={`readiness-symbol ${getReadinessClass(\r\n\t\t\t\t\t\t\t\tcharacter.experience\r\n\t\t\t\t\t\t\t)}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{getCharacterReadinessSymbol(character.experience)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default LevelUpButton;\r\n","import React, { useState } from 'react';\r\nimport { Character } from '../../models';\r\nimport { \r\n  getCharacterReadinessLevel, \r\n  getCharacterReadinessClass,\r\n  CHARACTER_READINESS_THRESHOLDS \r\n} from '../../consts/characterConsts';\r\nimport CImage from './cimage';\r\nimport RangedFillBar from './RangedFillBar';\r\nimport './CharacterLevelRow.scss';\r\n\r\ninterface CharacterLevelRowProps {\r\n  character: Character;\r\n  isSelected: boolean;\r\n  onToggle: () => void;\r\n}\r\n\r\nconst CharacterLevelRow: React.FC<CharacterLevelRowProps> = ({\r\n  character,\r\n  isSelected,\r\n  onToggle\r\n}) => {\r\n  const [hoverTooltip, setHoverTooltip] = useState<string>('');\r\n\r\n  const ranges = [\r\n    {\r\n      start: 0,\r\n      end: CHARACTER_READINESS_THRESHOLDS.VERY_UNREADY - 1,\r\n      backgroundColor: '#ffcdd2',\r\n      fillColor: '#f44336',\r\n      label: 'Very Unready: All other players -2 happiness'\r\n    },\r\n    {\r\n      start: CHARACTER_READINESS_THRESHOLDS.VERY_UNREADY,\r\n      end: CHARACTER_READINESS_THRESHOLDS.UNREADY - 1,\r\n      backgroundColor: '#ffe0b2',\r\n      fillColor: '#ff9800',\r\n      label: 'Unready: All other players -1 happiness'\r\n    },\r\n    {\r\n      start: CHARACTER_READINESS_THRESHOLDS.READY_START,\r\n      end: CHARACTER_READINESS_THRESHOLDS.READY_END,\r\n      backgroundColor: '#c8e6c9',\r\n      fillColor: '#8bc34a',\r\n      label: 'Ready: +1 Happiness'\r\n    },\r\n    {\r\n      start: CHARACTER_READINESS_THRESHOLDS.PERFECT_START,\r\n      end: CHARACTER_READINESS_THRESHOLDS.PERFECT_END,\r\n      backgroundColor: '#4caf50',\r\n      fillColor: '#2e7d32',\r\n      label: 'Perfect: +2 Happiness'\r\n    },\r\n    {\r\n      start: CHARACTER_READINESS_THRESHOLDS.READY_SECOND_START,\r\n      end: CHARACTER_READINESS_THRESHOLDS.READY_SECOND_END,\r\n      backgroundColor: '#c8e6c9',\r\n      fillColor: '#8bc34a',\r\n      label: 'Ready: +1 Happiness'\r\n    },\r\n    {\r\n      start: CHARACTER_READINESS_THRESHOLDS.OVERREADY,\r\n      end: 100,\r\n      backgroundColor: '#ffab91',\r\n      fillColor: '#ff5722',\r\n      label: 'Overready: +0 Happiness (-1 Happiness when OTHER Player\\'s Characters level up)'\r\n    }\r\n  ];\r\n\r\n  const handleHover = (rangeLabel: string) => {\r\n    setHoverTooltip(`Level Up: Full Attention\\n${rangeLabel}`);\r\n  };\r\n\r\n  const handleLeave = () => {\r\n    setHoverTooltip('');\r\n  };\r\n\r\n  const readinessClass = getCharacterReadinessClass(character.experience);\r\n\r\n  return (\r\n    <div className=\"character-level-row\">\r\n      <button \r\n        className={`character-toggle ${isSelected ? 'selected' : ''} ${readinessClass}`}\r\n        onClick={onToggle}\r\n      >\r\n        <div className=\"character-icon\">\r\n          <CImage imageId={character.icon} />\r\n        </div>\r\n        <div className=\"character-name\">{character.name}</div>\r\n      </button>\r\n      \r\n      <div className={`experience-bar ${isSelected ? 'selected' : ''}`}>\r\n        <RangedFillBar\r\n          totalSegments={100}\r\n          filledSegments={character.experience}\r\n          ranges={ranges}\r\n          onHover={handleHover}\r\n          onLeave={handleLeave}\r\n        />\r\n      </div>\r\n      \r\n      {hoverTooltip && (\r\n        <div className=\"tooltip\">\r\n          {hoverTooltip.split('\\n').map((line, index) => (\r\n            <div key={index}>{line}</div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CharacterLevelRow;\r\n","import React from 'react';\r\nimport { Player } from '../../models';\r\nimport CharacterLevelRow from './CharacterLevelRow';\r\nimport CImage from './cimage';\r\nimport './PlayerCharacterLevelRow.scss';\r\n\r\ninterface PlayerCharacterLevelRowProps {\r\n  player: Player;\r\n  selectedCharacters: Set<number>;\r\n  onCharacterToggle: (characterId: number) => void;\r\n}\r\n\r\nconst PlayerCharacterLevelRow: React.FC<PlayerCharacterLevelRowProps> = ({\r\n  player,\r\n  selectedCharacters,\r\n  onCharacterToggle\r\n}) => {\r\n  \r\n  const hasSelectedCharacter = player.characters.some(char => \r\n    selectedCharacters.has(char.id)\r\n  );\r\n\r\n  return (\r\n    <div className={`player-character-level-row ${hasSelectedCharacter ? 'highlighted' : ''}`}>\r\n      <div className=\"player-info\">\r\n        <div className=\"player-icon\">\r\n          <CImage imageId={player.icon} />\r\n        </div>\r\n        <div className=\"player-name\">{player.name}</div>\r\n      </div>\r\n      \r\n      <div className=\"characters-list\">\r\n        {player.characters.map((character) => (\r\n          <CharacterLevelRow\r\n            key={character.id}\r\n            character={character}\r\n            isSelected={selectedCharacters.has(character.id)}\r\n            onToggle={() => onCharacterToggle(character.id)}\r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PlayerCharacterLevelRow;\r\n","import React, { useState } from 'react';\r\nimport { Character, EffectData, ResultConfig, Attribute, ATTRIBUTE_TYPE } from '../../models';\r\nimport { \r\n  useAppManager, \r\n  useCharacterManager, \r\n  usePlayerManager \r\n} from '../managerContexts';\r\nimport { \r\n  getCharacterReadinessLevel, \r\n  CHARACTER_READINESS_LEVEL,\r\n  getClassAttributes\r\n} from '../../consts/characterConsts';\r\nimport ResultsDisplay from '../GameRoom/resultsDisplay';\r\nimport './PartyLevelUpModal.scss';\r\nimport PlayerCharacterLevelRow from './PlayerCharacterLevelRow';\r\n\r\ninterface PartyLevelUpModalProps {\r\n  onClose: () => void;\r\n}\r\n\r\nconst PartyLevelUpModal: React.FC<PartyLevelUpModalProps> = ({ onClose }) => {\r\n  const [selectedCharacters, setSelectedCharacters] = useState<Set<number>>(new Set());\r\n  const [showResults, setShowResults] = useState(false);\r\n  const [resultConfig, setResultConfig] = useState<ResultConfig | null>(null);\r\n  \r\n  const appManager = useAppManager();\r\n  const characterManager = useCharacterManager();\r\n  const playerManager = usePlayerManager();\r\n  const players = playerManager.getPlayers();\r\n\r\n  const handleCharacterToggle = (characterId: number) => {\r\n    const newSelected = new Set(selectedCharacters);\r\n    if (newSelected.has(characterId)) {\r\n      newSelected.delete(characterId);\r\n    } else {\r\n      newSelected.add(characterId);\r\n    }\r\n    setSelectedCharacters(newSelected);\r\n  };\r\n\r\n  const getAttributeGainForLevelUp = (character: Character): number => {\r\n    // Standard attribute gain per level - this could be made more sophisticated\r\n    // based on character class or level in the future\r\n    return 2;\r\n  };\r\n\r\n  const getAttributeGains = (character: Character): Attribute => {\r\n    // Get attributes at current level\r\n    const currentLevelAttributes = getClassAttributes(character.character_class, character.level);\r\n    \r\n    // Get attributes at next level\r\n    const nextLevelAttributes = getClassAttributes(character.character_class, character.level + 1);\r\n    \r\n    // Calculate the difference\r\n    const gains: Attribute = {\r\n      [ATTRIBUTE_TYPE.COMBAT]: nextLevelAttributes[ATTRIBUTE_TYPE.COMBAT] - currentLevelAttributes[ATTRIBUTE_TYPE.COMBAT],\r\n      [ATTRIBUTE_TYPE.MAGIC]: nextLevelAttributes[ATTRIBUTE_TYPE.MAGIC] - currentLevelAttributes[ATTRIBUTE_TYPE.MAGIC],\r\n      [ATTRIBUTE_TYPE.TOOLS]: nextLevelAttributes[ATTRIBUTE_TYPE.TOOLS] - currentLevelAttributes[ATTRIBUTE_TYPE.TOOLS]\r\n    };\r\n    \r\n    return gains;\r\n  };\r\n\r\n  const generateLevelUpEffects = (): EffectData[] => {\r\n    const effects: EffectData[] = [];\r\n    const partyManager = appManager.getPartyManager();\r\n\r\n    // Helper function to add results, combining effects for the same object\r\n    const addResult = (object: any, effect: string, className: string) => {\r\n      if (!object) {\r\n        return;\r\n      }\r\n\r\n      // Check if the object already has a result in the effects array\r\n      const existingResult = effects.find(result => result.object === object);\r\n      if (existingResult && existingResult.effects) {\r\n        existingResult.effects.push({\r\n          effect: effect,\r\n          class: className\r\n        });\r\n        return;\r\n      }\r\n\r\n      effects.push({\r\n        object: object,\r\n        effects: [{\r\n          effect: effect,\r\n          class: className\r\n        }]\r\n      });\r\n    };\r\n\r\n    // Get all characters that are leveling up\r\n    const charactersToLevelUp = Array.from(selectedCharacters)\r\n      .map(id => characterManager.getCharacterById(id))\r\n      .filter(char => char !== undefined) as Character[];\r\n\r\n    // Track which players own leveling characters\r\n    const playersWithLevelingChars = new Set<number>();\r\n    charactersToLevelUp.forEach(char => {\r\n      const owner = players.find(p => p.characters.some(c => c.id === char.id));\r\n      if (owner) {\r\n        playersWithLevelingChars.add(owner.id);\r\n      }\r\n    });\r\n\r\n    // Process each character leveling up\r\n    charactersToLevelUp.forEach(character => {\r\n      const owner = players.find(p => p.characters.some(c => c.id === character.id));\r\n      if (!owner) return;\r\n\r\n      const readinessLevel = getCharacterReadinessLevel(character.experience);\r\n      \r\n      // Show character level up details\r\n      const newLevel = character.level + 1;\r\n      const attributeGain = getAttributeGainForLevelUp(character);\r\n      const attributeGains = getAttributeGains(character);\r\n      \r\n      addResult(character, `Level ${newLevel}`, \"character-level\");\r\n      addResult(character, `+${attributeGain} Attributes`, \"character-attributes\");\r\n      \r\n      // Add attribute gains as a special effect that will render an AttributeDisplay\r\n      addResult(character, JSON.stringify(attributeGains), \"attribute-gains\");\r\n\r\n      // Give player full attention\r\n      owner.playerStats.involvement = owner.playerStats.maxInvolvement;\r\n      addResult(owner, \"Full Attention\", \"player-attention\");\r\n\r\n      // Give player experience for leveling up their character\r\n      playerManager.addPlayerExp(owner, 1);\r\n      addResult(owner, \"+1 Experience\", \"player-exp\");\r\n\r\n      // Apply happiness bonus based on readiness\r\n      let happinessBonus = 0;\r\n      switch (readinessLevel) {\r\n        case CHARACTER_READINESS_LEVEL.VERY_UNREADY:\r\n          happinessBonus = -2; // All other players lose happiness\r\n          break;\r\n        case CHARACTER_READINESS_LEVEL.UNREADY:\r\n          happinessBonus = -1; // All other players lose happiness\r\n          break;\r\n        case CHARACTER_READINESS_LEVEL.READY:\r\n          happinessBonus = 1;\r\n          break;\r\n        case CHARACTER_READINESS_LEVEL.PERFECT:\r\n          happinessBonus = 2;\r\n          break;\r\n        case CHARACTER_READINESS_LEVEL.OVERREADY:\r\n          happinessBonus = 0;\r\n          break;\r\n      }\r\n\r\n      if (readinessLevel === CHARACTER_READINESS_LEVEL.VERY_UNREADY || readinessLevel === CHARACTER_READINESS_LEVEL.UNREADY) {\r\n        // Apply negative happiness to all other players\r\n        players.forEach(player => {\r\n          if (player.id !== owner.id) {\r\n            partyManager.addEnjoyment(player, happinessBonus);\r\n            addResult(player, `${happinessBonus} Happiness`, \"player-attitude\");\r\n          }\r\n        });\r\n      } else if (happinessBonus > 0) {\r\n        // Apply positive happiness to the owner\r\n        partyManager.addEnjoyment(owner, happinessBonus);\r\n        addResult(owner, `+${happinessBonus} Happiness`, \"player-attitude\");\r\n      }\r\n    });\r\n\r\n    // Apply overready penalty to players with overready characters when OTHER players level up\r\n    players.forEach(player => {\r\n      const hasOverreadyChar = player.characters.some(char => \r\n        getCharacterReadinessLevel(char.experience) === CHARACTER_READINESS_LEVEL.OVERREADY\r\n      );\r\n      \r\n      // Only apply penalty if this player doesn't have any characters leveling up\r\n      if (hasOverreadyChar && !playersWithLevelingChars.has(player.id)) {\r\n        const numLevelingUp = charactersToLevelUp.length;\r\n        const penalty = -1 * numLevelingUp;\r\n        partyManager.addEnjoyment(player, penalty);\r\n        addResult(player, `${penalty} Happiness (Overready Penalty)`, \"player-attitude\");\r\n      }\r\n    });\r\n\r\n    // Add party exhaustion for level-up process\r\n    const exhaustionAmount = 25;\r\n    partyManager.exhaustParty(exhaustionAmount);\r\n    addResult('party', `+${exhaustionAmount} Exhaustion`, \"exhaustion\");\r\n\r\n    return effects;\r\n  };\r\n\r\n  const handleLevelUp = () => {\r\n    const effects = generateLevelUpEffects();\r\n    \r\n    // Actually level up the characters (reset experience)\r\n    selectedCharacters.forEach(charId => {\r\n      const character = characterManager.getCharacterById(charId);\r\n      if (character) {\r\n        character.level += 1;\r\n        character.experience = 0;\r\n      }\r\n    });\r\n\r\n    // Create ResultConfig for the existing ResultsDisplay component\r\n    const config: ResultConfig = {\r\n      results: effects,\r\n      title: \"Level Up Results\",\r\n      description: `Successfully leveled up ${selectedCharacters.size} character${selectedCharacters.size === 1 ? '' : 's'}!`,\r\n      tags: [], // No tags for level up results\r\n      travelOption: {\r\n        tagInstructions: \"\"\r\n      },\r\n      info: {}\r\n    };\r\n\r\n    setResultConfig(config);\r\n    setShowResults(true);\r\n  };\r\n\r\n  const handleBackdropClick = (e: React.MouseEvent) => {\r\n    if (e.target === e.currentTarget) {\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  const playersWithCharacters = players.filter(player => player.characters.length > 0);\r\n\r\n  const renderResultInfo = () => {\r\n    return null; // No additional info needed for level up results\r\n  };\r\n\r\n  if (showResults && resultConfig) {\r\n    return (\r\n      <div className=\"party-level-up-modal-overlay\" onClick={handleBackdropClick}>\r\n        <div className=\"party-level-up-modal-container\">\r\n          <div className=\"level-up-results-wrapper\">\r\n            <ResultsDisplay\r\n              resultConfig={resultConfig}\r\n              renderResultInfo={renderResultInfo}\r\n              onClose={onClose}\r\n              onTagClick={() => {}} // No tags to click for level up\r\n              selectedTags={[]} // No tags for level up\r\n              remainingClicks={0} // No tags to click\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"party-level-up-modal-overlay\" onClick={handleBackdropClick}>\r\n      <div className=\"party-level-up-modal-container\">\r\n        <div className=\"party-level-up-modal-header\">\r\n          <h2>Character Level Up</h2>\r\n          <button className=\"close-button\" onClick={onClose}>×</button>\r\n        </div>\r\n\r\n        <div className=\"party-level-up-modal-content\">\r\n          <p className=\"selection-prompt\">Select characters to level up:</p>\r\n          \r\n          <div className=\"players-list\">\r\n            {playersWithCharacters.map((player) => (\r\n              <PlayerCharacterLevelRow\r\n                key={player.id}\r\n                player={player}\r\n                selectedCharacters={selectedCharacters}\r\n                onCharacterToggle={handleCharacterToggle}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"party-level-up-modal-footer\">\r\n          <button\r\n            className={`confirm-button ${selectedCharacters.size === 0 ? 'exit' : ''}`}\r\n            onClick={selectedCharacters.size === 0 ? onClose : handleLevelUp}\r\n          >\r\n            {selectedCharacters.size === 0 ? 'Exit' : `Level Up ${selectedCharacters.size} Characters`}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PartyLevelUpModal;\r\n","import GameTable from \"./gameTable\";\r\nimport { useAppManager, usePlayerManager, useUiManager } from '../managerContexts';\r\n\r\nimport './gameRoom.scss';\r\nimport BottomBar from './bottomBar';\r\nimport RightSidebar from './rightSidebar';\r\nimport { useEffect, useState } from 'react';\r\n\r\nimport PlayerDisplay from './PlayerDisplay';\r\nimport TreasureDisplay from '../UI/treasureDisplay';\r\nimport LevelUpButton from '../UI/LevelUpButton';\r\nimport PartyLevelUpModal from '../UI/PartyLevelUpModal';\r\n\r\n\r\n\r\n\r\n\r\ninterface GameRoomProps {\r\n\toverviewMode?: boolean;\r\n}\r\n\r\nconst GameRoom: React.FC<GameRoomProps> = ({overviewMode = false}) => {\r\n\r\n\tconst appManager = useAppManager();\r\n\tconst playerManager = usePlayerManager(); \r\n\tconst players = playerManager.getPlayers();\r\n\r\n\tconst uiManager = useUiManager();\r\n\tconst partyManager = appManager.getPartyManager();\r\n\tconst [isLevelUpModalOpen, setIsLevelUpModalOpen] = useState(false);\r\n\t\r\n\t//const [partyScore, setPartyScore] = useState(partyManager.getPartyScore());\r\n\r\n\tconst [treasureLevel, setTreasureLevel] = useState(partyManager.getTreasureLevel());\r\n\tconst [treasurePoints, setTreasurePoints] = useState(partyManager.getTreasurePoints());\t\r\n\t//const [campaignScore, getCampaignScore] = useState(campaignManager.getCampaignScore());\r\n\r\n\r\n\t\r\n  useEffect(() => {\r\n\tconst forceUpdate = () => {\r\n\t  setTreasureLevel(partyManager.getTreasureLevel());\r\n\t  setTreasurePoints(partyManager.getTreasurePoints());\r\n\t};\r\n\tuiManager.on('playerUpdate', forceUpdate);\r\n\treturn () => {\r\n\t  uiManager.off('playerUpdate', forceUpdate);\r\n\t};\r\n  }, [uiManager, partyManager]);\r\n\r\n\r\n\r\n\tconst playerRowDisplay = () => {\r\n\t\treturn (\r\n\t\t<div className=\"gameroom-player-row\">\r\n\t\t\t{players.map((player) => (\r\n\t\t\t\t<PlayerDisplay \r\n\t\t\t\t\tkey={player.id}\r\n\t\t\t\t\tplayer={player}\r\n\t\t\t\t/>\r\n\t\t\t))}\r\n\t\t</div>)\r\n\t}\r\n\r\n\r\n\r\n  return (\r\n\t<div className=\"gameroom-container\">\r\n\t\t{/* New 2-Panel Layout */}\r\n\t\t<div className=\"gameroom-layout\">\r\n\t\t\t{/* Main Content Area */}\r\n\t\t\t<div className=\"gameroom-main-content\">\r\n\t\t\t\t{/* Top Container - Player Info */}\r\n\t\t\t\t<div className=\"gameroom-top-container\">\r\n\t\t\t\t\t<div className=\"player-display-container\">\r\n\t\t\t\t\t\t<div className=\"player-row\">\r\n\t\t\t\t\t\t\t{playerRowDisplay()}\r\n\t\t\t\t\t\t\t<LevelUpButton \r\n\t\t\t\t\t\t\t\tcharacters={appManager.getCharacterManager().getPlayerCharacters()} \r\n\t\t\t\t\t\t\t\tonClick={() => setIsLevelUpModalOpen(true)} \r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<TreasureDisplay \r\n\t\t\t\t\t\t\t\ttreasureLevel={treasureLevel}\r\n\t\t\t\t\t\t\t\ttreasurePoints={treasurePoints}\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t\t{/* Game Table Content */}\r\n\t\t\t\t{!overviewMode && (\r\n\t\t\t\t\t<div className=\"gameroom-table-container\">\r\n\t\t\t\t\t\t<GameTable />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\r\n\r\n\t\t\t\t)}\t{!overviewMode && (\r\n\t\t\t\t\r\n\t\t\t\t\t\t<BottomBar />\r\n\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\r\n\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t{/* Right Sidebar - Chat & DM Controls */}\r\n\t\t\t{!overviewMode && <RightSidebar />}\r\n\t\t</div>\r\n\t\t\r\n\t\t\r\n\t\t{isLevelUpModalOpen && (\r\n\t\t\t<PartyLevelUpModal \r\n\t\t\t\tonClose={() => setIsLevelUpModalOpen(false)}\r\n\t\t\t/>\r\n\t\t)}\r\n\r\n\r\n\t</div>\r\n  );\r\n}\r\n\r\nexport default GameRoom;","import React from 'react';\r\nimport './sessionControl.scss';\r\n\r\nimport EncounterOverview from './UI/encounterOverview';\r\nimport { CAMPAIGNS } from '../consts/campaigns';\r\nimport { useCampaignManager } from './managerContexts';\r\nimport CImage from './UI/cimage';\r\nimport GameRoom from './GameRoom/gameRoom';\r\nimport Chat from './UI/chat';\r\n\r\n\r\n\r\nconst SessionControlComponent: React.FC = () => {\r\n  \r\n  const campaignManager = useCampaignManager();\r\n\r\n  const encounterOverviewUi = () => {\r\n   \r\n      return (\r\n        <div className=\"temp\">temp</div>\r\n      )\r\n    \r\n  }\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"session-control-container\">\r\n        <GameRoom overviewMode={true}/>\r\n       <div className=\"encounter-overview\">\r\n          <EncounterOverview/>\r\n       </div>\r\n    \r\n   </div>\r\n  );\r\n}\r\n\r\nexport default SessionControlComponent;\r\n","import React from 'react';\nimport './sessionRun.scss';\nimport AppManager from '../managers/appManager';\nimport GameRoom from './GameRoom/gameRoom';\nimport DMScreen from './GameRoom/dmScreen';\n\ninterface SessionRunProps {\n  appManager: AppManager; \n}\n\nconst SessionRunComponent: React.FC<SessionRunProps> = ({appManager}) => {\n\n  return (\n    <div className=\"session-run-container\">\n      <GameRoom />\n\t\t\n\t\t\t\n    </div>\n  );\n}\n\nexport default SessionRunComponent;\n","import React, { useEffect } from 'react';\nimport './finalStats.scss';\nimport AppManager from '../managers/appManager';\n\ninterface FinalStatsProps {\n  appManager: AppManager; \n}\n\nconst FinalStatsComponent: React.FC<FinalStatsProps> = ({appManager}) => {\n\n  return (\n    <div className=\"final-stats-container\">\n       FINAL STATS\n    </div>\n  );\n}\n\nexport default FinalStatsComponent;\n","import React from 'react';\r\nimport './mainMenu.scss';\r\nimport AppManager from '../managers/appManager';\r\nimport { APP_STATE } from '../consts/states';\r\nimport NavBar from './UI/navBar';\r\nimport { NAV_ENTRY } from '../models';\r\nimport EncounterScenery from './UI/encounterScenery';\r\n\r\ninterface MainMenuProps {\r\n  appManager: AppManager; \r\n}\r\n\r\nconst MainMenuComponent: React.FC<MainMenuProps> = ({appManager}) => { \r\n\r\n\r\n  const handleQuickStart = () => {\r\n    appManager.initiateQuickStartSetup();\r\n    appManager.state = APP_STATE.SESSION_OVERVIEW;\r\n    }\r\n\r\n  return (\r\n    <div className=\"main-menu-container\">\r\n\r\n      <div className=\"main-menu-content\">\r\n        \r\n        <div className=\"main-menu-options\">\r\n         <NavBar buttonList={[NAV_ENTRY.PLAYER_RECRUITMENT, NAV_ENTRY.CHARACTER_ASSIGNMENT, NAV_ENTRY.CAMPAIGN]} highlight={NAV_ENTRY.PLAYER_RECRUITMENT}/>\r\n        </div>\r\n        <div className=\"game-start-container\">\r\n          <div className=\"buitton-container\">\r\n            <div className={`quickstart-button  nav-button`}  onClick={handleQuickStart} >Quick Start</div>\r\n          </div>\r\n          {/* <div className=\"button-container\">\r\n            <div className={`game-start-button  nav-button ${isStartDisabled() ? 'disabled' : ''}` }  onClick={handleGameStart} >Start</div>\r\n          </div>  */}\r\n        </div>\r\n      </div>\r\n\r\n          \r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MainMenuComponent;\r\n","import React, { useEffect, useState } from 'react';\r\nimport './ModeContainer.scss';\r\nimport PlayerRecruitmentComponent from './playerRecruitment';\r\nimport CharacterCreationComponent from './characterCreation';\r\nimport CampaignSetupComponent from './campaignSetup';\r\nimport SessionPrepComponent from './sessionControl';\r\nimport SessionRunComponent from './sessionRun';\r\nimport FinalStatsComponent from './finalStats';\r\nimport MainMenuComponent from './mainMenu';\r\nimport { APP_STATE } from '../consts/states';\r\nimport CImage from './UI/cimage';\r\nimport { useAppManager, useCampaignManager, useUiManager } from './managerContexts';\r\nimport CampaignManager from '../managers/campaignManager';\r\nimport BottomBar from './GameRoom/bottomBar';\r\n\r\n\r\ninterface ModeContainerProps {\r\n}\r\n\r\nconst ModeContainer: React.FC<ModeContainerProps> = ({}) => {\r\n\r\n  const appManager = useAppManager();\r\n\r\n  const [state, setState] = useState(appManager.state);\r\n  const [transitioning, setTransitioning] = useState(false);\r\n  const [transitionComplete, setTransitionComplete] = useState(false);\r\n\r\n  const [showImage, setShowImage] = useState(false);\r\n\r\n  const uiManager = useUiManager();\r\n  const dataManager = appManager.getDataManager();\r\n  const campaignManager = useCampaignManager();\r\n\r\n  useEffect(() => {\r\n    const handleStateChange = () => {\r\n      setTransitionComplete(false);\r\n      setTransitioning(false);\r\n      setState(appManager.state);\r\n      updateState(appManager.state);\r\n      \r\n    };\r\n\r\n    appManager.on('stateChange', handleStateChange);\r\n    return () => {\r\n      appManager.off('stateChange', handleStateChange);\r\n    };\r\n  \r\n  }, [appManager]);\r\n  \r\n\r\n  function updateState(state: APP_STATE) {\r\n\r\n    if(!uiManager) {return}\r\n\r\n    switch(state) {\r\n      case APP_STATE.MAIN_MENU:\r\n       \r\n      break;\r\n      case APP_STATE.PLAYER_RECRUITMENT:\r\n      case APP_STATE.CHARACTER_CREATION: \r\n      case APP_STATE.CAMPAIGN_SETUP:\r\n        setTransitioning(true);\r\n        setTimeout(() => {\r\n           setTransitioning(false);\r\n           setTransitionComplete(true);\r\n        }, 1000); \r\n      break;\r\n      case APP_STATE.SESSION_OVERVIEW:\r\n      break;\r\n      case APP_STATE.SESSION:\r\n        \r\n      break;\r\n      case APP_STATE.SCORE:\r\n        \r\n      break;\r\n    }\r\n   \r\n  }\r\n\r\n  function getModeComponent() {\r\n    switch(state) {\r\n      case APP_STATE.MAIN_MENU:\r\n        return( \r\n          <MainMenuComponent\r\n            appManager={appManager}\r\n          />\r\n         )\r\n      case APP_STATE.PLAYER_RECRUITMENT:\r\n       return( \r\n        <PlayerRecruitmentComponent\r\n          appManager={appManager}\r\n          playerManager={appManager.getPlayerManager()}\r\n        />\r\n       )\r\n      case APP_STATE.CHARACTER_CREATION:\r\n        return( \r\n        <CharacterCreationComponent/>\r\n        );\r\n      case APP_STATE.CAMPAIGN_SETUP:\r\n        return( \r\n        <CampaignSetupComponent\r\n          openCampaign={campaignManager.getOpenCampaignIndex()}\r\n        />\r\n        );\r\n      case APP_STATE.SESSION_OVERVIEW:\r\n        return( \r\n        <SessionPrepComponent\r\n         \r\n      />\r\n        );\r\n      case APP_STATE.SESSION:\r\n        return( \r\n        <SessionRunComponent\r\n          appManager={appManager}\r\n      />\r\n        );\r\n      case APP_STATE.SCORE:\r\n        return( \r\n        <FinalStatsComponent\r\n          appManager={appManager}\r\n      />\r\n        );\r\n    }\r\n    return (\r\n      <div>NOT YET IMPLEMENTED</div>\r\n    )\r\n  }\r\n\r\n  const getBackgroundClass = () => {\r\n    const transitionMode = dataManager.getStateProps().bg_transition_mode;\r\n    switch(transitionMode) {\r\n      case 'slide-left':\r\n        return `${transitioning ? 'slide-left' : ''} ${transitionComplete ? 'left' : ''}`;\r\n      case 'slide-right':\r\n        return `${transitioning ? 'slide-right' : ''} ${transitionComplete ? 'right' : ''}`;\r\n      case 'slide-down':\r\n        return `${transitioning ? 'slide-down' : ''} ${transitionComplete ? 'down' : ''}`;\r\n      default:\r\n        return '';\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"mode-container\">\r\n      <div className=\"bgImageContainer\">\r\n        <div className={`mode-background ${getBackgroundClass()}`}>\r\n            <div className='mode-background-image' style={{ backgroundRepeat: 'repeat' }}>\r\n              <CImage imageId={dataManager.getStateProps().background_image_id}/>\r\n            </div>\r\n          <div className='mode-background-overlay'>\r\n              <CImage imageId={dataManager.getStateProps().background_image_id}/>\r\n          </div>\r\n          <div className='mode-background-bottom'>\r\n              <CImage imageId={dataManager.getStateProps().secondary_bg_image_id}/>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className='mode-component'>\r\n            {getModeComponent()}\r\n        \r\n      </div>\r\n\r\n     \r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ModeContainer;\r\n","import React from 'react';\r\nimport { FlavorTagSource, FlavorTagTheme, ModalConfig } from '../../models';\r\nimport CImage from './cimage';\r\nimport './SetSceneModal.scss';\r\nimport TagPill from './TagPill';\r\n\r\ninterface SetSceneModalProps {\r\n  modalConfig: ModalConfig;\r\n  onClose: () => void;\r\n  onOptionSelect: (optionId: string) => void;\r\n}\r\n\r\nconst SetSceneModal: React.FC<SetSceneModalProps> = ({ modalConfig, onClose, onOptionSelect }) => {\r\n  if (!modalConfig.sceneData) return null;\r\n\r\n  const { location, encounter } = modalConfig.sceneData;\r\n\r\n  return (\r\n    <div className=\"modal-overlay\">\r\n      <div className=\"modal-container setscene\">\r\n        <div className=\"modal-header\">\r\n          <h2>{modalConfig.title}</h2>\r\n          <button className=\"close-button\" onClick={onClose}>×</button>\r\n        </div>\r\n        \r\n        <div className=\"setscene-content\">\r\n          <div className=\"setscene-image\">\r\n            <CImage imageId={location.icon} />\r\n          </div>\r\n          \r\n          <div className=\"setscene-info\">\r\n            <h3 className=\"location-name\">{location.name}</h3>\r\n            <p className=\"location-description\">{location.description}</p>\r\n            \r\n            <div className=\"encounter-info\">\r\n              <h4>Set the Scene</h4>\r\n              <p>Now that the Location is fully described, your players can imagine the details more clearly.</p>\r\n              <p>You will gain a multiplier during encounter scoring for the rest of this Encounter.</p>\r\n            </div>\r\n            \r\n            <div className=\"location-tags\">\r\n              \r\n              <div className=\"tags-grid\">\r\n                {location.tags.map((tag, index) => (\r\n                  <TagPill \r\n                    key={index}\r\n                    tag={tag}\r\n                    disabled={true}\r\n                    highlighted={false}\r\n                    showTooltip={false}\r\n                    theme={FlavorTagTheme.NONE}\r\n                    source={FlavorTagSource.LOCATION}\r\n                    className=\"setscene-tag\"/>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"setscene-actions\">\r\n          {modalConfig.options.map((option) => (\r\n            <button\r\n              key={option.id}\r\n              className=\"setscene-continue-button\"\r\n              onClick={() => onOptionSelect(option.id)}\r\n            >\r\n              {option.title}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SetSceneModal;\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport { ChatMessage, CHAT_TYPE } from \"../../models\";\r\nimport { useAppManager } from \"../managerContexts\";\r\nimport CImage from \"./cimage\";\r\nimport \"./ConversationSection.scss\";\r\n\r\ninterface ConversationSectionProps {\r\n\tmessages: ChatMessage[];\r\n\ttitle: string;\r\n\tonComplete: () => void;\r\n\tspeedUp: boolean;\r\n}\r\n\r\n// Conversation Display Component\r\ninterface ConversationDisplayProps {\r\n\tmessages: ChatMessage[];\r\n\tonComplete: () => void;\r\n\tspeedUp: boolean;\r\n}\r\n\r\nconst ConversationDisplay: React.FC<ConversationDisplayProps> = ({\r\n\tmessages,\r\n\tonComplete,\r\n\tspeedUp,\r\n}) => {\r\n\tconst [currentMessageIndex, setCurrentMessageIndex] = useState(0);\r\n\tconst [messageStates, setMessageStates] = useState<\r\n\t\tArray<{ text: string; complete: boolean }>\r\n\t>([]);\r\n\tconst intervalRef = useRef<NodeJS.Timeout | null>(null);\r\n\tconst uiManager = useAppManager().getUiManager();\r\n\tconst currentMessage = messages[currentMessageIndex];\r\n\r\n\t// Initialize message states\r\n\tuseEffect(() => {\r\n\t\tsetMessageStates(messages.map(() => ({ text: \"\", complete: false })));\r\n\t}, [messages]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!currentMessage) {\r\n\t\t\tonComplete();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst animateCurrentMessage = () => {\r\n\t\t\t// Split text into words while preserving spaces (same as main chat)\r\n\t\t\tconst words = currentMessage.message.split(/(?<=\\s)|(?=\\s)/);\r\n\t\t\tlet wordIndex = 0;\r\n\t\t\tlet visibleWords = words.map((word) => ({ word, visible: false }));\r\n\r\n\t\t\tconst animateWords = () => {\r\n\t\t\t\tif (wordIndex < words.length) {\r\n\t\t\t\t\tif (!visibleWords[wordIndex].word.match(/^\\s+$/)) {\r\n\t\t\t\t\t\tvisibleWords[wordIndex].visible = true;\r\n\t\t\t\t\t\tconst displayText = visibleWords\r\n\t\t\t\t\t\t\t.map(({ word, visible }) =>\r\n\t\t\t\t\t\t\t\tword.match(/^\\s+$/)\r\n\t\t\t\t\t\t\t\t\t? word\r\n\t\t\t\t\t\t\t\t\t: `<span class=\"chat-word ${\r\n\t\t\t\t\t\t\t\t\t\t\tvisible ? \"visible\" : \"\"\r\n\t\t\t\t\t\t\t\t\t  }\">${word}</span>`\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.join(\"\");\r\n\r\n\t\t\t\t\t\tsetMessageStates((prev) => {\r\n\t\t\t\t\t\t\tconst newStates = [...prev];\r\n\t\t\t\t\t\t\tnewStates[currentMessageIndex] = {\r\n\t\t\t\t\t\t\t\ttext: displayText,\r\n\t\t\t\t\t\t\t\tcomplete: false,\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\treturn newStates;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\twordIndex++;\r\n\r\n\t\t\t\t\tconst delay = speedUp ? 5 : 10; // Match main chat's 10ms interval\r\n\t\t\t\t\tintervalRef.current = setTimeout(animateWords, delay);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Message animation complete\r\n\t\t\t\t\tsetMessageStates((prev) => {\r\n\t\t\t\t\t\tconst newStates = [...prev];\r\n\t\t\t\t\t\tnewStates[currentMessageIndex] = {\r\n\t\t\t\t\t\t\ttext: currentMessage.message,\r\n\t\t\t\t\t\t\tcomplete: true,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\treturn newStates;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (currentMessageIndex < messages.length - 1) {\r\n\t\t\t\t\t\t// Move to next message after a pause\r\n\t\t\t\t\t\tconst pauseDelay = speedUp ? 50 : 800;\r\n\t\t\t\t\t\tintervalRef.current = setTimeout(() => {\r\n\t\t\t\t\t\t\tsetCurrentMessageIndex((prev) => prev + 1);\r\n\t\t\t\t\t\t}, pauseDelay);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// All messages complete\r\n\t\t\t\t\t\tsetTimeout(() => onComplete(), 500);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tanimateWords();\r\n\t\t};\r\n\r\n\t\tanimateCurrentMessage();\r\n\r\n\t\treturn () => {\r\n\t\t\tif (intervalRef.current) {\r\n\t\t\t\tclearTimeout(intervalRef.current);\r\n\t\t\t}\r\n\t\t};\r\n\t}, [\r\n\t\tcurrentMessageIndex,\r\n\t\tcurrentMessage,\r\n\t\tspeedUp,\r\n\t\tmessages.length,\r\n\t\tonComplete,\r\n\t]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (speedUp) {\r\n\t\t\t// Complete all animations immediately\r\n\t\t\tif (intervalRef.current) {\r\n\t\t\t\tclearTimeout(intervalRef.current);\r\n\t\t\t}\r\n\t\t\tsetMessageStates(\r\n\t\t\t\tmessages.map((msg) => ({ text: msg.message, complete: true }))\r\n\t\t\t);\r\n\t\t\tsetCurrentMessageIndex(messages.length - 1);\r\n\t\t\tsetTimeout(() => onComplete(), 100);\r\n\t\t}\r\n\t}, [speedUp, messages, onComplete]);\r\n\r\n\tconst getSpeakerClass = (speaker: any) => {\r\n\t\tif (speaker.type === CHAT_TYPE.DM) return \"dm\";\r\n\t\tif (speaker.type === CHAT_TYPE.PLAYER) return \"player\";\r\n\t\treturn \"character\";\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"conversation-display chat-expanded-messages\">\r\n\t\t\t{messages.map((message, messageIdx) => {\r\n\t\t\t\tconst messageState = messageStates[messageIdx];\r\n\t\t\t\tconst shouldShow = messageIdx <= currentMessageIndex;\r\n\r\n\t\t\t\tif (!shouldShow) return null;\r\n\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tkey={messageIdx}\r\n\t\t\t\t\t\tclassName={`chat-message-container ${getSpeakerClass(\r\n\t\t\t\t\t\t\tmessage.speaker\r\n\t\t\t\t\t\t)} ${messageState?.complete ? \"complete\" : \"current\"}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"chat-message-display\">\r\n\t\t\t\t\t\t\t<div className=\"chat-message-speaker-container\">\r\n\t\t\t\t\t\t\t\t<div className=\"chat-message-speaker\">\r\n\t\t\t\t\t\t\t\t\t{uiManager.getMessageSpeakerName(message.speaker)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"chat-message-icon\">\r\n\t\t\t\t\t\t\t\t\t<CImage\r\n\t\t\t\t\t\t\t\t\t\timageId={\r\n\t\t\t\t\t\t\t\t\t\t\tuiManager.getMessageIconId(message.speaker) || \"icon_dm\"\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"chat-messager-content\">\r\n\t\t\t\t\t\t\t\t<div className=\"chat-message-text\">\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"chat-message-words\"\r\n\t\t\t\t\t\t\t\t\t\tdangerouslySetInnerHTML={{\r\n\t\t\t\t\t\t\t\t\t\t\t__html: messageState?.text || message.message,\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t})}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst ConversationSection: React.FC<ConversationSectionProps> = ({\r\n\tmessages,\r\n\ttitle,\r\n\tonComplete,\r\n\tspeedUp,\r\n}) => {\r\n\tconst hasMessages = messages.length > 0;\r\n\r\n\treturn (\r\n\t\t<div className=\"conversation-section\">\r\n\t\t\t{/* <div className=\"section-header\">\r\n\t\t\t\t<h3>{title}</h3>\r\n\t\t\t</div> */}\r\n\t\t\t<div className=\"conversation-content\">\r\n\t\t\t\t{hasMessages ? (\r\n\t\t\t\t\t<ConversationDisplay\r\n\t\t\t\t\t\tmessages={messages}\r\n\t\t\t\t\t\tonComplete={onComplete}\r\n\t\t\t\t\t\tspeedUp={speedUp}\r\n\t\t\t\t\t/>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<div className=\"no-conversation\">\r\n\t\t\t\t\t\t<p>This tag was discovered without recorded conversation.</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ConversationSection;","import { ScoreEntry } from '../models';\r\n\r\n/**\r\n * Calculate the total score from an array of ScoreEntry objects.\r\n * Handles both additive points and multiplier entries correctly.\r\n * \r\n * @param scoreEntries Array of score entries to calculate total from\r\n * @returns Total calculated score\r\n */\r\nexport function calculateTotalScore(scoreEntries: ScoreEntry[]): number {\r\n  return scoreEntries.reduce((sum, entry) => {\r\n    if (entry.multiplier) {\r\n      return sum * entry.points;\r\n    }\r\n    return sum + entry.points;\r\n  }, 0);\r\n}\r\n\r\n/**\r\n * Get score entries filtered by type (additive vs multiplier)\r\n * \r\n * @param scoreEntries Array of score entries to filter\r\n * @param isMultiplier Whether to return multiplier entries (true) or additive entries (false)\r\n * @returns Filtered array of score entries\r\n */\r\nexport function getScoreEntriesByType(scoreEntries: ScoreEntry[], isMultiplier: boolean): ScoreEntry[] {\r\n  return scoreEntries.filter(entry => Boolean(entry.multiplier) === isMultiplier);\r\n}\r\n\r\n/**\r\n * Get only the additive score entries (non-multiplier)\r\n * \r\n * @param scoreEntries Array of score entries to filter\r\n * @returns Array of additive score entries\r\n */\r\nexport function getAdditiveScoreEntries(scoreEntries: ScoreEntry[]): ScoreEntry[] {\r\n  return getScoreEntriesByType(scoreEntries, false);\r\n}\r\n\r\n/**\r\n * Get only the multiplier score entries\r\n * \r\n * @param scoreEntries Array of score entries to filter\r\n * @returns Array of multiplier score entries\r\n */\r\nexport function getMultiplierScoreEntries(scoreEntries: ScoreEntry[]): ScoreEntry[] {\r\n  return getScoreEntriesByType(scoreEntries, true);\r\n}\r\n\r\n/**\r\n * Calculate just the additive portion of the score (before multipliers)\r\n * \r\n * @param scoreEntries Array of score entries\r\n * @returns Sum of all additive points\r\n */\r\nexport function calculateAdditiveScore(scoreEntries: ScoreEntry[]): number {\r\n  return getAdditiveScoreEntries(scoreEntries).reduce((sum, entry) => sum + entry.points, 0);\r\n}\r\n\r\n/**\r\n * Calculate the final multiplier from all multiplier entries\r\n * \r\n * @param scoreEntries Array of score entries\r\n * @returns Final multiplier value (product of all multiplier points)\r\n */\r\nexport function calculateMultiplier(scoreEntries: ScoreEntry[]): number {\r\n  return getMultiplierScoreEntries(scoreEntries).reduce((product, entry) => product * entry.points, 1);\r\n}\r\n","import React, { useEffect, useState, useMemo } from 'react';\r\nimport CImage from './cimage';\r\nimport './RewardFillBar.scss';\r\nimport DiceScore from './DiceScore';\r\n\r\ninterface RewardFillBarProps {\r\n    initialCampaignScore: number; // Current campaign score before adding new points\r\n    newScore: number; // New points being added this encounter\r\n    onRewardClaim: (rewardIndex: number) => void;\r\n    claimedRewards: number[]; // Array of reward indices that have been claimed\r\n    onDMPointClaim?: (dmPointIndex: number) => void; // Callback for claiming DM points\r\n    claimedDMPoints?: number[]; // Array of DM point indices that have been claimed\r\n    showScore?: boolean; // Whether to show the updated score (default: true)\r\n    onThresholdCrossed?: (threshold: number) => void; // Callback when crossing reward thresholds\r\n}\r\n\r\nconst RewardFillBar: React.FC<RewardFillBarProps> = ({ \r\n    initialCampaignScore, \r\n    newScore,\r\n    onRewardClaim, \r\n    claimedRewards = [],\r\n    onDMPointClaim,\r\n    claimedDMPoints = [],\r\n    showScore = true,\r\n    onThresholdCrossed\r\n}) => {\r\n    // Calculate final campaign score\r\n    const finalCampaignScore = initialCampaignScore + newScore;\r\n    \r\n    // Animation state - starts at initial campaign score, animates to final\r\n    const [animatingScore, setAnimatingScore] = useState(initialCampaignScore);\r\n    const [flashingThresholds, setFlashingThresholds] = useState<number[]>([]);\r\n    \r\n    // Constants for the reward system\r\n    const MAX_SCORE = 120;\r\n    const D6_INTERVAL = 4;\r\n    const REWARD_INTERVAL = 24; // D20 interval and reward threshold\r\n    \r\n    // Use displayed score for calculations\r\n    const displayedScore = showScore ? finalCampaignScore : initialCampaignScore;\r\n    \r\n    // Calculate which reward thresholds have been reached\r\n    const rewardThresholds = useMemo(() => [24, 48, 72, 96, 120], []);\r\n    const availableRewards = rewardThresholds\r\n        .map((threshold, index) => ({ threshold, index }))\r\n        .filter(({ threshold, index }) => \r\n            displayedScore >= threshold && !claimedRewards.includes(index)\r\n        );\r\n    \r\n    // Calculate which DM point thresholds have been reached\r\n    const dmPointThresholds = useMemo(() => [12, 36, 60, 84, 108], []); // Every 12 points, excluding quest reward points\r\n    const availableDMPoints = dmPointThresholds\r\n        .map((threshold, index) => ({ threshold, index }))\r\n        .filter(({ threshold, index }) => \r\n            displayedScore >= threshold && !claimedDMPoints.includes(index)\r\n        );\r\n    \r\n    // Check if any reward is available but not claimed\r\n    const hasUnclaimedReward = availableRewards.length > 0;\r\n    const hasUnclaimedDMPoint = availableDMPoints.length > 0;\r\n    \r\n    // Animate score changes and detect threshold crossings\r\n    useEffect(() => {\r\n        if (!showScore) {\r\n            // During scoring animation, keep at initial score\r\n            setAnimatingScore(initialCampaignScore);\r\n            return;\r\n        }\r\n        \r\n        // Animate from initial to final campaign score\r\n        const targetScore = finalCampaignScore;\r\n        if (targetScore !== animatingScore) {\r\n            // Check for threshold crossings during animation\r\n            const allThresholds = [...rewardThresholds, ...dmPointThresholds];\r\n            const thresholdsCrossed = allThresholds.filter(threshold => \r\n                animatingScore < threshold && targetScore >= threshold\r\n            );\r\n            \r\n            if (thresholdsCrossed.length > 0) {\r\n                // Flash the crossed thresholds\r\n                setFlashingThresholds(thresholdsCrossed);\r\n                thresholdsCrossed.forEach(threshold => {\r\n                    onThresholdCrossed?.(threshold);\r\n                });\r\n                \r\n                // Remove flash after animation\r\n                setTimeout(() => setFlashingThresholds([]), 1500);\r\n            }\r\n            \r\n            // Animate to target score with delay\r\n            const delay = (animatingScore === initialCampaignScore && targetScore > initialCampaignScore) ? 500 : 100;\r\n            const timer = setTimeout(() => {\r\n                setAnimatingScore(targetScore);\r\n            }, delay);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [finalCampaignScore, animatingScore, showScore, initialCampaignScore, rewardThresholds, dmPointThresholds, onThresholdCrossed]);\r\n    \r\n    // Calculate fill percentage (0-100%)\r\n    const fillPercentage = Math.min((animatingScore / MAX_SCORE) * 100, 100);\r\n    const bubblePosition = fillPercentage;\r\n    \r\n    // Generate milestone markers\r\n    const milestones = useMemo(() => {\r\n        const markers = [];\r\n        \r\n        // Add d6 markers every 4 points\r\n        for (let i = D6_INTERVAL; i <= MAX_SCORE; i += D6_INTERVAL) {\r\n            if (i % REWARD_INTERVAL !== 0) { // Don't overlap with d20 markers\r\n                // Check if this is a DM point threshold\r\n                const dmPointIndex = dmPointThresholds.indexOf(i);\r\n                const isDMPoint = dmPointIndex !== -1;\r\n                const isAvailableDMPoint = isDMPoint && displayedScore >= i && !claimedDMPoints.includes(dmPointIndex);\r\n                \r\n                markers.push({\r\n                    position: (i / MAX_SCORE) * 100,\r\n                    type: 'd6' as const,\r\n                    score: i,\r\n                    isDMPoint: isDMPoint,\r\n                    isAvailableDMPoint: isAvailableDMPoint\r\n                });\r\n            }\r\n        }\r\n        \r\n        // Add d20 markers every 24 points (reward thresholds)\r\n        for (let i = REWARD_INTERVAL; i <= MAX_SCORE; i += REWARD_INTERVAL) {\r\n            markers.push({\r\n                position: (i / MAX_SCORE) * 100,\r\n                type: 'd20' as const,\r\n                score: i\r\n            });\r\n        }\r\n        \r\n        return markers;\r\n    }, [MAX_SCORE, D6_INTERVAL, REWARD_INTERVAL, dmPointThresholds, displayedScore, claimedDMPoints]);\r\n    \r\n    const handleRewardClaim = () => {\r\n        if (hasUnclaimedReward && availableRewards.length > 0) {\r\n            // Claim the first available reward\r\n            const firstAvailableReward = availableRewards[0];\r\n            onRewardClaim(firstAvailableReward.index);\r\n        }\r\n    };\r\n    \r\n    const handleDMPointClaim = () => {\r\n        if (hasUnclaimedDMPoint && availableDMPoints.length > 0 && onDMPointClaim) {\r\n            // Claim the first available DM point\r\n            const firstAvailableDMPoint = availableDMPoints[0];\r\n            onDMPointClaim(firstAvailableDMPoint.index);\r\n        }\r\n    };\r\n    \r\n    return (\r\n        <div className=\"reward-fill-bar\">\r\n            <div className=\"reward-fill-container\">\r\n                {/* Custom progress bar */}\r\n                <div className=\"reward-progress-bar\">\r\n                    <div className=\"progress-track\">\r\n                        <div \r\n                            className=\"progress-fill\"\r\n                            style={{ width: `${fillPercentage}%` }}\r\n                        />\r\n                    </div>\r\n                    \r\n                    {/* Milestone markers */}\r\n                    <div className=\"milestone-markers\">\r\n                        {milestones.map((milestone, index) => (\r\n                            <div\r\n                                key={index}\r\n                                className={`milestone-marker ${milestone.type} ${\r\n                                    flashingThresholds.includes(milestone.score) ? 'flashing' : ''\r\n                                } ${\r\n                                    milestone.isDMPoint ? 'dmpoint-dice' : ''\r\n                                } ${\r\n                                    milestone.isAvailableDMPoint ? 'available-dmpoint' : ''\r\n                                }`}\r\n                                style={{ left: `${milestone.position}%` }}\r\n                                onClick={milestone.isAvailableDMPoint ? handleDMPointClaim : undefined}\r\n                            >\r\n                                <CImage \r\n                                    imageId={milestone.type === 'd6' ? 'die_d6' : 'die_d20'} \r\n                                />\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                    \r\n                    {/* Score bubble */}\r\n                    <div \r\n                        className=\"score-bubble\"\r\n                        style={{ left: `${bubblePosition}%` }}\r\n                    >\r\n                        <div className=\"bubble-arrow\"></div>\r\n                        <div className=\"bubble-content\">\r\n                            {hasUnclaimedReward ? (\r\n                                <button \r\n                                    className=\"reward-claim-button\"\r\n                                    onClick={handleRewardClaim}\r\n                                >\r\n                                    QUEST\r\n                                </button>\r\n                            ) : hasUnclaimedDMPoint ? (\r\n                                <button \r\n                                    className=\"dmpoint-claim-button\"\r\n                                    onClick={handleDMPointClaim}\r\n                                >\r\n                                    DM POINT\r\n                                </button>\r\n                            ) : (\r\n                                <span className=\"score-text\">\r\n                                    <DiceScore\r\n                                        score={animatingScore}\r\n                                    />\r\n                                </span>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default RewardFillBar;\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport {\r\n\tModalConfig,\r\n\tChatMessage,\r\n\tCHAT_TYPE,\r\n\tFlavorTagSource,\r\n\tFlavorTagTheme,\r\n\tTag,\r\n\tScoreEntry,\r\n} from \"../../models\";\r\nimport \"./EncounterTagModal.scss\";\r\nimport DiceScore from \"./DiceScore\";\r\nimport CImage from \"./cimage\";\r\nimport FlavorTagPill from \"./FlavorTagPill\";\r\nimport ConversationSection from \"./ConversationSection\";\r\nimport { useAppManager } from \"../managerContexts\";\r\nimport { calculateTotalScore } from \"../../utils/scoreUtils\";\r\nimport RewardFillBar from \"./RewardFillBar\";\r\n\r\ninterface EncounterTagModalProps {\r\n\tmodalConfig: ModalConfig;\r\n\tonClose: () => void;\r\n\tonOptionSelect: (optionId: string) => void;\r\n}\r\n\r\nconst EncounterTagModal: React.FC<EncounterTagModalProps> = ({\r\n\tmodalConfig,\r\n\tonClose,\r\n\tonOptionSelect,\r\n}) => {\r\n\tconst uiManager = useAppManager().getUiManager();\r\n\tconst [conversationComplete, setConversationComplete] = useState(false);\r\n\tconst [scoringComplete, setScoringComplete] = useState(false);\r\n\tconst [speedUp, setSpeedUp] = useState(false);\r\n\tconst [claimedRewards, setClaimedRewards] = useState<number[]>([]);\r\n\tconst [claimedDMPoints, setClaimedDMPoints] = useState<number[]>([]);\r\n\tconst appManager = useAppManager();\r\n\tconst tagManager = appManager.getTagManager();\r\n\tconst campaignManager = appManager.getCampaignManager();\r\n\r\n\t// Extract tag data safely with null checks\r\n\tconst tag = modalConfig.tagData?.tag;\r\n\tconst chatTrigger = modalConfig.tagData?.chatTrigger;\r\n\tconst encounter = modalConfig.tagData?.encounter;\r\n\r\n\t// Memoize messages to prevent recalculation\r\n\tconst messages = React.useMemo((): ChatMessage[] => {\r\n\t\tif (!chatTrigger) return [];\r\n\r\n\t\tif (Array.isArray(chatTrigger)) {\r\n\t\t\treturn chatTrigger;\r\n\t\t}\r\n\r\n\t\tif (chatTrigger.conversation) {\r\n\t\t\t// Handle conversation reference\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\t// just a string.\r\n\t\tif (chatTrigger.length > 0) {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tmessage: chatTrigger,\r\n\t\t\t\t\tspeaker: { type: CHAT_TYPE.DM, id: 0 },\r\n\t\t\t\t},\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\tif (chatTrigger.message) {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tmessage: chatTrigger.message,\r\n\t\t\t\t\tspeaker: chatTrigger.speaker || { type: CHAT_TYPE.DM, id: 0 },\r\n\t\t\t\t},\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\treturn [];\r\n\t}, [chatTrigger]);\r\n\r\n\t// Memoize scoring data to prevent regeneration with random values\r\n\tconst scoringData = React.useMemo((): ScoreEntry[] => {\r\n\t\tif (!tag) return [];\r\n\r\n\t\treturn (\r\n\t\t\tcampaignManager.getEncounterScoring(tag) || [\r\n\t\t\t\t{ description: \"Encounter\", points: 25, isPositive: true },\r\n\t\t\t\t{ description: \"Event \", points: 15, isPositive: true },\r\n\t\t\t\t{ description: \"Narrative Cohesion\", points: 10, isPositive: true },\r\n\t\t\t\t{ description: \"Time Efficiency\", points: -5, isPositive: false },\r\n\t\t\t\t{ description: \"Creative Solution\", points: 20, isPositive: true },\r\n\t\t\t]\r\n\t\t);\r\n\t}, [campaignManager, tag]);\r\n\tconst totalScore = React.useMemo(\r\n\t\t() => calculateTotalScore(scoringData),\r\n\t\t[scoringData]\r\n\t);\r\n\t\r\n\t// Get current campaign score\r\n\tconst currentCampaignScore = campaignManager.getCampaignScore();\r\n\tconst newTotalCampaignScore = currentCampaignScore + totalScore;\r\n\r\n\t// Early return after hooks\r\n\tif (!modalConfig.tagData || !tag) return null;\r\n\r\n\tconst handleClick = () => {\r\n\t\tif (!conversationComplete || !scoringComplete) {\r\n\t\t\tsetSpeedUp(true);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleModalClick = (e: React.MouseEvent) => {\r\n\t\te.stopPropagation();\r\n\t\thandleClick();\r\n\t};\r\n\r\n\tconst encounterTagSatisfied = (tag: Tag) =>\r\n\t\t!tagManager.getOutstandingEncounterTags().includes(tag);\r\n\tconst nbEncounterTagsSatisfied = (encounter?.tags || []).filter((encTag) =>\r\n\t\tencounterTagSatisfied(encTag)\r\n\t).length;\r\n\r\n\tconst canProceed = conversationComplete && scoringComplete;\r\n\r\n\tconst handleClickContinue = () => {\r\n\t\tif (canProceed) {\r\n\t\t\tcampaignManager.bankCampaignScore(calculateTotalScore(scoringData));\r\n\t\t\tcampaignManager.clearEncounterScore();\r\n\t\t\tonOptionSelect(modalConfig.options[0]?.id || \"continue\");\r\n\t\t\tonClose();\r\n\t\t}\r\n\t}\r\n\t\r\n\r\n\treturn (\r\n\t\t<div className=\"modal-overlay blue-theme\" onClick={handleClick}>\r\n\t\t\t<div className=\"modal-container encountertag\" onClick={handleModalClick}>\r\n\t\t\t\t{/* Header strip with encounter info */}\r\n\t\t\t\t<div className=\"encountertag-header\">\r\n\t\t\t\t\t<div className=\"header-background\">\r\n\t\t\t\t\t\t{encounter?.icon && <CImage imageId={encounter.icon} />}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"header-overlay\"></div>\r\n\t\t\t\t\t<div className=\"header-content\">\r\n\t\t\t\t\t\t<div className=\"header-left\">\r\n\t\t\t\t\t\t\t<div className=\"encounter-info\">\r\n\t\t\t\t\t\t\t\t<h2 className=\"encounter-title\">\r\n\t\t\t\t\t\t\t\t\t{encounter?.name || \"Unknown Encounter\"}\r\n\t\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t\t<div className=\"tag-discovery\">\r\n\t\t\t\t\t\t\t\t\t<span className=\"tag-name\">{tag.name}</span>\r\n\t\t\t\t\t\t\t\t\t{tag.type && <span className=\"tag-type\">{tag.type}</span>}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"header-right\">\r\n\t\t\t\t\t\t\t<div className=\"encounter-tags\">\r\n\t\t\t\t\t\t\t\t{encounter?.tags?.map((encTag, index) => (\r\n\t\t\t\t\t\t\t\t\t<FlavorTagPill\r\n\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\ttag={{\r\n\t\t\t\t\t\t\t\t\t\t\ttag: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t...encTag,\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tsource: encounterTagSatisfied(encTag)\r\n\t\t\t\t\t\t\t\t\t\t\t\t? FlavorTagSource.ENCOUNTER\r\n\t\t\t\t\t\t\t\t\t\t\t\t: FlavorTagSource.ENCOUNTER_EXPECTED,\r\n\t\t\t\t\t\t\t\t\t\t\ttheme: FlavorTagTheme.NONE,\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\toff={true}\r\n\t\t\t\t\t\t\t\t\t\tshowTooltip={false}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"encounter-tag\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Side-by-side content */}\r\n\t\t\t\t<div className=\"encountertag-body\">\r\n\t\t\t\t\t{/* Left side - Conversation */}\r\n\t\t\t\t\t<ConversationSection\r\n\t\t\t\t\t\tmessages={messages}\r\n\t\t\t\t\t\ttitle={`Encounter Topic ${nbEncounterTagsSatisfied} : ${tag.name}`}\r\n\t\t\t\t\t\tonComplete={() => setConversationComplete(true)}\r\n\t\t\t\t\t\tspeedUp={speedUp}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t{/* Right side - Scoring Ledger */}\r\n\t\t\t\t\t<div className=\"scoring-section\">\r\n\t\t\t\t\t\t<div className=\"section-header\">\r\n\t\t\t\t\t\t\t<h3>Encounter Scoring</h3>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"scoring-content\">\r\n\t\t\t\t\t\t\t<ScoringLedger\r\n\t\t\t\t\t\t\t\tentries={scoringData}\r\n\t\t\t\t\t\t\t\ttotalScore={totalScore}\r\n\t\t\t\t\t\t\t\tcurrentCampaignScore={currentCampaignScore}\r\n\t\t\t\t\t\t\t\tnewTotalCampaignScore={newTotalCampaignScore}\r\n\t\t\t\t\t\t\t\tonComplete={() => setScoringComplete(true)}\r\n\t\t\t\t\t\t\t\tspeedUp={speedUp}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Footer with Campaign Reward and Continue button */}\r\n\t\t\t\t<div className=\"encountertag-footer\">\r\n\t\t\t\t\t{/* Full-width Campaign Reward FillBar */}\r\n\t\t\t\t\t<div className=\"campaign-reward-section\">\r\n\t\t\t\t\t\t<RewardFillBar \r\n\t\t\t\t\t\t\tinitialCampaignScore={currentCampaignScore}\r\n\t\t\t\t\t\t\tnewScore={totalScore}\r\n\t\t\t\t\t\t\tonRewardClaim={(rewardIndex) => {\r\n\t\t\t\t\t\t\t\tsetClaimedRewards(prev => [...prev, rewardIndex]);\r\n\t\t\t\t\t\t\t\tuiManager.showSelectQuestModal();\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tonDMPointClaim={(dmPointIndex) => {\r\n\t\t\t\t\t\t\t\t// Award 1 DM ability point (for spending in skill screen)\r\n\t\t\t\t\t\t\t\tcampaignManager.addDMAbilityPoints(1);\r\n\t\t\t\t\t\t\t\t// Mark this DM point as claimed\r\n\t\t\t\t\t\t\t\tsetClaimedDMPoints(prev => [...prev, dmPointIndex]);\r\n\t\t\t\t\t\t\t\tconsole.log(`Claimed DM point ${dmPointIndex + 1}!`);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tclaimedRewards={claimedRewards}\r\n\t\t\t\t\t\t\tclaimedDMPoints={claimedDMPoints}\r\n\t\t\t\t\t\t\tshowScore={scoringComplete}\r\n\t\t\t\t\t\t\tonThresholdCrossed={(threshold) => {\r\n\t\t\t\t\t\t\t\tconsole.log(`Crossed reward threshold: ${threshold}`);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t{/* Continue Button */}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName={`encountertag-continue-button ${\r\n\t\t\t\t\t\t\t!canProceed ? \"disabled\" : \"\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\tcanProceed && handleClickContinue()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdisabled={!canProceed}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{modalConfig.options[0]?.title || \"CONTINUE\"}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\n// Scoring Ledger Component\r\ninterface ScoringLedgerProps {\r\n\tentries: ScoreEntry[];\r\n\ttotalScore: number;\r\n\tcurrentCampaignScore: number;\r\n\tnewTotalCampaignScore: number;\r\n\tonComplete: () => void;\r\n\tspeedUp: boolean;\r\n}\r\n\r\nconst ScoringLedger: React.FC<ScoringLedgerProps> = ({\r\n\tentries,\r\n\ttotalScore,\r\n\tcurrentCampaignScore,\r\n\tnewTotalCampaignScore,\r\n\tonComplete,\r\n\tspeedUp,\r\n}) => {\r\n\tconst [visibleEntries, setVisibleEntries] = useState(0);\r\n\tconst [showTotal, setShowTotal] = useState(false);\r\n\tconst intervalRef = useRef<NodeJS.Timeout | null>(null);\r\n\tuseEffect(() => {\r\n\t\tif (speedUp) {\r\n\t\t\t// Speed up animation - complete everything immediately\r\n\t\t\tsetVisibleEntries(entries.length);\r\n\t\t\tsetShowTotal(true);\r\n\t\t\tsetTimeout(() => onComplete(), 100);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst delay = 800;\r\n\r\n\t\tif (visibleEntries < entries.length) {\r\n\t\t\tintervalRef.current = setTimeout(() => {\r\n\t\t\t\tsetVisibleEntries((prev) => prev + 1);\r\n\t\t\t}, delay);\r\n\t\t} else if (!showTotal) {\r\n\t\t\tintervalRef.current = setTimeout(() => {\r\n\t\t\t\tsetShowTotal(true);\r\n\t\t\t\tsetTimeout(() => onComplete(), 500);\r\n\t\t\t}, delay);\r\n\t\t}\r\n\r\n\t\treturn () => {\r\n\t\t\tif (intervalRef.current) {\r\n\t\t\t\tclearTimeout(intervalRef.current);\r\n\t\t\t}\r\n\t\t};\r\n\t}, [visibleEntries, showTotal, entries.length, onComplete, speedUp]);\r\n\r\n\treturn (\r\n\t\t<div className=\"scoring-ledger\">\r\n\t\t\t{\" \"}\r\n\t\t\t<div className=\"score-entries\">\r\n\t\t\t\t{entries.slice(0, visibleEntries).map((entry, index) => (\r\n\t\t\t\t\t<div \r\n\t\t\t\t\t\tkey={index} \r\n\t\t\t\t\t\tclassName={`score-entry animate-in ${entry.multiplier ? (entry.points < 1 ? \"multiplier-low\" : \"multiplier-high\") : \"\"}`}\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tborderColor:  entry.color ? entry.color : undefined,\r\n\t\t\t\t\t\t\tboxShadow: entry.color ? `0 0 10px ${entry.color}` : undefined\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span className=\"score-description\">{entry.description}</span>\r\n\t\t\t\t\t\t{entry.multiplier ? (\r\n\t\t\t\t\t\t\t<span className={`score-points multiplier-${entry.points < 1 ? 'low' : 'high'}`}>x{entry.points}</span>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<span className=\"score-points\">\r\n\t\t\t\t\t\t\t<DiceScore\r\n\t\t\t\t\t\t\t\tscore={Math.abs(entry.points)}\r\n\t\t\t\t\t\t\t\tdirection=\"row\"\r\n\t\t\t\t\t\t\t\tclassName={`score-dice ${\r\n\t\t\t\t\t\t\t\t\tentry.points < 0 ? \"negative\" : \"positive\"\r\n\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t\t{showTotal && (\r\n\t\t\t\t<div className=\"score-total animate-in\">\r\n\t\t\t\t\t<div className=\"total-separator\"></div>\r\n\t\t\t\t\t<div className=\"total-entry glow\">\r\n\t\t\t\t\t\t<span className=\"total-label\">Added Score</span>\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclassName={`total-points ${\r\n\t\t\t\t\t\t\t\ttotalScore >= 0 ? \"positive\" : \"negative\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<DiceScore\r\n\t\t\t\t\t\t\t\tscore={Math.abs(totalScore)}\r\n\t\t\t\t\t\t\t\tdirection=\"row\"\r\n\t\t\t\t\t\t\t\tclassName={`total-dice ${\r\n\t\t\t\t\t\t\t\t\ttotalScore < 0 ? \"negative\" : \"positive\"\r\n\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t{/* Campaign Score Display */}\r\n\t\t\t\t\t<div className=\"total-entry campaign-score-entry\">\r\n\t\t\t\t\t\t<span className=\"total-label\">Total Score</span>\r\n\t\t\t\t\t\t<span className=\"campaign-score-breakdown\">\r\n\t\t\t\t\t\t\t{/* <span className=\"current-score\">\r\n\t\t\t\t\t\t\t\t<DiceScore score={currentCampaignScore} direction=\"row\" />\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<span className=\"score-separator\">+</span>\r\n\t\t\t\t\t\t\t<span className=\"new-score\">\r\n\t\t\t\t\t\t\t\t<DiceScore score={totalScore} direction=\"row\" />\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<span className=\"score-separator\">=</span> */}\r\n\t\t\t\t\t\t\t<span className=\"final-score\">\r\n\t\t\t\t\t\t\t\t<DiceScore score={newTotalCampaignScore} direction=\"row\" />\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default EncounterTagModal;\r\n","import React from 'react';\r\nimport { ModalConfig, Player, EncounterFlavorTag, FlavorTagSource, FlavorTagTheme } from '../../models';\r\nimport { useAppManager } from '../managerContexts';\r\nimport CImage from './cimage';\r\nimport FlavorTagPill from './FlavorTagPill';\r\nimport './NextEncounterModal.scss';\r\n\r\ninterface NextEncounterModalProps {\r\n  modalConfig: ModalConfig;\r\n  onClose: () => void;\r\n  onOptionSelect: (optionId: string) => void;\r\n}\r\n\r\nconst NextEncounterModal: React.FC<NextEncounterModalProps> = ({ modalConfig, onClose, onOptionSelect }) => {\r\n  const appManager = useAppManager();\r\n  const playerManager = appManager.getPlayerManager();\r\n  const tagManager = appManager.getTagManager();\r\n  \r\n  if (!modalConfig.encounterData) return null;\r\n\r\n  const { branches } = modalConfig.encounterData;\r\n\r\n  // Use new preference evaluation system instead of the old branchPreferences\r\n  const { preferredEncounters, notWantedEncounters } = playerManager.evaluateEncounterPreferences(branches);\r\n  \r\n  // Calculate incomplete exploration penalties\r\n  const explorationPenalties = playerManager.calculateIncompleteExplorationPenalties(tagManager);\r\n  const hasExplorationPenalties = explorationPenalties.totalStressPenalty > 0 || explorationPenalties.totalAttentionPenalty > 0;\r\n  \r\n  const getPlayerPreferences = (branchName: string): Player[] => {\r\n    return preferredEncounters[branchName] || [];\r\n  };\r\n\r\n  const getPenaltyPlayers = (branchName: string): Player[] => {\r\n    return notWantedEncounters[branchName] || [];\r\n  };\r\n\r\n  const isOnlyOneOption = branches.length === 1;\r\n\r\n  // Helper function to convert Tag to EncounterFlavorTag\r\n  const createFlavorTag = (tag: any, source: FlavorTagSource): EncounterFlavorTag => ({\r\n    tag: tag,\r\n    source: source,\r\n    theme: FlavorTagTheme.NONE\r\n  });\r\n\r\n  return (\r\n    <div className=\"modal-overlay\">\r\n      <div className=\"modal-container nextencounter\">\r\n        <div className=\"modal-header\">\r\n          <h2>{modalConfig.title}</h2>\r\n          <button className=\"close-button\" onClick={onClose}>×</button>\r\n        </div>\r\n        \r\n        <div className=\"nextencounter-content\">\r\n          <div className=\"encounter-options\">\r\n            {branches.map((branch) => {\r\n              const preferences = getPlayerPreferences(branch.name);\r\n              const penaltyPlayers = getPenaltyPlayers(branch.name);\r\n              \r\n              return (\r\n                <div\r\n                  key={branch.name}\r\n                  className=\"encounter-option\"\r\n                  onClick={() => onOptionSelect(branch.name)}\r\n                >\r\n                  <div className=\"encounter-card\">\r\n                    <div className=\"encounter-image\">\r\n                      <CImage imageId={branch.icon} />\r\n                    </div>\r\n                    \r\n                    <div className=\"encounter-info\">\r\n                      <h3 className=\"encounter-name\">{branch.name}</h3>\r\n                      <p className=\"encounter-description\">{branch.description}</p>\r\n                      \r\n                      <div className=\"encounter-location\">\r\n                        <strong>Location:</strong> {branch.location.name}\r\n                      </div>\r\n                       {branch.location.tags && branch.location.tags.length > 0 && (\r\n                        <div className=\"encounter-tags\">\r\n                          <div className=\"tags-list\">\r\n                            {branch.location.tags.map((tag, index) => (\r\n                              <FlavorTagPill\r\n                                key={index}\r\n                                tag={createFlavorTag(tag, FlavorTagSource.LOCATION)}\r\n                                showTooltip={true}\r\n                              />\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                      {branch.tags && branch.tags.length > 0 && (\r\n                        <div className=\"encounter-tags\">\r\n                          <div className=\"tags-label\">Elements:</div>\r\n                          <div className=\"tags-list\">\r\n                            {branch.tags.map((tag, index) => (\r\n                              <FlavorTagPill\r\n                                key={index}\r\n                                tag={createFlavorTag(tag, FlavorTagSource.ENCOUNTER)}\r\n                                showTooltip={true}\r\n                              />\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    \r\n                    <div className=\"player-preferences-container\">\r\n                      {preferences.length > 0 && (\r\n                        <div className=\"player-preferences preferred\">\r\n                          <div className=\"preferences-label\">Preferred by:</div>\r\n                          <div className=\"preferences-effect\">+1 Attitude</div>\r\n                          <div className=\"player-icons\">\r\n                            {preferences.map((player) => (\r\n                              <div\r\n                                key={player.id}\r\n                                className=\"player-icon\"\r\n                                title={player.name}\r\n                              >\r\n                                <CImage imageId={player.icon} />\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                      \r\n                      {(penaltyPlayers.length > 0 || isOnlyOneOption || hasExplorationPenalties) && (\r\n                        <div className=\"player-preferences not-wanted\">\r\n                          <div className=\"preferences-label\">Penalties:</div>\r\n                          \r\n                          {/* Incomplete Exploration Penalties */}\r\n                          {hasExplorationPenalties && (\r\n                            <>\r\n                              {explorationPenalties.totalStressPenalty > 0 && (\r\n                                <div className=\"penalty\">\r\n                                  Undescribed location topics : +{explorationPenalties.totalStressPenalty} Stress \r\n                                </div>\r\n                              )}\r\n                              {explorationPenalties.totalAttentionPenalty > 0 && (\r\n                                <div className=\"penalty\">\r\n                                 Need to describe {explorationPenalties.encounterTagPenalty} encounter topics : -{explorationPenalties.totalAttentionPenalty} Attention \r\n                                </div>\r\n                              )}\r\n                            </>\r\n                          )}\r\n                          \r\n                          {/* Railroading Penalty */}\r\n                          {isOnlyOneOption && (\r\n                            <div className=\"penalty\">Railroading: -1 Attention</div>\r\n                          )}\r\n                          \r\n                          {/* Player Preference Penalties */}\r\n                          {penaltyPlayers.length > 0 && !isOnlyOneOption && !hasExplorationPenalties && (\r\n                            <div className=\"penalty\">Player Dislikes: -1 Attitude</div>\r\n                          )}\r\n                          \r\n                          <div className=\"player-icons\">\r\n                            {(hasExplorationPenalties || isOnlyOneOption ? \r\n                              playerManager.playersAffectedByRailroading() : \r\n                              penaltyPlayers\r\n                            ).map((player: Player) => (\r\n                              <div\r\n                                key={player.id}\r\n                                className=\"player-icon not-wanted-icon\"\r\n                                title={player.name}\r\n                              >\r\n                                <CImage imageId={player.icon} />\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    \r\n                    <div className=\"encounter-overlay\">\r\n                      <div className=\"select-text\">Select Encounter</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n          \r\n          <div className=\"selection-help\">\r\n            <p>Choose the next encounter for your party. Player preferences are shown based on their attitudes toward the encounter elements and preparation level.</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NextEncounterModal;\r\n","import React, { useState, useMemo } from \"react\";\r\nimport \"./WelcomeModal.scss\";\r\nimport CImage from \"./cimage\";\r\nimport { useAppManager } from \"../managerContexts\";\r\nimport ConversationSection from \"./ConversationSection\";\r\n\r\ninterface WelcomeModalProps {\r\n\tonClose: () => void;\r\n}\r\n\r\n// Game Info Component\r\ninterface GameInfoPanelProps {\r\n\thandleOpenCampaignNotes: () => void;\r\n}\r\n\r\nconst GameInfoPanel: React.FC<GameInfoPanelProps> = ({ handleOpenCampaignNotes }) => {\r\n\treturn (\r\n\t\t<div className=\"game-info-panel\">\r\n\t\t\t<div className=\"info-content\">\r\n\t\t\t\t<div className=\"info-section\">\r\n\t\t\t\t\t<h3>Welcome to Dungeon Master Sim</h3>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tTake the role of Dungeon Master and run a Campaign by ushering your\r\n\t\t\t\t\t\tplayers through a series of Encounters.\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tEncounters are made up of Events, each with their own rules, goals,\r\n\t\t\t\t\t\tand basis in real-life tabletop rpgs.\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tKeep your players happy by engaging in topics they like, awarding treasure, and attitude bonuses. Players will get bored if their Characters are ignored. \r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tScore points by building <span className=\"inline-dice-symbols\">\r\n\t\t\t\t\t\t\t<CImage imageId=\"die_d4\" />\r\n\t\t\t\t\t\t\t<CImage imageId=\"die_d6\" />\r\n\t\t\t\t\t\t\t<CImage imageId=\"die_d20\" />\r\n\t\t\t\t\t\t</span> during events, and then collect them by hitting key encounter points.  \r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<div className=\"button-container-center\">\r\n\t\t\t\t\t\t<button \r\n\t\t\t\t\t\t\tclassName=\"welcome-button info\"\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t// Close this modal and open the Encounter notebook\r\n\t\t\t\t\t\t\t\thandleOpenCampaignNotes();\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tOpen Campaign Notes\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"info-section highlight\">\r\n\t\t\t\t\t<h3>Gameplay Tips</h3>\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t<li>Pay attention to your players' preferences and attitudes</li>\r\n\t\t\t\t\t\t<li>Balance different encounter types to keep things interesting</li>\r\n\t\t\t\t\t\t<li>Use the campaign notes to track important story elements</li>\r\n\t\t\t\t\t\t<li>Experiment with different approaches to see what works</li>\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst WelcomeModal: React.FC<WelcomeModalProps> = ({ onClose }) => {\r\n\tconst appManager = useAppManager();\r\n\tconst chatManager = appManager.getChatManager();\r\n\tconst [conversationComplete, setConversationComplete] = useState(false);\r\n\tconst [speedUp, setSpeedUp] = useState(false);\r\n\r\n\t// Get the welcome conversation\r\n\tconst messages = useMemo(() => {\r\n\t\treturn chatManager.getConversationById(\"WELCOME_CONVERSATION\") || [];\r\n\t}, [chatManager]);\r\n\r\n\tconst handleClick = () => {\r\n\t\tif (!conversationComplete) {\r\n\t\t\tsetSpeedUp(true);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleModalClick = (e: React.MouseEvent) => {\r\n\t\te.stopPropagation();\r\n\t\thandleClick();\r\n\t};\r\n\r\n\tconst handleOpenCampaignNotes = () => {\r\n\t\t// Close this modal and open the Campaign Notes\r\n\t\tonClose();\r\n\t\tappManager.getCampaignManager().displayNewEncounter();\r\n\t};\r\n\r\n\tconst handleContinue = () => {\r\n\t\tonClose();\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"modal-overlay blue-theme\" onClick={handleClick}>\r\n\t\t\t<div className=\"modal-container welcome\" onClick={handleModalClick}>\r\n\t\t\t\t{/* Header */}\r\n\t\t\t\t<div className=\"welcome-header\">\r\n\t\t\t\t\t<div className=\"header-background\">\r\n\t\t\t\t\t\t<CImage imageId=\"logo.png\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"header-overlay\"></div>\r\n\t\t\t\t\t<div className=\"header-content\">\r\n\t\t\t\t\t\t<h1 className=\"welcome-title\">Dungeon Master Sim v0.0.1</h1>\r\n\t\t\t\t\t\t<p className=\"welcome-subtitle\">\r\n\t\t\t\t\t\t\tPrepare for an unfinished experience!\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t\t{/* Side-by-side content */}\r\n\t\t\t\t<div className=\"welcome-body\">\r\n\t\t\t\t\t{/* Right side - Game Information */}\r\n\t\t\t\t\t<div className=\"info-section\">\r\n\t\t\t\t\t\t<div className=\"info-content\">\r\n\t\t\t\t\t\t\t<GameInfoPanel handleOpenCampaignNotes={handleOpenCampaignNotes} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t{/* Left side - Conversation */}\r\n\t\t\t\t\t<div className=\"conversation-section\">\r\n\t\t\t\t\t\t<div className=\"conversation-content\">\r\n\t\t\t\t\t\t\t{messages.length > 0 ? (\r\n\t\t\t\t\t\t\t\t<ConversationSection\r\n\t\t\t\t\t\t\t\t\tmessages={messages}\r\n\t\t\t\t\t\t\t\t\ttitle=\"Welcome\"\r\n\t\t\t\t\t\t\t\t\tonComplete={() => setConversationComplete(true)}\r\n\t\t\t\t\t\t\t\t\tspeedUp={speedUp}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<div className=\"no-conversation\">\r\n\t\t\t\t\t\t\t\t\t<p>What is happening? Why did Maxim break this? Ugh.</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Footer */}\r\n\t\t\t\t<div className=\"welcome-footer\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName={`welcome-button ${\r\n\t\t\t\t\t\t\t!conversationComplete ? \"disabled\" : \"\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\tonClick={handleContinue}\r\n\t\t\t\t\t\tdisabled={!conversationComplete}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tBEGIN THE ADVENTURE!\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default WelcomeModal;","import React from 'react';\r\nimport { ModalConfig } from '../../models';\r\nimport EffectDisplay from './effectDisplay';\r\nimport FlavorTagPill from './FlavorTagPill';\r\nimport TooltipWrapper from './TooltipWrapper';\r\n\r\ninterface TagModalProps {\r\n  modalConfig: ModalConfig;\r\n  onClose: () => void;\r\n}\r\n\r\nconst TagModal: React.FC<TagModalProps> = ({ modalConfig, onClose }) => {\r\n  if (!modalConfig.tagModalConfig) {\r\n    return null;\r\n  }\r\n\r\n  const {\r\n    title,\r\n    description,\r\n    tags,\r\n    effects,\r\n    selectedTags,\r\n    remainingClicks,\r\n    tagInstructions,\r\n    onTagClick,\r\n    onClose: configOnClose\r\n  } = modalConfig.tagModalConfig;\r\n\r\n  const handleClose = () => {\r\n    configOnClose();\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <div className=\"modal-overlay\">\r\n      <div className=\"modal-container\">\r\n        <div className=\"modal-header\">\r\n          <h2>{title}</h2>\r\n          {description && (\r\n            <div className=\"modal-description\">\r\n              {description}\r\n            </div>\r\n          )}\r\n          <button className=\"close-button\" onClick={handleClose}>×</button>\r\n        </div>\r\n\r\n        {/* Effects Display */}\r\n        {effects && effects.length > 0 && (\r\n          <div className=\"modal-effects\">\r\n            {effects.map((effect, index) => (\r\n              <EffectDisplay key={index} effectData={effect} />\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Tags Section */}\r\n        {tags.length > 0 && remainingClicks > 0 && (\r\n          <div className=\"modal-tag-container\">\r\n            <div className=\"clicks-remaining\">\r\n              <TooltipWrapper\r\n                content=\"Click on the tags to reveal them.\"\r\n                maxWidth=\"200\"\r\n                preservePositioning={true}\r\n                translate={[0, -80]}\r\n              >\r\n                {remainingClicks}\r\n              </TooltipWrapper>\r\n            </div>\r\n            {tagInstructions && (\r\n              <div className=\"tag-instructions\">\r\n                {tagInstructions}\r\n              </div>\r\n            )}\r\n            <div className=\"modal-tags-container\">\r\n              <div className=\"modal-tags\">\r\n                {tags.map((tag) => {\r\n                  const tagUsed = selectedTags.includes(tag.tag);\r\n                  return (\r\n                    <FlavorTagPill\r\n                      key={tag.tag.name}\r\n                      tag={tag}\r\n                      onClick={onTagClick}\r\n                      className={`${tagUsed ? \"used\" : \"\"}`}\r\n                      disabled={tagUsed}\r\n                      showTooltip={false}\r\n                    />\r\n                  );\r\n                })}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* No Tags Warning */}\r\n        {remainingClicks > 0 && tags.length === 0 && (\r\n          <div className=\"remaining-clicks-warning\">\r\n            Nothing new to present to the players.\r\n          </div>\r\n        )}\r\n\r\n        {/* Actions */}\r\n        {(tags.length === 0 || remainingClicks === 0) && (\r\n          <div className=\"modal-actions\">\r\n            <button\r\n              className={`modal-action-button ${remainingClicks > 0 ? 'disabled' : ''}`}\r\n              onClick={handleClose}\r\n              disabled={remainingClicks > 0}\r\n            >\r\n              Close\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TagModal;\r\n","import { LEVELUP_OPTION } from \"../../consts/general\";\r\nimport { useModal } from \"../../hooks/useModal\";\r\nimport CImage from \"./cimage\";\r\nimport EffectDisplay from \"./effectDisplay\";\r\nimport SetSceneModal from \"./SetSceneModal\";\r\nimport EncounterTagModal from \"./EncounterTagModal\";\r\nimport NextEncounterModal from \"./NextEncounterModal\";\r\nimport WelcomeModal from \"./WelcomeModal\";\r\nimport TagModal from \"./TagModal\";\r\nimport './Modal.scss';\r\n \r\n\r\nexport const Modal: React.FC = () => {\r\n    const { modalConfig, handleOptionSelect, closeModal } = useModal();\r\n  \r\n    if (!modalConfig) return null;\r\n  \r\n    // Handle our new modal types\r\n    if (modalConfig.type === 'setscene') {\r\n      return (\r\n        <SetSceneModal\r\n          modalConfig={modalConfig}\r\n          onClose={closeModal}\r\n          onOptionSelect={handleOptionSelect}\r\n        />\r\n      );\r\n    }\r\n\r\n    if (modalConfig.type === 'encountertag') {\r\n      return (\r\n        <EncounterTagModal\r\n          modalConfig={modalConfig}\r\n          onClose={closeModal}\r\n          onOptionSelect={handleOptionSelect}\r\n        />\r\n      );\r\n    }\r\n\r\n    if (modalConfig.type === 'nextencounter') {\r\n      return (\r\n        <NextEncounterModal\r\n          modalConfig={modalConfig}\r\n          onClose={closeModal}\r\n          onOptionSelect={handleOptionSelect}\r\n        />\r\n      );\r\n    }\r\n\r\n    if (modalConfig.type === 'tagmodal' && modalConfig.tagModalConfig) {\r\n      return (\r\n        <TagModal\r\n          modalConfig={modalConfig}\r\n          onClose={closeModal}\r\n        />\r\n      );\r\n    }\r\n\r\n// Add new modal types in here. \r\n// we should probably refactor/unify this! \r\n\r\n\r\n    if(modalConfig.type === 'levelup') {\r\n      return (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal-container\">\r\n            <div className=\"modal-header\">\r\n              <h2>{modalConfig.title}</h2>\r\n              <button className=\"close-button\" onClick={closeModal}>×</button>\r\n            </div>\r\n            <div className=\"modal-options\">\r\n              {modalConfig.options.map((option) => (\r\n                <button\r\n                  key={option.id}\r\n                  className={`modal-option ${option.class || ''}`}\r\n                  onClick={() => handleOptionSelect(option.id)}\r\n                >\r\n                  <div className=\"option-content\">\r\n                  <h3>{option.title}</h3>\r\n                  </div>\r\n                  {option.icon && (\r\n                    option.id === LEVELUP_OPTION.CHARACTER ? \r\n                      <CImage imageId={option.icon} /> \r\n                    : \r\n                      <span className=\"option-icon\">{option.icon}</span>\r\n                  )}\r\n                  <div className=\"option-content\">\r\n                  \r\n                    {option.description && <p>{option.description}</p>}\r\n                  </div>\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if(modalConfig.type === 'travelresult' && modalConfig.travelConfig) {\r\n      return (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal-container travel\">\r\n            <div className=\"modal-header\">\r\n              {modalConfig.title}\r\n              <button className=\"close-button\" onClick={closeModal}>×</button>\r\n            </div>\r\n            <div className=\"travel-results\">\r\n              {modalConfig.travelConfig.results.map((result, index) => (\r\n                  <EffectDisplay\r\n                    key={index}\r\n                    effectData={result}\r\n                    />\r\n              ))}\r\n            </div>\r\n            <div className=\"modal-actions\">\r\n              {modalConfig.options.map((option) => (\r\n                <button\r\n                  key={option.id}\r\n                  className=\"modal-action-button\"\r\n                  onClick={() => handleOptionSelect(option.id)}\r\n                >\r\n                  {option.title}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if(modalConfig.type === 'puzzle' && modalConfig.effectData) {\r\n      return (\r\n        <div className=\"modal-overlay\">\r\n          <div className=\"modal-container puzzle\">\r\n            <div className=\"modal-header\">\r\n              {modalConfig.title}\r\n              <button className=\"close-button\" onClick={closeModal}>×</button>\r\n            </div>\r\n            <div className=\"puzzle-results\">\r\n              {modalConfig.effectData.map((result, index) => (\r\n                  <EffectDisplay\r\n                    key={index}\r\n                    effectData={result}\r\n                    />\r\n              ))}\r\n            </div>\r\n            <div className=\"modal-actions\">\r\n              {modalConfig.options.map((option) => (\r\n                <button\r\n                  key={option.id}\r\n                  className=\"modal-action-button\"\r\n                  onClick={() => handleOptionSelect(option.id)}\r\n                >\r\n                  {option.title}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (modalConfig.type === 'welcome') {\r\n      return (\r\n        <WelcomeModal\r\n          onClose={closeModal}\r\n        />\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"modal-overlay\">\r\n        <div className=\"modal-container\">\r\n          <div className=\"modal-header\">\r\n            <h2>{modalConfig.title}</h2>\r\n            <button className=\"close-button\" onClick={closeModal}>×</button>\r\n          </div>\r\n          <div className=\"modal-options\">\r\n            {modalConfig.options.map((option) => (\r\n              <button\r\n                key={option.id}\r\n                className={`modal-option ${option.class || ''}`}\r\n                onClick={() => handleOptionSelect(option.id)}\r\n              >\r\n                <div className=\"option-content\">\r\n                <h3>{option.title}</h3>\r\n                </div>\r\n                {option.icon && (\r\n                  option.id === LEVELUP_OPTION.CHARACTER ? \r\n                    <CImage imageId={option.icon} /> \r\n                  : \r\n                    <span className=\"option-icon\">{option.icon}</span>\r\n                )}\r\n                <div className=\"option-content\">\r\n                \r\n                  {option.description && <p>{option.description}</p>}\r\n                </div>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  };","import { useState, useEffect } from 'react';\r\nimport { ModalConfig } from '../models';\r\nimport { useAppManager } from '../components/managerContexts';\r\n\r\nexport const useModal = () => {\r\n  const [modalConfig, setModalConfig] = useState<ModalConfig | null>(null);\r\n  const appManager = useAppManager();\r\n  const uiManager = appManager.getUiManager();\r\n\r\n  useEffect(() => {\r\n    const handleModalStateChanged = (config: ModalConfig | null) => {\r\n      setModalConfig(config);\r\n    };\r\n\r\n    uiManager.on('modalStateChanged', handleModalStateChanged);\r\n    return () => {\r\n      uiManager.off('modalStateChanged', handleModalStateChanged);\r\n    };\r\n  }, [uiManager]);\r\n\r\n  return {\r\n    modalConfig,\r\n    handleOptionSelect: (optionId: string) => uiManager.handleModalOptionSelected(optionId),\r\n    closeModal: () => uiManager.closeModal()\r\n  };\r\n};","import React from \"react\";\r\nimport { useUiManager } from \"../managerContexts\";\r\nimport DiceScore from \"./DiceScore\";\r\nimport FlavorTagPill from \"./FlavorTagPill\";\r\n\r\ninterface RewardDisplayProps {\r\n\treward: {\r\n\t\ttype: string;\r\n\t\tamount: number;\r\n\t\tdescription?: string;\r\n\t};\r\n}\r\n\r\nconst RewardDisplay: React.FC<RewardDisplayProps> = ({ reward }) => {\r\n\tconst uiManager = useUiManager();\r\n\tconst config = uiManager.getRewardDisplayConfig(reward);\r\n\r\n\tswitch (config.type) {\r\n\t\tcase \"dice\":\r\n\t\t\treturn <DiceScore score={config.score} />;\r\n\t\tcase \"treasurePills\":\r\n\t\t\treturn (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{Array.from({ length: config.amount }, (_, idx) => (\r\n\t\t\t\t\t\t<FlavorTagPill\r\n\t\t\t\t\t\t\tkey={idx}\r\n\t\t\t\t\t\t\ttag={config.tagConfig}\r\n\t\t\t\t\t\t\thighlighted={false}\r\n\t\t\t\t\t\t\tshowTooltip={false}\r\n\t\t\t\t\t\t\tclassName=\"encounter-flavor-tag\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t\tcase \"text\":\r\n\t\tdefault:\r\n\t\t\treturn <span>{config.text}</span>;\r\n\t}\r\n};\r\n\r\nexport default RewardDisplay;","import React from \"react\";\r\nimport { Quest } from \"../../models\";\r\nimport \"./SelectQuestModal.scss\";\r\nimport Cbox from \"./cbox\";\r\nimport CImage from \"./cimage\";\r\nimport RewardDisplay from \"./RewardDisplay\";\r\ninterface SelectQuestModalProps {\r\n\tquests: Quest[];\r\n\tactiveQuestIds: string[];\r\n\tonQuestSelect: (questId: string) => void;\r\n\tonClose: () => void;\r\n}\r\n\r\nconst SelectQuestModal: React.FC<SelectQuestModalProps> = ({\r\n\tquests,\r\n\tactiveQuestIds,\r\n\tonQuestSelect,\r\n\tonClose,\r\n}) => {\r\n\treturn (\r\n\t\t<div className=\"select-quest-modal-overlay\">\r\n\t\t\t<div className=\"quest-modal-container\">\r\n\t\t\t\t<Cbox title=\"Quest Opportunity\" theme=\"quests\">\r\n\t\t\t\t\t<div className=\"modal-header\">\r\n\t\t\t\t\t\t<div className=\"quest-subheader\">\r\n\t\t\t\t\t\t\tChoose a side-story to introduce to the players.\r\n            \r\n\t\t\t\t\t\t</div><div className=\"quest-subheader\">  Quest-related topics will grab the players attention.\r\n\t\t\t\t\t</div>\t{/* <button className=\"close-button\" onClick={onClose}>×</button> */}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"quest-tiles\">\r\n\t\t\t\t\t\t{quests.map((quest) => (\r\n\t\t\t\t\t\t\t<Cbox\r\n\t\t\t\t\t\t\t\ttitle={quest.name}\r\n\t\t\t\t\t\t\t\ttheme={\"quest\"}\r\n\t\t\t\t\t\t\t\tonClick={() => onQuestSelect(quest.id)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclassName=\"quest-tile-content\"\r\n\t\t\t\t\t\t\t\t\tdata-quest-icon={quest.icon || \"default\"}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<div className=\"quest-icon-background\">\r\n\t\t\t\t\t\t\t\t\t\t{quest.icon && <CImage imageId={quest.icon} />}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t<div className=\"quest-content-overlay\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"quest-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"quest-cost\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{quest.cost.map((cost, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span key={index} className=\"quest-cost-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t +{cost.amount} {cost.type}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"quest-description\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{quest.description}\r\n\t\t\t\t\t\t\t\t\t\t\t</div><div className=\"quest-rewards\">\r\n                        <div className=\"rewards-title\">Rewards:</div>\r\n                        <div className=\"quest-reward-row\">\r\n                          \r\n\t\t\t\t\t\t\t\t\t\t\t\t{quest.rewards.map((reward, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span key={index} className=\"quest-reward\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* {reward.description}:{reward.amount} */}\r\n                             <div className=\"quest-reward-treasure\">\r\n                              <RewardDisplay reward={reward} />\r\n                             </div>\r\n                            \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n                        </div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t{activeQuestIds.includes(quest.id) && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"active-indicator\">ACTIVE</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</Cbox>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Cbox>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SelectQuestModal;\r\n","import React, { useState } from 'react';\r\nimport { Quest, QuestNode, ChatMessage, Player, ATTITUDE } from '../../models';\r\nimport './QuestTerminalModal.scss';\r\n\r\ninterface PlayerPreference {\r\n  playerId: number;\r\n  optionIndex: number;\r\n  attitude: ATTITUDE;\r\n}\r\n\r\ninterface QuestTerminalModalProps {\r\n  quest: Quest;\r\n  node: QuestNode;\r\n  players: Player[];\r\n  onComplete: () => void;\r\n  onClose: () => void;\r\n}\r\n\r\nconst QuestTerminalModal: React.FC<QuestTerminalModalProps> = ({\r\n  quest,\r\n  node,\r\n  players,\r\n  onComplete,\r\n  onClose\r\n}) => {\r\n  const [selectedOption, setSelectedOption] = useState<number | null>(null);\r\n  const [currentConversation, setCurrentConversation] = useState<ChatMessage[]>(node.conversation);\r\n  \r\n  // Generate random preferences for each player and each option\r\n  const [playerPreferences] = useState<PlayerPreference[]>(() => {\r\n    const preferences: PlayerPreference[] = [];\r\n    const attitudes = [ATTITUDE.LIKE, ATTITUDE.HATE, ATTITUDE.NEUTRAL];\r\n    \r\n    if (quest.playerChoices) {\r\n      for (let i = 0; i < quest.playerChoices.length; i++) {\r\n        for (const player of players) {\r\n          const randomAttitude = attitudes[Math.floor(Math.random() * 3)];\r\n          preferences.push({\r\n            playerId: player.id,\r\n            optionIndex: i,\r\n            attitude: randomAttitude\r\n          });\r\n        }\r\n      }\r\n    }\r\n    \r\n    return preferences;\r\n  });\r\n\r\n  const getPlayerPreferencesForOption = (optionIndex: number) => {\r\n    return playerPreferences.filter(pref => pref.optionIndex === optionIndex);\r\n  };\r\n\r\n  const getAttitudeColor = (attitude: ATTITUDE) => {\r\n    switch (attitude) {\r\n      case ATTITUDE.LIKE: return '#4CAF50'; // Green\r\n      case ATTITUDE.HATE: return '#F44336'; // Red\r\n      case ATTITUDE.NEUTRAL: return '#999999'; // Grey\r\n      default: return '#999999';\r\n    }\r\n  };\r\n\r\n  const getPlayerIcon = (playerId: number) => {\r\n    const player = players.find(p => p.id === playerId);\r\n    return player?.icon || '👤';\r\n  };\r\n\r\n  const handleOptionClick = (optionIndex: number) => {\r\n    setSelectedOption(optionIndex);\r\n    if (quest.playerChoices && quest.playerChoices[optionIndex]) {\r\n      setCurrentConversation(quest.playerChoices[optionIndex].conversation);\r\n    }\r\n  };\r\n\r\n  const renderConversation = (conversation: ChatMessage[]) => {\r\n    return conversation.map((message, index) => (\r\n      <div key={index} className=\"conversation-message\">\r\n        <div className=\"speaker\">\r\n          {message.speaker.type === 'dm' ? 'DM' : \r\n           message.speaker.type === 'player' ? `Player ${message.speaker.id}` :\r\n           message.speaker.type === 'character' ? `Character ${message.speaker.id}` : 'Unknown'}\r\n        </div>\r\n        <div className=\"message\">{message.message}</div>\r\n      </div>\r\n    ));\r\n  };\r\n\r\n  return (\r\n    <div className=\"quest-terminal-modal-overlay\">\r\n      <div className=\"quest-terminal-modal\">\r\n        <div className=\"modal-header\">\r\n          <h2>{quest.name} - Terminal</h2>\r\n          <button className=\"close-button\" onClick={onClose}>×</button>\r\n        </div>\r\n        \r\n        <div className=\"modal-content\">\r\n          <div className=\"conversation-panel\">\r\n            <h3>Conversation</h3>\r\n            <div className=\"conversation-content\">\r\n              {renderConversation(currentConversation)}\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"options-panel\">\r\n            <h3>Player Choices</h3>\r\n            {quest.playerChoices && quest.playerChoices.length > 0 ? (\r\n              <div className=\"player-options\">\r\n                {quest.playerChoices.map((choice, index) => (\r\n                  <div \r\n                    key={index}\r\n                    className={`option-tile ${selectedOption === index ? 'selected' : ''}`}\r\n                    onClick={() => handleOptionClick(index)}\r\n                  >\r\n                    <div className=\"option-content\">\r\n                      <h4>{choice.name}</h4>\r\n                      <p>{choice.description}</p>\r\n                    </div>\r\n                    \r\n                    <div className=\"player-preferences\">\r\n                      {getPlayerPreferencesForOption(index).map((pref, prefIndex) => (\r\n                        <div \r\n                          key={prefIndex}\r\n                          className=\"player-preference\"\r\n                          style={{ borderColor: getAttitudeColor(pref.attitude) }}\r\n                          title={`${getPlayerIcon(pref.playerId)} - ${pref.attitude}`}\r\n                        >\r\n                          {getPlayerIcon(pref.playerId)}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n                \r\n                {selectedOption !== null && (\r\n                  <div className=\"accept-rewards\">\r\n                    <h4>Rewards:</h4>\r\n                    <ul>\r\n                      {quest.rewards.map((reward, index) => (\r\n                        <li key={index}>\r\n                          {reward.name || reward.type}: {reward.amount}\r\n                          {reward.description && <span> - {reward.description}</span>}\r\n                        </li>\r\n                      ))}\r\n                    </ul>\r\n                    <button className=\"accept-button\" onClick={onComplete}>\r\n                      Accept Rewards\r\n                    </button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"no-choices\">\r\n                <p>No player choices available for this quest.</p>\r\n                <button className=\"accept-button\" onClick={onComplete}>\r\n                  Complete\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default QuestTerminalModal;\r\n","import React, { useState, useEffect, useMemo, useCallback } from \"react\";\r\nimport { useAppManager } from \"../managerContexts\";\r\nimport { ChatMessage, Quest, QuestNode, Tag } from \"../../models\";\r\nimport \"./QuestProgressModal.scss\";\r\nimport FlavorTagPill from \"./FlavorTagPill\";\r\nimport CImage from \"./cimage\";\r\nimport ConversationSection from \"./ConversationSection\";\r\nimport RewardDisplay from \"./RewardDisplay\";\r\n\r\ninterface QuestProgressModalProps {\r\n\tquest: Quest;\r\n\tcurrentNode: QuestNode;\r\n\tcollectedTags: Tag[];\r\n\tonClose: () => void;\r\n\tonAccept: () => void;\r\n}\r\n\r\nconst QuestProgressModal: React.FC<QuestProgressModalProps> = ({\r\n\tquest,\r\n\tcurrentNode,\r\n\tcollectedTags,\r\n\tonClose,\r\n\tonAccept,\r\n}) => {\r\n\tconst appManager = useAppManager();\r\n\tconst questManager = appManager.getQuestManager();\r\n\tconst [conversationComplete, setConversationComplete] = useState(false);\r\n\tconst [speedUp, setSpeedUp] = useState(false);\r\n\tconst [selectedTagForConversation, setSelectedTagForConversation] =\r\n\t\tuseState<Tag | null>(null);\r\n\r\n\t// Helper function to find a node by its tag\r\n\tconst findNodeByTag = useCallback(\r\n\t\t(node: QuestNode, tag: Tag): QuestNode | null => {\r\n\t\t\tif (node.tag.name === tag.name) {\r\n\t\t\t\treturn node;\r\n\t\t\t}\r\n\t\t\tfor (const child of node.children) {\r\n\t\t\t\tconst found = findNodeByTag(child, tag);\r\n\t\t\t\tif (found) return found;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\t[]\r\n\t);\r\n\r\n\t// Get the conversation messages for the current node\r\n\tconst messages = useMemo((): ChatMessage[] => {\r\n\t\tif (selectedTagForConversation && collectedTags.length > 0) {\r\n\t\t\t// Show conversation for selected collected tag\r\n\t\t\tconst tagNode = findNodeByTag(\r\n\t\t\t\tquest.startingNode,\r\n\t\t\t\tselectedTagForConversation\r\n\t\t\t);\r\n\t\t\treturn tagNode?.conversation || [];\r\n\t\t} else {\r\n\t\t\t// Show current node conversation\r\n\t\t\treturn currentNode.conversation || [];\r\n\t\t}\r\n\t}, [\r\n\t\tcurrentNode,\r\n\t\tselectedTagForConversation,\r\n\t\tquest.startingNode,\r\n\t\tcollectedTags,\r\n\t\tfindNodeByTag,\r\n\t]);\r\n\r\n\t// Determine if quest is complete\r\n\tconst isQuestComplete = useMemo(() => {\r\n\t\treturn questManager.isQuestComplete(quest.id);\r\n\t}, [questManager, quest.id]);\r\n\r\n\t// Combine starting node tag with collected tags for conversation selection\r\n\tconst availableTagsForConversation = useMemo(() => {\r\n\t\tconst startingTag = quest.startingNode.tag;\r\n\t\tconst allTags = [startingTag, ...collectedTags];\r\n\r\n\t\t// Remove duplicates by tag name\r\n\t\tconst uniqueTags = allTags.filter(\r\n\t\t\t(tag, index, array) =>\r\n\t\t\t\tarray.findIndex((t) => t.name === tag.name) === index\r\n\t\t);\r\n\r\n\t\treturn uniqueTags;\r\n\t}, [quest.startingNode.tag, collectedTags]);\r\n\r\n\t// Get upcoming quest topics (current node's children)\r\n\tconst upcomingQuestTopics = useMemo(() => {\r\n\t\tconst activeQuest = questManager\r\n\t\t\t.getActiveQuests()\r\n\t\t\t.find((aq) => aq.quest.id === quest.id);\r\n\t\tif (!activeQuest || isQuestComplete) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\treturn activeQuest.currentNode.children.map((child) => child.tag);\r\n\t}, [questManager, quest.id, isQuestComplete]);\r\n\r\n\t// Set the most recent tag for conversation by default\r\n\tuseEffect(() => {\r\n\t\tif (\r\n\t\t\tavailableTagsForConversation.length > 0 &&\r\n\t\t\t!selectedTagForConversation\r\n\t\t) {\r\n\t\t\t// Default to the most recently collected tag, or starting tag if none collected\r\n\t\t\tconst defaultTag =\r\n\t\t\t\tcollectedTags.length > 0\r\n\t\t\t\t\t? collectedTags[collectedTags.length - 1]\r\n\t\t\t\t\t: quest.startingNode.tag;\r\n\t\t\tsetSelectedTagForConversation(defaultTag);\r\n\t\t}\r\n\t}, [\r\n\t\tavailableTagsForConversation,\r\n\t\tselectedTagForConversation,\r\n\t\tcollectedTags,\r\n\t\tquest.startingNode.tag,\r\n\t]);\r\n\r\n\tconst handleClick = () => {\r\n\t\tif (!conversationComplete) {\r\n\t\t\tsetSpeedUp(true);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleModalClick = (e: React.MouseEvent) => {\r\n\t\te.stopPropagation();\r\n\t\thandleClick();\r\n\t};\r\n\r\n\tconst handleTagClick = (tag: Tag) => {\r\n\t\tsetSelectedTagForConversation(tag);\r\n\t\tsetConversationComplete(false);\r\n\t\tsetSpeedUp(false);\r\n\t};\r\n\r\n\tconst handleAccept = () => {\r\n\t\tif (conversationComplete) {\r\n\t\t\tif (isQuestComplete) {\r\n\t\t\t\t// Apply quest rewards\r\n\t\t\t\tquestManager.completeQuest(quest.id);\r\n\r\n\t\t\t\t// The QUEST MANAGER is kind of a bookkeeper and it shouldnt know about all the \r\n\t\t\t\t// extra managers and game junk. So lets extract the rewards here: \r\n\t\t\t\tconst rewards = quest.rewards;\r\n\t\t\t\tconst treasureReward = rewards.find(r => r.type === \"treasure\");\r\n\t\t\t\tconst scoreReward = rewards.find(r => r.type === \"score\");\r\n\t\t\t\t\r\n\t\t\t\tif(treasureReward) {\r\n\t\t\t\t\tappManager.getPartyManager().addTreasurePoints(treasureReward.amount);\r\n\t\t\t\t}\r\n\t\t\t\tif(scoreReward) {\r\n\t\t\t\t\tappManager.getCampaignManager().addEncounterPoints(scoreReward.amount);\r\n\t\t\t\t}\r\n\r\n\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// Activate quest and add first tag to pool\r\n\t\t\t\tquestManager.activateQuest(quest.id);\r\n\t\t\t}\r\n\t\t\tonAccept();\r\n\t\t\tonClose();\r\n\t\t}\r\n\t};\r\n\r\n\tconst formatCostDescription = (cost: any) => {\r\n\t\tswitch (cost.type) {\r\n\t\t\tcase \"exhaustion\":\r\n\t\t\t\treturn `Increases party exhaustion by ${cost.amount}`;\r\n\t\t\tcase \"points\":\r\n\t\t\t\treturn `Costs ${cost.amount} encounter points`;\r\n\t\t\tcase \"tension\":\r\n\t\t\t\treturn `Increases party tension by ${cost.amount}`;\r\n\t\t\tdefault:\r\n\t\t\t\treturn `${cost.type}: ${cost.amount}`;\r\n\t\t}\r\n\t};\r\n\r\n\tconst formatRewardDescription = (reward: any) => {\r\n\t\tswitch (reward.type) {\r\n\t\t\tcase \"gmPoints\":\r\n\t\t\t\treturn `Grants ${reward.amount} GM points`;\r\n\t\t\tcase \"treasure\":\r\n\t\t\t\treturn `Adds ${reward.amount} treasure`;\r\n\t\t\tcase \"score\":\r\n\t\t\t\treturn `Adds ${reward.amount} to campaign score`;\r\n\t\t\tcase \"reward\":\r\n\t\t\t\treturn `Provides ${reward.amount} party rewards`;\r\n\t\t\tdefault:\r\n\t\t\t\treturn `${reward.type}: ${reward.amount}`;\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"modal-overlay blue-theme\" onClick={handleClick}>\r\n\t\t\t<div className=\"modal-container questprogress\" onClick={handleModalClick}>\r\n\t\t\t\t{/* Header strip with quest info */}\r\n\t\t\t\t<div className=\"questprogress-header\">\r\n\t\t\t\t\t<div className=\"header-background\">\r\n\t\t\t\t\t\t{quest.icon && <CImage imageId={quest.icon} />}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"header-overlay\"></div>\r\n\t\t\t\t\t<div className=\"header-content\">\r\n\t\t\t\t\t\t<div className=\"header-left\">\r\n\t\t\t\t\t\t\t<div className=\"quest-info\">\r\n\t\t\t\t\t\t\t\t<div className=\"quest-title\">{quest.name}</div>\r\n\t\t\t\t\t\t\t\t<div className=\"quest-description\">{quest.description}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"header-right\">\r\n\t\t\t\t\t\t\t<button className=\"close-button\" onClick={onClose}>\r\n\t\t\t\t\t\t\t\t×\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Quest Progress Section */}\r\n\t\t\t\t<div className=\"quest-progress-section\">\r\n\t\t\t\t\t{/* Quest Progress Row - Always show at least starting node */}\r\n\t\t\t\t\t<div className=\"progress-row\">\r\n\t\t\t\t\t\t<div className=\"progress-label\">\r\n\t\t\t\t\t\t\t<h4>Quest Progress</h4>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"progress-tags\">\r\n\t\t\t\t\t\t\t{availableTagsForConversation.map((tag, index) => {\r\n\t\t\t\t\t\t\t\tconst isStartingTag = tag.name === quest.startingNode.tag.name;\r\n\t\t\t\t\t\t\t\tconst isCompleted = collectedTags.some(\r\n\t\t\t\t\t\t\t\t\t(ct) => ct.name === tag.name\r\n\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\tclassName={`progress-tag-item ${\r\n\t\t\t\t\t\t\t\t\t\t\tselectedTagForConversation?.name === tag.name\r\n\t\t\t\t\t\t\t\t\t\t\t\t? \"selected\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t: \"\"\r\n\t\t\t\t\t\t\t\t\t\t} ${isStartingTag ? \"starting-tag\" : \"\"} ${\r\n\t\t\t\t\t\t\t\t\t\t\tisCompleted ? \"completed-tag\" : \"\"\r\n\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => handleTagClick(tag)}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<FlavorTagPill\r\n\t\t\t\t\t\t\t\t\t\t\ttag={{\r\n\t\t\t\t\t\t\t\t\t\t\t\ttag,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttheme: \"none\" as any,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsource: \"QUEST\" as any,\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\tshowTooltip={false}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Upcoming Quest Topics Row */}\r\n\t\t\t\t\t{/* {upcomingQuestTopics.length > 0 && !isQuestComplete && (\r\n\t\t\t\t\t\t<div className=\"progress-row\">\r\n\t\t\t\t\t\t\t<div className=\"progress-label\">\r\n\t\t\t\t\t\t\t\t<h4>Upcoming Quest Topics</h4>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"progress-tags\">\r\n\t\t\t\t\t\t\t\t{upcomingQuestTopics.map((tag, index) => (\r\n\t\t\t\t\t\t\t\t\t<div key={index} className=\"progress-tag-item upcoming-tag\">\r\n\t\t\t\t\t\t\t\t\t\t<FlavorTagPill\r\n\t\t\t\t\t\t\t\t\t\t\ttag={{\r\n\t\t\t\t\t\t\t\t\t\t\t\ttag,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttheme: \"none\" as any,\r\n\t\t\t\t\t\t\t\t\t\t\t\tsource: \"QUEST\" as any,\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\tshowTooltip={false}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)} */}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Side-by-side content */}\r\n\t\t\t\t<div className=\"questprogress-body\">\r\n\t\t\t\t\t{/* Left side - Conversation */}\r\n\t\t\t\t\t<div className=\"conversation-section\">\r\n\t\t\t\t\t\t<div className=\"conversation-content\">\r\n\t\t\t\t\t\t\t{messages.length > 0 ? (\r\n\t\t\t\t\t\t\t\t<ConversationSection\r\n\t\t\t\t\t\t\t\t\ttitle=\"Quest Dialogue\"\r\n\t\t\t\t\t\t\t\t\tmessages={messages}\r\n\t\t\t\t\t\t\t\t\tonComplete={() => setConversationComplete(true)}\r\n\t\t\t\t\t\t\t\t\tspeedUp={speedUp}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<div className=\"no-conversation\">\r\n\t\t\t\t\t\t\t\t\tNo dialogue available for this quest step.\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Right side - Quest Details */}\r\n\t\t\t\t\t<div className=\"quest-details-section\">\r\n\t\t\t\t\t\t<div className=\"section-header\">\r\n\t\t\t\t\t\t\t<h3>{isQuestComplete ? \"Quest Completed!\" : \"Quest Details\"}</h3>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"quest-details-content\">\r\n\t\t\t\t\t\t\t{!isQuestComplete ? (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t{/* Quest Cost */}\r\n\t\t\t\t\t\t\t\t\t<div className=\"quest-info-block\">\r\n\t\t\t\t\t\t\t\t\t\t<h4>Quest Cost</h4>\r\n\t\t\t\t\t\t\t\t\t\t{quest.cost.map((cost, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<div key={index} className=\"cost-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"cost-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{cost.type.charAt(0).toUpperCase() +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcost.type.slice(1)}{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+{cost.amount}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{/* <div className=\"cost-description\">{formatCostDescription(cost)}</div> */}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t{/* Quest Rewards */}\r\n\t\t\t\t\t\t\t\t\t<div className=\"quest-info-block\">\r\n\t\t\t\t\t\t\t\t\t\t<h4>Quest Rewards</h4>\r\n\t\t\t\t\t\t\t\t\t\t{quest.rewards.map((reward, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<div key={index} className=\"reward-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<RewardDisplay reward={reward} />\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t/* Quest Complete - Highlight Rewards */\r\n\t\t\t\t\t\t\t\t<div className=\"quest-complete-rewards\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"quest-info-block highlighted\">\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"quest-info-block\">\r\n\t\t\t\t\t\t\t\t\t\t<h4>Quest Rewards</h4>\r\n\t\t\t\t\t\t\t\t\t\t{quest.rewards.map((reward, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<div key={index} className=\"reward-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<RewardDisplay reward={reward} />\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Footer with OK button */}\r\n\t\t\t\t<div className=\"questprogress-footer\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName={`questprogress-accept-button ${\r\n\t\t\t\t\t\t\t!conversationComplete ? \"disabled\" : \"\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\tonClick={handleAccept}\r\n\t\t\t\t\t\tdisabled={!conversationComplete}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{isQuestComplete ? \"CLAIM REWARDS\" : \"CONTINUE\"}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default QuestProgressModal;\r\n","import React from \"react\";\r\nimport { QuestReward, Quest, QuestNode } from \"../../models\";\r\nimport \"./ActiveQuestsModal.scss\";\r\nimport Cbox from \"./cbox\";\r\nimport CImage from \"./cimage\";\r\nimport RewardDisplay from \"./RewardDisplay\";\r\n\r\n// Define ActiveQuest interface to match questManager\r\ninterface ActiveQuestData {\r\n\tquest: Quest;\r\n\tcurrentNode: QuestNode;\r\n\tcompletedTags: string[]; // Array of tag names\r\n}\r\n\r\ninterface ActiveQuestsModalProps {\r\n\tactiveQuests: ActiveQuestData[];\r\n\tonQuestSelect: (questId: string) => void;\r\n\tonClose: () => void;\r\n\tgetCollectedTagsForQuest: (questId: string) => any[]; // Function to get actual tag objects\r\n}\r\n\r\nconst ActiveQuestsModal: React.FC<ActiveQuestsModalProps> = ({\r\n\tactiveQuests,\r\n\tonQuestSelect,\r\n\tonClose,\r\n\tgetCollectedTagsForQuest,\r\n}) => {\r\n\t// Helper function to count all possible tags in a quest\r\n\tconst getAllTagsForQuest = (quest: Quest): number => {\r\n\t\tconst allTags = new Set<string>();\r\n\t\tconst countTags = (node: QuestNode) => {\r\n\t\t\tallTags.add(node.tag.name);\r\n\t\t\tfor (const child of node.children) {\r\n\t\t\t\tcountTags(child);\r\n\t\t\t}\r\n\t\t};\r\n\t\tcountTags(quest.startingNode);\r\n\t\treturn allTags.size;\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"active-quests-modal-overlay\">\r\n\t\t\t<div className=\"quest-modal-container\">\r\n\t\t\t\t<Cbox title=\"Active Quests\" theme=\"quests\">\r\n\t\t\t\t\t<div className=\"modal-header\">\r\n\t\t\t\t\t\t<div className=\"quest-subheader\">\r\n\t\t\t\t\t\t\tView your currently active side-stories and their progress.\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<button className=\"close-button\" onClick={onClose}>×</button>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{activeQuests.length === 0 ? (\r\n\t\t\t\t\t\t<div className=\"no-active-quests\">\r\n\t\t\t\t\t\t\t<p>No active quests at the moment.</p>\r\n\t\t\t\t\t\t\t<p>Complete tag collections or advance the story to discover new quests!</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<div className=\"quest-tiles\">\r\n\t\t\t\t\t\t\t{activeQuests.map((activeQuest) => {\r\n\t\t\t\t\t\t\t\tconst quest = activeQuest.quest;\r\n\t\t\t\t\t\t\t\tconst collectedTags = getCollectedTagsForQuest(quest.id);\r\n\t\t\t\t\t\t\t\tconst totalTags = getAllTagsForQuest(quest);\r\n\t\t\t\t\t\t\t\tconst progressPercentage = Math.round(\r\n\t\t\t\t\t\t\t\t\t(collectedTags.length / totalTags) * 100\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Cbox\r\n\t\t\t\t\t\t\t\t\t\tkey={quest.id}\r\n\t\t\t\t\t\t\t\t\t\ttitle={quest.name}\r\n\t\t\t\t\t\t\t\t\t\ttheme={\"quest\"}\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => onQuestSelect(quest.id)}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"quest-tile-content active-quest\"\r\n\t\t\t\t\t\t\t\t\t\t\tdata-quest-icon={quest.icon || \"default\"}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"quest-icon-background\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{quest.icon && <CImage imageId={quest.icon} />}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"quest-content-overlay\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"quest-info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"quest-progress-bar\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"progress-label\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tProgress: {progressPercentage}%\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"progress-track\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"progress-fill\" \r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ width: `${progressPercentage}%` }}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"progress-details\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{collectedTags.length} / {totalTags} tags collected\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"quest-description\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{quest.description}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"quest-rewards\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"rewards-title\">Potential Rewards:</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"quest-reward-row\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{quest.rewards.map((reward: QuestReward, index: number) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span key={index} className=\"quest-reward\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"quest-reward-treasure\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<RewardDisplay reward={reward} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</Cbox>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</Cbox>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ActiveQuestsModal;","import React, { useEffect } from 'react';\r\nimport './globalUi.scss';\r\nimport { APP_STATE } from '../../consts/states';\r\nimport { useAppManager, useUiManager } from '../managerContexts';\r\nimport Notebook from './notebook';\r\nimport { Modal } from './modal';\r\nimport SelectQuestModal from './SelectQuestModal';\r\nimport QuestTerminalModal from './QuestTerminalModal';\r\nimport QuestProgressModal from './QuestProgressModal';\r\nimport ActiveQuestsModal from './ActiveQuestsModal';\r\n\r\ninterface GlobalUiProps {\r\n \r\n}\r\n\r\nconst GlobalUi: React.FC<GlobalUiProps> = () => {\r\n\r\n  const appManager = useAppManager();\r\n  const uiManager = useUiManager();\r\n\r\n  const [state, setState] = React.useState(appManager.state);\r\n  const [notebookState, setNotebookState] = React.useState(undefined)\r\n  const [tutorialPage, setTutorialPage] = React.useState(0)\r\n  const [selectQuestModalVisible, setSelectQuestModalVisible] = React.useState(false);\r\n  const [activeQuestsModalVisible, setActiveQuestsModalVisible] = React.useState(false);\r\n  const [questTerminalModal, setQuestTerminalModal] = React.useState<{\r\n    quest: any;\r\n    node: any;\r\n  } | null>(null);\r\n  const [questProgressModalQuestId, setQuestProgressModalQuestId] = React.useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const handleStateChange = () => {\r\n      setState(appManager.state);\r\n    };\r\n\r\n    const handleSetNotebookState = (newState: any) => {\r\n      setTutorialPage(0)\r\n      setNotebookState(newState);\r\n    }\r\n\r\n    const handleTutorialPage = (page: number) => {\r\n      setTutorialPage(page)\r\n    }\r\n\r\n    const handleShowSelectQuestModal = (show: boolean) => {\r\n      setSelectQuestModalVisible(show);\r\n    };\r\n\r\n    const handleShowActiveQuestsModal = (show: boolean) => {\r\n      setActiveQuestsModalVisible(show);\r\n    };\r\n\r\n    const handleShowQuestTerminalModal = (data: { quest: any; node: any } | null) => {\r\n      setQuestTerminalModal(data);\r\n    };\r\n\r\n    const handleShowQuestProgressModal = (questId: string | null) => {\r\n      setQuestProgressModalQuestId(questId);\r\n    };\r\n\r\n    appManager.on('stateChange', handleStateChange);\r\n    uiManager.on('setNotebookState', handleSetNotebookState)\r\n    uiManager.on('setTutorialPage', handleTutorialPage)\r\n    uiManager.on('showSelectQuestModal', handleShowSelectQuestModal);\r\n    uiManager.on('showActiveQuestsModal', handleShowActiveQuestsModal);\r\n    uiManager.on('showQuestTerminalModal', handleShowQuestTerminalModal);\r\n    uiManager.on('showQuestProgressModal', handleShowQuestProgressModal);\r\n    \r\n    return () => {\r\n      uiManager.off('setNotebookState', handleSetNotebookState);\r\n      appManager.off('stateChange', handleStateChange);\r\n      uiManager.off('setTutorialPage', handleTutorialPage)\r\n      uiManager.off('showSelectQuestModal', handleShowSelectQuestModal);\r\n      uiManager.off('showActiveQuestsModal', handleShowActiveQuestsModal);\r\n      uiManager.off('showQuestTerminalModal', handleShowQuestTerminalModal);\r\n      uiManager.off('showQuestProgressModal', handleShowQuestProgressModal);\r\n    };\r\n  \r\n  }, [appManager, uiManager]);\r\n  \r\n  function getStateComponent( state: APP_STATE) {\r\n    switch(state) {\r\n      case APP_STATE.PLAYER_RECRUITMENT:\r\n      case APP_STATE.CHARACTER_CREATION:\r\n      case APP_STATE.MAIN_MENU:\r\n      case APP_STATE.CAMPAIGN_SETUP:\r\n      case APP_STATE.SESSION_OVERVIEW:\r\n      case APP_STATE.SESSION:\r\n      case APP_STATE.SCORE:\r\n      default:\r\n        return  getDefaultStateComponent()\r\n    }\r\n  }\r\n\r\n  // not yet implemented state UI\r\n  function getDefaultStateComponent() {\r\n    return <div></div>\r\n  }\r\n\r\n  return (\r\n    <div className=\"global-ui-container\">\r\n      <div className=\"state-display\">\r\n        {getStateComponent(state)}\r\n      </div>\r\n        {\r\n        notebookState ?  \r\n        <Notebook\r\n            notebookPages={notebookState}\r\n            pageIndex={tutorialPage}\r\n        /> : null}\r\n        <Modal />\r\n        \r\n        {selectQuestModalVisible && (\r\n          <SelectQuestModal\r\n            quests={[\r\n              ...appManager.getQuestManager().getAvailableQuests(),\r\n              ...appManager\r\n                .getQuestManager()\r\n                .getActiveQuests()\r\n                .map((aq) => aq.quest),\r\n            ]}\r\n            activeQuestIds={appManager\r\n              .getQuestManager()\r\n              .getActiveQuests()\r\n              .map((aq) => aq.quest.id)}\r\n            onQuestSelect={(questId: string) => {\r\n              // Close the selection modal and show the quest progress modal\r\n              uiManager.questSelected(questId);\r\n            \r\n            }}\r\n            onClose={() => uiManager.hideSelectQuestModal()}\r\n          />\r\n        )}\r\n\r\n        {activeQuestsModalVisible && (\r\n          <ActiveQuestsModal\r\n            activeQuests={appManager.getQuestManager().getActiveQuests()}\r\n            onQuestSelect={(questId: string) => {\r\n              // Close the active quests modal and show the quest progress modal\r\n              uiManager.hideActiveQuestsModal();\r\n              uiManager.showQuestProgressModal(questId);\r\n            }}\r\n            onClose={() => uiManager.hideActiveQuestsModal()}\r\n            getCollectedTagsForQuest={(questId: string) => appManager.getQuestManager().getCollectedTagsForQuest(questId)}\r\n          />\r\n        )}\r\n\r\n        {questTerminalModal && (\r\n          <QuestTerminalModal\r\n            quest={questTerminalModal.quest}\r\n            node={questTerminalModal.node}\r\n            players={appManager.getPlayerManager().getPlayers()}\r\n            onComplete={() => {\r\n              // Handle quest terminal completion\r\n              appManager\r\n                .getQuestManager()\r\n                .advanceQuest(\r\n                  questTerminalModal.quest.id,\r\n                  questTerminalModal.node.id\r\n                );\r\n              uiManager.hideQuestTerminalModal();\r\n            }}\r\n            onClose={() => uiManager.hideQuestTerminalModal()}\r\n          />\r\n        )}\r\n        \r\n        {questProgressModalQuestId && (\r\n          <QuestProgressModal\r\n            quest={(() => {\r\n              // Find quest in available or active quests\r\n              const availableQuest = appManager.getQuestManager().getAvailableQuests().find(q => q.id === questProgressModalQuestId);\r\n              if (availableQuest) return availableQuest;\r\n              \r\n              const activeQuest = appManager.getQuestManager().getActiveQuests().find(aq => aq.quest.id === questProgressModalQuestId);\r\n              return activeQuest?.quest;\r\n            })()!}\r\n            currentNode={(() => {\r\n              // Get current node for the quest\r\n              const activeQuest = appManager.getQuestManager().getActiveQuests().find(aq => aq.quest.id === questProgressModalQuestId);\r\n              if (activeQuest) return activeQuest.currentNode;\r\n              \r\n              // If not active, use starting node\r\n              const quest = appManager.getQuestManager().getAvailableQuests().find(q => q.id === questProgressModalQuestId);\r\n              return quest?.startingNode;\r\n            })()!}\r\n            collectedTags={appManager.getQuestManager().getCollectedTagsForQuest(questProgressModalQuestId)}\r\n            onClose={() => uiManager.hideQuestProgressModal()}\r\n            onAccept={() => {\r\n              appManager.getQuestManager().launchQuest(questProgressModalQuestId);\r\n              uiManager.hideQuestProgressModal();\r\n            }}\r\n          />\r\n        )}\r\n        \r\n        {/* <Chat /> */}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default GlobalUi;\r\n","import React from 'react';\r\nimport './App.scss';\r\nimport AppManager from './managers/appManager';\r\nimport ModeContainer from './components/modecontainer';\r\nimport GlobalUi from './components/UI/globalUi';\r\n\r\ninterface AppProps {\r\n}\r\n\r\nconst App: React.FC<AppProps> = ({}) => {\r\n//  const [state, setState] = React.useState(appManager.state);\r\n  \r\n  return (\r\n    <div>\r\n      <div className=\"App\">\r\n        <ModeContainer\r\n        />\r\n      </div>\r\n      <GlobalUi \r\n      \r\n      />\r\n      </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { execPath } from \"process\";\r\nimport {TRAVEL_OPTION } from \"../models\";\r\nimport { TAG } from \"./tags\";\r\n\r\n   \r\n  export const TRAVEL_OPTIONS_SHORT = [\r\n    {\r\n      id: 'exposition',\r\n      name: 'Boring Exposition',\r\n      description: 'Dryly describe the surroundings.',\r\n      time: 2,\r\n      tags: 2,\r\n      score: 0,\r\n      boredom: 20,\r\n      repeatable: true,\r\n      exhaustion: 10,\r\n      travelOptionType: TRAVEL_OPTION.EXPLORE_CURRENT_LOCATION,\r\n      tagInstructions: 'Describe the current area as you travel.'\r\n    },\r\n    {\r\n      id: 'forage',\r\n      name: 'Forage for Supplies',\r\n      description: 'Players procure supplies for the journey, or forage along the way.',\r\n      time: 5,\r\n      tags: 1,\r\n      score: 0,\r\n      boredom: 3,\r\n      repeatable: true,\r\n      exhaustion: 2,\r\n      travelOptionType: TRAVEL_OPTION.EXPLORE_CURRENT_LOCATION,\r\n      tagInstructions: 'describe something about the current location',\r\n    },\r\n    {\r\n      id: 'stories',\r\n      name: 'Share Stories',\r\n      description: 'Characters discuss their pasts during the trip.',\r\n      time: 5,\r\n      tags: 1,\r\n      score: 0,\r\n      boredom: 5,\r\n      exhaustion: 5,\r\n      travelOptionType: TRAVEL_OPTION.CHARACTER_BACKSTORY,\r\n      tagInstructions: 'Add a detail to a Character\\'s backstory',\r\n    },\r\n    {\r\n      id: 'scout_ahead',\r\n      name: 'Scout Ahead',\r\n      description: 'The players send a character to scout the path ahead',\r\n      time: 5,\r\n      tags: 1,\r\n      score: 0,\r\n      boredom: 10,\r\n      exhaustion: 3,\r\n      travelOptionType: TRAVEL_OPTION.EXPLORE_UPCOMING_LOCATION,\r\n      tagInstructions: 'Bring up something about what may lie ahead',\r\n    },\r\n  ]\r\n\r\n  export const TRAVEL_OPTIONS_MEDIUM = [\r\n    {\r\n      id: 'camp',\r\n      name: 'Camp',\r\n      description: 'Spend an uneventful night',\r\n      time: 20,\r\n      tags: 0,\r\n      score: 0,\r\n      repeatable: true,\r\n      boredom: 5,\r\n      travelOptionType: TRAVEL_OPTION.CAMP,\r\n      exhaustion: 5,\r\n    },\r\n    {\r\n      id: 'ambush',\r\n      name: 'Remember Me?',\r\n      description: 'An enemy from the past ambushes the party',\r\n      time: 10,\r\n      tags: 0,\r\n      score: 0,\r\n      boredom: 0,\r\n      travelOptionType: TRAVEL_OPTION.AMBUSH,\r\n      tagInstructions: '',\r\n      exhaustion: 15,\r\n    },\r\n    {\r\n      id: 'ambush2',\r\n      name: 'Camp Ambush',\r\n      description: 'Attacked in the night',\r\n      time: 10,\r\n      tags: 1,\r\n      score: 0,\r\n      boredom: 0,\r\n      travelOptionType: TRAVEL_OPTION.AMBUSH2,\r\n      tagInstructions: 'Introduce a new enemy',\r\n      exhaustion: 15,\r\n    },\r\n    {\r\n      id: 'traders',\r\n      name: 'Traders',\r\n      description: 'Characters meet traders on the road',\r\n      time: 5, \r\n      tags: 1,\r\n      score: 0,\r\n      boredom: 5,\r\n      travelOptionType: TRAVEL_OPTION.TRADERS,\r\n      tagInstructions: 'The Characters trade all their junk loot for some coins',\r\n      exhaustion: 5,\r\n    },\r\n    {\r\n      id: 'mysterious_cache',\r\n      name: 'Elven Cache',\r\n      description: 'Discover a hidden cache along the route.',\r\n      time: 10,\r\n      tags: 1,\r\n      score: 0,\r\n      boredom: 5,\r\n      tag: TAG.ELVES,\r\n      travelOptionType: TRAVEL_OPTION.MAGIC_CACHE,\r\n      tagInstructions: 'Reward a magic item from the cache.',\r\n      exhaustion: 10,\r\n    },\r\n  ]\r\n\r\n  export const TRAVEL_OPTIONS_LONG = [\r\n    {\r\n      id: 'cartography',\r\n      name: 'Cartography',\r\n      description: 'A player wants to carefully draw a map of the region...',\r\n      time: 15,\r\n      tags: 2,\r\n      score: 0,\r\n      exhaustion: 15,\r\n      boredom: 20,\r\n      travelOptionType: TRAVEL_OPTION.EXPLORE_CURRENT_LOCATION,\r\n      tagInstructions: 'The players learn things about the area while drawing a map',\r\n    },\r\n    {\r\n      id: 'horseback',\r\n      name: 'Horseback Riding',\r\n      description: 'Good thing we have these horsies!',\r\n      time: 20,\r\n      tags: 0,\r\n      score: 0,\r\n      boredom: 5,\r\n      exhaustion: 5,\r\n      travelOptionType: TRAVEL_OPTION.TRAVEL,\r\n      tag: TAG.HORSES,\r\n    },\r\n    {\r\n      id: 'ship',\r\n      name: 'Ship Travel',\r\n      description: 'How convenient! We can take this ship!',\r\n      time: 20,\r\n      tags: 0,\r\n      score: 0,\r\n      boredom: 5,\r\n      exhaustion: 5,\r\n      travelOptionType: TRAVEL_OPTION.TRAVEL,\r\n      tag: TAG.SHIPS,\r\n    },\r\n  ]","import { Character, ChatMessage, ChatTrigger, Encounter, EncounterFlavorTag, EncounterState, FlavorTagSource, FlavorTagTheme, NOTEBOOK_CATEGORY, TAGS_TYPE, PerceptionTags, REWARD_TYPE, RewardItem, RPEncounterFlavorTag, SESSION_STATE, Tag, TAG_TYPE, TravelOption, TRAVEL_OPTION, TravelResultConfig, EffectData, ATTRIBUTE_TYPE, Player, Campaign, ScoreEntry } from '.././models';\r\nimport { CAMPAIGNS, NB_EXPECTED_ENCOUNTER_TAGS } from '../consts/campaigns';\r\nimport { TAG } from '../consts/tags';\r\nimport { TENSION_DESCRIPTIONS, TensionDescription, PROPS_SCORES, PROPS_ENCOUNTER_SCORES, COMFORT_EXHAUSTION_BONUS } from '../consts/score';\r\nimport { calculateTotalScore } from '../utils/scoreUtils';\r\nimport AppManager from './appManager';\r\nimport PlayerManager from './playerManager';\r\nimport EventEmitter from 'events';\r\nimport { APP_STATE } from '../consts/states';\r\nimport { THEME_FILLED_REQ } from '../consts/general';\r\nimport { TRAVEL_OPTIONS_LONG, TRAVEL_OPTIONS_MEDIUM, TRAVEL_OPTIONS_SHORT } from '../consts/travel';\r\nimport TagManager from './tagManager';\r\nimport ActiveQuestsModal from '../components/UI/ActiveQuestsModal';\r\n\r\n\r\nclass CampaignManager extends EventEmitter {\r\n  currentCampaign: Campaign;\r\n  appManager: AppManager;\r\n  currentEncounter: Encounter | undefined;\r\n  encounterState: EncounterState | undefined;\r\n  playerManager: PlayerManager;\r\n  tagManager: TagManager;\r\n  collectedTreasure: number = 0;\r\n\r\n  establishedTags: Tag[] = [];\r\n  rumorTags: Tag[] = []; //Maxim:L refatoring  - these are for backstories and magic items. I dont think we want them for ANYTHING else....its just to introduce those into otherwise random taglists\r\n  collectedLocationTags: Tag[] = [];\r\n  expectedTagsForBranches: { [key: string]: Tag[] } = {};\r\n  resolvedTagsForBranches: { [key: string]: Tag[] } = {};\r\n  // New properties for encounter scene tracking\r\n  encounterSetScene: { [key: string]: boolean } = {};\r\n  dmTricks: EncounterFlavorTag[] = [];\r\n  dmPoints: number = 0;\r\n\r\n\r\n  campaignProgress: number = 0;\r\n  toneCounts: { [key in FlavorTagTheme]?: number } = {};\r\n  completedEventIndexes: number[] = [];\r\n  dmLevel: number = 1;\r\n  dmExperience: number = 0;\r\n  encounterPrepBonus: number = 0;\r\n  campaignScore: number = 0;\r\n  encounterPoints: number = 0;\r\n  travelOptions: TravelOption[][] = [TRAVEL_OPTIONS_SHORT, TRAVEL_OPTIONS_MEDIUM, TRAVEL_OPTIONS_LONG];\r\n\r\n  // Dynamic tension descriptions that can be modified during gameplay\r\n  tensionDescriptions: TensionDescription[] = [...TENSION_DESCRIPTIONS];\r\n\r\n  // DM Abilities System\r\n  dmAbilityPoints: number = 0;\r\n  // Simplified consumables tracking - max and remaining only\r\n  maxSnacks: number = 0;\r\n  remainingSnacks: number = 0;\r\n  maxBreaks: number = 0;\r\n  remainingBreaks: number = 0;\r\n\r\n  // Comprehensive DM Abilities Tracking (without consumables - they're now tracked separately)\r\n  dmAbilities: {\r\n    abilityMeters: {\r\n      [key: string]: {\r\n        id: string;\r\n        currentLevel: number;\r\n        maxLevel: number;\r\n        pointsSpent: number;\r\n      }\r\n    };\r\n    gameMasteries: {\r\n      [key: string]: {\r\n        id: string;\r\n        currentLevel: number;\r\n        maxLevel: number;\r\n        pointsSpent: number;\r\n      }\r\n    };\r\n  } = {\r\n      abilityMeters: {\r\n        tones: { id: 'tones', currentLevel: 0, maxLevel: 5, pointsSpent: 0 },\r\n        hosting: { id: 'hosting', currentLevel: 0, maxLevel: 4, pointsSpent: 0 },\r\n        storytelling: { id: 'storytelling', currentLevel: 0, maxLevel: 3, pointsSpent: 0 }\r\n      },\r\n      gameMasteries: {\r\n        roleplaying: { id: 'roleplaying', currentLevel: 0, maxLevel: 3, pointsSpent: 0 },\r\n        combat: { id: 'combat', currentLevel: 0, maxLevel: 3, pointsSpent: 0 },\r\n        travel: { id: 'travel', currentLevel: 0, maxLevel: 3, pointsSpent: 0 }\r\n      }\r\n    };\r\n\r\n  constructor(appManager: AppManager) {\r\n    super();\r\n    this.appManager = appManager;\r\n    this.playerManager = appManager.getPlayerManager();\r\n    this.tagManager = appManager.getTagManager();\r\n    this.currentCampaign = CAMPAIGNS[0]; // Default to the first campaign\r\n    this.init();\r\n\r\n\r\n  }\r\n\r\n  partyManager() {\r\n\r\n    return this.appManager.getPartyManager();\r\n  }\r\n\r\n  init() {\r\n\r\n    this.dmTricks = [\r\n\r\n    ]\r\n\r\n    // Initialize consumables based on current hosting level\r\n    this.resetConsumables();\r\n  }\r\n\r\n  // Initialize/reset consumables\r\n  private resetConsumables(): void {\r\n    const hostingLevel = this.getDMAbilityMeterLevel('hosting');\r\n    \r\n    // Reset max values based on hosting level\r\n    this.maxSnacks = hostingLevel >= 1 ? 1 : 0;\r\n    this.maxBreaks = hostingLevel >= 2 ? 1 : 0;\r\n    this.maxProps = hostingLevel >= 3 ? 1 : 0;\r\n    this.maxVenue = hostingLevel >= 4 ? 1 : 0;\r\n    \r\n    // Set remaining/current to max (full reset)\r\n    this.remainingSnacks = this.maxSnacks;\r\n    this.remainingBreaks = this.maxBreaks;\r\n    this.currentProps = this.maxProps;\r\n    this.currentVenue = this.maxVenue;\r\n  }\r\n\r\n\r\n\r\n  // ---------------------------------------------------------------------------------------------------------\r\n  // DM SCREEN EVENTS\r\n  // ---------------------------------------------------------------------------------------------------------\r\n\r\n\r\n\r\n  redeemTheme(theme: string) {\r\n    delete this.toneCounts[theme as FlavorTagTheme];\r\n    switch (theme) {\r\n      case FlavorTagTheme.COMEDIC:\r\n        this.partyManager().addPartyEnjoyment(1);\r\n        break;\r\n      // case FlavorTagTheme.HEROIC:\r\n      //   this.partyManager().addPartyEnjoyment(1);\r\n      //   break;\r\n      case FlavorTagTheme.HEROIC:\r\n        this.partyManager().setPartyTension(50);\r\n        break;\r\n      case FlavorTagTheme.DRAMATIC:\r\n        this.partyManager().updateAllAttention(10);\r\n        break;\r\n      case FlavorTagTheme.GRIM:\r\n        this.adjustTensionMeterForGrimTone();\r\n        break;\r\n      case FlavorTagTheme.ROMANTIC:\r\n        this.adjustTensionMeterForRomanticTone();\r\n        break;\r\n      // case FlavorTagTheme.FANTASY:\r\n      //   this.partyManager().addPartyEnjoyment(1);\r\n      //   break;\r\n      // case FlavorTagTheme.HORROR:\r\n      //   this.partyManager().addPartyEnjoyment(1);\r\n      //   break;\r\n      case FlavorTagTheme.NONE:\r\n        this.partyManager().addPartyEnjoyment(1);\r\n        break;\r\n    }\r\n    this.emit('dmScreenUpdated', this.toneCounts);\r\n  }\r\n\r\n  // This occurs when a user hits a theme that has been filled. \r\n  continueTheme(theme: string) {\r\n    // this.partyManager().addPartyScore(10);\r\n  }\r\n\r\n\r\n\r\n  updateFlavorTagThemesTally(tags: EncounterFlavorTag[]) {\r\n    tags.forEach(tag => {\r\n      if (tag.theme === FlavorTagTheme.NONE) {\r\n        return;\r\n      }\r\n      this.addTheme(tag.theme);\r\n    });\r\n  }\r\n\r\n  themedUiClicked(theme: string) {\r\n\r\n    this.addTheme(theme);\r\n    this.emit('dmScreenUpdated', this.toneCounts);\r\n  }\r\n\r\n  addTheme(theme: string) {\r\n    if (theme === FlavorTagTheme.NONE) {\r\n      return;\r\n    }\r\n    if (this.toneCounts[theme as FlavorTagTheme] === undefined) {\r\n      this.toneCounts[theme as FlavorTagTheme] = 1;\r\n    }\r\n    else if ((this.toneCounts[theme as FlavorTagTheme] || 0) >= THEME_FILLED_REQ) {\r\n      this.continueTheme(theme);\r\n    } else {\r\n      this.toneCounts[theme as FlavorTagTheme] = Math.min(THEME_FILLED_REQ, Math.max(0, (this.toneCounts[theme as FlavorTagTheme] || 0) + 1));\r\n    }\r\n\r\n\r\n    this.emit('dmScreenUpdated', this.toneCounts);\r\n  }\r\n\r\n\r\n\r\n  spendDMPoints(points: number) {\r\n    this.dmPoints += points;\r\n    this.emit('dmScreenUpdated', this.dmPoints);\r\n  }\r\n\r\n  addDMPoints(points: number) {\r\n    this.dmPoints += points;\r\n    this.emit('dmScreenUpdated', this.dmPoints);\r\n    console.log(`Awarded ${points} DM point(s). Total: ${this.dmPoints}`);\r\n  }\r\n\r\n  getDMPoints() {\r\n    return this.dmPoints;\r\n  }\r\n\r\n  // DM Abilities System Methods\r\n  getDMAbilityPoints() {\r\n    return this.dmAbilityPoints;\r\n  }\r\n\r\n  addDMAbilityPoints(points: number) {\r\n    this.dmAbilityPoints += points;\r\n    this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n    console.log(`Awarded ${points} DM ability point(s). Total: ${this.dmAbilityPoints}`);\r\n  }\r\n\r\n  spendDMAbilityPoints(points: number) {\r\n    if (this.dmAbilityPoints >= points) {\r\n      this.dmAbilityPoints -= points;\r\n      this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  // Simplified snacks management\r\n  getMaxSnacks(): number {\r\n    return this.maxSnacks;\r\n  }\r\n\r\n  getRemainingSnacks(): number {\r\n    return this.remainingSnacks;\r\n  }\r\n\r\n  setMaxSnacks(value: number): void {\r\n    this.maxSnacks = value;\r\n    // Ensure remaining doesn't exceed max\r\n    this.remainingSnacks = Math.min(this.remainingSnacks, this.maxSnacks);\r\n    this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n  }\r\n\r\n  // Simplified breaks management\r\n  getMaxBreaks(): number {\r\n    return this.maxBreaks;\r\n  }\r\n\r\n  getRemainingBreaks(): number {\r\n    return this.remainingBreaks;\r\n  }\r\n\r\n  setMaxBreaks(value: number): void {\r\n    this.maxBreaks = value;\r\n    // Ensure remaining doesn't exceed max\r\n    this.remainingBreaks = Math.min(this.remainingBreaks, this.maxBreaks);\r\n    this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n  }\r\n\r\n  useSnacks() {\r\n    if (this.remainingSnacks > 0) {\r\n      this.remainingSnacks -= 1;\r\n      this.showSnacksModal();\r\n      this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n    }\r\n  }\r\n\r\n  useBreak() {\r\n    if (this.remainingBreaks > 0) {\r\n      this.remainingBreaks -= 1;\r\n      this.showBreakModal();\r\n      this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n    }\r\n  }\r\n\r\n  private showSnacksModal() {\r\n    const results = this.generateSnacksEffects();\r\n    const mockTravelOption: TravelOption = {\r\n      id: \"snacks_action\",\r\n      name: \"Offer Snacks\",\r\n      description: \"Everyone enjoys a tasty treat and feels more positive about the adventure!\",\r\n      time: 0,\r\n      tags: 0,\r\n      score: 0,\r\n      boredom: 0,\r\n      exhaustion: 5,\r\n      tagInstructions: \"\",\r\n      repeatable: false\r\n    };\r\n\r\n    const resultConfig: TravelResultConfig = {\r\n      results: results,\r\n      title: \"Snacks Offered\",\r\n      description: \"Everyone enjoys a tasty treat and feels more positive about the adventure!\",\r\n      tags: [],\r\n      travelOption: mockTravelOption,\r\n      info: {\r\n        score: 0,\r\n        time: 0,\r\n        boredom: 0,\r\n        exhaustion: 5\r\n      }\r\n    };\r\n\r\n    this.appManager.getUiManager().showModal({\r\n      title: \"Snacks Effects\",\r\n      options: [{\r\n        id: \"ok\",\r\n        title: \"OK\",\r\n        callback: () => { }\r\n      }],\r\n      type: \"travelresult\",\r\n      travelConfig: resultConfig\r\n    });\r\n  }\r\n\r\n  private showBreakModal() {\r\n    const results = this.generateBreakEffects();\r\n    const mockTravelOption: TravelOption = {\r\n      id: \"break_action\",\r\n      name: \"Take Break\",\r\n      description: \"Everyone takes a moment to relax and decompress, but loses some focus in the process.\",\r\n      time: 0,\r\n      tags: 0,\r\n      score: 0,\r\n      boredom: 0,\r\n      exhaustion: 0,\r\n      tagInstructions: \"\",\r\n      repeatable: false\r\n    };\r\n\r\n    const resultConfig: TravelResultConfig = {\r\n      results: results,\r\n      title: \"Break Taken\",\r\n      description: \"Everyone takes a moment to relax and decompress, but loses some focus in the process.\",\r\n      tags: [],\r\n      travelOption: mockTravelOption,\r\n      info: {\r\n        score: 0,\r\n        time: 0,\r\n        boredom: 0,\r\n        exhaustion: 0\r\n      }\r\n    };\r\n\r\n    this.appManager.getUiManager().showModal({\r\n      title: \"Break Effects\",\r\n      options: [{\r\n        id: \"ok\",\r\n        title: \"OK\",\r\n        callback: () => { }\r\n      }],\r\n      type: \"travelresult\",\r\n      travelConfig: resultConfig\r\n    });\r\n  }\r\n\r\n  private generateSnacksEffects(): EffectData[] {\r\n    const results: EffectData[] = [];\r\n    const players = this.playerManager.getPlayers();\r\n\r\n    // Give each player +1 attitude\r\n    players.forEach(player => {\r\n      this.partyManager().addEnjoyment(player, 1);\r\n      results.push({\r\n        object: player,\r\n        effects: [{\r\n          effect: \"+1 Attitude\",\r\n          class: \"player-attitude\"\r\n        }]\r\n      });\r\n    });\r\n\r\n    // Add party exhaustion\r\n    this.partyManager().exhaustParty(5);\r\n    results.push({\r\n      object: 'party',\r\n      effects: [{\r\n        effect: \"+5 Exhaustion\",\r\n        class: \"exhaustion\"\r\n      }]\r\n    });\r\n\r\n    return results;\r\n  }\r\n\r\n  private generateBreakEffects(): EffectData[] {\r\n    const results: EffectData[] = [];\r\n    const players = this.playerManager.getPlayers();\r\n\r\n    // Give each player -1 attention\r\n    players.forEach(player => {\r\n      this.partyManager().updateAttention(player, -1);\r\n      // Also reduce individual player stress\r\n      player.playerStats.stress = Math.max(0, player.playerStats.stress - 10);\r\n      results.push({\r\n        object: player,\r\n        effects: [{\r\n          effect: \"-1 Attention\",\r\n          class: \"player-attention\"\r\n        }, {\r\n          effect: \"-10 Stress\",\r\n          class: \"player-stress\"\r\n        }]\r\n      });\r\n    });\r\n\r\n    // Reduce party tension\r\n    this.partyManager().addPartyTension(-10);\r\n    results.push({\r\n      object: 'party',\r\n      effects: [{\r\n        effect: \"-10 Tension\",\r\n        class: \"tension\"\r\n      }]\r\n    });\r\n\r\n    return results;\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n  // Simplified props and venue tracking - max and current only\r\n  maxProps: number = 0;\r\n  currentProps: number = 0;\r\n  maxVenue: number = 0;\r\n  currentVenue: number = 0;\r\n\r\n  // Simplified props management\r\n  getMaxProps(): number {\r\n    return this.maxProps;\r\n  }\r\n\r\n  getCurrentProps(): number {\r\n    return this.currentProps;\r\n  }\r\n\r\n  setMaxProps(value: number): void {\r\n    this.maxProps = value;\r\n    // Ensure current doesn't exceed max\r\n    this.currentProps = Math.min(this.currentProps, this.maxProps);\r\n    this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n  }\r\n\r\n  // Simplified venue management\r\n  getMaxVenue(): number {\r\n    return this.maxVenue;\r\n  }\r\n\r\n  getCurrentVenue(): number {\r\n    return this.currentVenue;\r\n  }\r\n\r\n  setMaxVenue(value: number): void {\r\n    this.maxVenue = value;\r\n    // Ensure current doesn't exceed max\r\n    this.currentVenue = Math.min(this.currentVenue, this.maxVenue);\r\n    this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n  }\r\n\r\n  // Legacy compatibility methods\r\n  getDMPropLevel(): number {\r\n    return this.getCurrentProps();\r\n  }\r\n\r\n  setDMPropLevel(value: number): void {\r\n    this.setMaxProps(value);\r\n    this.currentProps = value; // For props/venue, current typically equals max when set\r\n  }\r\n\r\n  getDMComfortLevel(): number {\r\n    return this.getCurrentVenue();\r\n  }\r\n\r\n  setDMComfortLevel(value: number): void {\r\n    this.setMaxVenue(value);\r\n    this.currentVenue = value; // For props/venue, current typically equals max when set\r\n  }\r\n\r\n  // ---------------------------------------------------------------------------------------------------------\r\n  // NEW DM ABILITIES TRACKING SYSTEM\r\n  // ---------------------------------------------------------------------------------------------------------\r\n\r\n  // Ability Meters Management\r\n  getDMAbilityMeterLevel(meterId: string): number {\r\n    return this.dmAbilities.abilityMeters[meterId]?.currentLevel || 0;\r\n  }\r\n\r\n  setDMAbilityMeterLevel(meterId: string, level: number): void {\r\n    if (this.dmAbilities.abilityMeters[meterId]) {\r\n      const previousLevel = this.dmAbilities.abilityMeters[meterId].currentLevel;\r\n      this.dmAbilities.abilityMeters[meterId].currentLevel = level;\r\n      const pointsSpent = level - previousLevel;\r\n      this.dmAbilities.abilityMeters[meterId].pointsSpent += pointsSpent;\r\n      \r\n      // // Grant initial consumables when hosting abilities are set\r\n      // if (meterId === 'hosting') {\r\n      //   if (previousLevel === 0 && level >= 1) {\r\n      //     // Unlock snacks - grant 1 initial snack\r\n      //     this.dmAbilities.consumables.snacks.currentValue += 1;\r\n      //     this.remainingSnacks += 1;\r\n      //   }\r\n      //   if (previousLevel <= 1 && level >= 2) {\r\n      //     // Unlock breaks - grant 1 initial break\r\n      //     this.dmAbilities.consumables.breaks.currentValue += 1;\r\n      //     this.remainingBreaks += 1;\r\n      //   }\r\n      // }\r\n      \r\n      this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n    }\r\n  }\r\n\r\n  upgradeDMAbilityMeter(meterId: string, pointCost: number = 1): boolean {\r\n    const meter = this.dmAbilities.abilityMeters[meterId];\r\n    if (!meter || meter.currentLevel >= meter.maxLevel) return false;\r\n\r\n    if (this.spendDMAbilityPoints(pointCost)) {\r\n      const previousLevel = meter.currentLevel;\r\n      meter.currentLevel += 1;\r\n      meter.pointsSpent += pointCost;\r\n      \r\n      // Grant initial consumables when hosting abilities are unlocked\r\n      if (meterId === 'hosting') {\r\n        if (previousLevel === 0 && meter.currentLevel === 1) {\r\n          // Unlock snacks - grant 1 initial snack\r\n          this.maxSnacks = 1;\r\n          this.remainingSnacks = 1;\r\n        }\r\n        if (previousLevel === 1 && meter.currentLevel === 2) {\r\n          // Unlock breaks - grant 1 initial break\r\n          this.maxBreaks = 1;\r\n          this.remainingBreaks = 1;\r\n        }\r\n        if (previousLevel === 2 && meter.currentLevel === 3) {\r\n          // Unlock props - grant 1 initial prop level\r\n          this.maxProps = 1;\r\n          this.currentProps = 1;\r\n        }\r\n        if (previousLevel === 3 && meter.currentLevel === 4) {\r\n          // Unlock venue - grant 1 initial venue level\r\n          this.maxVenue = 1;\r\n          this.currentVenue = 1;\r\n        }\r\n      }\r\n      \r\n      this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  // Game Mastery Management\r\n  getDMGameMasteryLevel(masteryId: string): number {\r\n    return this.dmAbilities.gameMasteries[masteryId]?.currentLevel || 0;\r\n  }\r\n\r\n  setDMGameMasteryLevel(masteryId: string, level: number): void {\r\n    if (this.dmAbilities.gameMasteries[masteryId]) {\r\n      const previousLevel = this.dmAbilities.gameMasteries[masteryId].currentLevel;\r\n      this.dmAbilities.gameMasteries[masteryId].currentLevel = level;\r\n      const pointsSpent = level - previousLevel;\r\n      this.dmAbilities.gameMasteries[masteryId].pointsSpent += pointsSpent;\r\n      this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n    }\r\n  }\r\n\r\n  upgradeDMGameMastery(masteryId: string, pointCost: number = 1): boolean {\r\n    const mastery = this.dmAbilities.gameMasteries[masteryId];\r\n    if (!mastery || mastery.currentLevel >= mastery.maxLevel) return false;\r\n\r\n    if (this.spendDMAbilityPoints(pointCost)) {\r\n      mastery.currentLevel += 1;\r\n      mastery.pointsSpent += pointCost;\r\n      this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  // Consumables Management\r\n  getDMConsumableValue(consumableId: string): number {\r\n    switch (consumableId) {\r\n      case 'snacks':\r\n        return this.maxSnacks;\r\n      case 'breaks':\r\n        return this.maxBreaks;\r\n      case 'props':\r\n        return this.maxProps;\r\n      case 'comfort':\r\n        return this.maxVenue;\r\n      default:\r\n        return 0;\r\n    }\r\n  }\r\n\r\n  setDMConsumableValue(consumableId: string, value: number): void {\r\n    switch (consumableId) {\r\n      case 'snacks':\r\n        this.maxSnacks = value;\r\n        this.remainingSnacks = Math.min(this.remainingSnacks, this.maxSnacks);\r\n        break;\r\n      case 'breaks':\r\n        this.maxBreaks = value;\r\n        this.remainingBreaks = Math.min(this.remainingBreaks, this.maxBreaks);\r\n        break;\r\n      case 'props':\r\n        this.maxProps = value;\r\n        this.currentProps = Math.min(this.currentProps, this.maxProps);\r\n        break;\r\n      case 'comfort':\r\n        this.maxVenue = value;\r\n        this.currentVenue = Math.min(this.currentVenue, this.maxVenue);\r\n        break;\r\n    }\r\n    this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n  }\r\n\r\n  purchaseDMConsumable(consumableId: string, pointCost: number = 1): boolean {\r\n    if (!this.spendDMAbilityPoints(pointCost)) return false;\r\n\r\n    // Update max and remaining/current for the appropriate consumable\r\n    if (consumableId === 'snacks') {\r\n      this.maxSnacks += 1;\r\n      this.remainingSnacks += 1;\r\n    } else if (consumableId === 'breaks') {\r\n      this.maxBreaks += 1;\r\n      this.remainingBreaks += 1;\r\n    } else if (consumableId === 'props') {\r\n      this.maxProps += 1;\r\n      this.currentProps += 1;\r\n    } else if (consumableId === 'comfort') {\r\n      this.maxVenue += 1;\r\n      this.currentVenue += 1;\r\n    }\r\n    \r\n    this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n    return true;\r\n  }\r\n\r\n  // Helper methods to get purchase history\r\n  getDMAbilitiesPurchaseHistory(): typeof this.dmAbilities {\r\n    return this.dmAbilities;\r\n  }\r\n\r\n  getTotalDMAbilityPointsSpent(): number {\r\n    let total = 0;\r\n\r\n    // Count ability meters\r\n    Object.values(this.dmAbilities.abilityMeters).forEach(meter => {\r\n      total += meter.pointsSpent;\r\n    });\r\n\r\n    // Count game masteries\r\n    Object.values(this.dmAbilities.gameMasteries).forEach(mastery => {\r\n      total += mastery.pointsSpent;\r\n    });\r\n\r\n    // Note: Consumables are now tracked separately as individual purchases\r\n    // rather than in the dmAbilities structure\r\n\r\n    return total;\r\n  }\r\n\r\n  // Check if an ability/upgrade is unlocked based on dependencies\r\n  isDMUpgradeUnlocked(consumableId: string, requiredAbility: string, requiredLevel: number): boolean {\r\n    const meter = this.dmAbilities.abilityMeters[requiredAbility];\r\n    return meter ? meter.currentLevel >= requiredLevel : false;\r\n  }\r\n\r\n  // Reset all DM abilities (for testing or campaign restart)\r\n  resetDMAbilities(): void {\r\n    Object.values(this.dmAbilities.abilityMeters).forEach(meter => {\r\n      meter.currentLevel = 0;\r\n      meter.pointsSpent = 0;\r\n    });\r\n\r\n    Object.values(this.dmAbilities.gameMasteries).forEach(mastery => {\r\n      mastery.currentLevel = 0;\r\n      mastery.pointsSpent = 0;\r\n    });\r\n\r\n    // Reset simplified consumables tracking\r\n    this.maxSnacks = 0;\r\n    this.remainingSnacks = 0;\r\n    this.maxBreaks = 0;\r\n    this.remainingBreaks = 0;\r\n    this.maxProps = 0;\r\n    this.currentProps = 0;\r\n    this.maxVenue = 0;\r\n    this.currentVenue = 0;\r\n\r\n    this.emit('dmAbilitiesUpdated', this.dmAbilityPoints);\r\n  }\r\n\r\n  // Convenience methods for checking specific abilities during gameplay\r\n  hasToneUnlocked(toneIndex: number): boolean {\r\n    const tonesLevel = this.getDMAbilityMeterLevel('tones');\r\n    return tonesLevel > toneIndex;\r\n  }\r\n\r\n\r\n  getUnlockedTones(): FlavorTagTheme[] {\r\n    const tonesLevel = this.getDMAbilityMeterLevel('tones');\r\n    const toneNames = [FlavorTagTheme.COMEDIC, FlavorTagTheme.DRAMATIC, FlavorTagTheme.HEROIC, FlavorTagTheme.ROMANTIC, FlavorTagTheme.GRIM];\r\n    return toneNames.slice(0, tonesLevel);\r\n  }\r\n\r\n  hasHostingAbility(abilityIndex: number): boolean {\r\n    const hostingLevel = this.getDMAbilityMeterLevel('hosting');\r\n    return hostingLevel > abilityIndex;\r\n  }\r\n\r\n  hasStorytellingAbility(abilityIndex: number): boolean {\r\n    const storytellingLevel = this.getDMAbilityMeterLevel('storytelling');\r\n    return storytellingLevel > abilityIndex;\r\n  }\r\n\r\n  // Check specific hosting abilities\r\n  canUseSnacks(): boolean {\r\n    return this.hasHostingAbility(0) && this.remainingSnacks > 0;\r\n  }\r\n\r\n  canUseBreaks(): boolean {\r\n    return this.hasHostingAbility(1) && this.remainingBreaks > 0;\r\n  }\r\n\r\n  getPropsBonus(): number {\r\n    if (!this.hasHostingAbility(2)) return 0;\r\n    return this.currentProps > 0 ? PROPS_SCORES[this.currentProps - 1] : 0;\r\n  }\r\n\r\n  getMaxPartyExhaustion(): number {\r\n    const baseMax = 100; // Default maximum\r\n    if (!this.hasHostingAbility(3)) return baseMax;\r\n    return baseMax + (this.currentVenue > 0 ? COMFORT_EXHAUSTION_BONUS[this.currentVenue - 1] : 0);\r\n  }\r\n\r\n  // Game mastery bonuses\r\n  getRoleplayingBonus(): number {\r\n    return this.getDMGameMasteryLevel('roleplaying');\r\n  }\r\n\r\n  getCombatBonus(): number {\r\n    return this.getDMGameMasteryLevel('combat');\r\n  }\r\n\r\n  getTravelBonus(): number {\r\n    return this.getDMGameMasteryLevel('travel');\r\n  }\r\n\r\n  // ---------------------------------------------------------------------------------------------------------\r\n  // TENSION DESCRIPTIONS MANAGEMENT\r\n  // ---------------------------------------------------------------------------------------------------------\r\n\r\n  // Set/replace a tension description with the same max value\r\n  setTensionDescription(newDescription: TensionDescription): void {\r\n    const existingIndex = this.tensionDescriptions.findIndex(desc => desc.max === newDescription.max);\r\n\r\n    if (existingIndex !== -1) {\r\n      // Replace existing description\r\n      this.tensionDescriptions[existingIndex] = { ...newDescription };\r\n    } else {\r\n      // Add new description and sort by max value\r\n      this.tensionDescriptions.push({ ...newDescription });\r\n      this.tensionDescriptions.sort((a, b) => a.max - b.max);\r\n    }\r\n\r\n    this.emit('tensionDescriptionsUpdated', this.tensionDescriptions);\r\n  }\r\n\r\n  // Get current tension descriptions (always use latest from constants)\r\n  getTensionDescriptions(): TensionDescription[] {\r\n    // If tensionDescriptions has been modified by DM abilities, use those\r\n    // Otherwise, always use the current TENSION_DESCRIPTIONS from constants \r\n    const hasModifications = this.tensionDescriptions.some((desc, index) =>\r\n      index >= TENSION_DESCRIPTIONS.length ||\r\n      desc.description !== TENSION_DESCRIPTIONS[index]?.description ||\r\n      desc.max !== TENSION_DESCRIPTIONS[index]?.max ||\r\n      desc.scoreMultiplier !== TENSION_DESCRIPTIONS[index]?.scoreMultiplier ||\r\n      desc.stressIncrease !== TENSION_DESCRIPTIONS[index]?.stressIncrease\r\n    );\r\n\r\n    return hasModifications ? [...this.tensionDescriptions] : [...TENSION_DESCRIPTIONS];\r\n  }\r\n\r\n  // Generate colors for needle gauge based on tension descriptions\r\n  getTensionColors(): string[] {\r\n    return this.getTensionDescriptions().map(desc => desc.color);\r\n  }\r\n\r\n  getTensionColor(partyTension: number): string {\r\n    const descriptions = this.getTensionDescriptions();\r\n    for (const desc of descriptions) {\r\n      if (partyTension <= desc.max) {\r\n        return desc.color;\r\n      }\r\n    }\r\n    return descriptions[descriptions.length - 1]?.color || '#ADFF2F'; // Fallback to last color or default\r\n  }\r\n  getTensionRanges(): number[] {\r\n    const descriptions = this.getTensionDescriptions();\r\n    const ranges: number[] = [];\r\n\r\n    for (let i = 0; i < descriptions.length; i++) {\r\n      const desc = descriptions[i];\r\n      if (desc.max === Infinity) {\r\n        // For infinity, use max gauge value (100) or skip\r\n        break;\r\n      }\r\n      ranges.push(desc.max);\r\n    }\r\n\r\n    return ranges;\r\n  }\r\n\r\n  // Reset tension descriptions to default\r\n  resetTensionDescriptions(): void {\r\n    this.tensionDescriptions = [...TENSION_DESCRIPTIONS];\r\n    this.emit('tensionDescriptionsUpdated', this.tensionDescriptions);\r\n  }\r\n\r\n  // Apply storytelling ability effects to tension descriptions\r\n  applyDramaticNarrationEffect(): void {\r\n    // This could be called when the \"Dramatic Narration\" storytelling ability is unlocked\r\n    // It widens the x2 score multiplier area (Perfect!) from 60-70 to 55-75\r\n    if (this.hasStorytellingAbility(2)) { // Dramatic Narration is the 3rd ability (index 2)\r\n      this.setTensionDescription({\r\n        max: 55,\r\n        description: \"Perfect!\",\r\n        scoreMultiplier: 2,\r\n        stressIncrease: 0,\r\n        color: \"#009900da\"\r\n      });\r\n      this.setTensionDescription({\r\n        max: 75,\r\n        description: \"Perfect!\",\r\n        scoreMultiplier: 2,\r\n        stressIncrease: 0,\r\n        color: \"#009900da\"\r\n      });\r\n      // Update the old \"Perfect!\" range to be \"Good\"\r\n      this.setTensionDescription({\r\n        max: 70,\r\n        description: \"Good\",\r\n        scoreMultiplier: 1,\r\n        stressIncrease: 0,\r\n        color: \"#32CD32da\"\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  adjustTensionMeterForRomanticTone(): void {\r\n    this.setTensionDescription({ max: 30, description: \"Romantic\", scoreMultiplier: 1.5, stressIncrease: 0, color: \"#d64cb4da\" });\r\n    this.setTensionDescription({ max: 15, description: \"Romantic\", scoreMultiplier: 1.5, stressIncrease: 0, color: \"#d64cb4da\" });\r\n  }\r\n  adjustTensionMeterForGrimTone(): void {\r\n    this.setTensionDescription({ max: 80, description: \"Dangerous\", scoreMultiplier: 2, stressIncrease: 0, color: \"#4f3a67da\" });\r\n    this.setTensionDescription({ max: 90, description: \"Grimdark\", scoreMultiplier: 3, stressIncrease: 0, color: \"#3a2755da\" });\r\n  }\r\n\r\n  // Demo method to test tension description modifications\r\n  testTensionDescriptionModifications(): void {\r\n    console.log('Original tension descriptions:', this.getTensionDescriptions());\r\n\r\n    // Test 1: Replace the \"Good\" description with \"Wowzer\"\r\n    this.setTensionDescription({\r\n      max: 60,\r\n      description: \"Wowzer\",\r\n      scoreMultiplier: 5,\r\n      stressIncrease: 0,\r\n      color: \"#FFD700da\"\r\n    });\r\n\r\n    // Test 2: Add a new tension range\r\n    this.setTensionDescription({\r\n      max: 85,\r\n      description: \"Intense\",\r\n      scoreMultiplier: 1.5,\r\n      stressIncrease: 7,\r\n      color: \"#FF6600da\"\r\n    });\r\n\r\n    console.log('Modified tension descriptions:', this.getTensionDescriptions());\r\n    console.log('Generated colors:', this.getTensionColors());\r\n  }\r\n\r\n\r\n  exhaustForRoleplayAction(amount = 0) {\r\n    // const baseActionCost = 4;\r\n    // const openRumorCost = 0;//this.rumorTags.length || 1;\r\n\r\n    // const actionCost = baseActionCost * openRumorCost;\r\n    this.partyManager().exhaustParty(amount);\r\n\r\n  }\r\n\r\n\r\n  // ---------------------------------------------------------------------------------------------------------\r\n  // PERCEPTION EVENTS\r\n  // ---------------------------------------------------------------------------------------------------------\r\n\r\n\r\n  getPerceptionTags(character: Character): PerceptionTags | [] {\r\n    // get player preferences \r\n    const player = this.playerManager.getPlayerAssignedCharacter(character);\r\n    const branches = this.currentEncounter?.branches || [];\r\n    // get player traits\r\n    if (!player || !this.currentEncounter) {\r\n      return [];\r\n    }\r\n\r\n    // TODO: Make this less random! Too many magic items, plot hooks and player backtories. Maybe color-code for rarity as well. \r\n    const perceptionTagType: TAGS_TYPE = Math.floor(Math.random() * 5);\r\n\r\n    switch (perceptionTagType) {\r\n\r\n      case TAGS_TYPE.BRANCH_LOCATION:\r\n        const branchIndex = Math.floor(Math.random() * branches.length);\r\n        const branch = branches[branchIndex];\r\n        const tagName = branch.name;\r\n        let branchTags = this.tagManager.encounterTagsExpected[branch.name];\r\n        branchTags = branchTags.filter(tag => !this.tagManager.encounterTagsCollected[branch.name].includes(tag));\r\n        const nbTags = Math.floor(Math.random() * 2) + 1;\r\n        // Get some random tags from the branch\r\n        if (branchTags.length === 0) {\r\n          // Get a magic item instead?\r\n          const newGear = this.appManager.getCharacterManager().getRandomGear();\r\n          const gearTag = { name: newGear.name, type: TAG_TYPE.GEAR };\r\n\r\n          return {\r\n            tags: [{\r\n              tag: gearTag,\r\n              source: FlavorTagSource.LOCATION,\r\n              theme: FlavorTagTheme.NONE\r\n            }],\r\n            type: perceptionTagType,\r\n            name: branch.name\r\n          }\r\n        }\r\n        const randomTags = branchTags.sort(() => Math.random() - 0.5);\r\n        const selectedBranchTags = randomTags.slice(0, nbTags);\r\n\r\n        const flavorTags: EncounterFlavorTag[] = selectedBranchTags.map(tag => {\r\n          return {\r\n            tag: tag,\r\n            source: FlavorTagSource.LOCATION,\r\n            theme: this.tagManager.getTheme()\r\n          }\r\n        });\r\n\r\n        return {\r\n          tags: flavorTags,\r\n          type: perceptionTagType,\r\n          name: tagName\r\n        }\r\n      case TAGS_TYPE.CURRENT_LOCATION:\r\n\r\n        const curLocationName = this.currentEncounter.location.name;\r\n        const locationTags = this.getEncounterLocationTags();\r\n        const nbLocationTags = Math.floor(Math.random() * 2) + 1;\r\n        // Get some random tags from the branch\r\n        const randomLocationTags = locationTags.sort(() => Math.random() - 0.5);\r\n        const selectedLocationTags = randomLocationTags.slice(0, nbLocationTags);\r\n\r\n        const locationFlavorTags: EncounterFlavorTag[] = selectedLocationTags.map(tag => {\r\n          return {\r\n            tag: tag,\r\n            source: FlavorTagSource.LOCATION,\r\n            theme: this.tagManager.getTheme()\r\n          }\r\n        });\r\n\r\n        return {\r\n          tags: locationFlavorTags,\r\n          type: perceptionTagType,\r\n          name: curLocationName\r\n        }\r\n\r\n      case TAGS_TYPE.PLOT_HOOK:\r\n\r\n        return {\r\n          tags: [{\r\n            tag: { name: `Plot Hook: ${this.campaignProgress + 1}`, type: TAG_TYPE.PLOT },\r\n            source: FlavorTagSource.PLOT,\r\n            theme: FlavorTagTheme.NONE\r\n          }],\r\n          type: TAGS_TYPE.PLOT_HOOK,\r\n          name: 'Campaign Story'\r\n        }\r\n      case TAGS_TYPE.CHARACTER_BACKSTORY:\r\n      case TAGS_TYPE.CHARACTER_BACKSTORY_PROGRESS:\r\n\r\n        // TODO: This can cause a bug where Player A has a unique tag, and player B will be assigned it at random as it is in the pool. \r\n        const outstandingBackstoryTags = this.appManager.getCharacterManager().getAllExpectedBackstoryTags();\r\n\r\n        // Determine if we should get a new random element, or one of the outstanding ones\r\n        if (outstandingBackstoryTags.length > 0 && Math.random() < 0.5) {\r\n          const randomIndex = Math.floor(Math.random() * outstandingBackstoryTags.length);\r\n          const tag = outstandingBackstoryTags[randomIndex];\r\n          return {\r\n            tags: [{\r\n              tag: tag,\r\n              source: FlavorTagSource.PLAYERS,\r\n              theme: this.tagManager.getTheme()\r\n            }],\r\n            type: TAGS_TYPE.CHARACTER_BACKSTORY_PROGRESS,\r\n            name: character.name\r\n          }\r\n        }\r\n\r\n\r\n        return {\r\n          tags: this.getNewBackstoryTags(player, character, 1),\r\n          type: TAGS_TYPE.CHARACTER_BACKSTORY,\r\n          name: character.name\r\n        }\r\n\r\n      case TAGS_TYPE.MAGIC_ITEM:\r\n\r\n        const expectedGearTags = this.tagManager.magicItemRumors;\r\n\r\n        // determine if we should get a new random element, or one of the outstanding ones\r\n        if (expectedGearTags.length > 0 && Math.random() < 0.5) {\r\n          const randomIndex = Math.floor(Math.random() * expectedGearTags.length);\r\n          const tag = expectedGearTags[randomIndex];\r\n          return {\r\n            tags: [{\r\n              tag: tag,\r\n              source: FlavorTagSource.PLAYERS,\r\n              theme: this.tagManager.getTheme()\r\n            }],\r\n            type: TAGS_TYPE.MAGIC_ITEM,\r\n            name: tag.name\r\n          }\r\n        }\r\n\r\n        const newGear = this.appManager.getCharacterManager().getRandomGear();\r\n        const gearTag = { name: newGear.name, type: TAG_TYPE.GEAR };\r\n\r\n        return {\r\n          tags: [{\r\n            tag: gearTag,\r\n            source: FlavorTagSource.PLAYERS,\r\n            theme: FlavorTagTheme.NONE\r\n          }],\r\n          type: TAGS_TYPE.MAGIC_ITEM,\r\n          name: gearTag.name\r\n        }\r\n    }\r\n    return [];\r\n  }\r\n\r\n  getNewBackstoryTags(player: Player, character: Character, nbTags: number): EncounterFlavorTag[] {\r\n    // Get a random one. \r\n    const NB_ALLTAGS = 5;\r\n\r\n    const allTags: Tag[] = Object.values(TAG).flat();\r\n    const randomBackstoryTags = allTags.sort(() => Math.random() - 0.5).slice(0, NB_ALLTAGS);\r\n    // player.preferences is [Tag, ATTITUDE][]\r\n    // To flatten and extract just the Tag objects:\r\n    const mixedTags = [\r\n      ...player.preferences.map(([tag]) => tag),\r\n      ...randomBackstoryTags\r\n    ];\r\n\r\n    // get nbTags of random tags\r\n    const randomTags = mixedTags.sort(() => Math.random() - 0.5).slice(0, nbTags);\r\n\r\n    // Ensure randomTag is of type Tag\r\n    // const tag: Tag = Array.isArray(randomTag) ? randomTag[0] : randomTag;\r\n\r\n    return randomTags.map(tag => ({\r\n      tag: tag,\r\n      source: FlavorTagSource.BACKSTORY,\r\n      theme: this.tagManager.getTheme()\r\n    }));\r\n    // type: TAGS_TYPE.CHARACTER_BACKSTORY,\r\n    // name: character.name\r\n\r\n  }\r\n\r\n  acceptPerceptionTags(perceptionTags: PerceptionTags, character: Character) {\r\n\r\n    this.updateFlavorTagThemesTally(perceptionTags.tags);\r\n    // adjust player happiness based on this tag\r\n    const flatTags = perceptionTags.tags.map(tag => tag.tag);\r\n    flatTags.forEach(tag => {\r\n      this.playerManager.exposeEncounterTag(tag);\r\n    });\r\n\r\n    const player = this.playerManager.getPlayerAssignedCharacter(character);\r\n\r\n    let updateAllAttention = -1;\r\n\r\n\r\n\r\n    switch (perceptionTags.type) {\r\n      case TAGS_TYPE.CURRENT_LOCATION:\r\n\r\n        perceptionTags.tags.forEach(tag => {\r\n          this.tagManager.collectLocationTag(tag.tag); // Expose the current location tag\r\n        });\r\n        break;\r\n      case TAGS_TYPE.BRANCH_LOCATION:\r\n        perceptionTags.tags.forEach(tag => {\r\n          this.expectedTagsForBranches[perceptionTags.name].push(tag.tag);\r\n        });\r\n\r\n        //  this.partyManager().addPartyScore(2);\r\n        break;\r\n      case TAGS_TYPE.PLOT_HOOK:\r\n        updateAllAttention = 0;\r\n        // this.setCampaignProgress(this.campaignProgress + 1);\r\n        this.collectPlotHook();\r\n        // this.partyManager().addPartyScore(3);\r\n        break;\r\n      case TAGS_TYPE.CHARACTER_BACKSTORY:\r\n        //   this.partyManager().addPartyScore(COST.PARTY_SCORE.BACKSTORY_ASSIGNED);\r\n        this.appManager.getCharacterManager().assignBackstory(character, perceptionTags.tags[0].tag);\r\n        break;\r\n      case TAGS_TYPE.CHARACTER_BACKSTORY_PROGRESS:\r\n        //   this.partyManager().addPartyScore(COST.PARTY_SCORE.BACKSTORY_FULFILLED);\r\n        this.appManager.getCharacterManager().assignBackstory(character, perceptionTags.tags[0].tag);\r\n\r\n        break;\r\n      case TAGS_TYPE.MAGIC_ITEM:\r\n        const newTag = perceptionTags.tags[0].tag;\r\n        if (this.tagManager.magicItemRumors.includes(newTag)) {\r\n          this.appManager.getCharacterManager().assignGear(character, newTag.name);\r\n          this.tagManager.magicItemRumors = this.tagManager.magicItemRumors.filter(tag => tag.name !== newTag.name);\r\n          //  this.partyManager().addPartyScore(COST.PARTY_SCORE.MAGIC_ITEM_FOUND);\r\n        } else {\r\n          //   this.partyManager().addPartyScore(COST.PARTY_SCORE.MAGIC_ITEM_INTRODUCED);\r\n          this.tagManager.magicItemRumors = [...this.tagManager.magicItemRumors, ...[newTag]];\r\n        }\r\n        break;\r\n    }\r\n\r\n    if (updateAllAttention !== -1) {\r\n      this.partyManager().updateAllAttention(updateAllAttention);\r\n    } else {\r\n      this.partyManager().playersTakeAction(((player && [player.name]) || undefined), true);\r\n    }\r\n    if (player) {\r\n      this.partyManager().stressAction([player]);\r\n    }\r\n    this.emit('dmScreenUpdated', this.establishedTags);\r\n  }\r\n\r\n\r\n  rewardsAccepted = (rewardsAccepted: RewardItem[], rewardDifference: number, advanceEvent: boolean) => {\r\n\r\n    if (rewardDifference === -2) {\r\n      this.partyManager().addPartyEnjoyment(-2);\r\n    } else if (rewardDifference === -1) {\r\n      this.partyManager().addPartyEnjoyment(-1);\r\n    } else if (rewardDifference === 1) {\r\n      this.partyManager().multiplyPartyTension(.5)\r\n    } else if (rewardDifference === 2) {\r\n      this.partyManager().multiplyPartyTension(0)\r\n    }\r\n\r\n    const partyManager = this.appManager.getPartyManager();\r\n    rewardsAccepted.forEach(reward => {\r\n      switch (reward.type) {\r\n        case REWARD_TYPE.TREASURE:\r\n          partyManager.addPartyEnjoyment(reward.value);\r\n          break;\r\n        case REWARD_TYPE.TOOLS:\r\n          partyManager.replenishPartyTools();\r\n          break;\r\n        case REWARD_TYPE.XP:\r\n          partyManager.levelUpLowestCharacter();\r\n          break;\r\n        case REWARD_TYPE.ITEM:\r\n          const player = this.playerManager.getRandomPlayer();\r\n          const character = this.playerManager.getRandomCharacterForPlayer(player, true);\r\n          if (reward.tag) {\r\n            this.appManager.getCharacterManager().assignGear(character!, reward.tag.name);\r\n          }\r\n          this.rumorTags = this.rumorTags.filter(tag => tag.name !== reward.tag?.name);\r\n          break;\r\n        case REWARD_TYPE.PLOT_HOOK:\r\n          this.collectPlotHook();\r\n          //update dm screen\r\n\r\n          break;\r\n        case REWARD_TYPE.HEALING:\r\n          if (reward.value === 1) {\r\n            partyManager.healRandomCharacter();\r\n          } else {\r\n            partyManager.raiseRandomFromDead();\r\n          }\r\n          break;\r\n        case REWARD_TYPE.BACKSTORY:\r\n          break;\r\n        case REWARD_TYPE.MAGIC:\r\n          partyManager.replenishPartyMagic();\r\n          break;\r\n      }\r\n    })\r\n\r\n    if (advanceEvent) {\r\n      this.backToOverview();\r\n    }\r\n    this.emit('dmScreenUpdated');\r\n  }\r\n\r\n\r\n  setCampaignProgress(progress: number) {\r\n    this.campaignProgress = progress;\r\n    this.emit('campaignProgressUpdated', progress);\r\n  }\r\n\r\n  getCampaignProgress() {\r\n    return this.campaignProgress;\r\n  }\r\n\r\n  // ------------------------------------------------------------------------------------------------------\r\n  // Tag Exposure\r\n  // ------------------------------------------------------------------------------------------------------\r\n\r\n  handleExpositionClicked() {\r\n    // Expose an unexposed location tag, encounter tag, or upcoming encounter tag.\r\n    const encounter = this.currentEncounter;\r\n    if (!encounter) {\r\n      return;\r\n    }\r\n    const upcomingBranches = encounter.branches || [];\r\n    const possibleTags: Tag[] = [];\r\n    this.currentEncounter?.location.tags.forEach(tag => {\r\n      if (!this.collectedLocationTags.includes(tag)) {\r\n        possibleTags.push(tag);\r\n      }\r\n    });\r\n\r\n    this.getExpectedEncounterTags().forEach(tag => {\r\n      // if(!this.establishedTags.includes(tag) && !possibleTags.includes(tag)) {\r\n      possibleTags.push(tag);\r\n      // }\r\n    }\r\n    )\r\n\r\n\r\n    upcomingBranches.forEach(branch => {\r\n      branch.tags.forEach(tag => {\r\n        if (!this.establishedTags.includes(tag) && !possibleTags.includes(tag) && !this.tagManager.encounterTagsExpected[branch.name].includes(tag)) {\r\n          possibleTags.push(tag);\r\n        }\r\n      });\r\n    });\r\n\r\n    if (possibleTags.length === 0) {\r\n      return;\r\n    }\r\n    const randomIndex = Math.floor(Math.random() * possibleTags.length);\r\n    const tag = possibleTags[randomIndex];\r\n\r\n    this.exposeTag({\r\n      tag: tag,\r\n      source: FlavorTagSource.EXPOSITION,\r\n      theme: FlavorTagTheme.NONE\r\n    });\r\n\r\n\r\n    // COST FOR EXPOSITION - CAN BE AFFECTED BY LEVELING UP\r\n    this.partyManager().updateAllAttention(-1);\r\n\r\n\r\n\r\n    this.emit('encounterUpdated', this.establishedTags);\r\n\r\n\r\n    //this.playerManager.handleLevelUp(this.playerManager.getPlayers()[0]);\r\n\r\n  }\r\n\r\n  // We use the flavor tag source to drive what we DO with a tag. Sometimes the tags are generated randomly though and we arent sure where\r\n  // they came from, so we should look to the location, future encounters, backstory fulfillment, magic items, and try to assign the right source. \r\n  getPotentialTagSource(tag: Tag): FlavorTagSource {\r\n\r\n    if (this.tagManager.getOutstandingLocationTags().includes(tag)) {\r\n      return FlavorTagSource.LOCATION;\r\n    }\r\n    if (this.tagManager.getCollectedLocationTags().includes(tag)) {\r\n      return FlavorTagSource.LOCATION;\r\n    }\r\n    if (this.tagManager.getUpcomingEncounterTags().includes(tag)) {\r\n      return FlavorTagSource.FORESHADOWING;\r\n    }\r\n    if (this.tagManager.magicItemRumors.includes(tag)) {\r\n      return FlavorTagSource.MAGIC_ITEM;\r\n    }\r\n    if (tag.type === TAG_TYPE.GEAR) {\r\n      return FlavorTagSource.MAGIC_ITEM_EXPECTED;\r\n    }\r\n\r\n    if (this.tagManager.getOutstandingBackstoryTags().includes(tag)) {\r\n      return FlavorTagSource.BACKSTORY;\r\n    }\r\n\r\n    return FlavorTagSource.NONE;\r\n  }\r\n\r\n\r\n  exposeTag(flavorTag: EncounterFlavorTag, activePlayer?: Player) {\r\n  \r\n    // Handle quest tags\r\n    if (flavorTag.source === FlavorTagSource.QUEST || flavorTag.source === FlavorTagSource.QUEST_TERMINAL) {\r\n      const questManager = this.appManager.getQuestManager();\r\n      const questData = questManager.getQuestForTag(flavorTag.tag.name);\r\n\r\n      if (questData) {\r\n        const { quest } = questData;\r\n        const advancedNode = questManager.advanceQuest(quest.id, flavorTag.tag.name);\r\n\r\n        if (advancedNode) {\r\n          // Send conversation to chat for all quest advancement with fast speed\r\n          if (advancedNode.conversation && advancedNode.conversation.length > 0) {\r\n            this.appManager.getChatManager().fireNewChatMessage(advancedNode.conversation, { speed: 'fast' });\r\n          }\r\n          \r\n          // Check if this node has player choices (quest.playerChoices exists and has items)\r\n          const hasPlayerChoices = quest.playerChoices && quest.playerChoices.length > 0;\r\n\r\n          if (flavorTag.source === FlavorTagSource.QUEST_TERMINAL && hasPlayerChoices) {\r\n            // Show terminal modal for player choices (conversation already sent to chat)\r\n            this.emit('showQuestTerminal', { quest, node: advancedNode });\r\n          } else {\r\n            // For all other cases (normal quest nodes and completions), show quest progress modal\r\n            this.appManager.getUiManager().showQuestProgressModal(quest.id);\r\n          }\r\n        }\r\n      }\r\n      return; // Exit early for quest tags\r\n    }\r\n\r\n    if (flavorTag.source === FlavorTagSource.TREASURE) {\r\n      this.partyManager().addTreasurePoints(1);\r\n      return;\r\n    }\r\n\r\n    if (flavorTag.source === FlavorTagSource.DM_POINT) {\r\n      this.addDmExp(1);\r\n      return;\r\n    }\r\n\r\n    let shouldCollectTag = true;\r\n    let triggerBasicChat = true;\r\n    this.updateFlavorTagThemesTally([flavorTag]);\r\n\r\n    // adjust player happiness based on this tag\r\n    this.playerManager.exposeEncounterTag(flavorTag.tag);\r\n\r\n    // Check if this fulfills a character's backstory\r\n    const charactersWithBackstoryTag = this.appManager.getCharacterManager().getCharactersWithBackstoryTag(flavorTag.tag);\r\n    charactersWithBackstoryTag.forEach(character => {\r\n      this.appManager.getCharacterManager().assignBackstory(character, flavorTag.tag);\r\n      this.appManager.getChatManager().triggerCharacterBackstoryResponse(flavorTag, character);\r\n      triggerBasicChat = false;\r\n    });\r\n\r\n    // check if this fulfills a magic-item rumor \r\n    if (this.tagManager.magicItemRumors.includes(flavorTag.tag)) {\r\n\r\n      const player = this.playerManager.getRandomPlayer();\r\n      const character = this.playerManager.getRandomCharacterForPlayer(player, true);\r\n      this.appManager.getCharacterManager().assignGear(character!, flavorTag.tag.name);\r\n     \r\n    } else if (flavorTag.tag.type === TAG_TYPE.GEAR) {\r\n      this.tagManager.addMagicItemRumor(flavorTag.tag);\r\n    }\r\n\r\n\r\n\r\n    // Also apply any wanted location-based tags\r\n    if (flavorTag.source === FlavorTagSource.LOCATION || flavorTag.source === FlavorTagSource.EXPOSITION || this.tagManager.getOutstandingLocationTags().includes(flavorTag.tag)) {\r\n\r\n      this.tagManager.collectLocationTag(flavorTag.tag);\r\n\r\n    }\r\n\r\n\r\n    // check if this should collect an encounter tag\r\n    if (flavorTag.source === FlavorTagSource.ENCOUNTER) {\r\n      // If this is a foreshadowing tag, we need to check if it is already expected\r\n      if (this.tagManager.getOutstandingEncounterTags().includes(flavorTag.tag)) {\r\n        // If it is, we can just resolve it\r\n        this.tagManager.collectEncounterTag(flavorTag.tag);\r\n\r\n        // no chat! This will be shown on the Campign advancement modal\r\n        triggerBasicChat = false;\r\n      }\r\n    }\r\n\r\n\r\n    // APPLY A KNOWN TAG TO AN UPCOMING ENCOUNTER\r\n    // note this also does some processing to determine a valid branch to assign a random tag to. \r\n    const possibleBranchesToAssignRandomTagTo: number[] = [];\r\n    const upcomingBranches = this.currentEncounter?.branches || [];\r\n    let tagAssigned = false;\r\n    if (this.tagManager.collectUpcomingEncounterTag(flavorTag.tag)) {\r\n      tagAssigned = true;\r\n    } else {\r\n\r\n      upcomingBranches.forEach((branch, index) => {\r\n        if (this.tagManager.couldAssignRandomTagToBranch(branch)) {\r\n          possibleBranchesToAssignRandomTagTo.push(index);\r\n        }\r\n      });\r\n    }\r\n\r\n\r\n\r\n    // APPLY A RANDOM TAG TO AN UPCOMING ENCOUNTER\r\n    if (flavorTag.source === FlavorTagSource.FORESHADOWING_RANDOM && !tagAssigned && possibleBranchesToAssignRandomTagTo.length > 0) {\r\n      const randomIndex = Math.floor(Math.random() * possibleBranchesToAssignRandomTagTo.length);\r\n      const branchIndex = possibleBranchesToAssignRandomTagTo[randomIndex];\r\n      const branch = upcomingBranches[branchIndex];\r\n      this.tagManager.introduceNewTagForUpcomingBranch(branch, flavorTag.tag);\r\n      this.tagManager.collectUpcomingEncounterTag(flavorTag.tag); // Collect the tag so it is not expected anymore\r\n      this.appManager.getChatManager().triggerAddRandomTagToEncounterConversation(flavorTag.tag, branch);\r\n\r\n      triggerBasicChat = false;\r\n\r\n    }\r\n\r\n\r\n    if (shouldCollectTag) {\r\n      this.appManager.getTagManager().collectTag(flavorTag)\r\n    }\r\n\r\n    const authoredChatTrigger = this.getEncounterChatTrigger(flavorTag.tag);\r\n\r\n    if (authoredChatTrigger && flavorTag.source !== FlavorTagSource.ENCOUNTER) {\r\n      this.appManager.getChatManager().fireNewChatMessage(authoredChatTrigger as ChatMessage);\r\n      triggerBasicChat = false;\r\n    }\r\n\r\n\r\n    if (triggerBasicChat) {\r\n      // Use enhanced chat system with LLM fallback\r\n      this.appManager.getChatManager().triggerEnhancedChatFromTag(flavorTag, activePlayer).catch(error => {\r\n        this.appManager.getChatManager().triggerChatFromTag(flavorTag);\r\n      });\r\n    }\r\n    this.appManager.getChatManager().trackRecentTopic(flavorTag.tag)\r\n    this.emit('dmScreenUpdated', this.establishedTags);\r\n  }\r\n\r\n\r\n  // ---------------------------------------------------------------------------------------------------------\r\n  // ROLEPLAY EVENT\r\n  // ---------------------------------------------------------------------------------------------------------\r\n\r\n  selectRoleplayFlavorTag(rpFlavorTag: RPEncounterFlavorTag, freeTags: number) {\r\n\r\n    this.exhaustForRoleplayAction(4);\r\n    if (freeTags <= 0) {\r\n      this.partyManager().updateAllAttention(-1);\r\n    }\r\n\r\n    // This will catch special things like treasure etc and chat about them. The rest are caught by the expose tag\r\n    this.appManager.getChatManager().triggerSpecialRPTagChat(rpFlavorTag);\r\n\r\n    if (rpFlavorTag.type === 'character' && rpFlavorTag.character) {\r\n      // this.appManager.getChatManager().RPCharacterSelected(rpFlavorTag.character);\r\n      const player = this.playerManager.getPlayerAssignedCharacter(rpFlavorTag.character);\r\n\r\n      if (player) {\r\n        this.partyManager().playersTakeAction([player.name], true, 2);\r\n        this.partyManager().stressAction([player]);\r\n      }\r\n      return;\r\n    }\r\n\r\n\r\n    // Handle treasure and DM point tags\r\n    const flavorTag = this.tagManager.convertRpTagToFlavorTag(rpFlavorTag);\r\n    if (flavorTag) {\r\n      // convert special types to proper soruce\r\n      if (flavorTag.source === FlavorTagSource.TREASURE) {\r\n        this.partyManager().addTreasurePoints(1);\r\n        return;\r\n      }\r\n\r\n      if (flavorTag.source === FlavorTagSource.DM_POINT) {\r\n        this.addDmExp(1);\r\n        return;\r\n      }\r\n\r\n      // Handle other tag types...\r\n      this.exposeTag(flavorTag);\r\n      // this.establishOrStartRumor(flavorTag.tag);\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  generateRoleplayEventTags(): RPEncounterFlavorTag[] {\r\n    const nbTags = 12;\r\n    const encounter = this.currentEncounter;\r\n    if (!encounter) {\r\n      return [];\r\n    }\r\n\r\n    // Get a random set of tags from the encounter\r\n    const randomRpTags = this.tagManager.generateRelevantFlavorTags(nbTags);\r\n\r\n    // Add a character to the mix\r\n\r\n    const includeCharacter = Math.random() < 0.5;\r\n    const allTags: RPEncounterFlavorTag[] = [];\r\n    randomRpTags.forEach((flavortag) => {\r\n      allTags.push({\r\n        tag: flavortag,\r\n        type: 'tag'\r\n      })\r\n    });\r\n    if (includeCharacter) {\r\n      const characters = this.appManager.getCharacterManager().getPlayerCharacters();\r\n      const randomChar = characters[Math.floor(Math.random() * characters.length)];\r\n      const charTag: RPEncounterFlavorTag =\r\n      {\r\n        character: randomChar,\r\n        type: 'character',\r\n      };\r\n      allTags.push(charTag);\r\n\r\n    }\r\n\r\n\r\n    // add a treasure to the mix\r\n\r\n    const includeTreasure = Math.random() < 0.5;\r\n    if (includeTreasure) {\r\n      const treasureTag: RPEncounterFlavorTag =\r\n      {\r\n        type: 'treasure',\r\n      };\r\n      allTags.push(treasureTag);\r\n    }\r\n\r\n    // // add a DM point to the mix\r\n    // const includeDMPoint = Math.random() < 0.5;\r\n    // if (includeDMPoint) {\r\n    //   const dmpointTag: RPEncounterFlavorTag =\r\n    //   {\r\n    //     type: 'dmpoint',\r\n    //   };\r\n    //   allTags.push(dmpointTag);\r\n    // }\r\n\r\n\r\n    return allTags;\r\n\r\n\r\n  }\r\n\r\n\r\n  // ---------------------------------------------------------------------------------------------------------\r\n  //  TRAVEL \r\n  // ---------------------------------------------------------------------------------------------------------\r\n  setDefaultTravelOptions() {\r\n    this.travelOptions = [TRAVEL_OPTIONS_SHORT, TRAVEL_OPTIONS_MEDIUM, TRAVEL_OPTIONS_LONG];\r\n  }\r\n  setTravelOptions(travelOptions: TravelOption[][]) {\r\n    this.travelOptions = travelOptions;\r\n    this.emit('travelOptionsUpdated', travelOptions);\r\n  }\r\n  getTravelOptions() {\r\n    return this.travelOptions;\r\n  }\r\n\r\n\r\n\r\n  getEventTag(travelOption: TravelOption): Tag | undefined {\r\n\r\n    switch (travelOption.travelOptionType) {\r\n      case TRAVEL_OPTION.AMBUSH:\r\n        if (this.tagManager.getEstablishedCombatantTags().length > 0) {\r\n          // get a random one\r\n          const randomIndex = Math.floor(Math.random() * this.tagManager.getEstablishedCombatantTags().length);\r\n          return this.tagManager.getEstablishedCombatantTags()[randomIndex];\r\n        }\r\n        const randomIndex = Math.floor(Math.random() * this.tagManager.getPotentialCombatantsTags().length);\r\n        return this.tagManager.getPotentialCombatantsTags()[randomIndex];\r\n\r\n      case TRAVEL_OPTION.TRADERS:\r\n        if (this.tagManager.getEstablishedFriendlyTags().length > 0) {\r\n          // get a random one\r\n          const randomIndex2 = Math.floor(Math.random() * this.tagManager.getEstablishedFriendlyTags().length);\r\n          return this.tagManager.getEstablishedFriendlyTags()[randomIndex2];\r\n        }\r\n        return this.tagManager.getRandomFriendlyTags(1)[0];\r\n    }\r\n    return travelOption.tag;\r\n\r\n  }\r\n\r\n\r\n  getResultTags(travelOption: TravelOption): EncounterFlavorTag[] | undefined {\r\n\r\n    //We need a random player to apply things to, and a random Character as well\r\n\r\n    const players = this.playerManager.getPlayers();\r\n    const randomPlayerIndex = Math.floor(Math.random() * players.length);\r\n    const randomPlayer = players[randomPlayerIndex];\r\n    const randomCharacter = this.playerManager.getRandomCharacterForPlayer(randomPlayer, true);\r\n    if (!randomCharacter) {\r\n      return [];\r\n    }\r\n\r\n    switch (travelOption.travelOptionType) {\r\n      case TRAVEL_OPTION.TRADERS:\r\n        // Return a treasure tag for traders\r\n        return [{\r\n          tag: { name: 'Treasure Cache', type: TAG_TYPE.NONE },\r\n          source: FlavorTagSource.TREASURE,\r\n          theme: this.tagManager.getTheme()\r\n        }];\r\n      case TRAVEL_OPTION.AMBUSH:\r\n        break;\r\n      case TRAVEL_OPTION.AMBUSH2:\r\n        // add a choice of five races either friendly or enemy \r\n\r\n\r\n        return this.tagManager.getRandomTags(5, this.tagManager.getPotentialCombatantsTags()).map(tag => {\r\n          return {\r\n            tag: tag,\r\n            source: FlavorTagSource.ENEMY,\r\n            theme: this.tagManager.getTheme()\r\n          }\r\n        });\r\n\r\n      case TRAVEL_OPTION.EXPLORE_CURRENT_LOCATION:\r\n        return this.getEncounterLocationTags().map(tag => {\r\n          return {\r\n            tag: tag,\r\n            source: FlavorTagSource.LOCATION,\r\n            theme: this.tagManager.getTheme()\r\n          }\r\n        });\r\n\r\n\r\n      case TRAVEL_OPTION.EXPLORE_UPCOMING_LOCATION:\r\n        return this.tagManager.getUpcomingEncounterTags().map(tag => {\r\n          return {\r\n            tag: tag,\r\n            source: FlavorTagSource.FORESHADOWING,\r\n            theme: this.tagManager.getTheme()\r\n          }\r\n        })\r\n      case TRAVEL_OPTION.CHARACTER_BACKSTORY:\r\n        const tags = this.getNewBackstoryTags(randomPlayer, randomCharacter, 3);\r\n        return tags;\r\n      case TRAVEL_OPTION.SIDE_QUEST:\r\n        return this.tagManager.getRandomTags(3, Object.values(TAG).flat()).map(tag => {\r\n          return {\r\n            tag: tag,\r\n            source: this.getPotentialTagSource(tag),\r\n            theme: this.tagManager.getTheme()\r\n          }\r\n        });\r\n      case TRAVEL_OPTION.MAGIC_CACHE:\r\n        return this.tagManager.getRandomMagicItemTag(3).map(tag => {\r\n          return {\r\n            tag: tag,\r\n            source: this.getPotentialTagSource(tag),\r\n            theme: this.tagManager.getTheme()\r\n          }\r\n        });\r\n\r\n      default:\r\n        break;\r\n    }\r\n\r\n\r\n  }\r\n\r\n\r\n  selectTravelOption(travelOption: TravelOption, boredomLevel: number) {\r\n    const results: EffectData[] = [];\r\n    // check for boredom \r\n\r\n    // -1's indicate that it should be be randomized\r\n    // THIS IS DONE BEFORE CAMPAIGN MANAGER GETS IT\r\n    // if (travelOption.boredom === -1) {\r\n    //   travelOption.boredom = Math.floor(Math.random() * 25);\r\n    // } \r\n    // if (travelOption.time === -1) {\r\n    //  travelOption.time = Math.floor(Math.random() * 20);\r\n    /// }\r\n    if (travelOption.score === -1) {\r\n      travelOption.score = Math.floor(Math.random() * 25);\r\n    }\r\n\r\n\r\n\r\n    if (travelOption.exhaustion === -1) {\r\n      travelOption.exhaustion = Math.floor(Math.random() * 15);\r\n    }\r\n\r\n    const addResult = (object: Player | Character | 'party', effect: string, className: string) => {\r\n\r\n      if (!object) {\r\n        return;\r\n      }\r\n\r\n      // need to check if the player has a result in the results array already as the object\r\n      const existingResult = results.find(result => result.object === object);\r\n      if (existingResult && existingResult.effects) {\r\n        existingResult.effects.push({\r\n          effect: effect,\r\n          class: className\r\n        });\r\n        return;\r\n      }\r\n\r\n      results.push({\r\n        object: object,\r\n        effects: [{\r\n          effect: effect,\r\n          class: className\r\n        }]\r\n      });\r\n    }\r\n\r\n    const players = this.playerManager.getPlayers();\r\n    const boredomRisk = boredomLevel > 66 ? 1 : boredomLevel > 33 ? 0.5 : 0.2;\r\n\r\n\r\n    const travelResultCharacter = this.playerManager.getRandomCharacter();\r\n    if (!travelResultCharacter) {\r\n      return;\r\n    }\r\n    const travelResultPlayer = this.playerManager.getPlayerAssignedCharacter(travelResultCharacter);\r\n\r\n    if (!travelResultPlayer) {\r\n      return;\r\n    }\r\n\r\n    switch (travelOption.travelOptionType) {\r\n      case TRAVEL_OPTION.AMBUSH:\r\n      case TRAVEL_OPTION.AMBUSH2:\r\n\r\n        // add 15 tension to the party\r\n        this.partyManager().addPartyTension(15);\r\n        if (travelResultCharacter) {\r\n          if (Math.random() < 0.5) {\r\n            const injuryResult = this.partyManager().addInjury(travelResultCharacter);\r\n            addResult(travelResultCharacter, injuryResult, \"injury\");\r\n          } else if (Math.random() < 0.5 && this.appManager.getCharacterManager().getRemainingAttributes(travelResultCharacter, ATTRIBUTE_TYPE.MAGIC) > 0) {\r\n            const magicReduced = this.appManager.getCharacterManager().useHalfRemainingAttributes(travelResultCharacter, ATTRIBUTE_TYPE.MAGIC);\r\n            addResult(travelResultCharacter, \"Used \" + magicReduced + \" Magic\", \"used-ability\");\r\n          } else if (this.appManager.getCharacterManager().getRemainingAttributes(travelResultCharacter, ATTRIBUTE_TYPE.TOOLS) > 0) {\r\n            const gearReduced = this.appManager.getCharacterManager().useHalfRemainingAttributes(travelResultCharacter, ATTRIBUTE_TYPE.TOOLS);\r\n            addResult(travelResultCharacter, \"Used \" + gearReduced + \" Tools\", \"used-ability\");\r\n          }\r\n        }\r\n        break;\r\n      case TRAVEL_OPTION.CHARACTER_BACKSTORY:\r\n        addResult(travelResultCharacter, \"+New Backstory Details\", \"backstory\");\r\n        break;\r\n    }\r\n\r\n    // IMPORTANT TO DO THESE LAST\r\n\r\n\r\n    // check for boredom\r\n    players.forEach(player => {\r\n      if (Math.random() < boredomRisk) {\r\n        this.partyManager().updateAttention(player, -1);\r\n\r\n        addResult(player, \"-1 Attention\", \"boredom\");\r\n      }\r\n      if (boredomLevel > 66 && Math.random() < 0.15) {\r\n        this.partyManager().addEnjoyment(player, -1);\r\n        addResult(player, \"-1 Attitude\", \"boredom\");\r\n      }\r\n\r\n    });\r\n    // reduce tension\r\n    const tensionAmount = boredomLevel > 66 ? -10 : boredomLevel > 33 ? -5 : -1;\r\n    this.partyManager().addPartyTension(tensionAmount);\r\n\r\n\r\n    if (travelOption.travelOptionType === TRAVEL_OPTION.AMBUSH || travelOption.travelOptionType === TRAVEL_OPTION.AMBUSH2) {\r\n      this.partyManager().addPartyTension(15);\r\n      // we also want to show the boredom risk tension but stikethrough\r\n\r\n      addResult('party', \"-\" + Math.abs(tensionAmount) + \" Tension\", \"tension-strikethrough\");\r\n\r\n      addResult('party', \"+15 Tension\", \"tension\");\r\n    } else {\r\n\r\n      addResult('party', \"-\" + Math.abs(tensionAmount) + \" Tension\", \"tension\");\r\n\r\n    }\r\n\r\n    if (travelOption.exhaustion) {\r\n      this.partyManager().exhaustParty(travelOption.exhaustion);\r\n      addResult('party', \"+\" + Math.abs(travelOption.exhaustion) + \" Exhaustion\", \"exhaustion\");\r\n    }\r\n\r\n\r\n    return {\r\n      travelResults: results,\r\n      travelTags: this.getResultTags(travelOption),\r\n    }\r\n  }\r\n\r\n\r\n\r\n  // ---------------------------------------------------------------------------------------------------------\r\n  // Utils \r\n  // ---------------------------------------------------------------------------------------------------------\r\n\r\n  collectPlotHook() {\r\n    this.partyManager().updateAllAttention(2);\r\n    this.setCampaignProgress(this.campaignProgress + 1);\r\n\r\n    this.emit('campaignProgressUpdated', this.campaignProgress);\r\n  }\r\n\r\n  getCampaignTooltipForTag(flavorTag: EncounterFlavorTag): string | undefined {\r\n    const campaign = this.currentCampaign;\r\n\r\n    if (campaign.tooltipTags && campaign.tooltipTags[this.currentEncounter?.name || '']?.[flavorTag.tag.name]) {\r\n      const tooltip = campaign.tooltipTags[this.currentEncounter?.name || '']?.[flavorTag.tag.name];\r\n      if (tooltip) {\r\n        return this.appManager.getChatManager().getEncounterTagPrefix(flavorTag) + tooltip + this.appManager.getChatManager().getThemePostFix(flavorTag);\r\n      }\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  // This is for the Campaign Choose screen UI\r\n  getOpenCampaignIndex() {\r\n    // Need the index of the campaign from the list \r\n    return CAMPAIGNS.findIndex(campaign => campaign.name === this.currentCampaign.name);\r\n\r\n  }\r\n\r\n\r\n\r\n  getColorForEncounterByName(name: string) {\r\n    const encounter = this.currentCampaign.processedEncounters?.flat().find(encounter => encounter.name === name);\r\n    if (!encounter) {\r\n      return 'none';\r\n    }\r\n    return encounter.location.themes[0];\r\n  }\r\n\r\n  getNextPlotHookText() {\r\n    const plotHookIndex = this.campaignProgress;\r\n    let description = this.currentCampaign.plotHooks?.[plotHookIndex || 0];\r\n    if (!description) {\r\n      description = 'Next important plot information....';\r\n    }\r\n    return description;\r\n  }\r\n\r\n  getCollectedTones() {\r\n    return this.toneCounts;\r\n  }\r\n\r\n  getAvailableCampaigns() {\r\n    return CAMPAIGNS;\r\n  }\r\n\r\n\r\n  getCampaignIcon() {\r\n    return this.currentCampaign.icon;\r\n  }\r\n\r\n  getCampaignName() {\r\n    return this.currentCampaign.name;\r\n  }\r\n\r\n  getDmTricks() {\r\n    return this.dmTricks;\r\n  }\r\n\r\n\r\n  getCurrentEncounter() {\r\n    return this.currentEncounter;\r\n  }\r\n\r\n  getNextEncounters() {\r\n    return this.currentEncounter?.branches || [];\r\n  }\r\n\r\n  getCurrentCampaign() {\r\n    return this.currentCampaign;\r\n  }\r\n\r\n  getEncounterEvents() {\r\n    return this.currentEncounter?.events || [[], [], []];\r\n  }\r\n\r\n  getEncounterLocationTags() {\r\n    return this.currentEncounter?.location.tags || [];\r\n  }\r\n\r\n\r\n\r\n  getEncounterTags() {\r\n    return this.currentEncounter?.tags || [];\r\n  }\r\n\r\n  getExpectedEncounterTags() {\r\n\r\n    return this.expectedTagsForBranches[this.currentEncounter?.name || ''] || [];\r\n  }\r\n\r\n  getTagsForUpcomingEncounters() {\r\n    const upcomingBranches = this.currentEncounter?.branches || [];\r\n    let upcomingTags: Tag[] = [];\r\n    upcomingBranches.forEach((branch) => {\r\n      upcomingTags = [...upcomingTags, ...branch.tags];\r\n    });\r\n    return upcomingTags;\r\n  }\r\n\r\n\r\n  getCampaignScore() {\r\n    return this.campaignScore;\r\n  }\r\n\r\n  bankCampaignScore(score: number) {\r\n    this.campaignScore += score;\r\n    this.emit('dmScreenUpdated', this.campaignScore);\r\n  }\r\n\r\n  clearEncounterScore() {\r\n    this.encounterPoints = 0;\r\n    this.collectedTreasure = 0;\r\n    this.emit('dmScreenUpdated', this.encounterPoints);\r\n\r\n  }\r\n  /**\r\n   * Calculate the total score for an encounter tag using the scoring system\r\n   * @param tag The encounter tag to calculate score for\r\n   * @returns The total calculated score including multipliers\r\n   */\r\n  calculateEncounterTotalScore(tag: Tag): number {\r\n    const scoreEntries = this.getEncounterScoring(tag);\r\n    return calculateTotalScore(scoreEntries);\r\n  }\r\n\r\n  // New methods for encounter scene tracking\r\n  currentEncounterSceneSet(): boolean {\r\n    if (!this.currentEncounter) return false;\r\n    return this.encounterSetScene[this.currentEncounter.name] || false;\r\n  }\r\n\r\n  setCurrentEncounterSceneComplete() {\r\n    if (this.currentEncounter) {\r\n      this.encounterSetScene[this.currentEncounter.name] = true;\r\n    }\r\n  }\r\n\r\n  // Method to manually trigger set scene modal (for testing)\r\n  showSetSceneModal() {\r\n    this.tagManager.triggerSetSceneModal();\r\n  }\r\n\r\n  getEncounterExpositionText() {\r\n    return \"Expose details, players lose attention\";\r\n  }\r\n\r\n\r\n  getFriendlyCombatantTags() {\r\n    // Look through all established tags for friendly types. \r\n    return [...this.establishedTags.filter(tag => tag.friendly), ...this.tagManager.locationTagsCollected.filter(tag => tag.friendly)];\r\n  }\r\n\r\n  getHostileCombatantTags(filteredName?: string) {\r\n    // Look through all established tags for hostile types. \r\n    return [...this.establishedTags.filter(tag => tag.enemy && tag.name !== filteredName), ...this.tagManager.locationTagsCollected.filter(tag => tag.enemy)];\r\n  }\r\n\r\n\r\n  getCampaignChatTriggers(): Record<string, Record<string, ChatTrigger | string | ChatMessage[]>> | undefined {\r\n    if (this.currentCampaign === undefined) {\r\n      return {};\r\n    }\r\n    return this.currentCampaign.chatTriggers;\r\n  }\r\n\r\n  getEncounterChatTriggers(): Record<string, ChatTrigger | string | ChatMessage[]> | undefined {\r\n    const campaignTriggers = this.getCampaignChatTriggers();\r\n    if (this.currentEncounter === undefined || campaignTriggers === undefined) {\r\n      return {};\r\n    }\r\n    const encounterTriggers = campaignTriggers[this.currentEncounter.name];\r\n    return encounterTriggers;\r\n  }\r\n\r\n  getEncounterChatTrigger(tag: Tag) {\r\n    const encounterTriggers = this.getEncounterChatTriggers();\r\n    if (encounterTriggers === undefined) {\r\n      return undefined;\r\n    }\r\n\r\n    return encounterTriggers[tag.name];\r\n  }\r\n\r\n\r\n\r\n\r\n  // ---------------------------------------------------------------------------------------------------------\r\n  // Initialization Functions\r\n  // ------------------------------------------------------------------------------------------------\r\n\r\n\r\n  initiateQuickStart() {\r\n    this.startCampaign(0);\r\n  }\r\n\r\n  // TODO - move most of this into startEncounter\r\n  startCampaign(index: number) {\r\n\r\n    // Bad initi code with a race condition. \r\n    if (this.tagManager === undefined) {\r\n      this.tagManager = this.appManager.getTagManager();\r\n    }\r\n\r\n    // Initialize encounter scene tracking\r\n    this.encounterSetScene = {};\r\n\r\n    this.currentCampaign = CAMPAIGNS[index];\r\n    this.currentEncounter = CAMPAIGNS[index]?.startingEncounter || undefined;\r\n\r\n    // Trigger campaign start chat event\r\n    if (this.currentCampaign) {\r\n      this.appManager.getChatEventManager().addCampaignStartEvent(this.currentCampaign.name);\r\n    }\r\n\r\n    //this.rumorTags = [];\r\n    //this.resolvedTagsForBranches = {};\r\n    // const currentEncounterBranches = this.currentEncounter?.branches || [];\r\n    // this.resolvedTagsForBranches[this.currentEncounter.name] = [];\r\n    // currentEncounterBranches.forEach(branch => {\r\n    //   this.expectedTagsForBranches[branch.name] = [];\r\n    //   this.resolvedTagsForBranches[branch.name] = [];\r\n    // });\r\n\r\n    //const currentTagsForBranch = this.expectedTagsForBranches[this.currentEncounter?.name || ''] || [];\r\n    // this.expectedTagsForBranches[this.currentEncounter?.name || ''] = [...currentTagsForBranch, ...this.getEncounterTags()];\r\n    this.resetConsumables();\r\n\r\n\r\n    this.tagManager.initializeNewCampaign(this.currentCampaign);\r\n    this.tagManager.initializeNewEncounter(this.currentEncounter);\r\n\r\n    //this.validateTags(CAMPAIGNS[index].processedEncounters?.flat() || []);\r\n    this.partyManager().setPartyTension(20);\r\n    this.completedEventIndexes = [];\r\n    this.displayNewEncounter();\r\n    this.emit('dmScreenUpdated', this.toneCounts);\r\n  }\r\n\r\n  // getTagsForEncounter(encounter: Encounter): Tag[] {\r\n  //   let tagsForBranches = this.expectedTagsForBranches[encounter.name] || [];\r\n  //   let tags = [...encounter.tags, ...tagsForBranches];\r\n  //   return Array.from(new Set(tags));\r\n  // }\r\n  setSessionState(state: SESSION_STATE) {\r\n    this.encounterState = {\r\n      sessionState: state,\r\n      eventIndex: 0,\r\n    }\r\n  }\r\n\r\n  // getResolvedTagsForBranch() {\r\n  //   const currentBranchName = this.currentEncounter?.name || '';\r\n  //   return this.resolvedTagsForBranches[currentBranchName] || [];\r\n  // }\r\n\r\n\r\n  validateTags(encounters: Encounter[]) {\r\n    // check that all tags are defined\r\n    for (let i = 0; i < encounters.length; i++) {\r\n      for (let j = 0; j < encounters[i].tags.length; j++) {\r\n        if (encounters[i].tags[j] === undefined) {\r\n          console.error(`Encounter ${encounters[i].name} tag ${j} is undefined`);\r\n        }\r\n      }\r\n      for (let j = 0; j < encounters[i].location.tags.length; j++) {\r\n        if (encounters[i].location.tags[j] === undefined) {\r\n          console.error(`Encounter ${encounters[i].name} location ${encounters[i].location.name} tag ${j} is undefined`);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // ---------------------------------------------------------------------------------------------------------\r\n  // DM level\r\n  // ---------------------------------------------------------------------------------------------------------\r\n  getDmLevel() {\r\n    return this.dmLevel;\r\n  }\r\n  addDmExp(amount: number) {\r\n    this.dmExperience += amount;\r\n    if (this.dmExperience >= 5) {\r\n      this.dmLevel++;\r\n      this.dmExperience = 0;\r\n    }\r\n    this.emit('dmScreenUpdated', this.dmExperience);\r\n  }\r\n\r\n  getDmExp() {\r\n    return this.dmExperience;\r\n  }\r\n\r\n\r\n\r\n\r\n  // ---------------------------------------------------------------------------------------------------------\r\n  // Encounter Progression\r\n  // ---------------------------------------------------------------------------------------------------------\r\n\r\n  isInitialEncounter() {\r\n    return this.currentEncounter?.name === this.currentCampaign?.startingEncounter?.name;\r\n  }\r\n\r\n  getCompletedEvents() {\r\n    return this.completedEventIndexes;\r\n  }\r\n\r\n  getEncounterAdvanceReadinessText() {\r\n    const currentEncounterEstablished = (this.getExpectedEncounterTags().length === 0);\r\n    const branches = this.currentEncounter?.branches || [];\r\n    const someBranchesReady = branches.some(branch => this.tagManager.encounterTagsExpected[branch.name].length >= NB_EXPECTED_ENCOUNTER_TAGS - 1);\r\n    const allBranchesReady = branches.every(branch => this.tagManager.encounterTagsExpected[branch.name].length >= NB_EXPECTED_ENCOUNTER_TAGS - 1);\r\n    if (!currentEncounterEstablished) {\r\n      return 'Players will be confused. They expect more from the current encounter.';\r\n    }\r\n    if (!someBranchesReady) {\r\n      return 'Players don\\'t have enough information to choose what to do next.';\r\n    }\r\n    if (!allBranchesReady) {\r\n      return 'Players are ready to move on, but feel some choices are unclear.';\r\n    }\r\n    return 'Players are ready to move on.';\r\n\r\n  }\r\n\r\n  encounterEventSelected(eventIndex: number) {\r\n    if (this.encounterState === undefined) {\r\n      return;\r\n    }\r\n    if (this.completedEventIndexes.includes(eventIndex)) {\r\n      return;\r\n    }\r\n    this.appManager.state = APP_STATE.SESSION\r\n    this.completedEventIndexes.push(eventIndex);\r\n    this.encounterState.eventIndex = eventIndex;\r\n    \r\n    // Trigger encounter event chat tile\r\n    const currentEvent = this.getCurrentEvent();\r\n    if (currentEvent) {\r\n      this.appManager.getChatEventManager().addEncounterEvent(currentEvent.type, currentEvent.name);\r\n    }\r\n    \r\n    this.appManager.getUiManager().updateEncounterState(this.encounterState);\r\n  }\r\n\r\n  getEncounterState() {\r\n    return this.encounterState;\r\n  }\r\n\r\n  getCurrentEvent() {\r\n    if (this.encounterState === undefined) {\r\n      return;\r\n    }\r\n    return this.currentEncounter?.events[this.encounterState.eventIndex];\r\n  }\r\n\r\n  backToOverview() {\r\n    if (this.encounterState === undefined) {\r\n      return;\r\n    }\r\n    this.appManager.state = APP_STATE.SESSION_OVERVIEW;\r\n\r\n    this.appManager.getUiManager().updateEncounterState(this.encounterState);\r\n\r\n  }\r\n\r\n  // Maxim - This init doesnt get run for the first encounter! (I think!) Lets fix this. \r\n\r\n  advanceEncounter(branch?: Encounter) {\r\n    // Log the end of the previous encounter if there was one\r\n    if (this.currentEncounter) {\r\n      this.appManager.getChatManager().getGameContextManager().logEvent({\r\n        type: 'encounter_end',\r\n        description: `Completed encounter: ${this.currentEncounter.name}`,\r\n        details: { encounter: this.currentEncounter, outcome: 'success' }\r\n      });\r\n    }\r\n\r\n    this.resetConsumables();\r\n    const potentialBranches = this.currentEncounter?.branches || [];\r\n\r\n    // Would I ever have secret branches? \r\n    if (branch && potentialBranches.includes(branch)) {\r\n      this.currentEncounter = branch;\r\n    }\r\n    else {\r\n      const branchWithMoreExpectedTags =\r\n        potentialBranches.sort((a, b) => this.tagManager.encounterTagsExpected[b.name].length - this.tagManager.encounterTagsExpected[a.name].length)[1];\r\n      this.currentEncounter = branchWithMoreExpectedTags || potentialBranches[0];\r\n    }\r\n\r\n    // Log the start of the new encounter\r\n    if (this.currentEncounter) {\r\n      this.appManager.getChatManager().logEncounterStart(this.currentEncounter);\r\n    }\r\n    this.resolvedTagsForBranches = {};\r\n    const currentEncounterBranches = this.currentEncounter?.branches || [];\r\n    this.resolvedTagsForBranches[this.currentEncounter.name] = [];\r\n\r\n    currentEncounterBranches.forEach(branch => {\r\n      this.expectedTagsForBranches[branch.name] = [];\r\n      this.resolvedTagsForBranches[branch.name] = [];\r\n    });\r\n\r\n    const currentTagsForBranch = this.expectedTagsForBranches[this.currentEncounter?.name || ''] || [];\r\n\r\n\r\n    // Make a note of the number of tags which were \"prepared\" for this encounter:\r\n    this.encounterPrepBonus = currentTagsForBranch.length * 4;\r\n\r\n    this.expectedTagsForBranches[this.currentEncounter?.name || ''] = [...currentTagsForBranch, ...this.getEncounterTags()];\r\n    this.collectedLocationTags = [];\r\n\r\n    this.completedEventIndexes = [];\r\n    this.displayNewEncounter();\r\n    this.emit('encounterUpdated', this.toneCounts);\r\n    this.emit('dmScreenUpdated', this.toneCounts);\r\n  }\r\n\r\n\r\n  displayNewEncounter() {\r\n    //Show notebook for current encounter: \r\n    if (!this.currentEncounter) {\r\n      return;\r\n    }\r\n    this.appManager.getUiManager().showBasicNotebook(NOTEBOOK_CATEGORY.ENCOUNTER, this.currentEncounter)\r\n  }\r\n\r\n\r\n\r\n\r\n  // I keep forgetting the name of this, so I just made an add... that calls collect... - Im sure this will never cause bugs.\r\n  addEncounterPoints(amount: number) {\r\n    this.collectEncounterPoints(amount);\r\n  }\r\n\r\n  collectEncounterPoints(amount: number) {\r\n    this.encounterPoints += amount;\r\n    this.emit('dmScreenUpdated', this.encounterPoints);\r\n    // this.emit('encounterPointsUpdated', this.encounterPoints);\r\n  }\r\n\r\n  getEncounterPoints() {\r\n    return this.encounterPoints;\r\n  }\r\n\r\n  getTensionMultiplier(tensionValue?: number): number {\r\n    const tension = tensionValue ?? this.partyManager().getPartyTension();\r\n    const tensionDescriptions = this.getTensionDescriptions();\r\n    for (const tensionDesc of tensionDescriptions) {\r\n      if (tension <= tensionDesc.max) {\r\n        return tensionDesc.scoreMultiplier;\r\n      }\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  getEncounterPrepBonus() {\r\n    return this.encounterPrepBonus;\r\n  }\r\n\r\n  collectTreasure(amount: number) {\r\n    this.collectedTreasure += amount;\r\n  }\r\n\r\n  getCollectedTreasure() {\r\n    return this.collectedTreasure;\r\n  }\r\n\r\n  getEncounterScoring(tag: Tag): ScoreEntry[] {\r\n    const scoreEntries: ScoreEntry[] = [];\r\n\r\n    if (this.isInitialEncounter()) {\r\n      scoreEntries.push({\r\n        description: \"New Campaign Bonus\",\r\n        points: 4\r\n\r\n      });\r\n    } else {\r\n      // Base scoring for encounter foundation\r\n      scoreEntries.push({\r\n        description: \"Encounter Prep Bonus\",\r\n        points: this.encounterPrepBonus\r\n\r\n      });\r\n    }\r\n    // Bonus for certain tag types\r\n    if (this.encounterPoints > 0) {\r\n      scoreEntries.push({\r\n        description: \"Event Points\",\r\n        points: this.encounterPoints\r\n\r\n      });\r\n    }\r\n\r\n    // each non-upset player \r\n\r\n    const players = this.playerManager.getPlayers();\r\n    let nbHappyPlayers = 0;\r\n    players.forEach(player => {\r\n      if (player.playerStats.enjoyment > 2) {\r\n        nbHappyPlayers++;\r\n      }\r\n    }); if (nbHappyPlayers > 0) {\r\n      scoreEntries.push({\r\n        description: `Players' Enjoyment`,\r\n        points: nbHappyPlayers * 1\r\n\r\n      });\r\n    }\r\n    if (this.collectedTreasure > 0) {\r\n      scoreEntries.push({\r\n        description: \"Treasure Collected\",\r\n        points: this.collectedTreasure\r\n      });\r\n    }\r\n\r\n    // Bonus score for Props\r\n    if (this.currentProps > 0) {\r\n      const propsNames = [\"Battlemaps\", \"Cardboard Buildings\", \"Miniatures\", \"3D Printed Everything\"]\r\n      scoreEntries.push({\r\n        description: \"Props: \" + propsNames[this.currentProps - 1],\r\n        points: PROPS_ENCOUNTER_SCORES[this.currentProps - 1]\r\n      });\r\n    }\r\n\r\n\r\n    // Apply tension multiplier to all positive scores\r\n    const tension = this.partyManager().getPartyTension();\r\n    const tensionDescriptions = this.getTensionDescriptions();\r\n    let currentTensionDesc = tensionDescriptions[tensionDescriptions.length - 1]; // fallback to last\r\n    \r\n    // Find the appropriate tension description\r\n    for (const desc of tensionDescriptions) {\r\n      if (tension <= desc.max) {\r\n        currentTensionDesc = desc;\r\n        break;\r\n      }\r\n    }\r\n    \r\n    const tensionMultiplier = currentTensionDesc.scoreMultiplier;\r\n    \r\n    scoreEntries.push({\r\n      description: `Tension: ${currentTensionDesc.description}`,\r\n      multiplier: true,\r\n      points: tensionMultiplier,\r\n      color: currentTensionDesc.color // Include color information\r\n    });\r\n\r\n\r\n\r\n    if (this.tagManager.getOutstandingLocationTags().length === 0) {\r\n      scoreEntries.push({\r\n        description: \"Location Bonus: Scene Set\",\r\n        points: 2,\r\n        multiplier: true\r\n      });\r\n    }\r\n\r\n    return scoreEntries;\r\n  }\r\n\r\n  getTotalEncounterScore() {\r\n    const baseScore = this.getEncounterScoring({} as Tag).reduce((total, entry) => total + entry.points, 0);\r\n    const tensionMultiplier = this.getTensionMultiplier();\r\n    return baseScore * tensionMultiplier;\r\n  }\r\n\r\n\r\n\r\n\r\n}\r\n\r\nexport default CampaignManager;","export const NAMES = {\n  'CHARACTER_NAMES' : [\n        // Firstnames\n        ['Godfrey', 'Sable', 'Saul', 'Jimbo', 'Neb', 'Nestrin', 'Dirk', 'Crystal', 'Immeral', 'Olga', 'Ricky'],\n        // Lastnames\n        ['Rose', 'Goodwyne', 'Halfheart', 'Farmer', 'Taylor', 'of the Sea', 'Trainer', 'of the Woods', 'Silkmonger', 'Smith']\n    ],\n    'PLAYER_NAMES' : [\n        // First Names\n        ['Olivier', 'Dan', 'Matt', 'Maxim', 'Angie', 'Charlotte', 'Dawn', 'Bill', 'Tom', 'Sarah'],\n        // Last Names\n        ['Brass', 'Andrews', 'Wallace', 'Skuski', 'Kubrik', 'Binchs', 'Wells', 'Anteds', 'Kruk', 'Madup']\n    ]\n}\n","import { NAMES } from \"../consts/names\";\n\n\nexport function test1(): string {\n  return 'test1';\n}\n\nexport function test2(): string {\n  return 'test2';\n}\n\n// Linear interpolation between two numbers\nexport const lerp = (a: number, b: number, t: number): number => {\n  return a + (b - a) * t;\n};\n\n// Linear interpolation between two colors\nexport const lerpColor = (a: string, b: string, d: number, l: number): string => {\n\n  const t = l / d;\n\n  const ah = parseInt(a.replace(/#/g, ''), 16);\n  const ar = ah >> 16;\n  const ag = (ah >> 8) & 0xff;\n  const ab = ah & 0xff;\n\n  const bh = parseInt(b.replace(/#/g, ''), 16);\n  const br = bh >> 16;\n  const bg = (bh >> 8) & 0xff;\n  const bb = bh & 0xff;\n\n  const rr = Math.round(ar + t * (br - ar));\n  const rg = Math.round(ag + t * (bg - ag));\n  const rb = Math.round(ab + t * (bb - ab));\n\n  return `#${((1 << 24) + (rr << 16) + (rg << 8) + rb).toString(16).slice(1)}`;\n};\n\n\nexport const randomElement = (someArray: any[]) : any => {\n  return someArray[Math.floor(Math.random() * someArray.length)]\n}\n\nexport const generateName = (character = true): string => {\n\n  const firstName = randomElement(character ? NAMES.CHARACTER_NAMES[0] : NAMES.PLAYER_NAMES[0]);\n  const lastName = randomElement(character ? NAMES.CHARACTER_NAMES[1] : NAMES.PLAYER_NAMES[1]);\n\n  return firstName + ' ' + lastName;\n}\n\nexport function clamp(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max);\n}","import { PlayerTrait } from \"../models\";\n\nexport const PLAYER_TRAITS: Record<string, PlayerTrait> = {\n    TEAM_PLAYER: {\n        name: \"Team Player\",\n        description: \"+1 to all other players happiness\"\n    },\n    GRUMPY: { \n        name: \"Grumpy\",\n        description: \"-1 to all other players happiness\"\n    },\n    FORMER_DM: {\n        name: \"Former DM\",\n        description: \"Ignores personal LIKES and HATES when choosing encounters\"\n    },\n    MIN_MAXER: {\n        name: \"Min-Maxer\",\n        description: \"Gets a bonus to Combat encounters\"\n    },\n    ROLE_PLAYER: {\n        name: \"Role Player\",\n        description: \"Gets a bonus to Social encounters\"\n    },\n    LOGICIAN: {\n        name: \"Logician\",\n        description: \"Gets a bonus to Puzzle encounters\"\n    },\n    WEALTHY: {\n        name: \"Wealthy\",\n        description: \"Gives a bonus 20% reward at the end of a Campaign if Happy\"\n    },\n    BLOODTHIRSTY: {\n        name: \"Bloodthirsty\",\n        description: \"Gets x2 happiness from Combat encounters\"\n    }\n\n\n}","\r\nimport { ATTITUDE, Character, Player } from '../models';\r\nimport { CHARACTER_CLASS, RACE } from './general';\r\nimport { PLAYER_TRAITS } from './playerTraits';\r\nimport { TAG } from './tags';\r\n\r\n\r\n\r\n\r\nexport const QUICKSTART_CHARACTERS: Character[] = [\r\n    {\r\n        race: RACE.ELF,\r\n        character_class: CHARACTER_CLASS.WIZARD, \r\n        abilities: [],\r\n        level: 1,\r\n        experience: 0,\r\n        name: 'Saul',\r\n        id: 0,\r\n        icon: 'elf_1',\r\n        gear: [],\r\n        backstory: [{\r\n            tag: {\r\n                name: 'Dark Gem',\r\n            },\r\n            completed: false,\r\n        }],\r\n       \r\n    },\r\n    {\r\n        race: RACE.HUMAN,\r\n        character_class: CHARACTER_CLASS.FIGHTER, \r\n        abilities: [],\r\n        level: 1,\r\n        experience: 0,\r\n        name: 'Riker',\r\n        id: 1,\r\n        icon: 'human_1',\r\n        gear: [],\r\n        backstory: [],\r\n    },\r\n    {\r\n        race: RACE.HUMAN,\r\n        character_class: CHARACTER_CLASS.ROGUE, \r\n        abilities: [],\r\n        level: 1,\r\n        experience: 0,\r\n        name: 'Godfrey',\r\n        id: 2,\r\n        icon: 'human_2',\r\n        gear: [],\r\n        backstory: []\r\n    }\r\n]\r\n\r\n\r\n\r\nexport const QUICKSTART_PLAYERS: Player[] = [\r\n    {\r\n        name: 'Matt W',\r\n        characters: [QUICKSTART_CHARACTERS[0]],\r\n        id: 0,\r\n        icon: 'player_1',\r\n        schedule: [10, 20, 30, 40, 50, 60, 70],\r\n        preferences:  [\r\n            [TAG.ELVES, ATTITUDE.LIKE],\r\n            [TAG.HUMANS, ATTITUDE.LIKE],\r\n            [TAG.UNDEAD, ATTITUDE.LIKE],\r\n            [TAG.DEER, ATTITUDE.HATE],\r\n            [TAG.POLITICS, ATTITUDE.HATE],\r\n            [TAG.BRIDGES, ATTITUDE.LIKE],\r\n            [TAG.SOCIALIZING, ATTITUDE.LIKE],\r\n            [TAG.BEER, ATTITUDE.LIKE],\r\n        ],\r\n        traits: [],\r\n        playerStats: {\r\n            stress: 0,\r\n            enjoyment: 1,\r\n            engagement: 25,\r\n            involvement: 3,\r\n            experience: 0,\r\n            level: 1,\r\n            maxEngagement: 5,\r\n            maxInvolvement: 5,\r\n            maxEnjoyment: 5,\r\n            stressBuffer: 10,\r\n          }\r\n    },\r\n    {\r\n        name: 'Dan A',\r\n        characters: [QUICKSTART_CHARACTERS[1]],\r\n        id: 1,\r\n        icon: 'player_2',\r\n        schedule: [10, 20, 30, 40, 50, 60, 70],\r\n        preferences:  [\r\n        \r\n            [TAG.HALFLINGS, ATTITUDE.LIKE],\r\n            [TAG.POLITICS, ATTITUDE.LIKE],\r\n            [TAG.TAVERNS, ATTITUDE.LIKE],\r\n            [TAG.GOBLINS, ATTITUDE.HATE],\r\n            [TAG.EXPLORATION, ATTITUDE.LIKE],\r\n            [TAG.BEER, ATTITUDE.LIKE],\r\n        \r\n        ],\r\n        traits: [],\r\n        playerStats: {\r\n            stress: 0,\r\n            enjoyment: 4,\r\n            engagement: 25,\r\n            involvement: 3,\r\n            experience: 0,\r\n            level: 1,\r\n            maxEngagement: 5,\r\n            maxInvolvement: 5,\r\n            maxEnjoyment: 5,\r\n            stressBuffer: 10,\r\n          }\r\n    },\r\n    {\r\n        name: 'Olivier B',\r\n        characters: [QUICKSTART_CHARACTERS[2]],\r\n        id: 2,\r\n        icon: 'player_3',\r\n        schedule: [10, 20, 30, 40, 50, 60, 70],\r\n        preferences:  [\r\n            [TAG.DWARVES, ATTITUDE.LIKE],\r\n            [TAG.HALFLINGS, ATTITUDE.LIKE],\r\n            [TAG.PUZZLES, ATTITUDE.LIKE],\r\n           // [TAG.TRAVEL, ATTITUDE.LIKE],\r\n            [TAG.SOCIALIZING, ATTITUDE.LIKE],\r\n            [TAG.BORING_THINGS, ATTITUDE.HATE],\r\n            [TAG.BEER, ATTITUDE.LIKE],\r\n        \r\n        ],\r\n        traits: [PLAYER_TRAITS.TEAM_PLAYER],\r\n        playerStats: {\r\n            stress: 0,\r\n            enjoyment: 3,\r\n            engagement: 25,\r\n            involvement: 3,\r\n            experience: 0,\r\n            level: 1,\r\n            maxEngagement: 5,\r\n            maxInvolvement: 5,\r\n            maxEnjoyment: 5,\r\n            stressBuffer: 10,\r\n          }\r\n    }\r\n]\r\n\r\n","import { LEVELUP_OPTION, MAX_CHARS_PER_PLAYER, PLAYER_EXP_LEVEL } from '../consts/general';\r\nimport { ATTITUDE, Character, ModalOption, Player, PREFERENCE, Tag } from '../models';\r\nimport { TAG } from '../consts/tags';\r\nimport { generateName } from '../utils/utils';\r\nimport { PLAYER_TRAITS } from '../consts/playerTraits';\r\nimport { QUICKSTART_PLAYERS } from '../consts/quickStart';\r\nimport UiManager from './uiManager';\r\nimport AppManager from './appManager';\r\nimport { channel } from 'diagnostics_channel';\r\nimport { ENEMIES } from '../consts/enemies';\r\nimport ChatManager from './chatManager';\r\nimport CharacterManager from './characterManager';\r\n\r\n\r\nconst CHANCE_FOR_PLAYER_TRAIT = 0.5;\r\n\r\n\r\n\r\n\r\n\r\nclass PlayerManager {\r\n  private recruitablePlayers: Player[];\r\n  private selectedPlayers: Player[];\r\n  private players: Player[];\r\n  private uniqueID: number = 0;\r\n  private _currentPlayerIndex: number = 0;\r\n  private appManager: AppManager;\r\n  private uiManager: UiManager | undefined;\r\n \r\n\r\n  constructor(appManager: AppManager) {\r\n    this.recruitablePlayers = [];\r\n    this.players = [];\r\n    this.selectedPlayers = [];\r\n    this.appManager = appManager;\r\n  }\r\n\r\n\r\n  getCurrentPlayer() {\r\n    return this.players.length === 0 ? undefined : this.players[this._currentPlayerIndex];\r\n  }\r\n\r\n  isCurrentPlayerLast() {\r\n    return this._currentPlayerIndex === this.players.length - 1;\r\n  }\r\n\r\n  init() {  \r\n      this.uiManager = this.appManager.getUiManager();\r\n      this.generateAvailablePlayers(8);\r\n  }\r\n  \r\n  stressPlayers(amount: number) {\r\n    \r\n    this.players.forEach((player) => {\r\n      player.playerStats.stress += amount;\r\n    });\r\n  \r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  getRecruitablePlayers() {\r\n    return this.recruitablePlayers;\r\n  }\r\n\r\n  setSelectedPlayers(selectedPlayers:number[]) {\r\n    this.selectedPlayers = this.recruitablePlayers.filter((_, index) => {\r\n      return selectedPlayers.includes(index);\r\n    });\r\n  }\r\n  \r\n  getPlayers() {\r\n    return this.players;\r\n  }\r\n\r\n  getSelectedPlayers() {\r\n    return this.selectedPlayers;\r\n  }\r\n\r\n  getPlayerById(id: number): Player | undefined {\r\n    return this.players.find((player) => player.id === id) || undefined;\r\n  }\r\n\r\n  getSelectedPlayerIds() {\r\n    return this.selectedPlayers.map((player) => player.id);\r\n  }\r\n\r\n  generateIcon() {\r\n    return \"player_\" + Math.ceil(Math.random() * 9.9);\r\n  }\r\n\r\n  generateSchedule() {\r\n    const schedule = [];\r\n    for(let i = 0; i<7; i++) {\r\n      schedule.push(Math.ceil(Math.random() * 100));\r\n    }\r\n    return schedule;\r\n  }\r\n\r\n  generateAvailablePlayers(nbPlayer: number) {\r\n    for(let p = 0; p<nbPlayer; p++){\r\n      const newPlayer: Player = {\r\n        name: generateName(false),\r\n        id: this.uniqueID++,\r\n        characters: [],\r\n        icon: this.generateIcon(),\r\n        schedule: this.generateSchedule(),\r\n        preferences: this.generatePreferences(),\r\n        traits: this.generatePlayerTraits(),\r\n        playerStats: {\r\n          stress: 50,\r\n          enjoyment: 3,\r\n          engagement: 50,\r\n          involvement: 3,\r\n          experience: 0,\r\n          level: 1,\r\n          maxEngagement: 5,\r\n          maxInvolvement: 5,\r\n          maxEnjoyment: 5,\r\n          stressBuffer: 10,\r\n        }\r\n      }\r\n      this.recruitablePlayers.push(newPlayer);\r\n    }\r\n  }\r\n\r\n  // This should be a campaign setting maaybe....\r\n  getMaxCharactersPerPlayer() {\r\n    return MAX_CHARS_PER_PLAYER;\r\n  }\r\n\r\n  acceptSelectedPlayers() {\r\n    this.players = this.selectedPlayers;\r\n  }\r\n\r\n  getPlayerWithAttitudeForTag(tag: Tag, attitude: ATTITUDE) {\r\n    \r\n    const playersWithAttitude = this.players.filter((player) => {\r\n      return player.preferences.some((pref) => pref[0].name === tag.name && pref[1] === attitude);\r\n    });\r\n    if(playersWithAttitude.length > 0) {\r\n      return playersWithAttitude[Math.floor(Math.random() * playersWithAttitude.length)];\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n\r\n  generatePlayerTraits() {\r\n    const allTraits = Object.values(PLAYER_TRAITS);\r\n    \r\n    if(Math.random() < CHANCE_FOR_PLAYER_TRAIT) {\r\n      const randomTrait = allTraits[Math.floor(Math.random() * allTraits.length)];\r\n      return [randomTrait];\r\n    }\r\n    return [];\r\n\r\n  }\r\n\r\n  generatePreferences(): [Tag, ATTITUDE][] {\r\n    const preferences: [Tag, ATTITUDE][] = [];\r\n\r\n    // Flatten the TAG object to get all tags\r\n    const allTags: Tag[] = Object.values(TAG).flat();\r\n\r\n    // Filter tags with preference = PREFERENCE.START\r\n    const startTags = allTags.filter(tag => tag.preference === PREFERENCE.START);\r\n    const mainTags = allTags.filter(tag => tag.preference === PREFERENCE.MAIN);\r\n\r\n    // Select one main like and one main hate\r\n    if (startTags.length > 1) {\r\n      const mainLike = startTags.splice(Math.floor(Math.random() * startTags.length), 1)[0];\r\n      const mainHate = startTags.splice(Math.floor(Math.random() * startTags.length), 1)[0];\r\n      preferences.push([mainLike, ATTITUDE.LIKE]);\r\n      preferences.push([mainHate, ATTITUDE.HATE]);\r\n    }\r\n\r\n    // Function to get random likes and hates\r\n    const getRandomPreferences = (tags: Tag[], count: number, min: number, max: number) => {\r\n      const selectedPreferences: [Tag, ATTITUDE][] = [];\r\n      for (let i = 0; i < count; i++) {\r\n        const randomTag = tags[Math.floor(Math.random() * tags.length)];\r\n        const randomValue = Math.floor(Math.random() * (max - min + 1)) + min;\r\n        selectedPreferences.push([randomTag, randomValue]);\r\n      }\r\n      return selectedPreferences;\r\n    };\r\n\r\n    // Get 0-2 random likes and hates\r\n    const randomLikesCount = Math.floor(Math.random() * 3);\r\n    const randomHatesCount = Math.floor(Math.random() * 3);\r\n\r\n    const randomLikes = getRandomPreferences(mainTags, randomLikesCount, 1, 5);\r\n    const randomHates = getRandomPreferences(mainTags, randomHatesCount, -5, -1);\r\n\r\n    preferences.push(...randomLikes);\r\n    preferences.push(...randomHates);\r\n\r\n    return preferences;\r\n  }\r\n\r\n  exposeEncounterTag(tag: Tag) {\r\n    // Player's happiness will go up or down by 5 points depending on their attitude towards the tag\r\n    this.players.forEach((player) => {\r\n      const attitude = player.preferences.find((pref) => pref[0].name === tag.name);\r\n      if(attitude) {\r\n        player.playerStats.enjoyment = Math.max(Math.min(player.playerStats.maxEnjoyment, player.playerStats.enjoyment + attitude[1]), 0);\r\n      }\r\n    });\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n\r\n  toggleSinglePlayerForCharacter(player: Player, character: Character) {\r\n    if(player) {\r\n      if(player.characters.includes(character)) {\r\n        this.removeCharacterFromPlayer(player, character);\r\n      }else{\r\n        this.players.forEach((p) => {\r\n          if(p.characters.includes(character)) {\r\n            this.removeCharacterFromPlayer(p, character);\r\n          }\r\n        });\r\n      player.characters.push(character);\r\n     }\r\n    }\r\n  }\r\n\r\n  getPlayerAssignedCharacter(character: Character| undefined): Player | undefined {\r\n    if(!character) return undefined;\r\n    let thePlayer: Player | undefined;\r\n    this.players.forEach((p) => {\r\n      if(p.characters.includes(character)) {\r\n        thePlayer = p;\r\n      }\r\n    });\r\n    return thePlayer;\r\n  }\r\n\r\n  assignCharactersToPlayer(player: Player, characters: Character[]) {\r\n    if(player) {\r\n     characters.forEach((character) => {\r\n        player.characters.push(character);\r\n      })\r\n    }\r\n  }\r\n\r\n  isCharacterAssigned(character: Character) {\r\n    return this.players.some((player) => player.characters.includes(character));\r\n  }\r\n\r\n  removeCharacterFromPlayer(player: Player, character: Character) {\r\n    if(player) {\r\n      const index = player.characters.indexOf(character);\r\n      if(index > -1) {\r\n        player.characters.splice(index, 1);\r\n      }\r\n    }\r\n  }\r\n\r\n  aggregateSchedule() {\r\n    const dayData = [0, 0, 0, 0, 0, 0, 0];\r\n    this.selectedPlayers.forEach((player) => {\r\n      player.schedule.forEach((dayValue, index) => {\r\n        dayData[index] += dayValue/this.selectedPlayers.length;\r\n        dayData[index] = Math.ceil(dayData[index]);\r\n      });\r\n    });\r\n    return dayData;\r\n  }\r\n\r\n  \r\n  getGroupAttitudes(players: Player[] = this.selectedPlayers) {\r\n    const groupAttitudes: { [key: string]: ATTITUDE } = {};\r\n    players.forEach((player) => {\r\n      player.preferences.forEach((pref) => {\r\n        const tag = pref[0];\r\n        const feel = pref[1];\r\n        \r\n        if(groupAttitudes[tag.name]) {\r\n          switch(groupAttitudes[tag.name]) {\r\n            case ATTITUDE.LIKE:\r\n              if(feel < 0) {\r\n                groupAttitudes[tag.name] = ATTITUDE.CONFLICTED;\r\n              }\r\n              break;\r\n            case ATTITUDE.HATE:\r\n              if(feel > 0) {\r\n                groupAttitudes[tag.name] = ATTITUDE.CONFLICTED;\r\n              }\r\n              break;\r\n          }\r\n        } else {\r\n          groupAttitudes[tag.name] = feel < 0 ? ATTITUDE.HATE : ATTITUDE.LIKE;\r\n        }\r\n      });\r\n    });\r\n\r\n\r\n  \r\n\r\n\r\n       const likes = Object.keys(groupAttitudes).map(key => {\r\n          if(groupAttitudes[key] === ATTITUDE.LIKE) return key\r\n          return ''\r\n        }\r\n       ).filter((e) => e !== '')\r\n\r\n       const hates = Object.keys(groupAttitudes).map(key => {\r\n        if(groupAttitudes[key] === ATTITUDE.HATE) return key\r\n        return ''\r\n      }\r\n     ).filter((e) => e !== '')\r\n\r\n     const conflicted = Object.keys(groupAttitudes).map(key => {\r\n      if(groupAttitudes[key] === ATTITUDE.CONFLICTED) return key\r\n      return ''\r\n    }\r\n   ).filter((e) => e !== '')\r\n\r\n\r\n    return {likes, hates, conflicted};\r\n  }\r\n\r\n  getGroupAttitudeForTag(players:Player[] ,tag: Tag) {\r\n    const groupAttitudes = this.getGroupAttitudes(players);\r\n    if(groupAttitudes.likes.includes(tag.name)) {\r\n      return ATTITUDE.LIKE;\r\n    } else if(groupAttitudes.hates.includes(tag.name)) {\r\n      return ATTITUDE.HATE;\r\n    } else if(groupAttitudes.conflicted.includes(tag.name)) {\r\n      return ATTITUDE.CONFLICTED;\r\n    }\r\n    return ATTITUDE.NEUTRAL;\r\n  }\r\n\r\n  getPartyAttitudeForTag(tag: Tag) {\r\n    return this.getGroupAttitudeForTag(this.players, tag);\r\n  }\r\n\r\n\r\n  // There are players in the group.\r\n  readyForGame() {\r\n    if(this.players.length === 0) return false;\r\n    let allPlayersHaveCharacter = true;\r\n    this.players.forEach((player) => {\r\n      if(player.characters.length === 0){\r\n        allPlayersHaveCharacter = false;\r\n      }\r\n    })\r\n    return allPlayersHaveCharacter; \r\n  }\r\n\r\n  initiateQuickStart() {\r\n    \r\n    this.recruitablePlayers = this.players = QUICKSTART_PLAYERS;\r\n  }\r\n\r\n  addPlayerExp(player: Player | undefined, amount: number) {\r\n   if(!player) return;\r\n      player.playerStats.experience += amount;\r\n      if(player.playerStats.experience >= this.expNeededForLevel(player.playerStats.level)) {\r\n        player.playerStats.level += 1;\r\n        player.playerStats.experience = 0;\r\n        console.log(\"player leveled up!!!!\");\r\n        this.appManager.getChatManager().dmMessage(`${player.name} learned something!`);\r\n        this.handleLevelUp(player);\r\n      }\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  expNeededForLevel(level: number) {\r\n    return PLAYER_EXP_LEVEL[level - 1] || 0;\r\n  }\r\n\r\n  getAllPlayerPreferences() {\r\n    const allPreferences: Tag[] = [];\r\n    this.players.forEach((player) => {\r\n      player.preferences.forEach((pref) => {\r\n        if(!allPreferences.includes(pref[0])) {\r\n          allPreferences.push(pref[0]);\r\n        }\r\n      });\r\n    });\r\n    return allPreferences;\r\n  }\r\n\r\n  getAllPlayerCharacters(): Character[] {\r\n    const allCharacters: Character[] = [];\r\n    this.players.forEach((player) => {\r\n      player.characters.forEach((character) => {\r\n        if(!allCharacters.includes(character)) {\r\n          allCharacters.push(character);\r\n        }\r\n      });\r\n    });\r\n    return allCharacters;\r\n  }\r\n\r\n  getRandomPlayer() {\r\n    return this.players[Math.floor(Math.random() * this.players.length)];\r\n  }\r\n\r\n  getRandomCharacter(allowDead: boolean = false) {\r\n    const allCharacters = this.getAllPlayerCharacters();\r\n    if(allCharacters.length === 0) return undefined;\r\n    if(!allowDead) {\r\n      const aliveCharacters = allCharacters.filter((character) => !(character.injury === \"dead\"));\r\n      if(aliveCharacters.length === 0) return undefined;\r\n      return aliveCharacters[Math.floor(Math.random() * aliveCharacters.length)];\r\n    }\r\n    // If allowDead is true, return any character\r\n    return allCharacters[Math.floor(Math.random() * allCharacters.length)];\r\n  }\r\n\r\n\r\n  getRandomCharacterForPlayer(player: Player, allowDead: boolean = false) {\r\n    if(!player) return undefined;\r\n    if(player.characters.length === 0) return undefined;\r\n    if(!allowDead) {\r\n      const aliveCharacters = player.characters.filter((character) => !(character.injury === \"dead\"));\r\n      if(aliveCharacters.length === 0) return undefined;\r\n      return aliveCharacters[Math.floor(Math.random() * aliveCharacters.length)];\r\n    }\r\n    // If allowDead is true, return any character\r\n    return player.characters[Math.floor(Math.random() * player.characters.length)];\r\n  }\r\n  \r\n  refreshPlayer(player: Player) {\r\n    if(player) {\r\n      player.playerStats.involvement = player.playerStats.maxInvolvement;\r\n      player.playerStats.enjoyment = player.playerStats.maxEnjoyment;\r\n      player.playerStats.stress = 0;\r\n    }\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  // player levelups give 1,2 or 3 points to either involvement, or enjoyment, or +5, +10, or +25 to stress buffer\r\n  getPlayerLevelUpOption(player: Player) {\r\n    let levelUpOption: ModalOption;\r\n\r\n    const randomStat = Math.floor(Math.random() * 3) + 1; // 1 for enjoyment, 2 for involvement, 3 for stress\r\n    const level = (() => {\r\n      const rand = Math.random();\r\n      if (rand < 0.5) return 1; // 50% chance\r\n      if (rand < 0.9) return 2; // 40% chance\r\n      return 3; // 10% chance\r\n    })();\r\n    const className =  (level === 1 ? 'common' : level === 2 ? 'rare' : 'legend');\r\n    if (randomStat === 1) { // enjoyment\r\n      levelUpOption = {\r\n        id: LEVELUP_OPTION.MAX_HAPPINESS,\r\n        title: (level === 1 ? '' : level === 2 ? 'Better ' : 'Great ') + 'Happiness',\r\n        description: `+${level} max Enjoyment`,\r\n        icon: '😊',\r\n        level: level,\r\n        class: className,\r\n        callback: () => {\r\n          player.playerStats.maxEnjoyment += level;\r\n          this.uiManager?.updateParty();\r\n        }\r\n      };\r\n    } else if(randomStat === 2) { // involvement\r\n      levelUpOption = {\r\n        id: LEVELUP_OPTION.MAX_ATTENTION,\r\n        title: (level === 1 ? '' : level === 2 ? 'Better ' : 'Great ') + 'Attention',\r\n        description: `+${level} max Attention`,\r\n        icon: '🧠',\r\n        level: level,\r\n        class: className,\r\n        callback: () => {\r\n          player.playerStats.maxInvolvement += level;\r\n          this.uiManager?.updateParty();\r\n        }\r\n      };\r\n    } else {\r\n      levelUpOption = {\r\n        id: LEVELUP_OPTION.STRESS_BUFFER,\r\n        title: (level === 1 ? '' : level === 2 ? 'Better ' : 'Great ') + 'Stress Proof',\r\n        description: `+${level * 5} Stress Buffer/Reduce`,\r\n        icon: '🛡️',\r\n        class: className,\r\n        callback: () => {\r\n          player.playerStats.stressBuffer += level * 5;\r\n          player.playerStats.stress = Math.max(0, player.playerStats.stress - level * 5);\r\n          this.uiManager?.updateParty();\r\n        }\r\n      };\r\n    }\r\n\r\n    return levelUpOption;\r\n  }\r\n\r\n  //This will eventully provide player traits but for now I want it to just generae a random chataracter and offer it as a level up option\r\n  getFancyLevelUpOption(player: Player) {\r\n    const randomCharacter = this.appManager.getCharacterManager().generateRandomCharacter(1)\r\n    const levelUpOption: ModalOption = {\r\n      id: LEVELUP_OPTION.CHARACTER,\r\n      title: 'New Character',\r\n      description: `Get ${randomCharacter.name}`,\r\n      icon: `${randomCharacter.icon}`,\r\n      class: 'level-up-option-character',\r\n      callback: () => {\r\n        player.characters.push(randomCharacter);\r\n        this.uiManager?.updateParty();\r\n        \r\n      }\r\n    };\r\n    return levelUpOption;\r\n  }\r\n\r\n\r\n\r\nhandleLevelUp(player: Player) {\r\n  const levelUpOptions: ModalOption[] = []\r\n\r\n  // Option to waive level up in favor of replenishing happiness, attention, and reducing stress. \r\n  levelUpOptions.push({\r\n    id: LEVELUP_OPTION.REFRESH,\r\n    title: 'Refresh',\r\n    description: 'Fill Attitude, Attention. Reduce Stress.',\r\n    icon: '🔄',\r\n\r\n    callback: () => this.refreshPlayer(player)\r\n  });\r\n\r\n  // get mid level up option\r\n  levelUpOptions.push(this.getPlayerLevelUpOption(player));\r\n\r\n  // get end level up option\r\n  levelUpOptions.push(this.getFancyLevelUpOption(player));\r\n\r\n\r\n  this.uiManager?.showModal({\r\n    title: player.name + ' Level Up!',\r\n    options: levelUpOptions,\r\n    onClose: () => console.log('Modal closed'),\r\n    type: 'levelup',\r\n  });\r\n  }\r\n\r\n  /**\r\n   * Evaluates player preferences for encounter options based on LIKE/HATE attitudes\r\n   * Returns preference data for each encounter\r\n   */\r\n  evaluateEncounterPreferences(encounters: any[]): { \r\n    preferredEncounters: { [encounterName: string]: Player[] },\r\n    notWantedEncounters: { [encounterName: string]: Player[] }\r\n  } {\r\n    const preferredEncounters: { [encounterName: string]: Player[] } = {};\r\n    const notWantedEncounters: { [encounterName: string]: Player[] } = {};\r\n\r\n    // Calculate like/hate indices for each encounter for each player\r\n    const playerEncounterScores: { [playerName: string]: { [encounterName: string]: { likes: number, hates: number } } } = {};\r\n    \r\n    this.players.forEach(player => {\r\n      playerEncounterScores[player.name] = {};\r\n      \r\n      encounters.forEach(encounter => {\r\n        let likes = 0;\r\n        let hates = 0;\r\n        \r\n        // Check encounter tags\r\n        encounter.tags?.forEach((tag: any) => {\r\n          const preference = player.preferences.find(pref => pref[0].name === tag.name);\r\n          if (preference) {\r\n            if (preference[1] === ATTITUDE.LIKE) likes++;\r\n            if (preference[1] === ATTITUDE.HATE) hates++;\r\n          }\r\n        });\r\n        \r\n        // Check location tags\r\n        encounter.location?.tags?.forEach((tag: any) => {\r\n          const preference = player.preferences.find(pref => pref[0].name === tag.name);\r\n          if (preference) {\r\n            if (preference[1] === ATTITUDE.LIKE) likes++;\r\n            if (preference[1] === ATTITUDE.HATE) hates++;\r\n          }\r\n        });\r\n        \r\n        playerEncounterScores[player.name][encounter.name] = { likes, hates };\r\n      });\r\n    });\r\n\r\n    // Determine preferred encounters for each player\r\n    this.players.forEach(player => {\r\n      const scores = playerEncounterScores[player.name];\r\n      let maxLikeScore = 0;\r\n      let preferredEncounterNames: string[] = [];\r\n      \r\n      // Find encounters with highest like score\r\n      Object.keys(scores).forEach(encounterName => {\r\n        const score = scores[encounterName];\r\n        const netScore = score.likes - score.hates; // Conflicting tags counteract each other\r\n        \r\n        if (score.likes > 0 && netScore > maxLikeScore) {\r\n          maxLikeScore = netScore;\r\n          preferredEncounterNames = [encounterName];\r\n        } else if (score.likes > 0 && netScore === maxLikeScore) {\r\n          preferredEncounterNames.push(encounterName);\r\n        }\r\n      });\r\n      \r\n      // Randomly select one if tied\r\n      if (preferredEncounterNames.length > 0) {\r\n        const selectedEncounter = preferredEncounterNames[Math.floor(Math.random() * preferredEncounterNames.length)];\r\n        if (!preferredEncounters[selectedEncounter]) {\r\n          preferredEncounters[selectedEncounter] = [];\r\n        }\r\n        preferredEncounters[selectedEncounter].push(player);\r\n      }\r\n      \r\n      // Determine NOT-WANTED encounters\r\n      Object.keys(scores).forEach(encounterName => {\r\n        const score = scores[encounterName];\r\n        const netScore = score.likes - score.hates;\r\n        \r\n        // Hated encounters (net negative score)\r\n        if (netScore < 0) {\r\n          if (!notWantedEncounters[encounterName]) {\r\n            notWantedEncounters[encounterName] = [];\r\n          }\r\n          notWantedEncounters[encounterName].push(player);\r\n        }\r\n        // Non-preferred encounters have 25% chance of being NOT-WANTED (only if player has preferences)\r\n        else if (!preferredEncounterNames.includes(encounterName) && \r\n                 player.preferences.length > 0 && \r\n                 Math.random() < 0.25) {\r\n          if (!notWantedEncounters[encounterName]) {\r\n            notWantedEncounters[encounterName] = [];\r\n          }\r\n          notWantedEncounters[encounterName].push(player);\r\n        }\r\n      });\r\n    });\r\n\r\n    return { preferredEncounters, notWantedEncounters };\r\n  }\r\n\r\n  /**\r\n   * Returns all players for railroading penalty when only one option is available\r\n   */\r\n  playersAffectedByRailroading(): Player[] {\r\n    return [...this.players];\r\n  }\r\n\r\n  /**\r\n   * Apply encounter selection effects based on player preferences\r\n   */\r\n  applyEncounterSelectionEffects(selectedEncounter: any, encounters: any[]): void {\r\n    // Delegate to PartyManager for stat updates\r\n    this.appManager.getPartyManager().applyEncounterSelectionEffects(selectedEncounter, encounters);\r\n  }\r\n\r\n  /**\r\n   * Calculate penalties for incomplete exploration\r\n   */\r\n  calculateIncompleteExplorationPenalties(tagManager: any): {\r\n    locationTagPenalty: number;\r\n    encounterTagPenalty: number;\r\n    totalStressPenalty: number;\r\n    totalAttentionPenalty: number;\r\n  } {\r\n    const outstandingLocationTags = tagManager.getOutstandingLocationTags();\r\n    const outstandingEncounterTags = tagManager.getOutstandingEncounterTags();\r\n    \r\n    const locationTagPenalty = outstandingLocationTags.length * 5;\r\n    const encounterTagPenalty = outstandingEncounterTags.length;\r\n    \r\n    // Stress penalty for any outstanding location tags\r\n    const totalStressPenalty = locationTagPenalty;\r\n    // -1 attention penalty for each outstanding encounter tag\r\n    const totalAttentionPenalty = encounterTagPenalty;\r\n    \r\n    return {\r\n      locationTagPenalty,\r\n      encounterTagPenalty,\r\n      totalStressPenalty,\r\n      totalAttentionPenalty\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Apply penalties for incomplete exploration when advancing encounters early\r\n   */\r\n  applyIncompleteExplorationPenalties(tagManager: any): void {\r\n    // Delegate to PartyManager for stat updates\r\n    this.appManager.getPartyManager().applyIncompleteExplorationPenalties(tagManager);\r\n  }\r\n\r\n  /**\r\n   * Handle encounter selection - apply all effects and advance the encounter\r\n   */\r\n  handleNextEncounterSelection(selectedBranch: any, allBranches: any[], tagManager: any): void {\r\n    // Delegate to PartyManager for encounter selection handling\r\n    this.appManager.getPartyManager().handleNextEncounterSelection(selectedBranch, allBranches, tagManager);\r\n  }\r\n\r\n}\r\n\r\nexport default PlayerManager;\r\n\r\n\r\n\r\n","\nclass SessionManager {\n\n  constructor() {\n    this.init();\n  }\n\n  init() {\n\n  }\n\n  startSession() {\n    console.log('Starting session...');\n    // Logic to guide players through the graph\n  }\n\n  // Other methods to manage sessions\n}\n\nexport default SessionManager;","import EventEmitter from 'events';\r\nimport { Character, HeroCombatant, Player, Tag } from '../models';\r\nimport AppManager from './appManager';\r\nimport CampaignManager from './campaignManager';\r\nimport CharacterManager from './characterManager';\r\nimport DataManager from './dataManager';\r\nimport PlayerManager from './playerManager';\r\nimport UiManager from './uiManager';\r\n\r\nclass PartyManager extends EventEmitter {\r\n\r\n  private dataManager: DataManager | undefined;\r\n  private appManager: AppManager | undefined;\r\n  private characterManager: CharacterManager | undefined;\r\n  private campaignManager: CampaignManager | undefined;\r\n  private playerManager: PlayerManager | undefined;\r\n  private uiManager: UiManager | undefined;\r\n // private partyScore: number = 0;\r\n  private partyTension: number = 0;\r\n  private treasureLevel: number = 0;\r\n  private treasurePoints: number = 0;\r\n  partyExhaustion: number = 0;\r\n\r\n  \r\n  private stressColors = ['#FFB347', '#FFDF80', '#FFDF80', '#B2FF66', '#B2FF66', '#B2FF66', '#66FF66', '#FF7043', '#FF7043', '#FF6666'];\r\n  constructor(appManager: AppManager) {\r\n    super();\r\n    setTimeout(() => {\r\n      this.appManager = appManager;\r\n      this.dataManager = appManager.getDataManager();\r\n      this.characterManager = appManager.getCharacterManager();\r\n      this.campaignManager = appManager.getCampaignManager();\r\n      this.playerManager = appManager.getPlayerManager();\r\n      this.uiManager = appManager.getUiManager();\r\n    }, 0);\r\n\r\n  }\r\n\r\n  perceptionEventReveal(character: Character) {\r\n    // We need to bump the player's engagement, and decreae all other players engamgement\r\n    const players = this.playerManager?.getPlayers();\r\n    players?.forEach((player) => {\r\n      if(player.characters.includes(character)) {\r\n        player.playerStats.engagement = Math.min(player.playerStats.maxEngagement, Math.max(player.playerStats.engagement + 1, 0));\r\n      } else {\r\n        player.playerStats.engagement = Math.min(player.playerStats.maxEngagement, Math.max(player.playerStats.engagement - 1, 0));\r\n\r\n      }\r\n    });\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n \r\n  getPartyStrength() {\r\n    const players = this.playerManager?.getPlayers();\r\n    // sum the levels for now\r\n    let strength = 0;\r\n    players?.forEach((player) => {\r\n      player.characters.forEach((character) => {\r\n        if(character) {\r\n          strength += character.level;\r\n        }\r\n      });\r\n    });\r\n    return strength;\r\n  }\r\n\r\n  playersTakeAction(playersAttended?: string[], reduceAllOthers = true, addAmount = 1) {\r\n    const players = this.playerManager?.getPlayers();\r\n    players?.forEach((player) => {\r\n      if(playersAttended?.includes(player.name)) {\r\n        player.playerStats.involvement = Math.min(player.playerStats.involvement + addAmount, player.playerStats.maxInvolvement );\r\n        this.playerManager?.addPlayerExp(player, addAmount);\r\n      }\r\n      else if(reduceAllOthers) {\r\n       this.updateAttention(player, -addAmount);\r\n      }\r\n    });\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  updateAllAttention(amount: number) {\r\n    const players = this.playerManager?.getPlayers();\r\n    players?.forEach((player) => {\r\n\r\n      this.updateAttention(player, amount);\r\n    });\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  updateAttention(player: Player, amount: number) {\r\n    if(player) {\r\n      if(amount < 0 && player.playerStats.involvement === 0) {\r\n        player.playerStats.enjoyment = Math.max(player.playerStats.enjoyment - 1, 0);\r\n      }\r\n      player.playerStats.involvement = Math.max(0, Math.min(player.playerStats.involvement + amount, player.playerStats.maxInvolvement));\r\n    }\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  multiplyPartyTension(amount: number) {\r\n    // const players = this.playerManager?.getPlayers();\r\n    // players?.forEach((player) => {\r\n    //   player.playerStats.stress *= amount;\r\n    // });\r\n    this.partyTension *= amount;\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  addPartyTension(amount: number) { \r\n    // const players = this.playerManager?.getPlayers();\r\n    // players?.forEach((player) => {\r\n    //   player.playerStats.stress += amount;\r\n    // });\r\n\r\n    this.partyTension += amount;\r\n    if(this.partyTension > 100) {\r\n      this.partyTension = 100;\r\n    }\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  setPartyTension(amount: number) {\r\n    // const players = this.playerManager?.getPlayers();\r\n    // players?.forEach((player) => {\r\n    //   player.playerStats.stress = amount;\r\n    // });\r\n    this.partyTension = amount;\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  takeBreak() {\r\n    this.partyTension = this.partyTension * 0.5;\r\n    // note, this will not affect the mood. \r\n    this.updateAllAttention(-2);\r\n    this.partyExhaustion = this.partyExhaustion * 0.5;\r\n    this.emit('dmScreenUpdated', this.partyExhaustion);\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  getPartyExhaustion() {\r\n    return this.partyExhaustion;\r\n  }\r\n\r\n  getMaxPartyExhaustion() {\r\n    return 100;\r\n  }\r\n  \r\n  exhaustParty(amount:  number) {\r\n    this.partyExhaustion += amount;\r\n    this.emit('dmScreenUpdated', this.partyExhaustion);\r\n  }\r\n  addPartyEngagement(amount: number) {  \r\n    const players = this.playerManager?.getPlayers();\r\n    players?.forEach((player) => {\r\n      player.playerStats.engagement = Math.min(player.playerStats.maxEngagement, Math.max(player.playerStats.engagement + amount, 0));\r\n    });\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  /**\r\n   * Update all players' stress by a certain amount\r\n   */\r\n  updateAllStress(amount: number) {\r\n    const players = this.playerManager?.getPlayers();\r\n    players?.forEach((player) => {\r\n      player.playerStats.stress = Math.max(0, player.playerStats.stress + amount);\r\n    });\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  /**\r\n   * Update specific players' stress by a certain amount\r\n   */\r\n  updatePlayersStress(players: Player[], amount: number) {\r\n    players.forEach((player) => {\r\n      player.playerStats.stress = Math.max(0, player.playerStats.stress + amount);\r\n    });\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  // addPartyScore(amount: number) {\r\n  //   //this.partyScore += amount * this.getTensionScoreMultiplier();\r\n  //   this.uiManager?.updateParty();\r\n  // }\r\n\r\n  // getPartyScore() {\r\n  // //  return this.partyScore;\r\n  // }\r\n\r\n\r\n  addInjury(character: Character): string {\r\n    if(!character) { \r\n      return ' invalid';\r\n    }\r\n    character.injury = character.injury === 'injured' ? 'dead' : 'injured';\r\n\r\n\r\n    const player = this.playerManager?.getPlayerAssignedCharacter(character);\r\n    if(player){\r\n      if(character.injury === 'injured') {\r\n        player.playerStats.enjoyment = Math.max(player.playerStats.enjoyment - 1, 0);\r\n      }else{\r\n        player.playerStats.enjoyment = Math.max(player.playerStats.enjoyment - 1, 0);\r\n      }\r\n    }\r\n\r\n\r\n    this.uiManager?.updateParty();\r\n    return character.injury;\r\n  }\r\n\r\n  addEnjoyment(player: Player, amount: number) {\r\n    if(player) {\r\n      player.playerStats.enjoyment = Math.min(player.playerStats.maxEnjoyment, Math.max(player.playerStats.enjoyment + amount, 0));\r\n      this.uiManager?.updateParty();\r\n    }\r\n  }\r\n\r\n  getTreasureLevel() { \r\n    return this.treasureLevel;\r\n  }\r\n\r\n  getTreasurePoints() {\r\n    return this.treasurePoints;\r\n  }\r\n\r\n  getTreasureThreshold(level: number): number {\r\n    return level + 1;\r\n  };\r\n  \r\n\r\n  addTreasurePoints(points: number) {\r\n    this.treasurePoints += points;\r\n    while (this.getTreasureThreshold(this.treasureLevel + 1) <= this.treasurePoints) {\r\n      this.treasureLevelUp(this.treasureLevel);\r\n      this.treasureLevel++;\r\n      this.treasurePoints = 0;\r\n      \r\n    }\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n\r\n  treasureLevelUp(level: number) {\r\n    const reward = this.getTreasureReward(level);\r\n    if(reward.type === 'score') {\r\n      this.campaignManager?.collectTreasure(reward.value);\r\n    } else {\r\n      const players = this.playerManager?.getPlayers();\r\n      players?.forEach((player) => {\r\n        player.playerStats.enjoyment = Math.min(player.playerStats.maxEnjoyment, player.playerStats.enjoyment + reward.value);\r\n      });\r\n    }\r\n  }\r\n\r\n  getTreasureReward = (level: number) => {\r\n    if(level % 2 === 0) {\r\n      return { type: 'attitude', value: 1 };\r\n    }\r\n    return { type: 'score', value: 2 * (level+1) };\r\n  };\r\n\r\n  addPartyEnjoyment(amount: number) {\r\n    const players = this.playerManager?.getPlayers();\r\n    players?.forEach((player) => {\r\n      player.playerStats.enjoyment = Math.min(player.playerStats.maxEnjoyment, Math.max(player.playerStats.enjoyment + amount, 0));\r\n    });\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  replenishTools(character: Character, amount?: number) {\r\n    if(!character.attributeLoss || !character.attributeLoss.tools) {\r\n      return;\r\n    }\r\n\r\n    if(!amount) {\r\n      amount = character.attributeLoss.tools;\r\n    }\r\n\r\n    character.attributeLoss.tools = Math.max(0, character.attributeLoss.tools - amount);\r\n    character.attributeLoss.tools = 0;\r\n  } \r\n\r\n  replenishPartyTools() {\r\n    const players = this.playerManager?.getPlayers();\r\n    players?.forEach((player) => {\r\n      player.characters.forEach((character) => {\r\n        if(character && character.attributeLoss) {\r\n          character.attributeLoss.tools = 0;\r\n        }\r\n      });\r\n    });\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n\r\n  healRandomCharacter() {\r\n    const players = this.playerManager?.getPlayers();\r\n    const injuredCharacters: Character[] = [];\r\n    players?.forEach((player) => {\r\n      player.characters.forEach((character) => {\r\n        if(character && character.injury) {\r\n          injuredCharacters.push(character);\r\n        }\r\n      });\r\n    });\r\n    if(injuredCharacters.length === 0) {\r\n      return;\r\n    }\r\n    const randomIndex = Math.floor(Math.random() * injuredCharacters.length);\r\n    const character = injuredCharacters[randomIndex];\r\n    character.injury = undefined;\r\n  }\r\n\r\n  healParty() {\r\n    const players = this.playerManager?.getPlayers();\r\n    players?.forEach((player) => {\r\n      player.characters.forEach((character) => {\r\n        if(character) {\r\n          character.injury = undefined;\r\n        }\r\n      });\r\n    });\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  healCharacter(character: Character) {\r\n    if(!character) {\r\n      return;\r\n    }\r\n    character.injury = undefined;\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  raiseRandomFromDead() {\r\n    const players = this.playerManager?.getPlayers();\r\n    const deadCharacters: Character[] = [];\r\n    players?.forEach((player) => {\r\n      player.characters.forEach((character) => {\r\n        if(character && character.injury === 'dead') {\r\n          deadCharacters.push(character);\r\n        }\r\n      });\r\n    });\r\n    if(deadCharacters.length === 0) {\r\n      return;\r\n    }\r\n    const randomIndex = Math.floor(Math.random() * deadCharacters.length);\r\n    const character = deadCharacters[randomIndex];\r\n    character.injury = undefined;\r\n  }\r\n\r\n  replenishPartyMagic() {\r\n    const players = this.playerManager?.getPlayers();\r\n    players?.forEach((player) => {\r\n      player.characters.forEach((character) => {\r\n        if(character && character.attributeLoss) {\r\n          character.attributeLoss.magic = 0;\r\n        }\r\n      });\r\n    });\r\n    this.uiManager?.updateParty();\r\n  }\r\n  replenishMagic(character: Character, amount?: number) {\r\n    if(!character.attributeLoss \r\n      || !character.attributeLoss.magic\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    if(!amount) {\r\n      amount = character.attributeLoss.magic;\r\n    }\r\n    character.attributeLoss.magic = Math.max(0, character.attributeLoss.magic - amount);\r\n\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n  levelUpLowestCharacter() {\r\n    const players = this.playerManager?.getPlayers();\r\n    let lowestLevel = 100;\r\n    let lowestCharacter: Character | undefined;\r\n    players?.forEach((player) => {\r\n      player.characters.forEach((character) => {\r\n        if(character && character.level < lowestLevel) {\r\n          lowestLevel = character.level;\r\n          lowestCharacter = character;\r\n        }\r\n      });\r\n    });\r\n    if(lowestCharacter) {\r\n      lowestCharacter.level += 1;\r\n    }\r\n  }\r\n\r\n  levelUp(character: Character) {\r\n    if(character) {\r\n      character.level += 1;\r\n    }\r\n  }\r\n\r\n  //stress action\r\n  //any action which will cause stress to increase when tension is high\r\n  stressAction(affectedPlayers? : Player[]) {\r\n    const players = this.playerManager?.getPlayers();\r\n    const stressIncrease = this.getStressIncrease(this.partyTension) || 0;\r\n    players?.forEach((player) => {\r\n      if(!affectedPlayers || affectedPlayers.includes(player)) {\r\n       player.playerStats.stress = Math.min(100, player.playerStats.stress + stressIncrease);\r\n      }\r\n    });\r\n    this.uiManager?.updateParty();\r\n  }\r\n\r\n\r\n\r\n    // Make a unified wrapper for both hero and NPCs for the display. \r\n   generateHeroes(npcs: Tag[]) {\r\n\r\n      const heroCombatants: HeroCombatant[] = [];\r\n      npcs.forEach((npc) => {\r\n        const heroCombatant: HeroCombatant = {\r\n          npcTag: npc,\r\n          icon: `combat_${npc.name}`,\r\n          name: npc.name,\r\n        };\r\n        heroCombatants.push(heroCombatant);\r\n      });\r\n     \r\n      const characters = this.characterManager?.getPlayerCharacters();\r\n      characters?.forEach((character) => {\r\n        const heroCombatant: HeroCombatant = {\r\n          character: character,\r\n          icon: character.icon,\r\n          name: character.name,\r\n        };\r\n        heroCombatants.push(heroCombatant);\r\n      });\r\n\r\n\r\n      return heroCombatants;\r\n    }    getPartyTension() {\r\n     return this.partyTension;\r\n    }\r\n\r\n    getTensionScoreMultiplier() {\r\n      const tensionDescriptions = this.campaignManager?.getTensionDescriptions() || [];\r\n      for (const tension of tensionDescriptions) {\r\n        if (this.partyTension <= tension.max) {\r\n          return tension.scoreMultiplier;\r\n        }\r\n      }\r\n      return 0;\r\n    }\r\n\r\n    getTensionDescription(value: number) {\r\n      const tensionDescriptions = this.campaignManager?.getTensionDescriptions() || [];\r\n      for (const tension of tensionDescriptions) {\r\n        if (value <= tension.max) {\r\n          return tension.description;\r\n        }\r\n      }\r\n      return \"Unknown Tension\";\r\n    }\r\n\r\n    getTensionDescription2(value: number) {\r\n      let mult = 0;\r\n      const tensionDescriptions = this.campaignManager?.getTensionDescriptions() || [];\r\n      for (const tension of tensionDescriptions) {\r\n        if (value <= tension.max) {\r\n          mult = tension.scoreMultiplier;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if(mult === 0) {\r\n        return \"No Score\";\r\n      }if(mult === 0.5) {\r\n        return \"Score Multiplier: 50%\";\r\n      }if(mult === 1) {\r\n        return \"Normal Scoring\";\r\n      }\r\n      return `Score x${mult}`;\r\n    }\r\n\r\n    getScoreMultiplier(value: number) {\r\n      const tensionDescriptions = this.campaignManager?.getTensionDescriptions() || [];\r\n      for (const tension of tensionDescriptions) {\r\n      if (value <= tension.max) {\r\n        return tension.scoreMultiplier;\r\n      }\r\n      }\r\n    }\r\n\r\n    getStressIncrease(value: number) {\r\n      const tensionDescriptions = this.campaignManager?.getTensionDescriptions() || [];\r\n      for (const tension of tensionDescriptions) {\r\n        if (value <= tension.max) {\r\n          return tension.stressIncrease;\r\n        }\r\n      }\r\n      return 0;\r\n    }\r\n\r\n  getStressColors() {\r\n    return this.stressColors;\r\n  }\r\n\r\n  /**\r\n   * Apply encounter selection effects based on player preferences\r\n   */\r\n  applyEncounterSelectionEffects(selectedEncounter: any, encounters: any[]): void {\r\n    const { preferredEncounters, notWantedEncounters } = this.playerManager?.evaluateEncounterPreferences(encounters) || { preferredEncounters: {}, notWantedEncounters: {} };\r\n    const isRailroading = encounters.length === 1;\r\n    \r\n    if (isRailroading) {\r\n      // Apply -1 attention to all players for railroading\r\n      this.updateAllAttention(-1);\r\n      console.log(`Applied railroading penalty: -1 engagement to all players`);\r\n    } else {\r\n      // Apply +1 attitude to players who preferred this encounter\r\n      const preferredPlayers = preferredEncounters[selectedEncounter.name] || [];\r\n      if (preferredPlayers.length > 0) {\r\n        preferredPlayers.forEach(player => {\r\n          this.updateAttention(player, 1);\r\n          console.log(`Applied +1 engagement to ${preferredPlayers.length} players who preferred \"${selectedEncounter.name}\"`);\r\n        });\r\n      }\r\n      \r\n      // Apply -1 attitude to players who not-wanted this encounter\r\n      const notWantedPlayers = notWantedEncounters[selectedEncounter.name] || [];\r\n      if (notWantedPlayers.length > 0) {\r\n        notWantedPlayers.forEach(player => {\r\n          this.updateAttention(player, 1);\r\n        console.log(`Applied -1 engagement to ${notWantedPlayers.length} players who not-wanted \"${selectedEncounter.name}\"`);\r\n      });\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Apply penalties for incomplete exploration when advancing encounters early\r\n   */\r\n  applyIncompleteExplorationPenalties(tagManager: any): void {\r\n    const penalties = this.playerManager?.calculateIncompleteExplorationPenalties(tagManager);\r\n    if (!penalties) return;\r\n    \r\n    if (penalties.totalStressPenalty > 0) {\r\n      this.updateAllStress(penalties.totalStressPenalty);\r\n    }\r\n    \r\n    if (penalties.totalAttentionPenalty > 0) {\r\n      this.updateAllAttention(-penalties.totalAttentionPenalty);\r\n    }\r\n    \r\n    if (penalties.totalStressPenalty > 0 || penalties.totalAttentionPenalty > 0) {\r\n      console.log(`Applied incomplete exploration penalties:`, {\r\n        stressPenalty: penalties.totalStressPenalty,\r\n        attentionPenalty: penalties.totalAttentionPenalty,\r\n        outstandingLocationTags: penalties.locationTagPenalty,\r\n        outstandingEncounterTags: penalties.encounterTagPenalty\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle encounter selection - apply all effects and advance the encounter\r\n   */\r\n  handleNextEncounterSelection(selectedBranch: any, allBranches: any[], tagManager: any): void {\r\n    // Apply incomplete exploration penalties first\r\n    this.applyIncompleteExplorationPenalties(tagManager);\r\n    \r\n    // Apply player preference effects\r\n    this.applyEncounterSelectionEffects(selectedBranch, allBranches);\r\n    \r\n    // Advance the encounter through the campaign manager\r\n    this.campaignManager?.advanceEncounter(selectedBranch);\r\n  }}\r\n\r\nexport default PartyManager;","import { Character, Encounter, NOTEBOOK_CATEGORY, NotebookState, Player, Location, TutorialStep, ChatSpeaker, CHAT_TYPE, EncounterState, ATTITUDE, Tag, ModalConfig, ResultConfig, EncounterFlavorTag, EffectData, FlavorTagSource, FlavorTagTheme } from \"../models\";\r\nimport { EventEmitter } from 'events';\r\nimport AppManager from \"./appManager\";\r\nimport PlayerManager from \"./playerManager\";\r\nimport CharacterManager from \"./characterManager\";\r\nimport QuestManager from \"./questManager\";\r\n\r\nclass UiManager extends EventEmitter {\r\n  private appManager: AppManager;\r\n  private playerManager: PlayerManager;\r\n  private characterManager: CharacterManager;\r\n  public renderImageForEvent: boolean = true;\r\n  public eventImageOpacity: number = 0;\r\n  private activeModal: ModalConfig | null = null;\r\n\r\n  constructor(appManager: AppManager) {\r\n    super();\r\n    this.init();\r\n    this.appManager = appManager;\r\n    this.playerManager = this.appManager.getPlayerManager();\r\n    this.characterManager = this.appManager.getCharacterManager();\r\n  }\r\n\r\n  showModal(config: ModalConfig) {\r\n    this.activeModal = config;\r\n    this.emit('modalStateChanged', this.activeModal);\r\n  }\r\n\r\n  closeModal() {\r\n    if (this.activeModal?.onClose) {\r\n      this.activeModal.onClose();\r\n    }\r\n    this.activeModal = null;\r\n    this.emit('modalStateChanged', null);\r\n  }\r\n\r\n  showWelcomeModal() {\r\n    this.showModal({\r\n      title: 'Welcome to Dungeon Planner',\r\n      type: 'welcome',\r\n      options: [{\r\n        id: 'continue',\r\n        title: 'Begin Adventure',\r\n        description: 'Start your campaign experience',\r\n        callback: () => {\r\n          // Close the modal\r\n        }\r\n      }]\r\n    });\r\n  \r\n  }\r\n\r\n  \r\n  handleModalOptionSelected(optionId: string) {\r\n    const option = this.activeModal?.options.find((opt: { id: string; }) => opt.id === optionId);\r\n    if (option) {\r\n      option.callback();\r\n      this.closeModal();\r\n    }\r\n  }\r\n\r\n\r\n  // TODO: Put all this in some kinda message thinger\r\n  closeNotebook() {\r\n    this.emit('setNotebookState', undefined);\r\n  }\r\n  closeTutorial() {\r\n    this.closeNotebook();\r\n  }\r\n\r\n  updateEncounterState(encounterState: EncounterState) {\r\n    this.emit('updateEncounterState', encounterState);\r\n  }\r\n\r\n  showNotebook(newNotebookStateArray: NotebookState[]) {\r\n    this.emit('setNotebookState', newNotebookStateArray)\r\n  }\r\n\r\n  removePlayer(player: Player) {\r\n    this.emit('removePlayer', player);\r\n  }\r\n\r\n  getEventIcon(eventType: string) {\r\n    return `event_${eventType}`;\r\n}   \r\n\r\n  showTutorialPage(page: number) {\r\n    this.emit('setTutorialPage', page);\r\n  }\r\n\r\n  changeEventTimer(time: number) {\r\n\r\n    this.emit('setupTimeChange', time);\r\n  }\r\n\r\n\r\n  showRewardModal(rewards: number, advanceEvent: boolean) {\r\n    this.emit('showRewardModal', rewards, advanceEvent);\r\n  }\r\n\r\n  // Quest Modal Management\r\n  showSelectQuestModal() {\r\n    this.emit('showSelectQuestModal', true);\r\n  }\r\n\r\n  hideSelectQuestModal() {\r\n    this.emit('showSelectQuestModal', false);\r\n  }\r\n\r\n  showQuestTerminalModal(quest: any, node: any) {\r\n    this.emit('showQuestTerminalModal', { quest, node });\r\n  }\r\n\r\n  hideQuestTerminalModal() {\r\n    this.emit('showQuestTerminalModal', null);\r\n  }\r\n\r\n  showQuestProgressModal(questId: string) {\r\n    this.emit('showQuestProgressModal', questId);\r\n  }\r\n\r\n  hideQuestProgressModal() {\r\n    this.emit('showQuestProgressModal', null);\r\n  }\r\n\r\n  // Active Quests Modal Management\r\n  showActiveQuestsModal() {\r\n    this.emit('showActiveQuestsModal', true);\r\n  }\r\n\r\n  hideActiveQuestsModal() {\r\n    this.emit('showActiveQuestsModal', false);\r\n  }\r\n\r\n  showResultModal(resultConfig: ResultConfig) {\r\n    this.emit('showResultModal', resultConfig);\r\n  }\r\n\r\n  hideResultModal() {\r\n    this.emit('showResultModal', undefined);\r\n  }\r\n\r\n  toggleImageForEvent() {\r\n    this.eventImageOpacity = 1;;\r\n    this.renderImageForEvent = !this.renderImageForEvent;\r\n    this.emit('eventUpdated');\r\n  }\r\n\r\n  questSelected(questId: string) {\r\n    const questExhaustion = this.appManager.getQuestManager().getExhaustionForQuest(questId);\r\n    const partyManager = this.appManager.getPartyManager();\r\n    if(questExhaustion > 0) {\r\n      partyManager.exhaustParty(questExhaustion); \r\n    }\r\n\r\n    this.hideSelectQuestModal();\r\n    this.showQuestProgressModal(questId);\r\n  }\r\n\r\n\r\n  getMessageIconId(speaker: ChatSpeaker) {\r\n    let iconId;\r\n    switch(speaker.type) {\r\n      case CHAT_TYPE.PLAYER:\r\n        const player = this.playerManager.getRecruitablePlayers()[speaker.id]; \r\n        iconId = player.icon;\r\n        break;\r\n      case CHAT_TYPE.CHARACTER:\r\n        const character = this.characterManager.getCharacterById(speaker.id);\r\n        iconId = character.icon;\r\n        break;\r\n      case CHAT_TYPE.DM:\r\n        iconId = 'chat_dm';\r\n        break;\r\n      case CHAT_TYPE.HELPER:\r\n      default:\r\n        iconId = 'chat_imp';\r\n        break;\r\n    }\r\n    return iconId;\r\n  }\r\n\r\n  getMessageSpeakerName(speaker: ChatSpeaker) {\r\n    let name;\r\n    switch(speaker.type) {\r\n      case CHAT_TYPE.PLAYER:\r\n        const player = this.playerManager.getRecruitablePlayers()[speaker.id]; \r\n        name = player.name;\r\n        break;\r\n      case CHAT_TYPE.CHARACTER:\r\n        const character = this.characterManager.getCharacterById(speaker.id);\r\n        name = character.name;\r\n        break;\r\n      case CHAT_TYPE.DM:\r\n        name = 'You';\r\n        break;\r\n      case CHAT_TYPE.HELPER:\r\n      default:\r\n        name = 'Impy';\r\n        break;\r\n    }\r\n    return name;\r\n  }\r\n\r\n  getShortenedName(name: string) {\r\n    return name.split(' ').map((n) => n[0]).join('');\r\n  }\r\n\r\n  showImageForEvent() {\r\n    return this.renderImageForEvent;\r\n  }\r\n\r\n  setEventImageOpacity(opacity: number) {\r\n    this.eventImageOpacity = opacity;\r\n    this.emit('eventUpdated'); \r\n    }\r\n\r\n  getEventImageOpacity() {\r\n    return this.eventImageOpacity;\r\n  }\r\n\r\n  getHeroFirstName(charName: string) {\r\n    return charName.split(' ')[0];\r\n  }\r\n  \r\n\r\n\r\n  showBasicNotebook(category: string, item: Character | Encounter | Location | Player, startPage: number = 0) {\r\n    let content;\r\n    let notebookTitle ='';\r\n    \r\n    let secondaryEntries = []\r\n    \r\n    // We might need to add more to this payload...? This might be unneccesary I dont know. I also dont\r\n    // know how to spell unessecary. \r\n    switch(category){\r\n      case NOTEBOOK_CATEGORY.CHARACTER:\r\n        content = {character: item as Character};\r\n        notebookTitle = content.character.name;\r\n        let playerInfo = this.playerManager.getPlayerAssignedCharacter(content.character)\r\n        if(playerInfo) {\r\n          secondaryEntries.push({\r\n            category: NOTEBOOK_CATEGORY.PLAYER,\r\n            content: {\r\n              player: playerInfo,\r\n              message: ''\r\n            },\r\n            title: playerInfo.name\r\n          })\r\n        }\r\n      break;\r\n      case NOTEBOOK_CATEGORY.LOCATION:\r\n        content = {location: item as Location};\r\n        notebookTitle = content.location.name\r\n      break;\r\n      case NOTEBOOK_CATEGORY.ENCOUNTER:\r\n        content = {encounter: item as Encounter};\r\n        notebookTitle = content.encounter.name;\r\n        secondaryEntries.push({\r\n          category: NOTEBOOK_CATEGORY.LOCATION,\r\n          content: {location: content.encounter.location},\r\n          title: content.encounter.location.name\r\n        })\r\n      break;\r\n      case NOTEBOOK_CATEGORY.PLAYER:\r\n        content = {player: item as Player};\r\n        notebookTitle = content.player.name;\r\n        //const characterManager = this.appManager.getCharacterManager();\r\n\r\n        content.player.characters.forEach((character) => {\r\n       \r\n        secondaryEntries.push({\r\n          category: NOTEBOOK_CATEGORY.CHARACTER,\r\n          content: {\r\n            character: character,\r\n            message: ''\r\n          },\r\n          title: character.name\r\n        })\r\n      });\r\n\r\n      break;\r\n      default:\r\n        console.error(\"BAD SHOW BASIC NOTEBOOK CALLED\")\r\n        return;\r\n    }\r\n    const notebookState: NotebookState = {\r\n      category,\r\n      content: content,\r\n      title: notebookTitle,\r\n    } \r\n\r\n    if(secondaryEntries.length > 0) {\r\n      this.showNotebook([notebookState, ...secondaryEntries])\r\n    } else {\r\n      this.showNotebook([notebookState])\r\n    }\r\n\r\n  }\r\n\r\n\r\n  showTutorialMessage(tutorialStep: TutorialStep) {\r\n    const notebookState: NotebookState = {\r\n      category: NOTEBOOK_CATEGORY.TUTORIAL,\r\n      content: {\r\n        message: tutorialStep.content[0],\r\n        showNext:  tutorialStep.content.length > 1 ? 1 : undefined,\r\n        icon: tutorialStep.icons ? tutorialStep.icons[0] : undefined,\r\n        title: tutorialStep.title\r\n      },\r\n      title: tutorialStep.title,\r\n    }\r\n    const secondaryEntries = tutorialStep.content.slice(1).map((content, index) => {\r\n      return {\r\n        category: NOTEBOOK_CATEGORY.TUTORIAL,\r\n        content: {\r\n          message: content,\r\n          showNext: index < tutorialStep.content.length - 2 ? index + 2 : undefined,\r\n          showPrev:  index,\r\n          icon: tutorialStep.icons ? tutorialStep.icons[index + 1] : undefined,\r\n          title: tutorialStep.title\r\n        },\r\n        title: tutorialStep.title,\r\n      }\r\n    })\r\n  \r\n    if(secondaryEntries.length > 0) {\r\n      this.showNotebook([notebookState, ...secondaryEntries])\r\n    } else {\r\n      this.showNotebook([notebookState])\r\n    }\r\n\r\n  }\r\n\r\n  getPlayerAttitudesStyle(tag: Tag) {\r\n    const playerAttitudes = this.playerManager.getGroupAttitudeForTag(this.playerManager.getPlayers(), tag);\r\n    switch(playerAttitudes) {\r\n      case ATTITUDE.LIKE:\r\n        return 'player-like';\r\n      case ATTITUDE.CONFLICTED:\r\n        return 'player-conflicted';\r\n      case ATTITUDE.HATE:\r\n        return 'player-hate';\r\n      default:\r\n        return '';\r\n    }\r\n  }\r\n\r\n  updateParty() {\r\n    \r\n    this.emit('playerUpdate');\r\n  }\r\n\r\n\r\n  showAcceptCampaignModal(campaignID: number) {\r\n    console.log('showing accept campaign modal...');\r\n  }\r\n\r\n  init() {\r\n    console.log('init uiManager...');\r\n    // Logic to guide players through the graph\r\n  }\r\n\r\n  update(timeDt: number) {\r\n   // this.updateColorLerps(timeDt);\r\n  }\r\n\r\n  showTagModal(config: {\r\n    title: string;\r\n    description?: string;\r\n    tags: EncounterFlavorTag[];\r\n    effects?: EffectData[];\r\n    selectedTags: Tag[];\r\n    remainingClicks: number;\r\n    tagInstructions?: string;\r\n    onTagClick: (tag: EncounterFlavorTag) => void;\r\n    onClose: () => void;\r\n  }) {\r\n    this.showModal({\r\n      title: config.title,\r\n      type: 'tagmodal',\r\n      options: [], // No options needed as the modal handles its own interactions\r\n      tagModalConfig: {\r\n        title: config.title,\r\n        description: config.description,\r\n        tags: config.tags,\r\n        effects: config.effects,\r\n        selectedTags: config.selectedTags,\r\n        remainingClicks: config.remainingClicks,\r\n        tagInstructions: config.tagInstructions,\r\n        onTagClick: config.onTagClick,\r\n        onClose: config.onClose\r\n      }\r\n    });\r\n  }\r\n\r\n  static getPlayerEmail(playerName: string) {\r\n    const seed = this.hashString(playerName);\r\n    const random = this.seededRandom(seed);\r\n    const email = `${playerName.replace(' ', '.').toLowerCase()}${this.randomDigit(random)}${this.randomDigit(random)}${this.randomDigit(random)}@gmail.com`;\r\n    return email;\r\n  }\r\n\r\n    static getPlayerPhone(playerName: string) {\r\n      const seed = this.hashString(playerName);\r\n      const random = this.seededRandom(seed);\r\n      const phoneNumber = `(${this.randomDigit(random)}${this.randomDigit(random)}${this.randomDigit(random)}) ${this.randomDigit(random)}${this.randomDigit(random)}${this.randomDigit(random)}-${this.randomDigit(random)}${this.randomDigit(random)}${this.randomDigit(random)}${this.randomDigit(random)}`;\r\n      return phoneNumber;\r\n    }\r\n\r\n   private static hashString(str: string): number {\r\n      let hash = 0;\r\n      for (let i = 0; i < str.length; i++) {\r\n        const char = str.charCodeAt(i);\r\n        hash = (hash << 5) - hash + char;\r\n        hash |= 0; // Convert to 32bit integer\r\n      }\r\n      return hash;\r\n    }\r\n\r\n    private static seededRandom(seed: number): () => number {\r\n      return function() {\r\n        const x = Math.sin(seed++) * 10000;\r\n        return x - Math.floor(x);\r\n      };\r\n    }\r\n\r\n    private static randomDigit(random: () => number): number {\r\n      return Math.floor(random() * 10);\r\n    }\r\n\r\n  /**\r\n   * Returns configuration for displaying quest rewards\r\n   */\r\n  getRewardDisplayConfig(reward: {\r\n    type: string;\r\n    amount: number;\r\n    description?: string;\r\n  }): \r\n    | { type: 'dice'; score: number }\r\n    | { type: 'treasurePills'; amount: number; tagConfig: { tag: { name: string }; source: FlavorTagSource; theme: FlavorTagTheme } }\r\n    | { type: 'text'; text: string }\r\n  {\r\n    switch (reward.type) {\r\n      case \"score\":\r\n        return {\r\n          type: 'dice',\r\n          score: reward.amount\r\n        };\r\n      case \"treasure\":\r\n        return {\r\n          type: 'treasurePills',\r\n          amount: reward.amount,\r\n          tagConfig: {\r\n            tag: { name: \"Treasure\" },\r\n            source: FlavorTagSource.TREASURE,\r\n            theme: FlavorTagTheme.NONE,\r\n          }\r\n        };\r\n     \r\n      default:\r\n        return {\r\n          type: 'text',\r\n          text: `${reward.description || \"Reward\"}: ${reward.amount}`\r\n        };\r\n    }\r\n  }\r\n  }\r\n\r\n\r\n  // Other methods to manage sessions\r\n\r\n\r\nexport default UiManager;","import { APP_STATE, DEFAULT_STATE_CONFIG, STATE_CONFIG } from \"../consts/states\";\nimport { StateConfig, Graph } from \"../models\";\nimport AppManager from \"./appManager\";\n\nclass DataManager {\n\n  // Should this LIVE here? :thinking: \n  campaignGraph: Graph | undefined;\n  stateConfigs: Map<APP_STATE, StateConfig> = new Map();\n  appManager: AppManager;\n\n  getGraph() : Graph | undefined {  \n    return this.campaignGraph;\n  }\n\n  constructor(appManager: AppManager) {\n    this.appManager = appManager;\n    this.init();\n  }\n\n  init() {\n    this.campaignGraph = new Graph();\n   \n\n    this.initStates();\n    console.log('init dataManager...');\n  }\n\n  getStateProps(state?: APP_STATE) : StateConfig {\n    return this.stateConfigs.get(state || this.appManager.state) ?? DEFAULT_STATE_CONFIG;\n  }\n\n  initStates() {\n    this.stateConfigs.set(APP_STATE.MAIN_MENU, {...DEFAULT_STATE_CONFIG, ...STATE_CONFIG[APP_STATE.MAIN_MENU]});\n    this.stateConfigs.set(APP_STATE.CAMPAIGN_SETUP, {...DEFAULT_STATE_CONFIG, ...STATE_CONFIG[APP_STATE.CAMPAIGN_SETUP]});\n    this.stateConfigs.set(APP_STATE.PLAYER_RECRUITMENT, {...DEFAULT_STATE_CONFIG, ...STATE_CONFIG[APP_STATE.PLAYER_RECRUITMENT]});\n    this.stateConfigs.set(APP_STATE.CHARACTER_CREATION, {...DEFAULT_STATE_CONFIG, ...STATE_CONFIG[APP_STATE.CHARACTER_CREATION]});\n    this.stateConfigs.set(APP_STATE.SESSION_OVERVIEW, {...DEFAULT_STATE_CONFIG, ...STATE_CONFIG[APP_STATE.SESSION_OVERVIEW]});\n    this.stateConfigs.set(APP_STATE.SESSION, {...DEFAULT_STATE_CONFIG, ...STATE_CONFIG[APP_STATE.SESSION]});\n    this.stateConfigs.set(APP_STATE.SCORE, {...DEFAULT_STATE_CONFIG, ...STATE_CONFIG[APP_STATE.SCORE]});\n  // Other methods to manage sessions\n  }\n}\n\nexport default DataManager;","import { GEAR, getCombinedAttributes } from '../consts/characterConsts';\r\nimport { ENEMIES } from '../consts/enemies';\r\nimport { CHARACTER_CLASS, RACE } from '../consts/general';\r\nimport { QUICKSTART_CHARACTERS } from '../consts/quickStart';\r\nimport { SCORE } from '../consts/score';\r\nimport { ATTRIBUTE_TYPE, Character, Tag } from '../models';\r\nimport { generateName } from '../utils/utils';\r\nimport AppManager from './appManager';\r\n\r\nclass CharacterManager {\r\n  private characters: Character[];\r\n  private uniqueID: number = 0;\r\n  private selectedCharacters: number[];\r\n  private appManager: AppManager;\r\n\r\n  constructor(appManager: AppManager) {\r\n    this.characters = [];\r\n    this.selectedCharacters = [];\r\n    this.appManager = appManager;\r\n  }\r\n\r\n  init() {\r\n    this.generateRandomCharacters(12);\r\n  }\r\n\r\n  getCharacters() {\r\n    return this.characters;\r\n  }\r\n\r\n  getPlayerCharacters() {\r\n    const players = this.appManager.getPlayerManager().getPlayers();\r\n    return players.flatMap((player) => player.characters);\r\n  }\r\n   \r\n  getUFClass= (classId: CHARACTER_CLASS)  =>{\r\n    switch(classId) {\r\n      case CHARACTER_CLASS.CLERIC: return 'Cleric';\r\n      case CHARACTER_CLASS.DRUID: return 'Druid';\r\n      case CHARACTER_CLASS.FIGHTER: return 'Fighter';\r\n      case CHARACTER_CLASS.PALADIN: return 'Paladin';\r\n      case CHARACTER_CLASS.ROGUE: return 'Rogue';\r\n      case CHARACTER_CLASS.WIZARD: return 'Wizard';\r\n      default: return 'Unknown';\r\n    }  \r\n  }\r\n\r\n   getUFRace= (raceId: RACE) => {\r\n    switch(raceId) {\r\n      case RACE.HUMAN: return 'Human';\r\n      case RACE.ELF: return 'Elven';\r\n      case RACE.DWARF: return 'Dwarven';\r\n      case RACE.HALFLING: return 'Halfling';\r\n      case RACE.HALF_ELF: return 'Half-Elf';\r\n      case RACE.HALF_ORC: return 'Half-Orc';\r\n      default: return 'Unknown';\r\n    }\r\n  }\r\n\r\n  getUFAttributeName= (attributeId: ATTRIBUTE_TYPE) => {\r\n    switch(attributeId) {\r\n      case ATTRIBUTE_TYPE.COMBAT: return 'Combat';\r\n      case ATTRIBUTE_TYPE.MAGIC: return 'Magic';\r\n      case ATTRIBUTE_TYPE.TOOLS: return 'Tools';\r\n      default: return 'Unknown';\r\n    }\r\n  }\r\n\r\n  getUFAttributeSymbol= (attributeId: ATTRIBUTE_TYPE) => {\r\n    switch(attributeId) {\r\n      case ATTRIBUTE_TYPE.COMBAT: return '⚔️';\r\n      case ATTRIBUTE_TYPE.MAGIC: return '✨';\r\n      case ATTRIBUTE_TYPE.TOOLS: return '🔧';\r\n      default: return '❓';\r\n    }\r\n  }\r\n\r\n  getUFInitials= (character: Character) => {\r\n    return character.name.split(' ').map((n) => n[0]).join('');\r\n  }\r\n\r\n  setSelectedCharacters(selectedCharacters:number[]) {\r\n    this.selectedCharacters = this.characters\r\n      .filter((_, index) => selectedCharacters.includes(index))\r\n      .map(character => character.id);\r\n  }\r\n\r\n  getCharacterByIndex(index: number) {\r\n    return this.characters[index];\r\n  }\r\n\r\n  getCharacterById(id: number) {\r\n    return this.characters.find(character => character.id === id) || this.characters[0];\r\n  }\r\n\r\n\r\n  getCharacterReferences() {\r\n    return this.characters;\r\n  }\r\n\r\n  setAttributeUsed(character: Character, attributeType: ATTRIBUTE_TYPE, amount: number) {\r\n    if(!character.attributeLoss) {\r\n      character.attributeLoss = {};\r\n    }\r\n    character.attributeLoss[attributeType] = (character.attributeLoss[attributeType] || 0) + amount;\r\n  }\r\n\r\n  addUsedAttribute(character: Character, attributeType: ATTRIBUTE_TYPE, amount: number = 1) {\r\n    // Add one or more points of attribute usage (default 1)\r\n    this.setAttributeUsed(character, attributeType, amount);\r\n  }\r\n\r\n  useHalfRemainingAttributes(character: Character, attributeType: ATTRIBUTE_TYPE) {\r\n    const remainingAttributes = getCombinedAttributes(character)[attributeType] - (character.attributeLoss?.[attributeType] || 0);\r\n    const halfRemaining = Math.floor(remainingAttributes / 2);\r\n    const reductionAmount = remainingAttributes - halfRemaining;\r\n    this.setAttributeUsed(character, attributeType, reductionAmount);\r\n    return reductionAmount;\r\n  } \r\n  \r\n  getRemainingAttributes(character: Character, attributeType: ATTRIBUTE_TYPE) {\r\n    const totalAttributes = getCombinedAttributes(character)[attributeType] || 0;\r\n    // need to add in the race attributes:\r\n    const usedAttributes = character.attributeLoss?.[attributeType] || 0;\r\n    return totalAttributes - usedAttributes;\r\n  }\r\n\r\n  getSelectedCharacters() {\r\n    return this.selectedCharacters;\r\n  }\r\n\r\n  getRandomRace() {\r\n    const races = Object.values(RACE);\r\n    const randomIndex = Math.floor(Math.random() * races.length);\r\n    return races[randomIndex];\r\n  }\r\n\r\n  getRandomClass() {\r\n    const classes = Object.values(CHARACTER_CLASS);\r\n    const randomIndex = Math.floor(Math.random() * classes.length);\r\n    return classes[randomIndex];\r\n  }\r\n\r\n  getRandomIconNumber() {\r\n    return Math.floor(Math.random() * 2) + 1;\r\n  }\r\n\r\n  getRandomIcon(characterRace: RACE) {\r\n    // currently each race has exactly two icons, named race_1.png and race_2.png. \r\n    // This function should return one of those two names\r\n    switch(characterRace) {\r\n      case RACE.DWARF:\r\n        return 'dwarf_' + this.getRandomIconNumber();\r\n      case RACE.ELF:\r\n        return 'elf_' + this.getRandomIconNumber();\r\n      case RACE.HUMAN:\r\n        return 'human_' + this.getRandomIconNumber();\r\n      case RACE.HALF_ORC:\r\n        return 'halfOrc_' + this.getRandomIconNumber();\r\n      case RACE.HALF_ELF:\r\n        return 'halfElf_' + this.getRandomIconNumber();\r\n      case RACE.HALFLING: \r\n        return 'halfling_' + this.getRandomIconNumber();\r\n      default:\r\n        return 'human_' + this.getRandomIconNumber();\r\n    }\r\n  }\r\n\r\n  generateStartingGear() {\r\n    switch(Math.floor(Math.random() * 6)) {\r\n      case 0: return [GEAR.SWORD_1];\r\n      case 1: return [GEAR.WAND_5];\r\n      case 2: return [GEAR.HELPFUL_IMP];\r\n     default: return [];\r\n    }\r\n  }\r\n\r\n\r\n  getRandomGear() {\r\n    const gearNames = Object.keys(GEAR);\r\n    const randomIndex = Math.floor(Math.random() * gearNames.length);\r\n    return GEAR[gearNames[randomIndex]];\r\n  }\r\n\r\n\r\n  assignGear(character: Character, gearName: string) {\r\n  \r\n    if(GEAR[gearName] === undefined) {\r\n      console.error('Gear not found: ' + gearName);\r\n      // Check if the gearName is the value of the gear instead of the key\r\n      gearName = Object.keys(GEAR).find(key => GEAR[key].name === gearName) || '';\r\n    }\r\n    \r\n    const gear = GEAR[gearName];\r\n\r\n    if(!gear) {\r\n      console.error('Gear not found: ' + gearName);\r\n      return;\r\n    }\r\n\r\n    character.gear.push(gear);\r\n  }\r\n\r\n\r\n  getAllExpectedBackstoryTags(): Tag[] {\r\n    const backstoryTags = this.characters.flatMap((character) => {\r\n      return character.backstory.filter((bs) => !bs.completed).map((backstory) => backstory.tag);\r\n    })\r\n\r\n    return [...new Set(backstoryTags)];\r\n  }\r\n\r\n  getCharactersWithBackstoryTag(tag: Tag): Character[] {\r\n    return this.characters.filter((character) => character.backstory.some((bs) => bs.tag === tag));\r\n  }\r\n\r\n  assignBackstory(character: Character, tag: Tag) {\r\n    const existingBackstory = character.backstory.find((backstory) => backstory.tag === tag);\r\n    if(existingBackstory) {\r\n      existingBackstory.completed = true;\r\n      //this.appManager.getPartyManager().addPartyScore(SCORE.COMPLETE_BACKSTORY);\r\n    } else {\r\n      const newBackstory = {\r\n        tag: tag,\r\n        completed: false,\r\n        description: undefined\r\n      }\r\n      character.backstory.push(newBackstory);\r\n    }\r\n    const player = this.appManager.getPlayerManager().getPlayerAssignedCharacter(character);\r\n    if(player){\r\n      this.appManager.getPlayerManager().addPlayerExp(player, 1);\r\n    }\r\n  }\r\n\r\n  generateRandomCharacter(level?: number): Character {\r\n    const newChar = this.generateSingleCharacter(level || 1);\r\n    return newChar;\r\n  }\r\n\r\n  generateSingleCharacter(level: number): Character {\r\n    const cclass = this.getRandomClass();\r\n    const crace = this.getRandomRace();\r\n    const newChar: Character = {\r\n      name: generateName(true),\r\n      race: crace,\r\n      character_class: cclass,\r\n      level: level || 1 + Math.floor(Math.random() * 4),\r\n      experience: Math.floor(Math.random() * 50) + 0, // Random experience 20-69\r\n      icon: this.getRandomIcon(crace),\r\n      abilities: [],\r\n      id: this.uniqueID++,\r\n      gear: this.generateStartingGear(),\r\n      backstory: []\r\n    }\r\n    return newChar;\r\n  }\r\n\r\n\r\n  generateRandomCharacters(nbChars: number, level?: number) {\r\n    for (let p = 0; p < nbChars; p++) {\r\n      this.characters.push(this.generateSingleCharacter(level || 1));\r\n    }\r\n   \r\n  }\r\n\r\n  generateNPC(npcTag: Tag) : Character {\r\n    \r\n    const newCharacter: Character = {\r\n      race: RACE.NPC,\r\n      character_class: CHARACTER_CLASS.NPC,\r\n      abilities: [],\r\n      level: 1,\r\n      experience: 0, // NPCs start with 0 experience\r\n      name: npcTag.name,\r\n      id: this.uniqueID++,\r\n      icon: `combat_${npcTag.name}`,\r\n      gear: [],\r\n      backstory: [],\r\n    }\r\n\r\n    return newCharacter;\r\n  }\r\n\r\n\r\n  initiateQuickStart() {\r\n    \r\n    this.characters = QUICKSTART_CHARACTERS;\r\n  }\r\n\r\n  /**\r\n   * Add experience to a character, capped at 100\r\n   * @param characterId - The ID of the character to give experience to\r\n   * @param amount - The amount of experience to add (if not provided, adds 1-5 randomly)\r\n   */\r\n  characterAction(characterId: number, amount?: number): void {\r\n    const character = this.getCharacterById(characterId);\r\n    if (!character) {\r\n      return;\r\n    }\r\n\r\n    const expToAdd = amount !== undefined ? amount : Math.floor(Math.random() * 5) + 1;\r\n    character.experience = Math.min(100, character.experience + expToAdd);\r\n  }\r\n\r\n}\r\n\r\nexport default CharacterManager;","import { TutorialStep } from \"../models\";\n\n\nconst longIntroText = {\n    withHTML: `\n        <h1>Welcome!</h1>\n        <p>Thanks for trying out my game, the latest version is version 0.0.1 from Dec 22, 2024. It is still very much in the early stages.<br><br>This is a game about running a fantasy-tabletop RPG. Instead of exploring, adventuring, and conquering, this is a game about scheduling players, designing balanced encounters, managing potential branches in storylines, and above all keeping your players happy!</p>\n        <p>At the moment the only things available are:</p>\n        <ul>\n            <li>Player Recruitment</li>\n            <li>Character Assignment</li>\n            <li>Campaign Selection</li>\n        </ul>\n        <p> Get started by going to Player Recruitment</p>\n        <br>\n        <h1>COMING SOON</h1>\n        <ul>\n            <li>Player chatter / message system</li>\n            <li>Campaign settings / launch game</li>\n        </ul>\n         <h1>COMING LATER</h1>\n          <ul>\n            <li>Rest of game</li>\n        </ul>\n    `,\n};\n\nconst secondPage = 'This is just here to test my tutorial system and I dont have enough real content yet to need more than one page. Guess I shouldn\\'t have spent all that time making it support multiple pages. Oh well!'\n\nconst playerRecruitmentHTML = `\n        <h1>PLAYERS</h1>\n        <p>Players are your clients. After a successful campaign, they will reward you with money and respect. You'll want to recruit players with similar, or complimentary preferences (LIKES/HATES), as well as making sure their schedules are compatible.<br><br>To see a player's preferences, hover over the red or green dots on their player card. When you click a player it will be added to the group, and you will see the player's preferences added to the notebook on the left. The notebook will also contain a page for each player.</p>\n        <p>I think three players is a good number to go for. I have a feeling the game will be more difficult to play with more players - as keeping them all happy and juggling other game elements with high player-counts may prove difficult. having more players would also logically lead to getting paid more at the end of the campaign so it could be a nice synergy of difficulty and reward scaling on its own.</p>\n        \n        <br>`;\nconst playerRecruitmentHTML2 = `\n        <h1>Notes</h1>\n        <ul>\n            <li>I have a new design for the player-cards in mind. I realize they are very busy now.</li>\n            <li>Im not sure how scheduling will work out in the game. Im hesitant to remove it because it provides a bit of a counter to simply matching LIKES/HATES of players. Im thinking that a better-schedule might impact some elements of the actual gameplay later on, even if it's just a points-multiplier at the end if you have a good schedule-synergy...give me ideas!</li>\n            <li>I'm thinking of adding more player-stats. Things like stamina, or focus, which would come into play during sessions. Some players may tolerate certain gameplay elements outside of simply liking/hating based on the metadata tags. \n        </ul>\n        <p>Once you have some Players, head over to Character Assignment to assign them some characters.</p>\n    `;\n\n    const CharacterCreationHTML = `\n        <h1>CHARACTERS</h1>\n        <p>Characters are what you are probably used to in a game. These are the wizards, fighters, elves, dwarves, etc.. Characters are assigned to Players. At the moment, there is a four Character limit for each player, and I feel like that's a lot. Im not sure what the tradeoff is in the Player:Character ratio though.</p>\n        <br>The Character stats are about as far into the 'game within the game' as I'd like to get. Id like for there to be some simple mechanics that can be used to make these stats important or fun though.</p>\n        <p>I'm also not sure what the limit should be for a player to have a higher level character. As a Dungeon Master, having higher level characters at your table isn't a reward in itself, but it might be a fun element of progression in the game. As you get to know your players and play with them over multiple campaigns, maybe the same would be true with the Characters.</p>\n        <p>Once you have some Characters, head over to Campaign Setup to start a campaign.</p>\n    `;\n\n    const CampaignSetupHTML = `\n    <h1>Campaigns</h1>\n    <p>Campaigns are the storyline of the game you are presenting to your players. A Campaign is composed of a series of events, called 'encounters'.\n    <br>Encounters all have different features, including a Location and some number of characteristics. For example, an encounter called 'Goblin Ambush' may feature a Location 'Forest' and have characteristics like 'goblins', 'combat', forest', 'wilderness', 'night', etc.. Any of which may be things certain players prefer (or prefer to avoid!)\n    <p>During the encounter, the players will uncover the different features and react to them based on their preferences. They will also be uncovering information about the <i>upcoming<i> encounters. This will then lead to the players choosing which branching encounter to go to next. Some encounters may be more rewarding than others, so there will be ways to try and 'steer' the player's decisions, but there will still be an element of randomness, and if you try to put too much emphasis on ONE encounter over the others there will be some penalty.</p>\n    `\n    const CampaignSetupHTML2 = `\n        <h1>Notes</h1>\n        <ul>\n            <li>I actually really like the design of this screen. I'd like to achieve this level of style in the rest of the game.</p> \n            <li>Making the encounters is pretty fun too. I like being able to tell the idea of a story - it allows for so much potential in terms of the details that could all <i>possibly</i> exist. \n            <li>I plan to make the actual CREATING of campaigns, encounters, and location possible. I find the idea of making an in-game editor a bit daunting, to be honest so I'll probably circle back to that closer to the end of the first full version of this game.</li>\n        \n        </ul>\n`;\n\n\nexport const TUTORIALS: Record<string, TutorialStep> = {\n    MAIN_MENU:\n    {\n        title: 'Welcome to Dungeon Master Simulator!',\n        content: [longIntroText.withHTML],\n        icons: ['tutorial_mascot', 'tutorial_mascot', 'tutorial_mascot']\n\n    },\n    PLAYER_RECRUITMENT:\n    {\n        title: 'Player Recruitment',\n        content: [playerRecruitmentHTML, playerRecruitmentHTML2],\n        icons: ['tutorial_mascot', 'tutorial_mascot']\n    },\n    CHARACTER_CREATION:\n    {\n        title: 'Character Creation',\n        content: [CharacterCreationHTML],\n        icons: ['tutorial_mascot']\n    },\n    CAMPAIGN_SETUP:\n    {\n        title: 'Campaign Setup',\n        content: [CampaignSetupHTML, CampaignSetupHTML2],\n        icons: ['tutorial_mascot', 'tutorial_mascot']\n    }\n}\n","import { Character, Encounter, NOTEBOOK_CATEGORY, NotebookState, Player, Location } from \"../models\";\nimport { EventEmitter } from 'events';\nimport { TUTORIALS } from '../consts/tutorials';\nimport AppManager from \"./appManager\";\nimport UiManager from \"./uiManager\";\n\nclass TutorialManager extends EventEmitter {\n  private appManager: AppManager;\n  private uiManager: UiManager;\n  private seenTutorials: Set<keyof typeof TUTORIALS> = new Set();\n  private turnOffTutorials: boolean = false;\n  \n\n  constructor(appManager: AppManager) {\n    super();\n    this.appManager = appManager;\n    this.uiManager = this.appManager.getUiManager();\n    this.seenTutorials = new Set();\n  }\n\n  startTutorial(tutorialId: keyof typeof TUTORIALS, force: boolean = false) {\n    if(this.turnOffTutorials) {\n      return;\n    }\n    if(this.seenTutorials.has(tutorialId) && !force){\n      return;\n    }\n    this.uiManager.showTutorialMessage(TUTORIALS[tutorialId]);\n  }\n\n  disableTutorial() {\n    this.turnOffTutorials = true;\n  }\n  \n}\n\n\n\nexport default TutorialManager;","import { ENCOUNTER_EVENT_TYPE } from \"../consts/general\";\r\nimport { ChatMessage, CHAT_TYPE, Tag, ATTITUDE, Player } from \"../models\";\r\nimport { ChatRuleEngine } from \"./chatRuleEngine\";\r\n\r\n\r\n\r\nconst PROMPT_CHANCE = {\r\n  MENTION_LOCATION: 20,\r\n  MENTION_PLOT: 0,\r\n  DM_CONVERSATION: 0,\r\n  PLAYER_CONVERSATION: 0,\r\n  REFERENCE_TOPIC: 15,\r\n}\r\nexport interface LLMResponse {\r\n  message: string;\r\n  speaker: 'dm' | 'player' | 'character';\r\n  speakerId?: number;\r\n  confidence: number; // 0-1, how confident the LLM is in the response\r\n  appliedRules?: string[]; // Debug: which rules were applied\r\n  debugInfo?: string; // Debug: formatted debug string\r\n}\r\n\r\nexport interface LLMRequest {\r\n  tag: Tag;\r\n  gameContext: Record<string, any>;\r\n  theme?: string;\r\n  participants?: number[];\r\n  speakerType?: 'dm' | 'player' | 'character';\r\n  partyTension: number;\r\n  recentTopics?: string[];\r\n}\r\n\r\nclass LLMService {\r\n  private apiKey: string | null = null;\r\n  private baseUrl: string = 'https://api.openai.com/v1';\r\n  private model: string = 'gpt-3.5-turbo';\r\n  private enabled: boolean = false;\r\n\r\n  constructor() {\r\n    // Check for API key in environment or local storage\r\n    this.loadConfiguration();\r\n  }\r\n\r\n  private loadConfiguration(): void {\r\n    // Try to load from environment variables or local storage\r\n    const apiKey = process.env.REACT_APP_OPENAI_API_KEY || localStorage.getItem('llm_api_key');\r\n    if (apiKey) {\r\n      this.apiKey = apiKey;\r\n      this.enabled = true;\r\n    }\r\n  }\r\n\r\n  public setApiKey(apiKey: string): void {\r\n    this.apiKey = apiKey;\r\n    this.enabled = true;\r\n    localStorage.setItem('llm_api_key', apiKey);\r\n  }\r\n\r\n  public setConfiguration(config: { baseUrl?: string; model?: string }): void {\r\n    if (config.baseUrl) this.baseUrl = config.baseUrl;\r\n    if (config.model) this.model = config.model;\r\n  }\r\n\r\n  public isEnabled(): boolean {\r\n    return this.enabled && this.apiKey !== null;\r\n  }\r\n\r\n  public async generateContextualResponse(request: LLMRequest): Promise<LLMResponse | null> {\r\n    if (!this.isEnabled()) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      // Get applicable rules first to capture debug info\r\n      const applicableRules: any = [];\r\n\r\n      const prompt = this.buildPrompt(request);\r\n\r\n      console.log('LLM Prompt:', prompt);\r\n\r\n      const response = await this.callLLM(prompt);\r\n      const parsedResponse = this.parseResponse(response, request);\r\n\r\n\r\n      return parsedResponse;\r\n    } catch (error) {\r\n      console.error('LLM Service Error:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  private getGameContextPrompt(tag: Tag, context: Record<string, any> = {}) {\r\n\r\n\r\n\r\n    switch (context.eventType) {\r\n      case ENCOUNTER_EVENT_TYPE.CHALLENGE:\r\n        \r\n          return `The player(s) or DM must discuss how ${tag.name} helps them overcome a challenge with the description: ${context.challengeDescription || ' something difficult'}  ${context.attribute || ' skills'}`\r\n        \r\n        break;\r\n      case ENCOUNTER_EVENT_TYPE.ROLEPLAY:\r\n      default:\r\n        return `The player(s) or DM should casually mention ${tag.name}`\r\n    }\r\n  }\r\n\r\n  private buildPrompt(request: LLMRequest): string {\r\n    const { tag, gameContext, theme, participants, speakerType, partyTension, recentTopics } = request;\r\n\r\n\r\n    let themeString = ''\r\n    if (theme && theme !== 'none') {\r\n      themeString = `The ${tag.name} should be treated with a ${theme} attitude`\r\n    }\r\n\r\n    let tensionString = ``;\r\n    if (Math.random() * 3 < 1) {\r\n      if (partyTension < 10) {\r\n        tensionString = `the party is bored and the message should reflect this`\r\n      } else if (partyTension > 80) {\r\n        tensionString = 'the party mood is very tense and the message tone should reflect this.'\r\n      }\r\n    }\r\n\r\n    let locationString = '';\r\n\r\n    if (Math.random() * 100 < PROMPT_CHANCE.MENTION_LOCATION) {\r\n      locationString = `The current location ${gameContext.location} should be mentioned.`\r\n    }\r\n\r\nlet basicInstructions = `The message should be short and nonspecific, like a casual remark.`\r\n\r\nlet recentTopic = ''\r\nif(recentTopics && Math.random() * 100 < PROMPT_CHANCE.REFERENCE_TOPIC) {\r\n  const relatedTopic = recentTopics[Math.floor((Math.random() * recentTopics.length))];\r\n  recentTopic = `the message should refer to ${relatedTopic} as potentially related`\r\n}\r\n    let prompt = `You are a helpful assistant for a tabletop RPG game. \r\n    Generate short contextual dialogue for the following situation. \r\n    \r\n    GAME CONTEXT: ${this.getGameContextPrompt(tag, gameContext)}\r\n    ${themeString}\r\n    ${tensionString}\r\n    ${locationString}\r\n    ${recentTopic}\r\n    ${basicInstructions}\r\n`;\r\n\r\nlet conversationChance = Math.random() * 100; \r\nif(conversationChance <= PROMPT_CHANCE.DM_CONVERSATION){\r\n  prompt +=\r\n`return a JSON object representing the conversation as an array with the structure such that each message in the converstation is an object with this structure :\r\n\r\n{\r\n  \"message\": \"The actual dialogue text\",\r\n  \"speaker\": \"dm\" | \"player\" | \"character\",\r\n  \"speakerId\": ${participants?.[0] || 0},\r\n  }`  \r\n\r\n} else {\r\n  // conversationChance -= PROMPT_CHANCE.DM_CONVERSATION;\r\n  // if(conversationChance <= PROMPT_CHANCE.PLAYER_CONVERSATION) {\r\n\r\n  // }else {\r\n    prompt += \r\n\r\n`Return a JSON object with this structure:\r\n{\r\n  \"message\": \"The actual dialogue text\",\r\n  \"speaker\": ${speakerType},\r\n  \"speakerId\": ${participants?.[0]},\r\n}`\r\n  }\r\n\r\n\r\n\r\n    return prompt;\r\n  }\r\n\r\n  private async callLLM(prompt: string): Promise<any> {\r\n    if (!this.apiKey) {\r\n      throw new Error('No API key configured');\r\n    }\r\n\r\n    const response = await fetch(`${this.baseUrl}/chat/completions`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'Authorization': `Bearer ${this.apiKey}`\r\n      },\r\n      body: JSON.stringify({\r\n        model: this.model,\r\n        messages: [\r\n          {\r\n            role: 'user',\r\n            content: prompt\r\n          }\r\n        ],\r\n        temperature: 0.8,\r\n        max_tokens: 150\r\n      })\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`LLM API Error: ${response.status} ${response.statusText}`);\r\n    }\r\n\r\n    const data = await response.json();\r\n    return data.choices[0].message.content;\r\n  }\r\n\r\n  private parseResponse(responseText: string, request: LLMRequest): LLMResponse {\r\n    try {\r\n      // Try to parse as JSON first\r\n      const parsed = JSON.parse(responseText);\r\n      // If response is an array, then it is a conversation \r\n      if (Array.isArray(parsed)) {\r\n        \r\n      }\r\n      // Otherwise, treat as single message object\r\n\r\n\r\n      return {\r\n        message: parsed.message || responseText,\r\n        speaker: parsed.speaker || 'dm',\r\n        speakerId: parsed.speakerId,\r\n        confidence: parsed.confidence || 0.7\r\n      };\r\n    } catch (error) {\r\n      // Fallback to treating the whole response as a message\r\n      return {\r\n        message: responseText.trim(),\r\n        speaker: 'dm',\r\n        confidence: 0.5\r\n      };\r\n    }\r\n  }\r\n\r\n  // Generate fallback responses that are more contextual than the current generic ones\r\n  public generateFallbackResponse(topic: Tag, gameContext: string): ChatMessage {\r\n    const contextualResponses = [\r\n      `Oh! That ${topic.name} is interesting given our current situation...`,\r\n      `${topic.name}... that reminds me of something important.`,\r\n      `Hmm, ${topic.name} could be significant here.`,\r\n      `I wonder if that ${topic.name} is connected to what we're doing...`,\r\n      `${topic.name}? That's unexpected in this context.`\r\n    ];\r\n\r\n    const message = contextualResponses[Math.floor(Math.random() * contextualResponses.length)];\r\n\r\n    return {\r\n      message,\r\n      speaker: {\r\n        type: CHAT_TYPE.DM,\r\n        id: 0\r\n      }\r\n    };\r\n  }\r\n\r\n  // Convert LLMResponse to ChatMessage format\r\n  public toLLMResponseToChatMessage(response: LLMResponse): ChatMessage {\r\n    let chatType: CHAT_TYPE;\r\n    switch (response.speaker) {\r\n      case 'player':\r\n        chatType = CHAT_TYPE.PLAYER;\r\n        break;\r\n      case 'character':\r\n        chatType = CHAT_TYPE.CHARACTER;\r\n        break;\r\n      default:\r\n        chatType = CHAT_TYPE.DM;\r\n    }\r\n\r\n    // Add debug information to the message if available\r\n    const debugSuffix = response.debugInfo || '';\r\n    const finalMessage = response.message + debugSuffix;\r\n\r\n    return {\r\n      message: finalMessage,\r\n      speaker: {\r\n        type: chatType,\r\n        id: response.speakerId || 0\r\n      }\r\n    };\r\n  }\r\n\r\n}\r\n\r\nexport default LLMService;\r\n","import EventEmitter from \"events\";\r\nimport { Character, Encounter, Tag, Location } from \"../models\";\r\nimport AppManager from \"./appManager\";\r\n\r\nexport interface GameEvent {\r\n  id: string;\r\n  timestamp: number;\r\n  type: 'encounter_start' | 'encounter_end' | 'tag_discovered' | 'combat_start' | 'combat_end' | 'challenge_attempt' | 'location_change' | 'conversation' | 'quest_progress' | 'character_action';\r\n  description: string;\r\n  details: {\r\n    encounter?: Encounter;\r\n    tag?: Tag;\r\n    character?: Character;\r\n    location?: Location;\r\n    outcome?: 'success' | 'failure' | 'partial';\r\n    participants?: string[];\r\n    [key: string]: any;\r\n  };\r\n}\r\n\r\nexport interface GameContext {\r\n  currentLocation: Location | null;\r\n  currentEncounter: Encounter | null;\r\n  recentEvents: GameEvent[];\r\n  discoveredTags: Tag[];\r\n  activeCharacters: Character[];\r\n  currentTheme: string;\r\n  sessionDuration: number;\r\n  mood: 'tense' | 'relaxed' | 'excited' | 'mysterious' | 'humorous' | 'dramatic';\r\n}\r\n\r\nclass GameContextManager extends EventEmitter {\r\n  private appManager: AppManager;\r\n  private gameEvents: GameEvent[] = [];\r\n  private maxEvents = 50; // Keep last 50 events for context\r\n\r\n  constructor(appManager: AppManager) {\r\n    super();\r\n    this.appManager = appManager;\r\n  }\r\n\r\n  // Log a new game event\r\n  logEvent(event: Omit<GameEvent, 'id' | 'timestamp'>): void {\r\n    const gameEvent: GameEvent = {\r\n      ...event,\r\n      id: this.generateEventId(),\r\n      timestamp: Date.now()\r\n    };\r\n\r\n    this.gameEvents.push(gameEvent);\r\n    \r\n    // Keep only the most recent events\r\n    if (this.gameEvents.length > this.maxEvents) {\r\n      this.gameEvents = this.gameEvents.slice(-this.maxEvents);\r\n    }\r\n\r\n    this.emit('gameEvent', gameEvent);\r\n  }\r\n\r\n  // Get current game context for LLM prompts\r\n  getGameContext(): GameContext {\r\n    const campaignManager = this.appManager.getCampaignManager();\r\n    const playerManager = this.appManager.getPlayerManager();\r\n    \r\n    return {\r\n      currentLocation: campaignManager.getCurrentEncounter()?.location || null,\r\n      currentEncounter: campaignManager.getCurrentEncounter() || null,\r\n      recentEvents: this.gameEvents.slice(-10), // Last 10 events\r\n      discoveredTags: this.appManager.getTagManager().getCollectedTags(),\r\n      activeCharacters: playerManager.getPlayers().flatMap(p => p.characters),\r\n      currentTheme: campaignManager.getCurrentEncounter()?.location?.themes?.[0] || 'fantasy',\r\n      sessionDuration: Date.now() - (this.gameEvents[0]?.timestamp || Date.now()),\r\n      mood: this.inferCurrentMood()\r\n    };\r\n  }\r\n\r\n  // Create a narrative summary for LLM context\r\n  getContextSummary(): string {\r\n    const context = this.getGameContext();\r\n    const recentEvents = context.recentEvents.slice(-5);\r\n    \r\n    let summary = \"\";\r\n    \r\n    if (context.currentLocation) {\r\n      summary += `Current Location: ${context.currentLocation.name} - ${context.currentLocation.description}\\n`;\r\n    }\r\n    \r\n    if (context.currentEncounter) {\r\n      summary += `Current Encounter: ${context.currentEncounter.name} - ${context.currentEncounter.description}\\n`;\r\n    }\r\n    \r\n    summary += `Current Theme: ${context.currentTheme}\\n`;\r\n    summary += `Current Mood: ${context.mood}\\n`;\r\n    \r\n    if (recentEvents.length > 0) {\r\n      summary += `\\nRecent Events:\\n`;\r\n      recentEvents.forEach(event => {\r\n        summary += `- ${event.description}\\n`;\r\n      });\r\n    }\r\n    \r\n    if (context.discoveredTags.length > 0) {\r\n      const recentTags = context.discoveredTags.slice(-5);\r\n      summary += `\\nRecently Discovered: ${recentTags.map(t => t.name).join(', ')}\\n`;\r\n    }\r\n    \r\n    return summary;\r\n  }\r\n\r\n  // Helper to infer current mood from recent events\r\n  private inferCurrentMood(): 'tense' | 'relaxed' | 'excited' | 'mysterious' | 'humorous' | 'dramatic' {\r\n    const recentEvents = this.gameEvents.slice(-3);\r\n    \r\n    for (const event of recentEvents.reverse()) {\r\n      if (event.type === 'combat_start') return 'tense';\r\n      if (event.type === 'combat_end' && event.details.outcome === 'success') return 'excited';\r\n      if (event.type === 'tag_discovered' && event.details.tag?.name.toLowerCase().includes('mystery')) return 'mysterious';\r\n      if (event.details.outcome === 'failure') return 'dramatic';\r\n    }\r\n    \r\n    return 'relaxed';\r\n  }\r\n\r\n  private generateEventId(): string {\r\n    return `evt_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  // Convenience methods for common events\r\n  logEncounterStart(encounter: Encounter): void {\r\n    this.logEvent({\r\n      type: 'encounter_start',\r\n      description: `Started encounter: ${encounter.name} at ${encounter.location.name}`,\r\n      details: { encounter, location: encounter.location }\r\n    });\r\n  }\r\n\r\n  logTagDiscovered(tag: Tag, context?: string): void {\r\n    this.logEvent({\r\n      type: 'tag_discovered',\r\n      description: `Discovered ${tag.name}${context ? ` ${context}` : ''}`,\r\n      details: { tag }\r\n    });\r\n  }\r\n\r\n  logCombatStart(enemies: string[]): void {\r\n    this.logEvent({\r\n      type: 'combat_start',\r\n      description: `Combat started against ${enemies.join(', ')}`,\r\n      details: { participants: enemies }\r\n    });\r\n  }\r\n\r\n  logCombatEnd(outcome: 'success' | 'failure', details?: string): void {\r\n    this.logEvent({\r\n      type: 'combat_end',\r\n      description: `Combat ended in ${outcome}${details ? `: ${details}` : ''}`,\r\n      details: { outcome }\r\n    });\r\n  }\r\n\r\n  logConversation(participants: string[], topic: string): void {\r\n    this.logEvent({\r\n      type: 'conversation',\r\n      description: `Conversation about ${topic}`,\r\n      details: { participants, topic }\r\n    });\r\n  }\r\n}\r\n\r\nexport default GameContextManager;\r\n","import EventEmitter from \"events\";\r\nimport { ATTITUDE, Building, Character, CHAT_TYPE, ChatMessage, Encounter, EncounterFlavorTag, TAGS_TYPE, Player, RPEncounterFlavorTag, Tag, FlavorTagSource } from \"../models\";\r\nimport AppManager from \"./appManager\";\r\nimport PlayerManager from \"./playerManager\";\r\nimport { PerceptionTags } from \"../models\";\r\nimport CharacterManager from \"./characterManager\";\r\nimport TagManager from \"./tagManager\";\r\nimport LLMService from \"../services/llmService\";\r\nimport GameContextManager from \"./gameContextManager\";\r\nimport { ENCOUNTER_EVENT_TYPE } from \"../consts/general\";\r\nimport { TAG_COLLECTIONS } from \"../consts/tagCollections\";\r\n\r\nclass ChatManager extends EventEmitter {\r\n  appManager: AppManager;\r\n  playerManager: PlayerManager;\r\n  characterManager: CharacterManager;\r\n  private _tagManager?: TagManager;\r\n  private llmService: LLMService;\r\n  private gameContextManager: GameContextManager;\r\n  private recentTopics: string[] = [];\r\n  private messageQueue: ChatMessage[] = [];\r\n  private isProcessingQueue = false;\r\n  private messageDelay = 3000; // Base delay between messages\r\n  private currentTimeout: NodeJS.Timeout | null = null;\r\n\r\n  private messageHistory: ChatMessage[] = [];\r\n  private recentMessages: ChatMessage[] = [];\r\n  private conversationMessageIds: string[] = []; // Track messages in current conversation\r\n  private isInConversation = false;\r\n\r\n  constructor(appManager: AppManager) {\r\n    super();\r\n    this.appManager = appManager;\r\n    this.playerManager = this.appManager.getPlayerManager();\r\n    this.characterManager = this.appManager.getCharacterManager();\r\n    this.llmService = new LLMService();\r\n    this.gameContextManager = new GameContextManager(appManager);\r\n    // Don't set tagManager in constructor - it will be available through appManager when needed\r\n  }\r\n\r\n  private get tagManager(): TagManager {\r\n    if (!this._tagManager) {\r\n      this._tagManager = this.appManager.getTagManager();\r\n    }\r\n    return this._tagManager;\r\n  }\r\n\r\n  private set tagManager(value: TagManager) {\r\n    this._tagManager = value;\r\n  }\r\n\r\n  fireNewChatMessage(newMessage: ChatMessage | string | ChatMessage[], options?: { speed?: 'fast' | 'normal' }) {\r\n    const speed = options?.speed || 'normal';\r\n    \r\n    if (Array.isArray(newMessage)) {\r\n      const messagesWithSpeed = newMessage.map(msg => ({ ...msg, _speed: speed }));\r\n      this.messageQueue.push(...messagesWithSpeed);\r\n    } else {\r\n      const formattedMessage = typeof newMessage === 'string' ? {\r\n        message: newMessage,\r\n        speaker: {\r\n          type: CHAT_TYPE.DM,\r\n          id: 0\r\n        },\r\n        _speed: speed\r\n      } : { ...newMessage, _speed: speed };\r\n\r\n      this.messageQueue.push(formattedMessage);\r\n    }\r\n\r\n    if (!this.isProcessingQueue) {\r\n      this.processMessageQueue();\r\n    }\r\n  }\r\n\r\n  private async processMessageQueue() {\r\n    if (this.messageQueue.length === 0) {\r\n      this.isProcessingQueue = false;\r\n      this.currentTimeout = null;\r\n      this.isInConversation = false;\r\n      this.conversationMessageIds = [];\r\n      return;\r\n    }\r\n\r\n    this.isProcessingQueue = true;\r\n    const message = this.messageQueue[0];\r\n    const messageId = `msg-${Date.now()}-${Math.random()}`;\r\n    \r\n    // Track conversation state\r\n    const hasMoreInQueue = this.messageQueue.length > 1;\r\n    const wasInConversation = this.isInConversation;\r\n    \r\n    if (hasMoreInQueue || wasInConversation) {\r\n      this.isInConversation = true;\r\n      this.conversationMessageIds.push(messageId);\r\n    } else {\r\n      // Single message or end of conversation\r\n      this.isInConversation = false;\r\n      this.conversationMessageIds = [messageId];\r\n    }\r\n\r\n    // Add timestamp to message if not present and remove internal properties\r\n    const { _speed, ...cleanMessage } = message as any;\r\n    const messageWithTimestamp = {\r\n      ...cleanMessage,\r\n      timestamp: cleanMessage.timestamp || Date.now()\r\n    };\r\n\r\n    // Save to message history\r\n    this.messageHistory.push(messageWithTimestamp);\r\n    this.recentMessages.push(messageWithTimestamp);\r\n    while(this.recentMessages.length > 20) {\r\n      this.recentMessages.shift();\r\n    }\r\n\r\n    // Emit the message with highlighting information\r\n    this.emit('chat-message', {\r\n      ...messageWithTimestamp,\r\n      messageId,\r\n      hasMoreMessages: hasMoreInQueue,\r\n      isNewConversation: !wasInConversation && hasMoreInQueue,\r\n      conversationIds: [...this.conversationMessageIds],\r\n      isLastInConversation: !hasMoreInQueue && this.isInConversation\r\n    });\r\n\r\n    // Determine timeout: use speed setting for modal conversations\r\n    const shouldDelay = hasMoreInQueue; // Only delay if more messages in queue\r\n    const isFastSpeed = (message as any)._speed === 'fast';\r\n    \r\n    let delay = 0;\r\n    if (shouldDelay) {\r\n      if (isFastSpeed) {\r\n        // Fast speed for modal conversations - much shorter delays\r\n        delay = message.message.length > 42 ? 400 : 200; // 400ms max, 200ms min\r\n      } else {\r\n        // Normal speed\r\n        delay = message.message.length > 42 ? this.messageDelay * 2 : this.messageDelay;\r\n      }\r\n    }\r\n    \r\n    this.currentTimeout = setTimeout(() => {\r\n      this.messageQueue.shift(); // Remove the processed message\r\n      this.processMessageQueue(); // Process next message if any\r\n    }, delay);\r\n  }\r\n\r\n  // Method to advance the queue manually (when user clicks)\r\n  advanceQueue() {\r\n    if (this.messageQueue.length > 0 && this.currentTimeout) {\r\n      clearTimeout(this.currentTimeout);\r\n      this.currentTimeout = null;\r\n      this.messageQueue.shift();\r\n      this.processMessageQueue();\r\n    }\r\n  }\r\n\r\n  playerMessage(message: string, playerId?: number) {\r\n\r\n\r\n\r\n    let playerMessage: string;\r\n    if (Array.isArray(message)) {\r\n      playerMessage = message[Math.floor(Math.random() * message.length)];\r\n    } else {\r\n      playerMessage = message;\r\n    }\r\n    const player = playerId ?? this.playerManager.getRandomPlayer().id;\r\n    const newMessage: ChatMessage = {\r\n      message: playerMessage,\r\n      speaker: {\r\n        type: CHAT_TYPE.PLAYER,\r\n        id: player\r\n      }\r\n    }\r\n    this.fireNewChatMessage(newMessage);\r\n  }\r\n\r\n  dmMessage(message: string | string[]) {\r\n\r\n\r\n    let dmMessage: string;\r\n    if (Array.isArray(message)) {\r\n      dmMessage = message[Math.floor(Math.random() * message.length)];\r\n    } else {\r\n      dmMessage = message;\r\n    }\r\n\r\n    const newMessage: ChatMessage = {\r\n      message: dmMessage,\r\n      speaker: {\r\n        type: CHAT_TYPE.DM,\r\n        id: 0\r\n      }\r\n    }\r\n    this.fireNewChatMessage(newMessage);\r\n  }\r\n\r\n  launchNewConversationById(convoid: string) {\r\n    const conversation = this.conversations[convoid];\r\n    if (!conversation) {\r\n      console.error(\"Conversation not found: \", convoid);\r\n      return;\r\n    }\r\n    // // Schedule one message every 5 seconds\r\n    // conversation.forEach((message, index) => {\r\n\r\n    //     this.fireNewChatMessage(message);\r\n\r\n    // });\r\n\r\n    this.fireNewChatMessage(conversation);\r\n  }\r\n\r\n  launchNewConversation(conversation: ChatMessage[]) {\r\n    this.fireNewChatMessage(conversation);\r\n    // Schedule one message every 5 seconds\r\n    // conversation.forEach((message, index) => {\r\n    //     this.fireNewChatMessage(message);\r\n    // });\r\n\r\n  }\r\n\r\n\r\n  startSessionEvent() {\r\n   // this.launchNewConversationById('WELCOME_CONVERSATION');\r\n  }\r\n\r\n  perceptionEvent(character: Character, perceptionTags: PerceptionTags) {\r\n    let messageString = \"\";\r\n    let campaignChatTrigerred = false;\r\n    perceptionTags.tags.forEach((flavorTag) => {\r\n\r\n      if (this.tagResolved_badFunctionDontUse(flavorTag.tag)) {\r\n        campaignChatTrigerred = true;\r\n      }\r\n    })\r\n    if (campaignChatTrigerred) {\r\n      return;\r\n    }\r\n\r\n    switch (perceptionTags.type) {\r\n      case TAGS_TYPE.CURRENT_LOCATION:\r\n        messageString = `${perceptionTags.tags[0].tag.name}? Pretty much what I would expect from a ${perceptionTags.name}.`;\r\n        break;\r\n      case TAGS_TYPE.BRANCH_LOCATION:\r\n        messageString = `Hmm. Sounds like we know where to look for ${perceptionTags.tags[0].tag.name}...`;\r\n        break;\r\n      case TAGS_TYPE.CHARACTER_BACKSTORY:\r\n        messageString = `OH. MY. GOSH.`;\r\n        break;\r\n      case TAGS_TYPE.CHARACTER_BACKSTORY_PROGRESS:\r\n        messageString = `AT LAST! My character has been searching for ${perceptionTags.tags[0].tag.name}.`;\r\n        break;\r\n      case TAGS_TYPE.MAGIC_ITEM:\r\n        messageString = `Magic item? I'm intrigued.`;\r\n        break;\r\n      case TAGS_TYPE.PLOT_HOOK:\r\n\r\n        const conversation: ChatMessage[] = [{\r\n          message: \"I have a feeling this is going to be important\",\r\n          speaker: {\r\n            type: CHAT_TYPE.PLAYER,\r\n            id: character.id\r\n          }\r\n        }\r\n          , {\r\n          message: \"... in a few months.\",\r\n          speaker: {\r\n            type: CHAT_TYPE.PLAYER,\r\n            id: this.playerManager.getRandomPlayer().id,\r\n          }\r\n        }]\r\n\r\n        this.launchNewConversation(conversation);\r\n        return;\r\n\r\n\r\n\r\n    }\r\n\r\n    const newMessage: ChatMessage = {\r\n      message: messageString,\r\n      speaker: {\r\n        type: CHAT_TYPE.PLAYER,\r\n        id: character.id\r\n      }\r\n    }\r\n    this.fireNewChatMessage(newMessage);\r\n\r\n  }\r\n\r\n\r\n  chance(percentChance: number) {\r\n    return Math.random() * 100 < percentChance;\r\n  }\r\n\r\n  // expectedTagForeshadowed(flavorTag: EncounterFlavorTag, branchName: string) {\r\n  //   const encounterTagMessage = this.appManager.getCampaignManager().getEncounterChatTrigger(flavorTag.tag);\r\n\r\n  //   if(encounterTagMessage && encounterTagMessage.message){\r\n  //     encounterTagMessage.message += this.getThemePostFix(flavorTag);\r\n  //   }\r\n  //   if(encounterTagMessage) {\r\n  //     this.fireNewChatMessage(encounterTagMessage as ChatMessage);\r\n  //     return true;\r\n  //   }\r\n  //   return false\r\n  // }\r\n\r\n\r\n  getThemePostFix(flavorTag: EncounterFlavorTag) {\r\n    switch (flavorTag.theme) {\r\n      case 'comedic':\r\n        return ' in a comedic way';\r\n      case 'heroic':\r\n        return ' in a heroic way';\r\n      case 'serious':\r\n        return ' in a serious way';\r\n      case 'dramatic':\r\n        return ' in a dramatic way';\r\n      case 'grim':\r\n        return ' in a grim way';\r\n      case 'romantic':\r\n        return ' in a romantic way';\r\n      case 'fantasy':\r\n        return ' in a fantasy way';\r\n      case 'horror':\r\n        return ' in a horror way';\r\n      default:\r\n    }\r\n    return '';\r\n  }\r\n\r\n  getEncounterTagPrefix(flavorTag: EncounterFlavorTag) {\r\n    // Add an indication if the tag is an expected location tag or a diffeent one if its an outstanding encounter tag. Otherwise nothing. \r\n    const tagSource = flavorTag.source;\r\n    if(tagSource === FlavorTagSource.LOCATION)\r\n      return 'Set the Scene: ';\r\n    else if(tagSource === FlavorTagSource.ENCOUNTER)\r\n      return 'Encounter Event: '\r\n    return '';\r\n  }\r\n\r\n  triggerCharacterBackstoryResponse(flavorTag: EncounterFlavorTag, character: Character) {\r\n    let messageString = \"\";\r\n    let player = this.playerManager.getPlayerAssignedCharacter(character) || this.playerManager.getRandomPlayer();\r\n    let chatType = CHAT_TYPE.DM;\r\n    let chatId = 0;\r\n    // Randomize some responses to fulfilling a characters backstory, using any themes as extra flavor in some cases\r\n    switch (Math.floor(Math.random() * 5)) {\r\n      case 0:\r\n        messageString = `I never expected to find ${flavorTag.tag.name} here.`;\r\n        chatType = CHAT_TYPE.PLAYER;\r\n        chatId = player.id;\r\n        break;\r\n      case 1:\r\n        messageString = `${character.name} you discovered that ${flavorTag.tag.name} were looking for`;\r\n        break;\r\n      case 2:\r\n        messageString = `${flavorTag.tag.name} has been on your ${character.name}'s mind for a while...behold, ${flavorTag.tag.name}!`;\r\n        break;\r\n      case 3:\r\n        messageString = `I HAVE BEEN WAITING FOR ${flavorTag.tag.name.toUpperCase()} FOREVER!`;\r\n        chatType = CHAT_TYPE.CHARACTER;\r\n        chatId = player.id;\r\n        break;\r\n      default:\r\n        messageString = `You find ${flavorTag.tag.name} in a place you never expected.`;\r\n        break;\r\n    }\r\n\r\n    const newMessage: ChatMessage = {\r\n      message: messageString,\r\n      speaker: {\r\n        type: chatType,\r\n        id: chatId\r\n      }\r\n    }\r\n    this.fireNewChatMessage(newMessage);\r\n\r\n\r\n  }\r\n\r\n\r\n  triggerSpecialRPTagChat(rpFlavorTag: RPEncounterFlavorTag): void {\r\n    if (rpFlavorTag.type === 'character') {\r\n      const character = rpFlavorTag.character;\r\n      this.dmMessage(`We are going to focus on ${character!.name} for a while...`);\r\n      \r\n    }\r\n\r\n    if (rpFlavorTag.type === 'treasure') {\r\n      this.dmMessage(`You guys discover.... some treasure!`);\r\n      \r\n    }\r\n\r\n    if (rpFlavorTag.type === 'dmpoint') {\r\n      this.dmMessage(`Something just clicked for me! Im getting better at this...`);\r\n     \r\n    }\r\n  }\r\n\r\n  triggerChatFromTag(flavorTag: EncounterFlavorTag): boolean {\r\n\r\n\r\n    let player: Player | undefined = this.playerManager.getRandomPlayer();\r\n\r\n\r\n    let messageString = \"maxim broke something, haha\";\r\n    let chatSpeaker = player.id;\r\n    let type = CHAT_TYPE.PLAYER;\r\n\r\n\r\n\r\n\r\n    if (this.chance(50) && this.tagManager.magicItemRumors.includes(flavorTag.tag)) {\r\n      this.magicItemConversation(flavorTag.tag.name, player.id);\r\n      return true;\r\n    }\r\n\r\n\r\n    if (this.chance(50) && flavorTag.theme !== 'none') {\r\n      this.themeConversation(flavorTag, player.id);\r\n      return true;\r\n    }\r\n    const players = this.playerManager.getPlayers();\r\n    if (this.tagManager.getOutstandingBackstoryTags().includes(flavorTag.tag)) {\r\n      const character = this.characterManager.getCharactersWithBackstoryTag(flavorTag.tag)[0];\r\n      player = this.playerManager.getPlayerAssignedCharacter(character) || player;\r\n      messageString = `${character.name} was looking for ${flavorTag.tag.name}!`;\r\n\r\n\r\n    } else\r\n      if (this.chance(50) && this.playerManager.getGroupAttitudeForTag(players, flavorTag.tag) !== ATTITUDE.NEUTRAL) {\r\n\r\n        if (this.playerManager.getGroupAttitudeForTag(players, flavorTag.tag) === ATTITUDE.HATE) {\r\n          player = this.playerManager.getPlayerWithAttitudeForTag(flavorTag.tag, ATTITUDE.HATE);\r\n          messageString = `Ick. ${flavorTag.tag.name}.`;\r\n        } else if (this.playerManager.getGroupAttitudeForTag(players, flavorTag.tag) === ATTITUDE.LIKE) {\r\n          player = this.playerManager.getPlayerWithAttitudeForTag(flavorTag.tag, ATTITUDE.LIKE);\r\n          messageString = `Oooh, I like ${flavorTag.tag.name}.`;\r\n        } else if (this.playerManager.getGroupAttitudeForTag(players, flavorTag.tag) === ATTITUDE.CONFLICTED) {\r\n          player = this.playerManager.getPlayerWithAttitudeForTag(flavorTag.tag, ATTITUDE.LIKE);\r\n          let player2 = this.playerManager.getPlayerWithAttitudeForTag(flavorTag.tag, ATTITUDE.HATE);\r\n\r\n          let playerId = player?.id ?? 0;\r\n          let player2Id = player2?.id ?? 0;\r\n\r\n          const conflictedConversation = [{\r\n            message: `Ugh. I'm sick of ${flavorTag.tag.name}!`,\r\n            speaker: {\r\n              type: CHAT_TYPE.PLAYER,\r\n              id: player2Id,\r\n            }\r\n          },\r\n          {\r\n            message: `...I like ${flavorTag.tag.name}.`,\r\n            speaker: {\r\n              type: CHAT_TYPE.PLAYER,\r\n              id: playerId,\r\n            }\r\n          }\r\n          ];\r\n          this.launchNewConversation(conflictedConversation);\r\n          return true;\r\n\r\n        }\r\n\r\n\r\n      } else {\r\n\r\n        switch (Math.floor(Math.random() * 7)) {\r\n          case 0: // Serious\r\n            messageString = `What do we think about ${flavorTag.tag.name}?`;\r\n            break;\r\n          case 1: // Dramatic\r\n\r\n            messageString = `You remember something about ${flavorTag.tag.name} ...`;\r\n            type = CHAT_TYPE.DM;\r\n            break;\r\n          case 2: // Grim\r\n\r\n            messageString = `I was hoping ${flavorTag.tag.name} would come up!`;\r\n            break;\r\n          case 3: // Casual\r\n            messageString = `Can ${flavorTag.tag.name} be important?`;\r\n            break;\r\n          case 4: // Funny\r\n            messageString = `${flavorTag.tag.name}? ok.`;\r\n            break;\r\n          case 5:\r\n            // Dramatic\r\n            messageString = `${flavorTag.tag.name} reminds me of gob${flavorTag.tag.name}lins.`;\r\n            break;\r\n          case 6:\r\n\r\n            messageString = `You overhear someone talking about ${flavorTag.tag.name}.`;\r\n            type = CHAT_TYPE.DM;\r\n            break;\r\n          default:\r\n\r\n        }\r\n\r\n      }\r\n\r\n    const newMessage: ChatMessage = {\r\n      message: messageString,\r\n      speaker: {\r\n        type: type,\r\n        id: chatSpeaker\r\n      }\r\n    }\r\n    this.fireNewChatMessage(newMessage);\r\n    return true;\r\n  }\r\n\r\n  tagResolved_badFunctionDontUse(tag: Tag) {\r\n    // check for Campaign-specific triggers\r\n    const campaignManager = this.appManager.getCampaignManager();\r\n    const encounterTriggers = campaignManager.getEncounterChatTriggers();\r\n\r\n\r\n\r\n\r\n    const trigger = encounterTriggers?.[tag.name];\r\n    if (trigger) {\r\n      this.fireNewChatMessage(trigger as ChatMessage);\r\n      return true;\r\n    }\r\n\r\n\r\n    return false;\r\n  };\r\n\r\n  triggerAddRandomTagToEncounterConversation(tag: Tag, branch: Encounter) {\r\n    const randomTagConversations = [[\r\n      {\r\n        message: `Thinking: \"Hmmm....should I add ${tag.name} to the ${branch.name} encounter....?\"`,\r\n        speaker: {\r\n          type: CHAT_TYPE.DM,\r\n          id: 0,\r\n        }\r\n      },\r\n      {\r\n        message: \"Hey!...why are you so quiet? What are you thinking about?\",\r\n        speaker: {\r\n          type: CHAT_TYPE.PLAYER,\r\n          id: this.playerManager.getRandomPlayer().id,\r\n        }\r\n      }, {\r\n\r\n        message: `Oh, nothing...just thinking about how much you guys are going to love ${tag.name} if you go to ${branch.location.name}...`,\r\n        speaker: {\r\n          type: CHAT_TYPE.DM,\r\n          id: 0,\r\n        }\r\n      }\r\n    ],\r\n    [\r\n      {\r\n        message: `Why do I get the feeling we will find ${tag.name} at ${branch.location.name}?`,\r\n        speaker: {\r\n          type: CHAT_TYPE.PLAYER,\r\n          id: this.playerManager.getRandomPlayer().id,\r\n        }\r\n      },\r\n      {\r\n        message: \"Yeah, sure. Why not?\",\r\n        speaker: {\r\n          type: CHAT_TYPE.DM,\r\n          id: 0,\r\n        }\r\n      }, {\r\n\r\n        message: `You shrewdly devise that you will find ${tag.name} at ${branch.location.name}...`,\r\n        speaker: {\r\n          type: CHAT_TYPE.DM,\r\n          id: 0,\r\n        }\r\n      }\r\n    ],\r\n    [{\r\n      message: `Going off-script here - but I think it will be fun to have ${tag.name} involved with the events at ${branch.location.name}...`,\r\n      speaker: {\r\n        type: CHAT_TYPE.DM,\r\n        id: 0,\r\n      }\r\n    }],\r\n    [\r\n      {\r\n        message: `I bet ${tag.name} will be at ${branch.location.name}!`,\r\n        speaker: {\r\n          type: CHAT_TYPE.PLAYER,\r\n          id: this.playerManager.getRandomPlayer().id,\r\n        }\r\n      },\r\n      {\r\n        message: \"Why? I don't think I ever indicated that th-\",\r\n        speaker: {\r\n          type: CHAT_TYPE.DM,\r\n          id: 0,\r\n        }\r\n      }, {\r\n\r\n        message: `Oh man! I bet you're right! If we get to ${branch.location.name} we are sure to find ${tag.name}!`,\r\n        speaker: {\r\n          type: CHAT_TYPE.PLAYER,\r\n          id: this.playerManager.getRandomPlayer().id,\r\n        }\r\n      }\r\n    ],\r\n\r\n\r\n    ]\r\n\r\n    const randomTagConversation1 = randomTagConversations[Math.floor(Math.random() * randomTagConversations.length)];\r\n\r\n\r\n    this.launchNewConversation(randomTagConversation1);\r\n  }\r\n\r\n\r\n  magicItemConversation(magicItem: string, playerId: number) {\r\n    const magicItemConversation = [{\r\n      message: `Behold....the ${magicItem}...`,\r\n      speaker: {\r\n        type: CHAT_TYPE.PLAYER,\r\n        id: playerId,\r\n      }\r\n    },\r\n    {\r\n      message: \"Say it in-character\",\r\n      speaker: {\r\n        type: CHAT_TYPE.DM,\r\n        id: this.playerManager.getRandomPlayer().id,\r\n      }\r\n    }, {\r\n\r\n      message: `Behold....the ${magicItem}...`,\r\n      speaker: {\r\n        type: CHAT_TYPE.CHARACTER,\r\n        id: playerId,\r\n      }\r\n    }];\r\n    this.launchNewConversation(magicItemConversation);\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n  themeConversation(flavorTag: EncounterFlavorTag, playerId: number) {\r\n    let messageString = \"\";\r\n    let chatSpeaker = playerId;\r\n    let type = CHAT_TYPE.PLAYER;\r\n\r\n    switch (flavorTag.theme) {\r\n      case 'comedic':\r\n        messageString = `Heheh...\"${flavorTag.tag.name}\"`;\r\n        break;\r\n      case 'grim':\r\n        messageString = `I need to tell you something disturbing about ${flavorTag.tag.name}.`;\r\n        type = CHAT_TYPE.DM;\r\n        break;\r\n      case 'fantasy':\r\n        messageString = `I sometimes daydream about ${flavorTag.tag.name}.`\r\n        break;\r\n      case 'heroic':\r\n        messageString = `Yeah! ${flavorTag.tag.name}!!!`;\r\n        type = CHAT_TYPE.CHARACTER;\r\n        break;\r\n      case 'horror':\r\n        messageString = `A chill descends on the party as they think about ${flavorTag.tag.name}.`;\r\n        type = CHAT_TYPE.DM;\r\n        break;\r\n      case 'romantic':\r\n        messageString = `OOoooooOOOoo ${flavorTag.tag.name}. Kissy kissy!`;\r\n        break;\r\n      case 'serious':\r\n        messageString = `We should focus on ${flavorTag.tag.name}.`;\r\n        break;\r\n      case 'dramatic':\r\n        messageString = `BEHOLD! ${flavorTag.tag.name}!!!`\r\n        type = CHAT_TYPE.CHARACTER;\r\n        break;\r\n    }\r\n\r\n    const newChat = {\r\n      message: messageString,\r\n      speaker: {\r\n        type,\r\n        id: chatSpeaker,\r\n      }\r\n    }\r\n    this.fireNewChatMessage(newChat);\r\n  }\r\n\r\n\r\n\r\n\r\n  sayCombatModifiedMessage(side: 'heroes' | 'enemies', flavor: Tag, enemy: Tag, modifier: number) {\r\n    let messageString = \"\";\r\n    if (flavor.name === \"DM\") {\r\n      if (side === 'heroes') {\r\n        messageString = `The ${enemy.name} are not as strong as you first thought...`;\r\n      } else {\r\n        messageString = `Oops, the ${enemy.name} have more HP than regular...`;\r\n      }\r\n    } else {\r\n      if (modifier < 0) {\r\n        messageString = `Nevermind about the ${flavor.name}...`;\r\n      } else {\r\n        if (side === 'heroes') {\r\n          if (flavor.enemy || flavor.friendly) {\r\n            messageString = `Some ${flavor.name} are distracting the ${enemy.name}!`;\r\n          } else {\r\n            messageString = `The ${enemy.name} get stuck trying to avoid the ${flavor.name}.`;\r\n          }\r\n        } else {\r\n          if (flavor.enemy || flavor.friendly) {\r\n            messageString = `The ${enemy.name} seem to have some ${flavor.name} on their side...`;\r\n          } else {\r\n            messageString = `The ${enemy.name} use the ${flavor.name} to their advantage.`;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n\r\n\r\n    const newChat = {\r\n      message: messageString,\r\n      speaker: {\r\n        type: CHAT_TYPE.DM,\r\n        id: 0,\r\n      }\r\n    }\r\n    this.fireNewChatMessage(newChat);\r\n\r\n  }\r\n\r\n\r\n\r\n  combatIntroMessage(enemy: Tag) {\r\n    const playerAttitude = this.playerManager.getGroupAttitudeForTag(this.playerManager.getPlayers(), enemy);\r\n    let messageString = \"\";\r\n    let playerToSpeak = this.playerManager.getRandomPlayer();\r\n    if (playerAttitude === ATTITUDE.LIKE) {\r\n      messageString = `Yay! ${enemy.name} are my favorite!`;\r\n      playerToSpeak = this.playerManager.getPlayerWithAttitudeForTag(enemy, ATTITUDE.LIKE) || playerToSpeak;\r\n    } else if (playerAttitude === ATTITUDE.HATE) {\r\n      playerToSpeak = this.playerManager.getPlayerWithAttitudeForTag(enemy, ATTITUDE.HATE) || playerToSpeak;\r\n      messageString = `Ugh. I hate ${enemy.name}. Why do we even have them in the game?`;\r\n    } else if (playerAttitude === ATTITUDE.CONFLICTED) {\r\n      messageString = `Well, I know some people don't like ${enemy.name}, but I like em.`;\r\n      playerToSpeak = this.playerManager.getPlayerWithAttitudeForTag(enemy, ATTITUDE.LIKE) || playerToSpeak;\r\n    } else {\r\n      messageString = `I figured we'd fight ${enemy.name} eventually.`;\r\n    }\r\n    const newChat = {\r\n      message: messageString,\r\n      speaker: {\r\n        type: CHAT_TYPE.PLAYER,\r\n        id: playerToSpeak.id,\r\n      }\r\n    }\r\n\r\n\r\n    this.dmMessage('You guys enter combat with some ' + enemy.name);\r\n\r\n    setTimeout(() => {\r\n      this.fireNewChatMessage(newChat);\r\n    }, 5000);\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n  conversations: Record<string, ChatMessage[]> = {\r\n    WELCOME_CONVERSATION: [\r\n      {\r\n        message: \"Hello everyone, welcome to the game. Have a seat and grab some snacks. I'm just looking over my notes and we will start in a moment.\",\r\n        speaker: {\r\n          type: CHAT_TYPE.DM,\r\n          id: 0\r\n        },\r\n      },\r\n       {\r\n        message: \"Where are the snacks?\",\r\n        speaker: {\r\n          type: CHAT_TYPE.PLAYER,\r\n          id: 2\r\n        },\r\n      },\r\n      {\r\n        message: \"Can I sit here?\",\r\n        speaker: {\r\n          type: CHAT_TYPE.PLAYER,\r\n          id: 1\r\n        },\r\n      },\r\n       {\r\n        message: \"I apologize in advance, Im in kind of a bad mood tonight. I even have a red bar by my name.\",\r\n        speaker: {\r\n          type: CHAT_TYPE.PLAYER,\r\n          id: 0\r\n        },\r\n      },\r\n     \r\n      {\r\n        // This could be \"campaign manager -> getCurrentLocationIntro\"\r\n        message: \"Everyone settled? We start in the Village of Fairlight during the Fairlight Festival. You should listen for gossip about some cursed fog you've heard of. Maybe the Village Elder knows something.\",\r\n        speaker: {\r\n          type: CHAT_TYPE.DM,\r\n          id: 0\r\n        },\r\n      },\r\n    ],\r\n  }\r\n  startWelcomeConversation() {\r\n    this.launchNewConversationById(\"WELCOME_CONVERSATION\");\r\n  };\r\n\r\n  getConversationById(conversationId: string): ChatMessage[] | null {\r\n    return this.conversations[conversationId] || null;\r\n  }\r\n\r\n  // LLM Integration Methods\r\n  public getLLMService(): LLMService {\r\n    return this.llmService;\r\n  }\r\n\r\n  public getGameContextManager(): GameContextManager {\r\n    return this.gameContextManager;\r\n  }\r\n\r\n  public trackRecentTopic(tag: Tag) {\r\n    this.recentTopics.push(tag.name);\r\n    if(this.recentTopics.length > 10) {\r\n      this.recentTopics.shift();\r\n    }\r\n  }\r\n\r\n  // Enhanced tag-based chat with LLM fallback\r\npublic async triggerEnhancedChatFromTag(\r\n  flavorTag: EncounterFlavorTag, \r\n  activePlayer?: Player, \r\n  fallbackFunction?: (flavorTag: EncounterFlavorTag, activePlayer?: Player) => Promise<boolean>\r\n  ): Promise<boolean> {\r\n\r\n    //additional context\r\n    // MAXIM: check if we are in a skill chalenge, if so - add a \r\n    // gameContext and pass it in. \r\n    // these should ONLY be uysed for custom things!\r\n    const currentEvent = this.appManager.getCampaignManager().getCurrentEvent();\r\n    const currentEncounter = this.appManager.getCampaignManager().getCurrentEncounter();\r\n    const gameContext: Record<string, any> = {\r\n      location: currentEncounter?.location?.name || \"unknown location\",\r\n      eventType : currentEvent?.type || ENCOUNTER_EVENT_TYPE.ROLEPLAY,\r\n    }\r\n    if(currentEvent?.type === ENCOUNTER_EVENT_TYPE.CHALLENGE ) {\r\n      gameContext.challengeDescription = currentEncounter?.challenge?.[0].description || null;\r\n    }\r\n \r\n    // If no deterministic response, try LLM\r\n    if (this.llmService.isEnabled()) {\r\n      try {\r\n       \r\n\r\n        \r\n        // Determine speaker type and attitude for rules\r\n        const speakerType = Math.random() < 0.4 ? 'player' : Math.random() < 0.3 ? 'character' : 'dm';\r\n        \r\n        const llmResponse = await this.llmService.generateContextualResponse({\r\n          tag: flavorTag.tag,\r\n          gameContext,\r\n          theme: flavorTag.theme.toString(),\r\n          participants: activePlayer ? [activePlayer.id] : [0],\r\n          recentTopics: this.recentTopics,\r\n          speakerType,\r\n          partyTension: this.appManager.getPartyManager().getPartyTension(),\r\n        });\r\n\r\n        if (llmResponse && llmResponse.confidence > 0.6) {\r\n          const chatMessage = this.llmService.toLLMResponseToChatMessage(llmResponse);\r\n          this.fireNewChatMessage(chatMessage);\r\n          \r\n          // Log this as a conversation event\r\n          this.gameContextManager.logConversation(\r\n            [llmResponse.speaker],\r\n            `Discussion about ${flavorTag.tag.name}`\r\n          );\r\n          \r\n          return true;\r\n        }\r\n      } catch (error) {\r\n        console.warn('LLM response failed, falling back to enhanced generic:', error);\r\n      }\r\n    }\r\n\r\n    // Fallback to enhanced generic chat\r\n    if(fallbackFunction) {\r\n      fallbackFunction(flavorTag, activePlayer);\r\n    }else {\r\n      this.triggerChatFromTag(flavorTag);\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  // Log game events to context manager (convenience methods)\r\n  public logEncounterStart(encounter: Encounter): void {\r\n    this.gameContextManager.logEncounterStart(encounter);\r\n  }\r\n\r\n  public logTagDiscovered(tag: Tag, context?: string): void {\r\n    this.gameContextManager.logTagDiscovered(tag, context);\r\n  }\r\n\r\n  public logCombatStart(enemies: string[]): void {\r\n    this.gameContextManager.logCombatStart(enemies);\r\n  }\r\n\r\n  public logCombatEnd(outcome: 'success' | 'failure', details?: string): void {\r\n    this.gameContextManager.logCombatEnd(outcome, details);\r\n  }\r\n\r\n  public triggerCollectionCompleteChat(collectionName: string) {\r\n    const challengeMessage = TAG_COLLECTIONS.find((collection) => collection.name === collectionName);\r\n    if(challengeMessage) {\r\n    this.fireNewChatMessage(challengeMessage.chat)\r\n\r\n    } \r\n  }\r\n\r\n  // Method to get message history for persistent chat display\r\n  public getMessageHistory(): ChatMessage[] {\r\n    return [...this.messageHistory];\r\n  }\r\n\r\n  // Method to get recent messages for component initialization\r\n  public getRecentMessages(): ChatMessage[] {\r\n    return [...this.recentMessages];\r\n  }\r\n    \r\n  \r\n\r\n  // Trigger assist chat for skill challenges\r\n  public triggerChallengeAssistChat(tag: Tag, character?: Character): void {\r\n    if (character && tag) {\r\n      const flavorTag = this.tagManager.tagToFlavorTag(tag);\r\n      const player = this.playerManager.getPlayerAssignedCharacter(character);\r\n      this.triggerEnhancedChatFromTag(flavorTag, player, async (tag) => {\r\n        const assistMessage = `${character.name} uses their ${tag.tag.name} to assist in the challenge!`;\r\n        this.dmMessage(assistMessage);\r\n        return true;\r\n      });\r\n     \r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport default ChatManager;","import EventEmitter from \"events\";\r\nimport { ChatEvent, CHAT_EVENT_TYPE } from \"../models\";\r\nimport { ENCOUNTER_EVENT_TYPE } from \"../consts/general\";\r\nimport AppManager from \"./appManager\";\r\n\r\nclass ChatEventManager extends EventEmitter {\r\n  private appManager: AppManager;\r\n  private eventHistory: ChatEvent[] = [];\r\n\r\n  constructor(appManager: AppManager) {\r\n    super();\r\n    this.appManager = appManager;\r\n  }\r\n\r\n  public addEvent(type: CHAT_EVENT_TYPE, title: string, subtitle?: string, data?: any): void {\r\n    const event: ChatEvent = {\r\n      type,\r\n      title,\r\n      subtitle,\r\n      data,\r\n      timestamp: Date.now()\r\n    };\r\n\r\n    this.eventHistory.push(event);\r\n    \r\n    // Emit the event to the chat system\r\n    this.emit('chat-event', event);\r\n  }\r\n\r\n  public addCampaignStartEvent(campaignName: string): void {\r\n    this.addEvent(CHAT_EVENT_TYPE.CAMPAIGN_START, campaignName);\r\n  }\r\n\r\n  public addEncounterEvent(eventType: ENCOUNTER_EVENT_TYPE, eventName?: string): void {\r\n    const title = this.getEncounterEventDescription(eventType);\r\n    this.addEvent(CHAT_EVENT_TYPE.ENCOUNTER_EVENT, title, eventName, { eventType });\r\n  }\r\n\r\n  public addLocationChangeEvent(locationName: string): void {\r\n    this.addEvent(CHAT_EVENT_TYPE.LOCATION_CHANGE, \"Location Change\", locationName);\r\n  }\r\n\r\n  public addCombatStartEvent(enemyName?: string): void {\r\n    this.addEvent(CHAT_EVENT_TYPE.COMBAT_START, \"Combat Started\", enemyName);\r\n  }\r\n\r\n  public addCombatEndEvent(outcome: 'victory' | 'defeat' | 'flee'): void {\r\n    this.addEvent(CHAT_EVENT_TYPE.COMBAT_END, \"Combat Ended\", outcome);\r\n  }\r\n\r\n  public getEventHistory(): ChatEvent[] {\r\n    return [...this.eventHistory];\r\n  }\r\n\r\n  private getEncounterEventDescription(eventType: ENCOUNTER_EVENT_TYPE): string {\r\n    switch (eventType) {\r\n      case ENCOUNTER_EVENT_TYPE.COMBAT:\r\n        return \"Combat\";\r\n      case ENCOUNTER_EVENT_TYPE.ROLEPLAY:\r\n        return \"Roleplaying\";\r\n      case ENCOUNTER_EVENT_TYPE.PUZZLE:\r\n        return \"Puzzle\";\r\n      case ENCOUNTER_EVENT_TYPE.DUNGEON:\r\n        return \"Dungeon Crawl\";\r\n      case ENCOUNTER_EVENT_TYPE.PERCEPTION:\r\n        return \"Perception Check\";\r\n      case ENCOUNTER_EVENT_TYPE.TOWN:\r\n        return \"Town Stuff\";\r\n      case ENCOUNTER_EVENT_TYPE.TRAVEL:\r\n        return \"Travel\";\r\n      case ENCOUNTER_EVENT_TYPE.CHALLENGE:\r\n        return \"Skill Challenge\";\r\n      case ENCOUNTER_EVENT_TYPE.TRAP:\r\n        return \"Trap\";\r\n      case ENCOUNTER_EVENT_TYPE.CHARACTER_BACKSTORY:\r\n        return \"Backstory\";\r\n      case ENCOUNTER_EVENT_TYPE.STORY:\r\n        return \"Story\";\r\n      case ENCOUNTER_EVENT_TYPE.EXPLORATION:\r\n        return \"Exploration\";\r\n      default:\r\n        return \"Unknown Event\";\r\n    }\r\n  }\r\n}\r\n\r\nexport default ChatEventManager;","import { TAG } from '../consts/tags';\r\nimport { ATTRIBUTE_TYPE, Building, BUILDING_EFFECT_TYPE, BUILDING_TYPE, BuildingEffect, Campaign, Character, EffectData, EncounterFlavorTag, FlavorTagSource, Player, ResultConfig, Tag, TownBuilding } from '../models';\r\nimport AppManager from './appManager';\r\nimport CampaignManager from './campaignManager';\r\nimport PartyManager from './partyManager';\r\nimport PlayerManager from './playerManager';\r\nimport TagManager from './tagManager';\r\nimport UiManager from './uiManager';\r\n\r\nclass TownManager {\r\n\r\nprivate appManager: AppManager;\r\nprivate partyManager: PartyManager;\r\nprivate playerManager: PlayerManager;\r\nprivate campaignManager: CampaignManager\r\nprivate tagManager: TagManager;\r\n\r\nconstructor(appManager: AppManager) {\r\n    this.appManager = appManager;\r\n    this.tagManager = appManager.getTagManager();\r\n    this.partyManager = this.appManager.getPartyManager();\r\n    this.playerManager = this.appManager.getPlayerManager();\r\n    this.campaignManager = this.appManager.getCampaignManager();\r\n}\r\n\r\n  getTagsForBuilding(building: Building): EncounterFlavorTag[] {\r\n        let tags: Tag[] = [...building.tags];\r\n\r\n        // filter out any tags already claimed\r\n        const collectedTags = this.tagManager.getCollectedTags();\r\n        tags = tags.filter(tag => !collectedTags.some(collectedTag => collectedTag.name === tag.name));\r\n\r\n        if (building.addFriendlyTags) {\r\n           const friendlyTags = this.tagManager.getRandomFriendlyTags(1, false);\r\n           tags = [...tags, ...friendlyTags];\r\n        }\r\n\r\n        if(building.allowMagicItems) {\r\n            const magicTags = this.tagManager.getRandomMagicItemTag(1);\r\n            tags = [...tags, ...magicTags];\r\n        }\r\n        \r\n        const randomTags = [];\r\n\r\n        // Encounter tags\r\n      //  const encounterTags = this.tagManager.getOutstandingEncounterTags();\r\n\r\n       // location tags\r\n        const locationTags = this.tagManager.getOutstandingLocationTags();\r\n       \r\n       // foreshadowing tags\r\n        const upcomingEncounterTags = this.tagManager.getUpcomingEncounterTags();\r\n\r\n       // backstory tags\r\n        const backstoryTags = this.tagManager.getOutstandingBackstoryTags()\r\n       // rumor tags\r\n\r\n       const nbRandomTags = (building.nbTags || 5) - tags.length;\r\n        const allTags = [...locationTags, ...upcomingEncounterTags, ...backstoryTags,]//...encounterTags,];\r\n        const randomTagSet = new Set<Tag>(tags);\r\n        while (randomTagSet.size < nbRandomTags && randomTagSet.size < allTags.length) {\r\n            const randomIndex = Math.floor(Math.random() * allTags.length);\r\n            const randomTag = allTags[randomIndex];\r\n            randomTagSet.add(randomTag);\r\n        }\r\n\r\n        // Turn all the tags into flavor tags\r\n        let flavorTags: EncounterFlavorTag[] = [];\r\n        randomTagSet.forEach(tag => {\r\n            flavorTags.push({\r\n                tag: tag,\r\n                source: this.tagManager.getFormattedSource(tag, FlavorTagSource.ALL),\r\n                theme: this.tagManager.getTheme()\r\n            });\r\n        });\r\n\r\n\r\n        return flavorTags;\r\n}\r\n\r\n\r\n// When character is sliding towards building\r\ntownBuildingAssigned(character: Character, building: TownBuilding): void {\r\n    const player = this.playerManager.getPlayerAssignedCharacter(character);\r\n     \r\n    if(player) {\r\n      this.partyManager.playersTakeAction([player.name], true, 1);\r\n      this.partyManager.stressAction([player]);\r\n    }\r\n\r\n    this.appManager.getChatManager().playerMessage(`${character.name} will head towards the ${building.building.name}`, player?.id);\r\n\r\n\r\n}\r\n\r\n\r\n// when building is activated\r\ntownBuildingResolved(character: Character, building: TownBuilding, position: number): ResultConfig {\r\n    const player = this.playerManager.getPlayerAssignedCharacter(character);\r\n    const allEffects: EffectData[] = [];\r\n\r\n    // Track effects for character and party separately\r\n    let characterEffects: {effect: string, class: string}[] = [];\r\n    let partyEffects: {effect: string, class: string}[] = [];\r\n    let playerEffects: {effect: string, class: string}[] = [];\r\n\r\n\r\n    // Player gets player Experience\r\n    playerEffects.push({\r\n        effect: `+1 Player experience`,\r\n        class: 'player-experience'\r\n    });\r\n\r\n      playerEffects.push({\r\n        effect: `+1 Attention`,\r\n        class: 'player-attention'\r\n    });\r\n\r\n    partyEffects.push({\r\n        effect: `other players -1 Attention`,\r\n        class: 'party-experience'\r\n    });\r\n\r\n    // Process building effects\r\n    [...building.effects, ...(building.positionEffects[position] || [])].forEach((effect) => {\r\n        if (effect.chance && Math.random() > effect.chance) {\r\n            return;\r\n        }\r\n\r\n        const effectStr = this.formatBuildingEffect(effect);\r\n        const effectClass = this.getBuildingEffectClass(effect);\r\n\r\n        switch (effect.type) {\r\n            case BUILDING_EFFECT_TYPE.HEAL:\r\n            case BUILDING_EFFECT_TYPE.RESURRECT:\r\n            case BUILDING_EFFECT_TYPE.INJURE:\r\n            case BUILDING_EFFECT_TYPE.USE_MAGIC:\r\n            case BUILDING_EFFECT_TYPE.USE_TOOLS:\r\n            case BUILDING_EFFECT_TYPE.REPLENISH_MAGIC:\r\n            case BUILDING_EFFECT_TYPE.REPLENISH_TOOLS:\r\n                characterEffects.push({effect: effectStr, class: effectClass});\r\n                break;\r\n // case BUILDING_EFFECT_TYPE.ADD_INVOLVEMENT:\r\n            case BUILDING_EFFECT_TYPE.ADD_TENSION:\r\n            case BUILDING_EFFECT_TYPE.ADD_ENJOYMENT:\r\n            // case BUILDING_EFFECT_TYPE.ADD_SCORE:\r\n             partyEffects.push({effect: effectStr, class: effectClass});\r\n                 break;\r\n // case BUILDING_EFFECT_TYPE.ADD_PLAYER_POINT:\r\n            // case BUILDING_EFFECT_TYPE.CAMPAIGN_POINT:\r\n            // break;  \r\n        }\r\n\r\n        // Apply effect\r\n        this.applyBuildingEffect(effect, character, building);\r\n    });\r\n\r\n    // Add effects to results if they exist\r\n    if (characterEffects.length > 0) {\r\n        allEffects.push({\r\n            object: character,\r\n            effects: characterEffects\r\n        });\r\n    }\r\n\r\n    if (playerEffects.length > 0 && player) {\r\n        allEffects.push({\r\n            object: player,\r\n            effects: playerEffects\r\n        });\r\n    }\r\n\r\n    if (partyEffects.length > 0) {\r\n        allEffects.push({\r\n            object: 'party',\r\n            effects: partyEffects\r\n        });\r\n    }\r\n\r\n    building.capacity = 0;\r\n\r\n    // Return ResultConfig\r\n    return {\r\n        results: allEffects,\r\n        title: `${building.building.name} Results`,\r\n        description: `${character.name} visits the ${building.building.name}`,\r\n        tags: this.getTagsForBuilding(building.building),\r\n        travelOption: {\r\n            tagInstructions: \"Select a topic\",\r\n        },\r\n        info: {\r\n            building: building.building.name,\r\n            character: character.name,\r\n            player: player?.name\r\n        }\r\n    };\r\n}\r\n\r\nprivate applyBuildingEffect(effect: BuildingEffect, character: Character, building: TownBuilding) {\r\n    // Initialize attributeLoss if it doesn't exist\r\n    if (!character.attributeLoss) {\r\n        character.attributeLoss = {};\r\n    }\r\n\r\n    switch(effect.type) {\r\n        case BUILDING_EFFECT_TYPE.HEAL:\r\n            // Remove injury effects\r\n            character.injury = undefined;\r\n            break;\r\n        case BUILDING_EFFECT_TYPE.RESURRECT:\r\n            // Remove all negative effects\r\n            character.injury = undefined;\r\n            character.attributeLoss = {};\r\n            break;\r\n        case BUILDING_EFFECT_TYPE.INJURE:\r\n            character.injury = \"injured\";\r\n            break;\r\n        case BUILDING_EFFECT_TYPE.ADD_TENSION:\r\n            this.partyManager.addPartyTension(effect.value);\r\n            break;\r\n        // case BUILDING_EFFECT_TYPE.ADD_SCORE:\r\n        //   //  this.partyManager.addPartyScore(effect.value);\r\n        //     break;\r\n        case BUILDING_EFFECT_TYPE.ADD_ENJOYMENT:\r\n            this.partyManager.addPartyEnjoyment(effect.value);\r\n            break;\r\n        case BUILDING_EFFECT_TYPE.CAMPAIGN_POINT:\r\n            this.campaignManager.addEncounterPoints(effect.value);\r\n            break;\r\n        // case BUILDING_EFFECT_TYPE.ADD_PLAYER_POINT:\r\n        //     const player = this.playerManager.getPlayerAssignedCharacter(character);\r\n        //     if (player) {\r\n        //         player.playerStats.experience += effect.value;\r\n        //     }\r\n        //     break;\r\n        case BUILDING_EFFECT_TYPE.REPLENISH_MAGIC:\r\n            // Remove magic losses\r\n            character.attributeLoss[ATTRIBUTE_TYPE.MAGIC] = 0;\r\n            break;\r\n        case BUILDING_EFFECT_TYPE.REPLENISH_TOOLS:\r\n            // Remove tool losses \r\n            character.attributeLoss[ATTRIBUTE_TYPE.TOOLS] = 0;\r\n            break;\r\n        case BUILDING_EFFECT_TYPE.USE_MAGIC:\r\n            // Add to magic loss\r\n            character.attributeLoss[ATTRIBUTE_TYPE.MAGIC] = (character.attributeLoss[ATTRIBUTE_TYPE.MAGIC] || 0) + effect.value;\r\n            break;\r\n        case BUILDING_EFFECT_TYPE.USE_TOOLS:\r\n            // Add to tool loss\r\n            character.attributeLoss[ATTRIBUTE_TYPE.TOOLS] = (character.attributeLoss[ATTRIBUTE_TYPE.TOOLS] || 0) + effect.value;\r\n            break;\r\n        case BUILDING_EFFECT_TYPE.ADD_TREASURE:\r\n            // Add treasure to character\r\n            this.partyManager.addTreasurePoints(effect.value);\r\n    }\r\n}\r\n\r\nprivate formatBuildingEffect(effect: BuildingEffect): string {\r\n    switch(effect.type) {\r\n        case BUILDING_EFFECT_TYPE.HEAL:\r\n            return `any Injuries Healed`;\r\n        case BUILDING_EFFECT_TYPE.RESURRECT:\r\n            return `Resurrected if dead`;\r\n        case BUILDING_EFFECT_TYPE.INJURE:\r\n            return `Injured!`;\r\n        case BUILDING_EFFECT_TYPE.ADD_TENSION:\r\n            return `${effect.value > 0 ? '+' : ''}${effect.value} tension`;\r\n        case BUILDING_EFFECT_TYPE.ADD_ENJOYMENT:\r\n            return `${effect.value > 0 ? '+' : ''}${effect.value} attitude`;\r\n        // case BUILDING_EFFECT_TYPE.ADD_INVOLVEMENT:\r\n        //     return `${effect.value > 0 ? '+' : ''}${effect.value} involvement`;\r\n        case BUILDING_EFFECT_TYPE.ADD_REWARDS:\r\n            return `${effect.value} rewards`;\r\n        case BUILDING_EFFECT_TYPE.REPLENISH_MAGIC:\r\n            return `Replenished ✨`;\r\n        case BUILDING_EFFECT_TYPE.REPLENISH_TOOLS:\r\n            return `Replenished 🔧`;\r\n        case BUILDING_EFFECT_TYPE.USE_MAGIC:\r\n            return `Used ✨`;\r\n        case BUILDING_EFFECT_TYPE.USE_TOOLS:\r\n            return `Used 🔧`;\r\n        // case BUILDING_EFFECT_TYPE.CAMPAIGN_POINT:\r\n        //     return `DM gained ${effect.value} exp`;\r\n        // case BUILDING_EFFECT_TYPE.ADD_PLAYER_POINT:\r\n        //     return `Gained ${effect.value} exp`;\r\n        case BUILDING_EFFECT_TYPE.ADD_TREASURE:\r\n            return `Found treasure (${effect.value})`;\r\n        // case BUILDING_EFFECT_TYPE.ADD_SCORE:\r\n        //     return `+${effect.value} Party Score`;\r\n        default:\r\n            return 'Unknown effect';\r\n    }\r\n}\r\n\r\nprivate getBuildingEffectClass(effect: BuildingEffect): string {\r\n    switch(effect.type) {\r\n        case BUILDING_EFFECT_TYPE.HEAL:\r\n        case BUILDING_EFFECT_TYPE.REPLENISH_MAGIC:\r\n        case BUILDING_EFFECT_TYPE.REPLENISH_TOOLS:\r\n        case BUILDING_EFFECT_TYPE.RESURRECT:\r\n            return 'positive';\r\n        case BUILDING_EFFECT_TYPE.INJURE:\r\n        case BUILDING_EFFECT_TYPE.ADD_TENSION:\r\n        case BUILDING_EFFECT_TYPE.USE_TOOLS:\r\n        case BUILDING_EFFECT_TYPE.USE_MAGIC:\r\n            return 'negative';\r\n        \r\n        //case BUILDING_EFFECT_TYPE.CAMPAIGN_POINT: \r\n        // //case BUILDING_EFFECT_TYPE.ADD_SCORE:\r\n        //case BUILDING_EFFECT_TYPE.ADD_PLAYER_POINT:\r\n        case BUILDING_EFFECT_TYPE.ADD_REWARDS:\r\n        case BUILDING_EFFECT_TYPE.ADD_TREASURE:\r\n        case BUILDING_EFFECT_TYPE.ADD_ENJOYMENT:\r\n            return 'reward';\r\n        default:\r\n            return 'neutral';\r\n    }\r\n}\r\n}\r\n\r\nexport default TownManager;\r\n","import { NB_EXPECTED_ENCOUNTER_TAGS } from \"../consts/campaigns\";\r\nimport { TAG } from \"../consts/tags\";\r\nimport { ATTITUDE, FlavorTagSource, FlavorTagTheme, RPEncounterFlavorTag, EncounterFlavorTag, Tag, Encounter, TAG_TYPE, Campaign, Player, CHAT_TYPE } from \"../models\";\r\nimport AppManager from \"./appManager\";\r\nimport CampaignManager from \"./campaignManager\";\r\nimport ChatManager from \"./chatManager\";\r\nimport PlayerManager from \"./playerManager\";\r\n\r\n\r\nclass TagManager {\r\n\r\n  private campaignManager: CampaignManager;\r\n  private playerManager: PlayerManager;\r\n  private chatManager: ChatManager;\r\n  private appManager: AppManager;\r\n\r\n  private _locationTagsCollected: Tag[] = [];\r\n  private _locationTagsExpected: Tag[] = [];\r\n  private _encounterTagsCollected: Record<string, Tag[]> = {};\r\n  private _encounterTagsExpected: Record<string, Tag[]> = {};\r\n  private _magicItemRumors: Tag[] = [];\r\n  private _collectedTags: Tag[] = [];\r\n  private _cashedInCollections: string[] = [];\r\n\r\n\r\n  set locationTagsCollected(value: Tag[]) {\r\n    this._locationTagsCollected = value;\r\n  }\r\n\r\n  get locationTagsExpected(): Tag[] {\r\n    return this._locationTagsExpected;\r\n  }\r\n\r\n  set locationTagsExpected(value: Tag[]) {\r\n    this._locationTagsExpected = value;\r\n  }\r\n\r\n  get encounterTagsCollected(): Record<string, Tag[]> {\r\n    return this._encounterTagsCollected;\r\n  }\r\n\r\n  set encounterTagsCollected(value: Record<string, Tag[]>) {\r\n    this._encounterTagsCollected = value;\r\n  }\r\n\r\n  get encounterTagsExpected(): Record<string, Tag[]> {\r\n    return this._encounterTagsExpected;\r\n  }\r\n\r\n  set encounterTagsExpected(value: Record<string, Tag[]>) {\r\n    this._encounterTagsExpected = value;\r\n  }\r\n\r\n  addMagicItemRumor(tag: Tag): void {\r\n    if (!this._magicItemRumors.some(t => t.name === tag.name)) {\r\n      this._magicItemRumors.push(tag);\r\n    }\r\n  }\r\n\r\n\r\n  get magicItemRumors(): Tag[] {\r\n    return this._magicItemRumors;\r\n  }\r\n\r\n  set magicItemRumors(value: Tag[]) {\r\n    this._magicItemRumors = value;\r\n  }\r\n\r\n  get collectedTags(): Tag[] {\r\n    return this._collectedTags;\r\n  }\r\n\r\n  set collectedTags(value: Tag[]) {\r\n    this._collectedTags = value;\r\n  }\r\n\r\n  collectLocationTag(tag: Tag): void {\r\n    if (!this._locationTagsCollected.some(t => t.name === tag.name)) {\r\n      this._locationTagsCollected.push(tag);\r\n      this.collectTag(tag);\r\n    }\r\n\r\n    // Check if all location tags are collected and trigger scene set modal\r\n    if (this._locationTagsCollected.length >= this._locationTagsExpected.length) {\r\n      this.triggerSetSceneModal();\r\n      this.appManager.getUiManager().setEventImageOpacity(1);\r\n    }\r\n\r\n  }\r\n\r\n  collectEncounterTag(tag: Tag): boolean {\r\n    // check the current encounter, then the connected branches\r\n    const currentEncounter = this.campaignManager.getCurrentEncounter();\r\n    let satisfiedNeededTag = false;\r\n    if (!currentEncounter) return false;  \r\n    const expectedTags = currentEncounter.tags || [];\r\n    if (expectedTags.some(t => t.name === tag.name) && !this.encounterTagsCollected[currentEncounter.name]?.some(t => t.name === tag.name)) {\r\n\r\n      // If the tag is expected, add it to the collected tags for that branch\r\n      if (!this.encounterTagsCollected[currentEncounter.name]) {\r\n        this.encounterTagsCollected[currentEncounter.name] = [];\r\n      }\r\n      this.encounterTagsCollected[currentEncounter.name].push(tag);\r\n      satisfiedNeededTag = true;\r\n      \r\n      // Trigger encounter tag modal\r\n      this.triggerEncounterTagModal(tag);\r\n    }\r\n   \r\n    return satisfiedNeededTag;\r\n  }\r\n\r\n  isTagCollected(tag: Tag): boolean {\r\n    return this.collectedTags.some(t => t.name === tag.name);\r\n  }\r\n\r\n\r\n  introduceNewTagForUpcomingBranch(branch: Encounter, tag: Tag) {\r\n    // check the current encounter, then the connected branches\r\n    if(!branch || !this.campaignManager.getCurrentEncounter()) return;\r\n    if(!branch.tags.includes(tag) && this.encounterTagsExpected[branch.name] && !this.encounterTagsExpected[branch.name].includes(tag)) {\r\n     \r\n      this.encounterTagsExpected[branch.name].push(tag);\r\n     \r\n    }\r\n  }\r\n\r\n  collectUpcomingEncounterTag(tag: Tag): boolean {\r\n    // check the current encounter, then the connected branches\r\n    const currentEncounter = this.campaignManager.getCurrentEncounter();\r\n    let satisfiedNeededTag = false;\r\n    if (!currentEncounter) return false;\r\n    const branches = currentEncounter.branches || [];\r\n    branches.forEach(branch => {\r\n      if (this.encounterTagsExpected[branch.name]) {\r\n        const expectedTags = this.encounterTagsExpected[branch.name];\r\n        if (expectedTags.some(t => t.name === tag.name) && !this.encounterTagsCollected[branch.name]?.some(t => t.name === tag.name)) {\r\n          // If the tag is expected, add it to the collected tags for that branch\r\n          if (!this.encounterTagsCollected[branch.name]) {\r\n            this.encounterTagsCollected[branch.name] = [];\r\n          }\r\n          this.encounterTagsCollected[branch.name].push(tag);\r\n          satisfiedNeededTag = true;\r\n        }\r\n      }\r\n    });\r\n \r\n\r\n    return satisfiedNeededTag;\r\n  }\r\n  // Functions to get tags for various reasons but which do not ask a collection of tags directly. \r\n\r\n  getOutstandingQuestTags(): Tag[] {\r\n    return this.appManager?.getQuestManager()?.getOutstandingQuestTags() || [];\r\n  } \r\n  // Get tags needed for backstories\r\n\r\n  getOutstandingBackstoryTags() {\r\n    return this.appManager.getCharacterManager().getAllExpectedBackstoryTags();\r\n  }\r\n\r\n  getOutstandingLocationTags() {\r\n    return this._locationTagsExpected.filter(tag => !this._locationTagsCollected.some(t => t.name === tag.name));\r\n  }\r\n\r\n  getCollectedLocationTags(): Tag[] {\r\n    return this._locationTagsCollected;\r\n  }\r\n\r\n  getEstablishedFriendlyTags() {\r\n    // get number of unique friendly tags from the list:\r\n    const allTags: Tag[] = Object.values(TAG).flat();\r\n    const friendlyTags = allTags.filter(tag => tag.friendly);\r\n    const establishedFriendlyTags = this.collectedTags.filter(tag => friendlyTags.includes(tag));\r\n    return establishedFriendlyTags;\r\n  }\r\n\r\n  getRandomFriendlyTags(nbTags: number, allowCollected: boolean = true): Tag[] {\r\n    // get number of unique friendly tags from the list:\r\n    const allTags: Tag[] = Object.values(TAG).flat();\r\n    if (!allowCollected) {\r\n      const collectedFriendlyTags = this.getEstablishedFriendlyTags();\r\n      const uncollectedFriendlyTags = allTags.filter(tag => tag.friendly && !collectedFriendlyTags.includes(tag));\r\n      return this.getRandomTags(nbTags, uncollectedFriendlyTags);\r\n    }\r\n    const friendlyTags = allTags.filter(tag => tag.friendly);\r\n    const randomFriendlyTags = this.getRandomTags(nbTags, friendlyTags);\r\n    return randomFriendlyTags;\r\n  }\r\n\r\n  getPotentialCombatantsTags() {\r\n    // get number of unique friendly tags from the list:\r\n    const allTags: Tag[] = Object.values(TAG).flat();\r\n    const combatantTags = allTags.filter(tag => tag.enemy || tag.friendly);\r\n    return combatantTags;\r\n  }\r\n\r\n  getEstablishedCombatantTags() {\r\n    // get number of unique friendly tags from the list:\r\n    const allTags: Tag[] = Object.values(TAG).flat();\r\n    const combatantTags = allTags.filter(tag => tag.enemy || tag.friendly);\r\n    const establishedCombatantTags = this.collectedTags.filter(tag => combatantTags.includes(tag));\r\n    return establishedCombatantTags;\r\n  }\r\n\r\n\r\n  getRandomMagicItemTag(nbTags: number): Tag[] {\r\n\r\n    const expectedGearTags = [...this.magicItemRumors];\r\n    // determine if we should get a new random element, or one of the outstanding ones\r\n\r\n    while (expectedGearTags.length < nbTags + 2) {\r\n      const newGear = this.appManager.getCharacterManager().getRandomGear();\r\n      const gearTag = { name: newGear.name, type: TAG_TYPE.GEAR };\r\n      expectedGearTags.push(gearTag);\r\n    }\r\n    const randomTags = this.getRandomTags(nbTags, expectedGearTags);\r\n    return randomTags;\r\n\r\n  }\r\n\r\n\r\n\r\n  get locationTagsCollected(): Tag[] {\r\n    return this._locationTagsCollected;\r\n  }\r\n\r\n\r\n  initializeNewCampaign(campaign: Campaign) {\r\n    this.locationTagsCollected = [];\r\n    this.encounterTagsCollected = {};\r\n    this.magicItemRumors = [];\r\n    this.collectedTags = [];\r\n    this.cashedInCollections = [];\r\n    // Add all the authored tags for encounters to the expected tags. \r\n    this.encounterTagsExpected = {};\r\n    if (campaign) {\r\n      campaign.encounters.forEach(encounter => {\r\n        this.encounterTagsExpected[encounter.name] = encounter.tags || [];\r\n        this.encounterTagsCollected[encounter.name] = [];\r\n      });\r\n    }\r\n\r\n  }\r\n\r\n\r\n  initializeNewEncounter(encounter: Encounter) {\r\n    this.locationTagsCollected = [];\r\n    this.locationTagsExpected = encounter.location.tags || [];\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  constructor(\r\n    campaignManager: CampaignManager,\r\n    playerManager: PlayerManager,\r\n    chatManager: ChatManager | undefined,\r\n    appManager: AppManager\r\n  ) {\r\n    this.playerManager = playerManager;\r\n    this.chatManager = chatManager as ChatManager; // Will be set later if undefined\r\n    this.campaignManager = campaignManager;\r\n    this.appManager = appManager;\r\n  }\r\n\r\n  // Method to set chat manager after construction\r\n  setChatManager(chatManager: ChatManager) {\r\n    this.chatManager = chatManager;\r\n  }\r\n\r\n  getTooltipText(rpFlavorTag: RPEncounterFlavorTag) {\r\n    let tooltipText = \"\";\r\n\r\n    if (rpFlavorTag.tag) {\r\n      if (this.campaignManager.getCampaignTooltipForTag(rpFlavorTag.tag)) {\r\n        return this.campaignManager.getCampaignTooltipForTag(rpFlavorTag.tag);\r\n      }\r\n\r\n      const flavorTag = rpFlavorTag.tag;\r\n      const playerLikes = this.playerManager.getPartyAttitudeForTag(flavorTag.tag);\r\n      switch (flavorTag.source) {\r\n        case FlavorTagSource.LOCATION:\r\n          switch (Math.floor(Math.random() * 2)) {\r\n            case 0:\r\n              tooltipText = `The players interact with ${flavorTag.tag.name}`;\r\n              break;\r\n            case 1:\r\n              tooltipText = `You describe some nearby ${flavorTag.tag.name}`;\r\n              break;\r\n          }\r\n\r\n          break;\r\n        case FlavorTagSource.MAGIC_ITEM_EXPECTED:\r\n          tooltipText = \"Hint about a magic item: \" + flavorTag.tag.name;\r\n          break;\r\n        case FlavorTagSource.FORESHADOWING:\r\n          if (playerLikes === ATTITUDE.LIKE) {\r\n            tooltipText = `Some players will be happy to know that ${flavorTag.tag.name} seems to be part of an upcoming encounter`;\r\n          } else if (playerLikes === ATTITUDE.HATE) {\r\n            tooltipText = `Much to one player's annoyaince - you imply that ${flavorTag.tag.name} will be expected in an upcoming encounter`;\r\n          } else {\r\n            tooltipText = `You foreshadow ${flavorTag.tag.name} for an upcoming encounter`;\r\n          }\r\n          break;\r\n        case FlavorTagSource.FORESHADOWING_RANDOM:\r\n          if (playerLikes === ATTITUDE.LIKE) {\r\n            tooltipText = `The players like ${flavorTag.tag.name}...add it on a whim to an upcoming encounter`;\r\n          } else if (playerLikes === ATTITUDE.HATE) {\r\n            tooltipText = `${flavorTag.tag.name} will feature in an upcoming encounter - even though some players hate ${flavorTag.tag.name}!`;\r\n          } else {\r\n            tooltipText = `Ad-lib ${flavorTag.tag.name} into an upcoming encounter`;\r\n          }\r\n          break;\r\n        case FlavorTagSource.RUMOR:\r\n          // check if this is an expected tag for a branch\r\n          const isExpectedForCurrentEncounter = this.campaignManager\r\n            .getExpectedEncounterTags()\r\n            .includes(flavorTag.tag);\r\n          tooltipText = isExpectedForCurrentEncounter\r\n            ? `You reinforce the importance of ${flavorTag.tag.name}.`\r\n            : `You confirm the players' questions about ${flavorTag.tag.name}`;\r\n          break;\r\n        case FlavorTagSource.PLAYERS:\r\n          tooltipText = `The players have feelings about ${flavorTag.tag.name}`;\r\n          break;\r\n        case FlavorTagSource.QUESTS:\r\n          tooltipText = `While questing, the players learn about ${flavorTag.tag.name}`;\r\n          break;\r\n        case FlavorTagSource.ALL:\r\n          tooltipText = `For no specific reason, the players discuss ${flavorTag.tag.name}`;\r\n          break; case FlavorTagSource.MAGIC_ITEM:\r\n          if(this.magicItemRumors.includes(flavorTag.tag)) {\r\n            tooltipText = `You award the players the ${flavorTag.tag.name} they have been looking for!`;\r\n          } else {\r\n            tooltipText = `You tell the players about a magic item: ${flavorTag.tag.name}`;\r\n          }\r\n          break;\r\n        case FlavorTagSource.BACKSTORY:\r\n          tooltipText = `The ${flavorTag.tag.name} is integral to a character's backstory!`;\r\n          break;\r\n        case FlavorTagSource.PLOT:\r\n          tooltipText = `${flavorTag.tag.name} will be important to the story`;\r\n          break;\r\n        case FlavorTagSource.ENEMY:\r\n          tooltipText = `Introduce some ${flavorTag.tag.name} as a new enemy for this campaign.`;\r\n          break;\r\n        case FlavorTagSource.TREASURE:\r\n          tooltipText = `The players discover valuable treasure!`;\r\n          break;\r\n        case FlavorTagSource.NONE:\r\n          tooltipText = flavorTag?.tag.name + ' comes up for no specific reason.';\r\n          break;\r\n        case FlavorTagSource.ENCOUNTER:\r\n          tooltipText = flavorTag?.tag.name + ' is a very important topic. Maxim should have Authored a tooltip for this! BAD MAXIM';\r\n          tooltipText = \"LAUNCH ENCOUNTER SCENE:\" + tooltipText;\r\n          break;\r\n        case FlavorTagSource.QUEST:\r\n          tooltipText = `Revealing or discussing this will progress a quest`;\r\n          break;\r\n         case FlavorTagSource.QUEST_TERMINAL:\r\n          tooltipText = `Revealing or discussing this will complete a quest`;\r\n          break; \r\n        default:\r\n          tooltipText = \"\";\r\n          break;\r\n      }\r\n\r\n      tooltipText += this.chatManager.getThemePostFix(flavorTag);\r\n\r\n      return tooltipText;\r\n    } else if (rpFlavorTag.character) {\r\n      tooltipText = `Spend some time focusing on ${rpFlavorTag.character.name}`;\r\n      return tooltipText;\r\n    } else if (rpFlavorTag.type === \"treasure\") {\r\n      tooltipText = `TREASURE: award the players a bit of treasure...`;\r\n      return tooltipText;\r\n    } else if (rpFlavorTag.type === \"dmpoint\") {\r\n      tooltipText = `DM POINT: You have a great idea which will inform future decisions and make you an overall better dm`;\r\n      return tooltipText;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Convert a simple Tag into an EncounterFlavorTag with default source/theme\r\n   */\r\n  public tagToEncounterFlavorTag(tag: Tag, source: FlavorTagSource = FlavorTagSource.ALL, theme: FlavorTagTheme = FlavorTagTheme.NONE, isHighlighted = false): EncounterFlavorTag {\r\n    return { tag, source, theme };\r\n  }\r\n\r\n  public collectTag(tag: Tag | EncounterFlavorTag): void {\r\n    const flavorTag = ('tag' in tag) ? tag : this.tagToEncounterFlavorTag(tag);\r\n    const baseTag = flavorTag.tag;\r\n\r\n\r\n    if (!this.collectedTags.some(t => t.name === baseTag.name)) {\r\n      this.collectedTags.push(baseTag);\r\n    }\r\n\r\n  }\r\n\r\n  public getCollectedTags(): Tag[] {\r\n    return this.collectedTags;\r\n  }\r\n\r\n  public isCurrentEncounterTag(tagName: string): boolean {\r\n    const currentEncounter = this.campaignManager.getCurrentEncounter();\r\n    if (!currentEncounter) return false;\r\n    return this.encounterTagsExpected[currentEncounter.name].some(t => t.name === tagName);\r\n  }\r\n\r\n\r\n public getCollectedEncounterTags(): Tag[] {\r\n    const currentEncounter = this.campaignManager.getCurrentEncounter();\r\n    if (!currentEncounter) return [];\r\n    return this.encounterTagsCollected[currentEncounter.name] || [];\r\n  }\r\n\r\n  public getOutstandingEncounterTags(): Tag[] {\r\n    const currentEncounter = this.campaignManager.getCurrentEncounter();\r\n    \r\n    if (!currentEncounter) return [];\r\n    const expectedTags = this.encounterTagsExpected[currentEncounter.name] || [];\r\n    return expectedTags.filter(tag => !this.encounterTagsCollected[currentEncounter.name]?.some(t => t.name === tag.name));\r\n  }\r\n\r\n  public getUpcomingEncounterTags(): Tag[] {\r\n    const currentEncounter = this.campaignManager.getCurrentEncounter();\r\n    if (!currentEncounter) return [];\r\n    const upcomingEncounters = currentEncounter.branches || [];\r\n    return upcomingEncounters.flatMap(encounter => this.encounterTagsExpected[encounter.name] || []);\r\n  }\r\n\r\n  public isUpcomingEncounterTag(tagName: string): boolean {\r\n    const currentEncounter = this.campaignManager.getCurrentEncounter();\r\n    const upcomingEncounters = currentEncounter?.branches;;\r\n    if (!upcomingEncounters || upcomingEncounters.length === 0) return false;\r\n    return upcomingEncounters.some(encounter =>\r\n      this.encounterTagsExpected[encounter.name].some(t => t.name === tagName)\r\n    );\r\n  }\r\n\r\n  public showNextEncounterModal(): void {\r\n    this.triggerNextEncounterModal();\r\n  }\r\n  // Check against magic items, backstories, etc and change the location based on that. This will then set the style\r\n  getFormattedSource = (tag: Tag, source: FlavorTagSource) => {\r\n    let formattedSource = source;\r\n    if (this.magicItemRumors.includes(tag)) {\r\n      formattedSource = FlavorTagSource.MAGIC_ITEM;\r\n    } else if(tag.type === TAG_TYPE.GEAR) {\r\n      formattedSource = FlavorTagSource.MAGIC_ITEM_EXPECTED;\r\n    } \r\n    \r\n    else if (this.getOutstandingBackstoryTags().includes(tag)) {\r\n      formattedSource = FlavorTagSource.BACKSTORY;\r\n    }\r\n    else if (this.locationTagsExpected.includes(tag)) {\r\n      formattedSource = FlavorTagSource.LOCATION;\r\n    } else if (this.isCurrentEncounterTag(tag.name)) {\r\n      //  debugger\r\n      formattedSource = FlavorTagSource.ENCOUNTER;\r\n    }\r\n    else if (this.isUpcomingEncounterTag(tag.name)) {\r\n      //  debugger\r\n      formattedSource = FlavorTagSource.FORESHADOWING;\r\n    }\r\n    return formattedSource;\r\n  }\r\n\r\n  couldAssignRandomTagToBranch(encounter: Encounter) {\r\n\r\n    return NB_EXPECTED_ENCOUNTER_TAGS > this.encounterTagsExpected[encounter.name].length;\r\n  }\r\n\r\n\r\n  // Check if we might be able to assign a randome tag to any branch \r\n  couldAssignRandomTag(currentEncounter: Encounter | undefined): boolean {\r\n    if (!currentEncounter) {\r\n      return false;\r\n    }\r\n\r\n    const upcomingBranches = currentEncounter.branches || [];\r\n    let couldAssignRandomTagToAnyBranch = false;\r\n    upcomingBranches.forEach((branch) => {\r\n      if (this.couldAssignRandomTagToBranch(branch)) {\r\n        couldAssignRandomTagToAnyBranch = true;\r\n      }\r\n    });\r\n    return couldAssignRandomTagToAnyBranch;\r\n  }\r\n\r\n  tagToFlavorTag(tag: Tag, theme: FlavorTagTheme = FlavorTagTheme.NONE): EncounterFlavorTag {\r\n    const source = this.getFormattedSource(tag, FlavorTagSource.ALL);\r\n    return {\r\n      tag,\r\n      source,\r\n      theme\r\n    };\r\n  }\r\n\r\n  convertRpTagToFlavorTag(rpTag: RPEncounterFlavorTag): EncounterFlavorTag | undefined {\r\n    // Usually thie RP tag just contains a flavor tag, but sometimes they are special and we neex to eract the flavortag and add some shit\r\n\r\n    if (rpTag.type === \"treasure\") {\r\n      return {\r\n        tag: {\r\n          name: \"Treasure\",\r\n        },\r\n        source: FlavorTagSource.TREASURE,\r\n        theme: FlavorTagTheme.NONE,\r\n      };\r\n    }\r\n\r\n    if (rpTag.type === \"dmpoint\") {\r\n      return {\r\n        tag: {\r\n          name: \"DM Point\",\r\n        },\r\n        source: FlavorTagSource.DM_POINT,\r\n        theme: FlavorTagTheme.NONE,\r\n      };\r\n    }\r\n\r\n    if (rpTag.type === \"character\") {\r\n      return {\r\n        tag: {\r\n          name: rpTag.character!.name,\r\n        },\r\n        source: FlavorTagSource.PLAYERS,\r\n        theme: FlavorTagTheme.NONE,\r\n      };\r\n    }\r\n\r\n    return rpTag.tag;\r\n  }\r\n\r\n\r\n\r\n  generateRelevantFlavorTags(nbTags: number, omitSources?: FlavorTagSource[]): EncounterFlavorTag[] {\r\n\r\n    const encounter = this.campaignManager.getCurrentEncounter();\r\n    if (!encounter) {\r\n      return [];\r\n    }\r\n\r\n    const outstandingLocationTags = this.getOutstandingLocationTags();\r\n    const outstandingEncounterTags = this.encounterTagsExpected[encounter.name] || [];\r\n    const upcomingEncounterTagsToAdd = this.getUpcomingEncounterTags();\r\n    const magicItemsToAdd = this.magicItemRumors;\r\n    const backstoryTagsToAdd = this.getOutstandingBackstoryTags();\r\n    const playerPreferenceTagsToAdd = this.playerManager.getAllPlayerPreferences();\r\n    const questTagsToAdd = this.appManager?.getQuestManager()?.getCurrentQuestTags() || [];\r\n\r\n    let allTagsSoFar: any[] = [];\r\n\r\n    //Convert the locationTags into EncounterFlavorTags\r\n    const locationFlavorTags: EncounterFlavorTag[] = outstandingLocationTags.map(tag => {\r\n      return {\r\n        tag: tag,\r\n        source: this.getFormattedSource(tag, FlavorTagSource.LOCATION),\r\n        theme: this.getTheme()\r\n      }\r\n    });\r\n    allTagsSoFar = [...allTagsSoFar, ...outstandingLocationTags];\r\n\r\n\r\n    // MAXIM TODO: Why do we get so many of these in RP events?!\r\n    const encounterFlavorTags: EncounterFlavorTag[] = outstandingEncounterTags.map(tag => {\r\n      return {\r\n        tag: tag,\r\n        source: this.getFormattedSource(tag, FlavorTagSource.ENCOUNTER),\r\n        theme: FlavorTagTheme.NONE\r\n      }\r\n    });\r\n    // we only want to add one encounter flavor tag, so get a random one, \r\n    if (encounterFlavorTags.length > 0) {\r\n      const randomEncounterTag = encounterFlavorTags[Math.floor(Math.random() * encounterFlavorTags.length)];\r\n      allTagsSoFar.push(randomEncounterTag);\r\n    }\r\n\r\n\r\n    //CONVERT THE UPCOMING TAGS INTO FORESHADOWING TAGS\r\n    const upcomingEncounterFlavorTags: EncounterFlavorTag[] = upcomingEncounterTagsToAdd.map(tag => {\r\n      return {\r\n        tag: tag,\r\n        source: this.getFormattedSource(tag, FlavorTagSource.FORESHADOWING),\r\n        theme: this.getTheme()\r\n      }\r\n    });\r\n\r\n    allTagsSoFar = [...allTagsSoFar, ...upcomingEncounterTagsToAdd];\r\n\r\n\r\n    //Convert the magic items into EncounterFlavorTags\r\n    const magicItemFlavorTags: EncounterFlavorTag[] = magicItemsToAdd.map(tag => {\r\n      return {\r\n        tag: tag,\r\n        source: this.getFormattedSource(tag, FlavorTagSource.MAGIC_ITEM),\r\n        theme: this.getTheme()\r\n      }\r\n    });\r\n\r\n    allTagsSoFar = [...allTagsSoFar, ...magicItemsToAdd];\r\n    //Convert the backstory tags into EncounterFlavorTags\r\n    const backstoryFlavorTags: EncounterFlavorTag[] = backstoryTagsToAdd.map(tag => {\r\n      return {\r\n        tag: tag,\r\n        source: this.getFormattedSource(tag, FlavorTagSource.BACKSTORY),\r\n        theme: this.getTheme()\r\n      }\r\n    });\r\n    allTagsSoFar = [...allTagsSoFar, ...backstoryTagsToAdd];\r\n\r\n    // Helper function to generate extra random flavor tags\r\n    const generateExtraRandomFlavorTags = (count: number, existingTags: Tag[]): EncounterFlavorTag[] => {\r\n      const extraTags = this.getRandomTags(count, this.getAllAllTags(), existingTags);\r\n      return extraTags.map(tag => {\r\n        if (tag === undefined) {\r\n          debugger\r\n        }\r\n        if (omitSources && !omitSources.includes(FlavorTagSource.FORESHADOWING_RANDOM)  && this.couldAssignRandomTag(this.campaignManager.getCurrentEncounter()) && Math.random() < 0.25) {\r\n          return {\r\n            tag: tag,\r\n            source: this.getFormattedSource(tag, FlavorTagSource.FORESHADOWING_RANDOM),\r\n            theme: this.getTheme()\r\n          }\r\n        }\r\n\r\n        return {\r\n          tag: tag,\r\n          source: this.getFormattedSource(tag, FlavorTagSource.ALL),\r\n          theme: this.getTheme()\r\n        }\r\n      });\r\n    };\r\n\r\n    // Now we can get random tags. These can be in favor of player favorites or hates, or things to complete a collection, etc....\r\n\r\n    // This is how we get the random tags.\r\n    const randomPlayerTags: Tag[] =  this.getRandomTags(4, playerPreferenceTagsToAdd, allTagsSoFar);\r\n    const initialExtraFlavorTags = generateExtraRandomFlavorTags(4, allTagsSoFar);\r\n    const randomPlayerFlavorTags: EncounterFlavorTag[] = randomPlayerTags.map(tag => {\r\n      if (tag === undefined) {\r\n        debugger\r\n      }\r\n      return {\r\n        tag: tag,\r\n        source: this.getFormattedSource(tag, FlavorTagSource.ALL),\r\n        theme: this.getTheme()\r\n      }\r\n    });\r\n\r\n    let allFlavorTags = [...locationFlavorTags, ...encounterFlavorTags, ...upcomingEncounterFlavorTags, ...magicItemFlavorTags, ...backstoryFlavorTags, ...questTagsToAdd, ...randomPlayerFlavorTags, ...initialExtraFlavorTags];\r\n    allFlavorTags = allFlavorTags.filter(tag => this.collectedTags.includes(tag.tag) === false);\r\n    if (omitSources) {\r\n      allFlavorTags = allFlavorTags.filter(tag => !omitSources.includes(tag.source));\r\n    }\r\n\r\n    const randomizedTags = allFlavorTags.sort(() => Math.random() - 0.5).slice(0, nbTags);\r\n\r\n    // If we don't have enough tags to fulfill our order, generate additional random tags\r\n    if (randomizedTags.length < nbTags) {\r\n      const shortfall = nbTags - randomizedTags.length;\r\n      const allUsedTags = allFlavorTags.map(ft => ft.tag);\r\n      const additionalFlavorTags = generateExtraRandomFlavorTags(shortfall * 2, allUsedTags); // Generate extra to account for filtering\r\n      \r\n      // Filter out collected tags and omitted sources\r\n      let filteredAdditionalTags = additionalFlavorTags.filter(tag => this.collectedTags.includes(tag.tag) === false);\r\n      if (omitSources) {\r\n        filteredAdditionalTags = filteredAdditionalTags.filter(tag => !omitSources.includes(tag.source));\r\n      }\r\n      \r\n      // Add the additional tags to fill the shortfall\r\n      randomizedTags.push(...filteredAdditionalTags.slice(0, shortfall));\r\n    }\r\n\r\n    return randomizedTags;\r\n   \r\n  }\r\n\r\n\r\n\r\n  getRandomTags(nbTags: number | number[], tagList: Tag[], omittedTags?: Tag[]) {\r\n\r\n    if (Array.isArray(nbTags)) {\r\n      // if nbTags is a range, get a random amount selected from that range\r\n      nbTags = Math.floor(Math.random() * (nbTags[1]) + nbTags[0]);\r\n    }\r\n    if (nbTags <= 0) {\r\n      return [];\r\n    }\r\n    if (omittedTags) {\r\n      const omittedNames = omittedTags.map(tag => tag.name);\r\n      tagList = tagList.filter(tag => !omittedNames.includes(tag.name));\r\n    }\r\n    const randomTags = tagList.sort(() => Math.random() - 0.5).slice(0, nbTags);\r\n    return randomTags;\r\n  }\r\n\r\n  getAllAllTags(): Tag[] {\r\n     return Object.values(TAG).flat();\r\n  }\r\n  \r\n\r\n getTheme(): FlavorTagTheme {\r\n\r\n    // 1 in 5 chance of having a theme\r\n    if (Math.floor(Math.random() * 6) !== 0) {\r\n      return FlavorTagTheme.NONE;\r\n    }\r\n\r\n\r\n    const availableTones = this.campaignManager.getUnlockedTones();\r\n\r\n    if (availableTones.length === 0) {\r\n      return FlavorTagTheme.NONE;\r\n    }\r\n\r\n    // Randomly select one of the available tones\r\n    const themeRoll = Math.floor(Math.random() * availableTones.length);\r\n    return availableTones[themeRoll];\r\n\r\n  }\r\n\r\n  // Modal trigger methods\r\n  triggerSetSceneModal(): void {\r\n    const currentEncounter = this.campaignManager.getCurrentEncounter();\r\n    if (!currentEncounter) return;\r\n\r\n    const uiManager = this.appManager.getUiManager();\r\n    uiManager.showModal({\r\n      title: 'Location Described',\r\n      type: 'setscene',\r\n      options: [{\r\n        id: 'ok',\r\n        title: 'Continue',\r\n        description: 'Proceed with the encounter',\r\n        callback: () => {\r\n          this.campaignManager.setCurrentEncounterSceneComplete();\r\n        }\r\n      }],\r\n      // Store additional data for the modal component\r\n      sceneData: {\r\n        location: currentEncounter.location,\r\n        encounter: currentEncounter\r\n      }\r\n    } as any);\r\n  }\r\n\r\n  triggerEncounterTagModal(tag: Tag): void {\r\n    const currentEncounter = this.campaignManager.getCurrentEncounter();\r\n    if (!currentEncounter) return;\r\n\r\n    // Get chat information for the tag\r\n    const chatTrigger = this.campaignManager.getEncounterChatTrigger(tag);\r\n    \r\n    // Send conversation directly to chat instead of showing modal\r\n    if (chatTrigger) {\r\n      const chatManager = this.appManager.getChatManager();\r\n      \r\n      // Handle different chat trigger types with fast speed for modal conversations\r\n      if (Array.isArray(chatTrigger)) {\r\n        // Array of messages\r\n        chatManager.fireNewChatMessage(chatTrigger, { speed: 'fast' });\r\n      } else if (typeof chatTrigger === 'string') {\r\n        // Simple string message\r\n        chatManager.fireNewChatMessage(chatTrigger, { speed: 'fast' });\r\n      } else if (chatTrigger.message) {\r\n        // Message object\r\n        chatManager.fireNewChatMessage({\r\n          message: chatTrigger.message,\r\n          speaker: chatTrigger.speaker || { type: CHAT_TYPE.DM, id: 0 }\r\n        }, { speed: 'fast' });\r\n      }\r\n    }\r\n    \r\n    // Still show a simple modal for scoring/rewards if needed, but without conversation\r\n    const uiManager = this.appManager.getUiManager();\r\n    uiManager.showModal({\r\n      title: `Tag Discovered: ${tag.name}`,\r\n      type: 'encountertag',\r\n      options: [{\r\n        id: 'ok',\r\n        title: 'Continue',\r\n        description: 'Proceed with the encounter',\r\n        callback: () => {\r\n          // Modal will close automatically\r\n        }\r\n      }],\r\n      // Store additional data for the modal component\r\n      tagData: {\r\n        tag: tag,\r\n        chatTrigger: chatTrigger, // Keep conversation in modal AND send to chat\r\n        encounter: currentEncounter\r\n      }\r\n    } as any);\r\n  }\r\n\r\n  triggerNextEncounterModal(): void {\r\n    const currentEncounter = this.campaignManager.getCurrentEncounter();\r\n    if (!currentEncounter || !currentEncounter.branches || currentEncounter.branches.length === 0) return;\r\n\r\n    const players = this.playerManager.getPlayers();\r\n    const branches = currentEncounter.branches;\r\n    \r\n    // Calculate player preferences for each branch\r\n    const branchPreferences = this.calculateBranchPreferences(branches, players);\r\n    \r\n    const uiManager = this.appManager.getUiManager();\r\n    uiManager.showModal({\r\n      title: 'Choose Next Encounter',\r\n      type: 'nextencounter',\r\n      options: branches.map(branch => ({\r\n        id: branch.name,\r\n        title: branch.name,\r\n        description: branch.description,\r\n        callback: () => {\r\n          this.handleNextEncounterSelection(branch);\r\n        }\r\n      })),\r\n      // Store additional data for the modal component\r\n      encounterData: {\r\n        branches: branches,\r\n        branchPreferences: branchPreferences,\r\n        currentEncounter: currentEncounter\r\n      }\r\n    } as any);\r\n  }\r\n\r\n  private calculateBranchPreferences(branches: Encounter[], players: Player[]): { [branchName: string]: Player[] } {\r\n    const preferences: { [branchName: string]: Player[] } = {};\r\n    \r\n    branches.forEach(branch => {\r\n      preferences[branch.name] = [];\r\n      const expectedTags = this.encounterTagsExpected[branch.name] || [];\r\n      const collectedTags = this.encounterTagsCollected[branch.name] || [];\r\n      \r\n      players.forEach(player => {\r\n        const score = this.calculatePlayerBranchScore(player, expectedTags, collectedTags);\r\n        if (score > 0) {\r\n          preferences[branch.name].push(player);\r\n        }\r\n      });\r\n    });\r\n    \r\n    // Ensure each player has at least one preference (random if none)\r\n    players.forEach(player => {\r\n      const hasPreference = Object.values(preferences).some(prefs => prefs.includes(player));\r\n      if (!hasPreference) {\r\n        const randomBranch = branches[Math.floor(Math.random() * branches.length)];\r\n        preferences[randomBranch.name].push(player);\r\n      }\r\n    });\r\n    \r\n    return preferences;\r\n  }\r\n\r\n  private calculatePlayerBranchScore(player: Player, expectedTags: Tag[], collectedTags: Tag[]): number {\r\n    let score = 0;\r\n    \r\n    // Higher score for more collected tags\r\n    const collectedCount = collectedTags.length;\r\n    if (collectedCount >= 3) score += 4;\r\n    else if (collectedCount >= 1) score += 2;\r\n    else return 0; // Never consider branches with zero collected tags\r\n      // Factor in player preferences\r\n    expectedTags.forEach(tag => {\r\n      const preference = player.preferences.find((pref: [Tag, ATTITUDE]) => pref[0].name === tag.name);\r\n      if (preference) {\r\n        score += preference[1]; // ATTITUDE.LIKE = 1, ATTITUDE.HATE = -1\r\n      }\r\n    });\r\n    \r\n    return Math.max(0, score);\r\n  }\r\n\r\n  private handleNextEncounterSelection(selectedBranch: Encounter): void {\r\n    // Get the current encounter branches for evaluation\r\n    const currentEncounter = this.campaignManager.getCurrentEncounter();\r\n    const branches = currentEncounter?.branches || [];\r\n    \r\n    // Let PartyManager handle all encounter selection effects and advancement\r\n    this.appManager.getPartyManager().handleNextEncounterSelection(selectedBranch, branches, this);\r\n  }\r\n\r\n  get cashedInCollections(): string[] {\r\n    return this._cashedInCollections;\r\n  }\r\n\r\n  set cashedInCollections(value: string[]) {\r\n    this._cashedInCollections = value;\r\n  }\r\n\r\n  cashInCollection(collectionName: string): void {\r\n    if (!this._cashedInCollections.includes(collectionName)) {\r\n      this.chatManager.triggerCollectionCompleteChat(collectionName);\r\n      this._cashedInCollections.push(collectionName);\r\n    }\r\n  }\r\n\r\n  isCollectionCashedIn(collectionName: string): boolean {\r\n    return this._cashedInCollections.includes(collectionName);\r\n  }\r\n\r\n  getAvailableCollectionRewards(): number {\r\n    const { TAG_COLLECTIONS } = require('../consts/tagCollections');\r\n    const completedCollections = TAG_COLLECTIONS.filter((c: any) =>\r\n      c.tags.every((t: Tag) => this._collectedTags.some((ct: Tag) => ct.name === t.name))\r\n    );\r\n    return completedCollections.filter((c: any) => !this.isCollectionCashedIn(c.name)).length;\r\n  }\r\n}\r\n\r\nexport default TagManager;","import { CHAT_TYPE, Quest, QuestNode } from \"../models\";\r\n\r\n\r\n\r\nexport const RICKY: Quest = {\r\n    id: \"ricky\",\r\n    name: \"Tricky Rose\",\r\n    description: \"A fast-talking merchant with a dirty velvet coat has a job for you...\",\r\n    icon: \"rickyrose\",\r\n    cost: [\r\n        { type: \"exhaustion\", amount: 5 },\r\n    ],\r\n    rewards: [\r\n        { type: \"score\", amount: 5 },\r\n        { type: \"treasure\", amount: 2 }\r\n    ]\r\n    ,\r\n    playerChoices: [\r\n        { \r\n            name: \"Claim the Reward\", \r\n            description: \"Deliver Ricky's Cargo and Get the Reward\",\r\n            conversation: [{\r\n                message: \"You deliver the cargo to Ricky and he pays you handsomely.\",\r\n                speaker: { type: CHAT_TYPE.DM, id: 0 },\r\n            }],\r\n        },\r\n    ],\r\n    startingNode: {\r\n        tag: { name: \"Ricky Rose\" },\r\n        conversation: [{\r\n            message: \"Ricky Rose is a fast-talking merchant with a dirty velvet coat. He has a job for you that involves some risk, but the rewards could be worth it. Are you interested in hearing more?\",\r\n            speaker:\r\n                { type: CHAT_TYPE.DM, id: 0 },\r\n        }],\r\n        children: [\r\n            {\r\n                tag: { name: \"Mark's Menagerie\" },\r\n                conversation: [{\r\n                    message: \"Mark's Menagerie blah blah\",\r\n                    speaker: { type: CHAT_TYPE.DM, id: 1 }\r\n                }],\r\n                children: [{\r\n                    tag: { name: \"Cargo\" },\r\n                    conversation: [{\r\n                        message: \"You smuggle some crazy cargo for ricky.\",\r\n                        speaker: { type: CHAT_TYPE.DM, id: 1 }\r\n                    }],\r\n                    children: [],\r\n                }]\r\n            },\r\n\r\n        ]\r\n\r\n    }\r\n}\r\n\r\nexport const RICKY2: Quest = {\r\n    id: \"rockpepper\",\r\n    name: \"Rock Pepper Scissors\",\r\n    description: \"The Spicer's guild will reward anyone who can find who is stealing rock pepper.\",\r\n    icon: \"theface\",\r\n    cost: [\r\n        { type: \"exhaustion\", amount: 15 },\r\n        \r\n    ],\r\n    rewards: [\r\n        { type: \"score\", amount: 10 },\r\n        \r\n    ],\r\n    startingNode: {\r\n        tag: { name: \"Shadowy Figure\" },\r\n        conversation: [{\r\n            message: \"A shadowy figure approaches\",\r\n            speaker:\r\n                { type: CHAT_TYPE.DM, id: 0 },\r\n        },{\r\n            message: \"I ATTACK!\",\r\n            speaker:\r\n                { type: CHAT_TYPE.CHARACTER, id: 0 },\r\n        },{\r\n            message: \"'Hold on there, I am not your enemy!' The figure pulls back it's hood to reveal a wide moustache, the signature look for a member of the spicers guild. He goes on to explain that soeone has been stealing rock pepper from the guild and they will offer a reward to anyone who can find out who is behind it.\",\r\n            speaker:\r\n                { type: CHAT_TYPE.DM, id: 0 },\r\n        },{\r\n            message: \"I ACCEPT!\",\r\n            speaker:\r\n                { type: CHAT_TYPE.CHARACTER, id: 0 },\r\n        } \r\n    ],\r\n        children: [\r\n            {\r\n                tag: { name: \"Pepper Pots\" },\r\n                conversation: [{\r\n                    message: \"A discarded pot is found in a dark corner.\",\r\n                    speaker: { type: CHAT_TYPE.DM, id: 1 }\r\n                },{\r\n                    message: \"I peer inside.\",\r\n                    speaker: { type: CHAT_TYPE.CHARACTER, id: 2 }\r\n                }, {\r\n                    message: \"inside is a discarded hankerchief with the intials 'R.R.' and a pair of small, specialized scissors.\",\r\n                    speaker: { type: CHAT_TYPE.DM, id: 1 }\r\n                }, {\r\n                    message: \"I'm going to smell the hankerchief and lick the scissors.\",\r\n                    speaker: { type: CHAT_TYPE.CHARACTER, id: 2 }\r\n                }, {\r\n                    message: \"...\",\r\n                    speaker: { type: CHAT_TYPE.PLAYER, id: 0 }\r\n                }, {\r\n                    message: \"The hankerchief smells like clove-scented cologne and the scissors have a faint peppery flavor which immediately becomes very spicy!\",\r\n                    speaker: { type: CHAT_TYPE.DM, id: 0 }\r\n                }\r\n            ],\r\n                children: [{\r\n                    tag: { name: \"Spicy Meet\" },\r\n                    conversation: [{\r\n                        message: \"The Spicer's guild member approaches again and asks if you have found any information.\",\r\n                        speaker: { type: CHAT_TYPE.DM, id: 1 }\r\n                    }],\r\n                    children: [],\r\n                }]\r\n            },\r\n\r\n        ]\r\n\r\n    }\r\n}\r\n\r\n\r\n\r\n/*\r\n*\r\nexport interface QuestReward {\r\n  type: string; // e.g., 'item', 'xp', 'gold'\r\n  amount: number;\r\n  description?: string; // Optional description of the reward\r\n}\r\nexport interface Quest {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  icon: string;\r\n  cost: QuestCost[];\r\n  rewards: QuestReward[];\r\n}\r\n\r\nexport interface QuestNode {\r\n  children: QuestNode[];\r\n  tag: Tag;\r\n  conversation: ChatMessage; // Optional conversation associated with the quest\r\n}\r\n*/","import { EventEmitter } from 'events';\r\nimport { Quest, QuestNode, Tag, ATTITUDE, Player, EncounterFlavorTag, FlavorTagSource } from '../models';\r\nimport { RICKY, RICKY2 } from '../consts/quests';\r\n\r\ninterface ActiveQuest {\r\n  quest: Quest;\r\n  currentNode: QuestNode;\r\n  completedTags: string[];\r\n}\r\n\r\ninterface PlayerPreference {\r\n  playerId: number;\r\n  optionIndex: number;\r\n  attitude: ATTITUDE;\r\n}\r\n\r\nclass QuestManager extends EventEmitter {\r\n  private activeQuests: Map<string, ActiveQuest> = new Map();\r\n  private availableQuests: Quest[] = [RICKY, RICKY2];\r\n\r\n  getAvailableQuests(): Quest[] {\r\n    return this.availableQuests.filter(quest => !this.activeQuests.has(quest.id));\r\n  }\r\n\r\n  getActiveQuests(): ActiveQuest[] {\r\n    return Array.from(this.activeQuests.values());\r\n  }\r\n\r\n  launchQuest(questId: string): boolean {\r\n    const quest = this.availableQuests.find(q => q.id === questId);\r\n    if (!quest || this.activeQuests.has(questId)) {\r\n      return false;\r\n    }\r\n\r\n    this.activeQuests.set(questId, {\r\n      quest,\r\n      currentNode: quest.startingNode,\r\n      completedTags: []\r\n    });\r\n\r\n\r\n\r\n    this.emit('questLaunched', quest);\r\n    return true;\r\n  }\r\n\r\n  isQuestActive(questId: string): boolean {\r\n    return this.activeQuests.has(questId);\r\n  }\r\n\r\n  getCurrentQuestTags(): EncounterFlavorTag[] {\r\n    const questTags: EncounterFlavorTag[] = [];\r\n\r\n    for (const activeQuest of this.activeQuests.values()) {\r\n      // Add tags from current node's children\r\n      for (const child of activeQuest.currentNode.children) {\r\n        const isTerminal = child.children.length === 0;\r\n        questTags.push({\r\n          tag: child.tag,\r\n          source: isTerminal ? FlavorTagSource.QUEST_TERMINAL : FlavorTagSource.QUEST,\r\n          theme: 'none' as any // Will be styled with bright pink\r\n        });\r\n      }\r\n    }\r\n\r\n    return questTags;\r\n  }\r\n\r\n  getOutstandingQuestTags(): Tag[] {\r\n    const outstandingTags: Tag[] = [];\r\n\r\n    for (const activeQuest of this.activeQuests.values()) {\r\n      // Add tags from current node's children that haven't been completed\r\n      for (const child of activeQuest.currentNode.children) {\r\n        if (!activeQuest.completedTags.includes(child.tag.name)) {\r\n          outstandingTags.push(child.tag);\r\n        }\r\n      }\r\n    }\r\n\r\n    return outstandingTags;\r\n  }\r\n\r\n  getExhaustionForQuest(questId: string): number {\r\n    const quest = this.getQuestById(questId);\r\n    if (!quest) return 0;\r\n    let totalCost: number = 0;\r\n    quest.cost.forEach(cost => {\r\n      if (cost.type === 'exhaustion') {\r\n        totalCost += cost.amount;\r\n      }\r\n    });\r\n    return totalCost;\r\n  }\r\n\r\n  getQuestById(questId: string): Quest | null {\r\n    const activeQuest = this.activeQuests.get(questId);\r\n    if (activeQuest) return activeQuest.quest;\r\n    return this.availableQuests.find(q => q.id === questId) || null;\r\n  }\r\n\r\n  advanceQuest(questId: string, tagName: string): QuestNode | null {\r\n    const activeQuest = this.activeQuests.get(questId);\r\n    if (!activeQuest) return null;\r\n\r\n    // Find the node with the matching tag in the entire quest tree\r\n    const targetNode = this.findNodeByTag(activeQuest.quest.startingNode, tagName);\r\n    if (!targetNode) return null;\r\n\r\n    // Mark the tag as completed if not already done\r\n    if (!activeQuest.completedTags.includes(tagName)) {\r\n      activeQuest.completedTags.push(tagName);\r\n    }\r\n\r\n    // If the exposed tag matches a child of the current node, advance to that child\r\n    const matchingChild = activeQuest.currentNode.children.find(child => child.tag.name === tagName);\r\n    if (matchingChild) {\r\n      // Advance to the child node\r\n      activeQuest.currentNode = matchingChild;\r\n      \r\n      if (matchingChild.children.length === 0) {\r\n        // This is a terminal node\r\n        this.emit('questTerminalReached', { quest: activeQuest.quest, node: matchingChild });\r\n      } else {\r\n        this.emit('questAdvanced', { quest: activeQuest.quest, node: matchingChild });\r\n      }\r\n      \r\n      return matchingChild;\r\n    }\r\n\r\n    // If the exposed tag matches the current node itself, just mark as visited\r\n    // This typically happens when showing the conversation for the current node\r\n    if (activeQuest.currentNode.tag.name === tagName) {\r\n      this.emit('questAdvanced', { quest: activeQuest.quest, node: activeQuest.currentNode });\r\n      return activeQuest.currentNode;\r\n    }\r\n\r\n    // Tag doesn't match current progression - this shouldn't normally happen\r\n    console.warn(`Quest ${questId}: Tag \"${tagName}\" doesn't match current quest progression from node \"${activeQuest.currentNode.tag.name}\"`);\r\n    return null;\r\n  }\r\n\r\n  getQuestForTag(tagName: string): { quest: Quest; node: QuestNode } | null {\r\n    // Search in all active quests\r\n    for (const activeQuest of this.activeQuests.values()) {\r\n      const foundNode = this.findNodeByTag(activeQuest.quest.startingNode, tagName);\r\n      if (foundNode) {\r\n        return { quest: activeQuest.quest, node: foundNode };\r\n      }\r\n    }\r\n    \r\n    // Also search in available quests (for initial quest activation)\r\n    for (const quest of this.availableQuests) {\r\n      const foundNode = this.findNodeByTag(quest.startingNode, tagName);\r\n      if (foundNode) {\r\n        return { quest, node: foundNode };\r\n      }\r\n    }\r\n    \r\n    return null;\r\n  }\r\n\r\n  // Helper method to recursively find a node by tag name\r\n  private findNodeByTag(node: QuestNode, tagName: string): QuestNode | null {\r\n    if (node.tag.name === tagName) {\r\n      return node;\r\n    }\r\n    \r\n    for (const child of node.children) {\r\n      const found = this.findNodeByTag(child, tagName);\r\n      if (found) return found;\r\n    }\r\n    \r\n    return null;\r\n  }\r\n\r\n  generatePlayerPreferences(numOptions: number, players: Player[]): PlayerPreference[] {\r\n    const preferences: PlayerPreference[] = [];\r\n    const attitudes = [ATTITUDE.LIKE, ATTITUDE.HATE, ATTITUDE.NEUTRAL];\r\n\r\n    for (let i = 0; i < numOptions; i++) {\r\n      for (const player of players) {\r\n        const randomAttitude = attitudes[Math.floor(Math.random() * 3)];\r\n        preferences.push({\r\n          playerId: player.id,\r\n          optionIndex: i,\r\n          attitude: randomAttitude\r\n        });\r\n      }\r\n    }\r\n\r\n    return preferences;\r\n  }\r\n\r\n  completeQuest(questId: string): void {\r\n    if (this.activeQuests.has(questId)) {\r\n      const activeQuest = this.activeQuests.get(questId)!;\r\n      this.activeQuests.delete(questId);\r\n      this.emit('questCompleted', activeQuest.quest);\r\n    }\r\n  }\r\n\r\n  // New methods for quest modal system\r\n  isQuestComplete(questId: string): boolean {\r\n    const activeQuest = this.activeQuests.get(questId);\r\n    if (!activeQuest) return false;\r\n    \r\n    // Quest is complete if current node has no children (terminal node)\r\n    return activeQuest.currentNode.children.length === 0;\r\n  }\r\n\r\n  getNextQuestNode(questId: string): QuestNode | null {\r\n    const activeQuest = this.activeQuests.get(questId);\r\n    if (!activeQuest || activeQuest.currentNode.children.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    // Return the first child node as the next topic\r\n    return activeQuest.currentNode.children[0];\r\n  }\r\n\r\n  activateQuest(questId: string): boolean {\r\n    // This is the same as launchQuest but with different name for clarity\r\n    return this.launchQuest(questId);\r\n  }\r\n\r\n  getCollectedTagsForQuest(questId: string): Tag[] {\r\n    const activeQuest = this.activeQuests.get(questId);\r\n    if (!activeQuest) return [];\r\n\r\n    // Find all nodes that have been completed\r\n    const collectedTags: Tag[] = [];\r\n    const findCompletedTags = (node: QuestNode, visited: Set<string> = new Set()) => {\r\n      if (visited.has(node.tag.name)) return;\r\n      visited.add(node.tag.name);\r\n\r\n      if (activeQuest.completedTags.includes(node.tag.name)) {\r\n        collectedTags.push(node.tag);\r\n      }\r\n\r\n      for (const child of node.children) {\r\n        findCompletedTags(child, visited);\r\n      }\r\n    };\r\n\r\n    findCompletedTags(activeQuest.quest.startingNode);\r\n    return collectedTags;\r\n  }\r\n}\r\n\r\nexport default QuestManager;\r\n","import { EventEmitter } from 'events';\r\nimport CampaignManager from './campaignManager';\r\nimport PlayerManager from './playerManager';\r\nimport SessionManager from './sessionManager';\r\nimport PartyManager from './partyManager';\r\nimport UiManager from './uiManager';\r\nimport DataManager from './dataManager';\r\nimport { APP_STATE } from \"../consts/states\";\r\nimport CharacterManager from './characterManager';\r\nimport TutorialManager from './tutorialManager';\r\nimport ChatManager from './chatManager';\r\nimport ChatEventManager from './chatEventManager';\r\nimport CombatManager from './combatManager';\r\nimport { SESSION_STATE } from '../models';\r\nimport TownManager from './townManager';\r\nimport TagManager from './tagManager';\r\nimport QuestManager from './questManager';\r\n\r\n\r\n\r\nconst ENABLE_TUTORIAL = false;\r\n\r\n\r\nclass AppManager extends EventEmitter {\r\n\r\n\r\n  private _state: APP_STATE = APP_STATE.MAIN_MENU;\r\n  private lastTime: number = 0;\r\n\r\n  private campaignManager : CampaignManager;\r\n  private playerManager : PlayerManager;\r\n  private sessionManager : SessionManager;\r\n  private dataManager :   DataManager;\r\n  private partyManager :   PartyManager;\r\n  private uiManager : UiManager;\r\n  private characterManager : CharacterManager;\r\n  private tutorialManager : TutorialManager;\r\n  private chatManager : ChatManager;\r\n  private chatEventManager : ChatEventManager;\r\n  private combatManager : CombatManager;\r\n  private townManager : TownManager\r\n  private tagManager : TagManager;\r\n  private questManager : QuestManager;\r\n  constructor() {\r\n    super();\r\n    // First phase: Initialize managers that don't have circular dependencies\r\n    this.playerManager = new PlayerManager(this);\r\n    this.campaignManager = new CampaignManager(this);\r\n    this.characterManager = new CharacterManager(this);\r\n    this.sessionManager = new SessionManager();\r\n    this.dataManager = new DataManager(this);\r\n    this.partyManager = new PartyManager(this);\r\n    this.uiManager = new UiManager(this);\r\n    this.tutorialManager = new TutorialManager(this);\r\n    this.combatManager = new CombatManager(this);\r\n   \r\n\r\n    // Second phase: Initialize managers with circular dependencies\r\n    this.tagManager = new TagManager(this.campaignManager, this.playerManager, undefined, this);\r\n    this.chatManager = new ChatManager(this);\r\n    this.chatEventManager = new ChatEventManager(this);\r\n    this.questManager = new QuestManager();\r\n    \r\n    // Third phase: Resolve circular dependencies after both are created\r\n    this.tagManager.setChatManager(this.chatManager);\r\n    this.townManager = new TownManager(this);\r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.state = APP_STATE.MAIN_MENU;\r\n   \r\n  \r\n    this.playerManager.init();\r\n    this.characterManager.init();\r\n\r\n\r\n    if(ENABLE_TUTORIAL) {\r\n    setTimeout(() => {\r\n      this.tutorialManager.startTutorial('MAIN_MENU');\r\n    }, 100);\r\n\r\n  }\r\n    this.startGameLoop();\r\n\r\n    this.initiateQuickStartSetup();\r\n    this.state = APP_STATE.SESSION_OVERVIEW;\r\n    \r\n  }\r\n\r\n\r\n  \r\n  initiateQuickStartSetup() {\r\n\r\n    this.playerManager.initiateQuickStart();\r\n    this.characterManager.initiateQuickStart();\r\n    this.campaignManager.initiateQuickStart();\r\n    this.chatManager.startSessionEvent();\r\n\r\n    // Show welcome modal\r\n    setTimeout(() => {\r\n    this.uiManager.showWelcomeModal();\r\n    this.chatManager.startWelcomeConversation();\r\n    }, 1000);\r\n\r\n  }\r\n\r\n\r\n  startGameLoop() {\r\n    const gameLoop = (currentTime: number) => {\r\n      const timeDt = currentTime - this.lastTime;\r\n      this.lastTime = currentTime;\r\n\r\n      this.update(timeDt);\r\n\r\n      requestAnimationFrame(gameLoop);\r\n    };\r\n\r\n    requestAnimationFrame(gameLoop);\r\n  }\r\n\r\n  update(timeDt: number) {\r\n   // console.log(`Updating game state with time delta: ${timeDt}ms`);\r\n    // Update game state and pass timeDt to other controllers\r\n    this.uiManager?.update(timeDt);\r\n  }\r\n\r\n // Getter for state\r\n get state(): APP_STATE {\r\n  return this._state;\r\n}\r\n\r\n// Setter for state\r\nset state(newState: APP_STATE) {\r\n  console.log(\"Changing state from\", this._state, \"to\", newState);\r\n switch(this._state){\r\n\r\n    case APP_STATE.PLAYER_RECRUITMENT:\r\n      this.playerManager.acceptSelectedPlayers();  \r\n    break;\r\n    case APP_STATE.MAIN_MENU:\r\n    case APP_STATE.CHARACTER_CREATION:\r\n    case APP_STATE.CAMPAIGN_SETUP:\r\n      console.log(\"Changing state from \", this._state);\r\n      break;\r\n }\r\n\r\n switch(newState){\r\n  case APP_STATE.MAIN_MENU:\r\n    break;\r\n  case APP_STATE.PLAYER_RECRUITMENT:\r\n    \r\n    this.tutorialManager.startTutorial('PLAYER_RECRUITMENT');\r\n    break;\r\n  case APP_STATE.CHARACTER_CREATION:\r\n    this.tutorialManager.startTutorial('CHARACTER_CREATION');\r\n    break;\r\n  case APP_STATE.CAMPAIGN_SETUP:\r\n    this.tutorialManager.startTutorial('CAMPAIGN_SETUP');\r\n    break;\r\n  case APP_STATE.SESSION_OVERVIEW:\r\n    //this.tutorialManager.startTutorial('SESSION_PREP');\r\n    this.campaignManager.setSessionState(SESSION_STATE.LOCATION_INTRO);\r\n    break;\r\n  case APP_STATE.SESSION:\r\n   // this.tutorialManager.startTutorial('SESSION');\r\n    this.campaignManager.setSessionState(SESSION_STATE.INTRO_EVENTS);\r\n    //this.chatManager.startSessionEvent();\r\n    break;\r\n\r\n}\r\n  this._state = newState;\r\n  this.emit('stateChange');\r\n}\r\n\r\nadvanceState() {\r\n  this.state = this.dataManager?.getStateProps().nextState || APP_STATE.MAIN_MENU;\r\n}\r\n\r\ngetUiManager() {\r\n  return this.uiManager;\r\n}\r\ngetDataManager() {\r\n  return this.dataManager;\r\n}\r\n\r\ngetPlayerManager () {\r\n  return this.playerManager;\r\n}\r\n\r\ngetCharacterManager() {\r\n  return this.characterManager;\r\n}\r\n\r\ngetSessionManager() {\r\n  return this.sessionManager;\r\n};\r\n\r\ngetPartyManager() {\r\n\r\n  return this.partyManager;\r\n};\r\n\r\ngetTagManager() {\r\n  return this.tagManager;\r\n}\r\n\r\ngetCombatManager() {\r\n  return this.combatManager;\r\n}\r\n\r\ngetCampaignManager() {\r\n  return this.campaignManager;\r\n};\r\n\r\ngetTutorialManager() {\r\n  return this.tutorialManager;\r\n}\r\n\r\ngetChatManager() {\r\n  return this.chatManager;\r\n}\r\n\r\ngetChatEventManager() {\r\n  return this.chatEventManager;\r\n}\r\n\r\ngetTownManager() {\r\n  return this.townManager;\r\n}\r\n\r\ngetQuestManager() {\r\n  return this.questManager;\r\n}\r\n\r\n\r\n}\r\n\r\nexport default AppManager;","import React from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport './index.scss';\r\nimport App from './App';\r\n\r\nimport AppManager from './managers/appManager';\r\n\r\nimport { AppManagerProvider, CampaignManagerProvider, CharacterManagerProvider, DataManagerProvider, PartyManagerProvider, PlayerManagerProvider, SessionManagerProvider, UiManagerProvider } from './components/managerContexts';\r\n\r\n// Initialize managers\r\n\r\nconst appManager = new AppManager();\r\n\r\nconst dataManager = appManager.getDataManager();\r\nconst campaignManager = appManager.getCampaignManager();\r\nconst sessionManager = appManager.getSessionManager();\r\nconst PartyManager = appManager.getPartyManager();\r\nconst uiManager = appManager.getUiManager();\r\nconst characterManager = appManager.getCharacterManager();\r\nconst playerManager = appManager.getPlayerManager();\r\n\r\n\r\nconst root = ReactDOM.createRoot(document.getElementById('root') as HTMLElement);\r\nroot.render(\r\n  <React.StrictMode>\r\n    <CharacterManagerProvider manager={characterManager}>\r\n      <PlayerManagerProvider manager={playerManager}>\r\n        <AppManagerProvider manager={appManager}>\r\n          <DataManagerProvider manager={dataManager}>\r\n            <CampaignManagerProvider manager={campaignManager}>\r\n              <SessionManagerProvider manager={sessionManager}>\r\n                <PartyManagerProvider manager={PartyManager}>\r\n                  <UiManagerProvider manager={uiManager}>\r\n                    <App />\r\n                  </UiManagerProvider>\r\n                </PartyManagerProvider>\r\n              </SessionManagerProvider>\r\n            </CampaignManagerProvider>\r\n          </DataManagerProvider>\r\n        </AppManagerProvider>\r\n      </PlayerManagerProvider>\r\n    </CharacterManagerProvider>\r\n  </React.StrictMode>\r\n);"],"names":["TAG_COLLECTIONS","name","tags","TAG","ARMOR","WEAPONS","ARCHERY","FIGHTING","type","unlocks","BATTLES","theme","chat","reward","GOLD","TREASURE","GEMS","GOSSIP","SOCIALIZING","MAGIC","SPELLS","BOOKS","HUMANS","ELVES","DWARVES","HALFLINGS","DEER","COWS","BEARS","WOLVES","TRADING","TOWN","GOBLINS","DRAGONS","UNDEAD","BORING_THINGS","FARMING","FURNITURE","TREES","FOLIAGE","GRASS","BEER","WINE","FIRE","FOOD","CULTISTS","RELIGION","PRIESTS","CHURCHES","RITUALS","DUNGEON","RUINS","CAVES","UNDERGROUND","DOGS","CATS","HORSES","FALCONS","preference","PREFERENCE","MAIN","friendly","category","ORCS","HALF_ELVES","HUNTERS","MERCHANTS","enemy","GNOMES","BEASTS","BANDITS","MONSTERS","PUZZLES","STRATEGY","START","EXPLORATION","TREASURE_HUNTING","POLITICS","TOOLS","CRAFTING","HEALING","CURSE","EVIL","TRAPS","MYSTERY","ARTIFACTS","CITIES","WILDERNESS","FORESTS","DESERTS","SWAMPS","OCEANS","ISLANDS","VILLAGES","CASTLES","CAVE","PLAINS","TAVERNS","BEACHES","BRIDGES","BUILDINGS","CAMP","TOWER","CABIN","SHIPS","travel","ROADS","attributeDefault","TABLES","BARRELS","CANDLES","DRINKS","BELL","COULDRON","ROPE","STATUES","RUNES","FESTIVALS","TOURNAMENTS","QUESTS","MYSTERIES","DISASTERS","CELEBRATIONS","NOBILITY","DARKNESS","WATER","FOG","SMOKE","MOUNTAINS","RIVERS","LAKES","BOULDERS","CHICKENS","CLICKING","Graph","constructor","nodes","edges","this","Map","addNode","node","set","addEdge","from","to","weight","_this$edges$get","get","getNode","TAG_TYPE","ATTITUDE","ATTRIBUTE_TYPE","ATTRIBUTE_CONTRIBUTOR","NOTEBOOK_CATEGORY","ENCOUNTER","LOCATION","CHARACTER","PLAYER","MESSAGE","TUTORIAL","TOC","GROUP","NAV_ENTRY","CAMPAIGN","PLAYER_RECRUITMENT","CHARACTER_ASSIGNMENT","CHAT_TYPE","CHAT_EVENT_TYPE","SESSION_STATE","FlavorTagSource","FlavorTagTheme","TAGS_TYPE","PERIL_INDEX","REWARD_TYPE","BUILDING_EFFECT_TYPE","BUILDING_TYPE","TRAVEL_LENGTH","TRAVEL_OPTION","ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","prototype","call","ownKeys","Object","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","value","EventEmitter","init","module","exports","once","emitter","Promise","resolve","reject","errorListener","err","removeListener","resolver","slice","arguments","eventTargetAgnosticAddListener","handler","flags","on","addErrorHandlerIfEventEmitter","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","prepend","m","events","existing","warning","create","newListener","emit","unshift","push","length","warned","w","Error","String","count","console","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","bind","_listeners","unwrap","evlistener","arr","ret","Array","i","unwrapListeners","arrayClone","listenerCount","n","copy","addEventListener","wrapListener","arg","removeEventListener","defineProperty","enumerable","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","message","context","len","listeners","addListener","prependListener","prependOnceListener","list","position","originalListener","shift","index","pop","spliceOne","off","removeAllListeners","key","keys","rawListeners","eventNames","aa","require","ca","p","a","b","c","encodeURIComponent","da","Set","ea","fa","ha","add","ia","window","document","createElement","ja","hasOwnProperty","ka","la","ma","v","d","e","f","g","acceptsBooleans","attributeName","attributeNamespace","mustUseProperty","propertyName","sanitizeURL","removeEmptyString","z","split","forEach","toLowerCase","ra","sa","toUpperCase","ta","pa","qa","test","oa","removeAttribute","setAttribute","setAttributeNS","replace","xlinkHref","ua","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","va","Symbol","for","wa","ya","za","Aa","Ba","Ca","Da","Ea","Fa","Ga","Ha","Ia","Ja","iterator","Ka","La","A","assign","Ma","stack","trim","match","Na","Oa","prepareStackTrace","construct","l","h","k","displayName","includes","Pa","tag","render","Qa","$$typeof","_context","_payload","_init","Ra","Sa","Ta","nodeName","Va","_valueTracker","getOwnPropertyDescriptor","configurable","getValue","setValue","stopTracking","Ua","Wa","checked","Xa","activeElement","body","Ya","defaultChecked","defaultValue","_wrapperState","initialChecked","Za","initialValue","controlled","ab","bb","cb","db","ownerDocument","eb","isArray","fb","options","selected","defaultSelected","disabled","gb","dangerouslySetInnerHTML","children","hb","ib","jb","textContent","kb","lb","mb","nb","namespaceURI","innerHTML","valueOf","toString","firstChild","removeChild","appendChild","MSApp","execUnsafeLocalFunction","ob","lastChild","nodeType","nodeValue","pb","animationIterationCount","aspectRatio","borderImageOutset","borderImageSlice","borderImageWidth","boxFlex","boxFlexGroup","boxOrdinalGroup","columnCount","columns","flex","flexGrow","flexPositive","flexShrink","flexNegative","flexOrder","gridArea","gridRow","gridRowEnd","gridRowSpan","gridRowStart","gridColumn","gridColumnEnd","gridColumnSpan","gridColumnStart","fontWeight","lineClamp","lineHeight","opacity","order","orphans","tabSize","widows","zIndex","zoom","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","strokeWidth","qb","rb","sb","style","indexOf","setProperty","charAt","substring","tb","menuitem","area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr","ub","vb","is","wb","xb","srcElement","correspondingUseElement","parentNode","yb","zb","Ab","Bb","Cb","stateNode","Db","Eb","Fb","Gb","Hb","Ib","Jb","Kb","Lb","Mb","Nb","onError","Ob","Pb","Qb","Rb","Sb","Tb","Vb","alternate","return","Wb","memoizedState","dehydrated","Xb","Zb","child","sibling","current","Yb","$b","ac","unstable_scheduleCallback","bc","unstable_cancelCallback","cc","unstable_shouldYield","dc","unstable_requestPaint","B","unstable_now","ec","unstable_getCurrentPriorityLevel","fc","unstable_ImmediatePriority","gc","unstable_UserBlockingPriority","hc","unstable_NormalPriority","ic","unstable_LowPriority","jc","unstable_IdlePriority","kc","lc","oc","Math","clz32","pc","qc","log","LN2","rc","sc","tc","uc","pendingLanes","suspendedLanes","pingedLanes","entangledLanes","entanglements","vc","xc","yc","zc","Ac","eventTimes","Cc","C","Dc","Ec","Fc","Gc","Hc","Ic","Jc","Kc","Lc","Mc","Nc","Oc","Pc","Qc","Rc","Sc","delete","pointerId","Tc","nativeEvent","blockedOn","domEventName","eventSystemFlags","targetContainers","Vc","Wc","priority","isDehydrated","containerInfo","Xc","Yc","dispatchEvent","Zc","$c","ad","bd","cd","ReactCurrentBatchConfig","dd","ed","transition","fd","gd","hd","id","Uc","stopPropagation","jd","kd","ld","md","nd","od","keyCode","charCode","pd","qd","rd","_reactName","_targetInst","currentTarget","isDefaultPrevented","defaultPrevented","returnValue","isPropagationStopped","preventDefault","cancelBubble","persist","isPersistent","wd","xd","yd","sd","eventPhase","bubbles","cancelable","timeStamp","Date","now","isTrusted","td","ud","view","detail","vd","Ad","screenX","screenY","clientX","clientY","pageX","pageY","ctrlKey","shiftKey","altKey","metaKey","getModifierState","zd","button","buttons","relatedTarget","fromElement","toElement","movementX","movementY","Bd","Dd","dataTransfer","Fd","Hd","animationName","elapsedTime","pseudoElement","Id","clipboardData","Jd","Ld","data","Md","Esc","Spacebar","Left","Up","Right","Down","Del","Win","Menu","Apps","Scroll","MozPrintableKey","Nd","Od","Alt","Control","Meta","Shift","Pd","Qd","fromCharCode","code","location","repeat","locale","which","Rd","Td","width","height","pressure","tangentialPressure","tiltX","tiltY","twist","pointerType","isPrimary","Vd","touches","targetTouches","changedTouches","Xd","Yd","deltaX","wheelDeltaX","deltaY","wheelDeltaY","wheelDelta","deltaZ","deltaMode","Zd","$d","ae","be","documentMode","ce","de","ee","fe","ge","he","ie","le","color","date","datetime","email","month","number","password","range","search","tel","text","time","url","week","me","ne","oe","event","pe","qe","re","se","te","ue","ve","we","xe","ye","ze","oninput","Ae","detachEvent","Be","Ce","attachEvent","De","Ee","Fe","He","Ie","Je","Ke","offset","nextSibling","Le","contains","compareDocumentPosition","Me","HTMLIFrameElement","contentWindow","href","Ne","contentEditable","Oe","focusedElem","selectionRange","documentElement","start","end","selectionStart","selectionEnd","min","defaultView","getSelection","extend","rangeCount","anchorNode","anchorOffset","focusNode","focusOffset","createRange","setStart","removeAllRanges","addRange","setEnd","element","left","scrollLeft","top","scrollTop","focus","Pe","Qe","Re","Se","Te","Ue","Ve","We","animationend","animationiteration","animationstart","transitionend","Xe","Ye","Ze","animation","$e","af","bf","cf","df","ef","ff","gf","hf","lf","mf","nf","Ub","instance","D","of","has","pf","qf","rf","random","sf","capture","passive","t","J","x","u","F","tf","uf","parentWindow","vf","wf","na","xa","$a","ba","je","char","ke","xf","yf","zf","Af","Bf","Cf","Df","Ef","__html","Ff","setTimeout","Gf","clearTimeout","Hf","Jf","queueMicrotask","then","catch","If","Kf","Lf","Mf","previousSibling","Nf","Of","Pf","Qf","Rf","Sf","Tf","Uf","E","G","Vf","H","Wf","Xf","Yf","contextTypes","__reactInternalMemoizedUnmaskedChildContext","__reactInternalMemoizedMaskedChildContext","Zf","childContextTypes","$f","ag","bg","getChildContext","cg","__reactInternalMemoizedMergedChildContext","dg","eg","fg","gg","hg","jg","kg","lg","mg","ng","og","pg","qg","rg","sg","tg","ug","vg","wg","xg","yg","I","zg","Ag","Bg","elementType","deletions","Cg","pendingProps","overflow","treeContext","retryLane","Dg","mode","Eg","Fg","Gg","memoizedProps","Hg","Ig","Jg","Kg","Lg","ref","_owner","_stringRef","refs","Mg","join","Ng","Og","Pg","Qg","props","Rg","implementation","Sg","Tg","q","r","y","next","done","Ug","Vg","Wg","Xg","Yg","Zg","$g","ah","_currentValue","bh","childLanes","ch","dependencies","firstContext","lanes","dh","eh","memoizedValue","fh","gh","hh","interleaved","ih","jh","kh","updateQueue","baseState","firstBaseUpdate","lastBaseUpdate","shared","pending","effects","lh","mh","eventTime","lane","payload","callback","nh","K","oh","ph","qh","rh","sh","th","uh","vh","wh","xh","yh","tagName","zh","Ah","Bh","L","Ch","revealOrder","Dh","Eh","_workInProgressVersionPrimary","Fh","ReactCurrentDispatcher","Gh","Hh","M","N","O","Ih","Jh","Kh","Lh","P","Mh","Nh","Oh","Ph","Qh","Rh","Sh","Th","baseQueue","queue","Uh","Vh","Wh","lastRenderedReducer","action","hasEagerState","eagerState","lastRenderedState","dispatch","Xh","Yh","Zh","$h","ai","getSnapshot","bi","ci","Q","di","lastEffect","stores","ei","fi","gi","hi","ii","destroy","deps","ji","ki","li","mi","ni","oi","pi","qi","ri","si","ti","ui","vi","wi","xi","yi","zi","Ai","Bi","readContext","useCallback","useContext","useEffect","useImperativeHandle","useInsertionEffect","useLayoutEffect","useMemo","useReducer","useRef","useState","useDebugValue","useDeferredValue","useTransition","useMutableSource","useSyncExternalStore","useId","unstable_isNewReconciler","identifierPrefix","Ci","defaultProps","Di","Ei","isMounted","_reactInternals","enqueueSetState","enqueueReplaceState","enqueueForceUpdate","Fi","shouldComponentUpdate","isPureReactComponent","Gi","contextType","updater","Hi","componentWillReceiveProps","UNSAFE_componentWillReceiveProps","Ii","getDerivedStateFromProps","getSnapshotBeforeUpdate","UNSAFE_componentWillMount","componentWillMount","componentDidMount","Ji","digest","Ki","Li","Mi","WeakMap","Ni","Oi","Pi","Qi","getDerivedStateFromError","componentDidCatch","Ri","componentStack","Si","pingCache","Ti","Ui","Vi","Wi","ReactCurrentOwner","Xi","Yi","Zi","$i","aj","compare","bj","cj","dj","baseLanes","cachePool","transitions","ej","fj","gj","hj","ij","UNSAFE_componentWillUpdate","componentWillUpdate","componentDidUpdate","jj","kj","pendingContext","lj","zj","Aj","Bj","Cj","mj","nj","oj","fallback","pj","qj","sj","dataset","dgst","tj","uj","_reactRetry","rj","subtreeFlags","vj","wj","isBackwards","rendering","renderingStartTime","last","tail","tailMode","xj","Dj","S","Ej","Fj","wasMultiple","multiple","suppressHydrationWarning","onClick","onclick","size","createElementNS","autoFocus","createTextNode","T","Gj","Hj","Ij","Jj","U","Kj","WeakSet","V","Lj","W","Mj","Nj","Pj","Qj","Rj","Sj","Tj","Uj","Vj","insertBefore","_reactRootContainer","Wj","X","Xj","Yj","Zj","onCommitFiberUnmount","componentWillUnmount","ak","bk","ck","dk","ek","isHidden","fk","gk","display","hk","ik","jk","kk","__reactInternalSnapshotBeforeUpdate","src","Vk","lk","ceil","mk","nk","ok","Y","Z","pk","qk","rk","sk","tk","Infinity","uk","vk","wk","xk","yk","zk","Ak","Bk","Ck","Dk","callbackNode","expirationTimes","expiredLanes","wc","callbackPriority","ig","Ek","Fk","Gk","Hk","Ik","Jk","Kk","Lk","Mk","Nk","Ok","finishedWork","finishedLanes","Pk","timeoutHandle","Qk","Rk","Sk","Tk","Uk","mutableReadLanes","Bc","Oj","onCommitFiberRoot","mc","onRecoverableError","Wk","onPostCommitFiberRoot","Xk","Yk","$k","isReactComponent","pendingChildren","al","mutableSourceEagerHydrationData","bl","cache","pendingSuspenseBoundaries","dl","el","fl","gl","hl","il","yj","Zk","kl","reportError","ll","_internalRoot","ml","nl","ol","pl","rl","ql","unmount","unstable_scheduleHydration","splice","querySelectorAll","JSON","stringify","form","sl","usingClientEntryPoint","Events","tl","findFiberByHostInstance","bundleType","version","rendererPackageName","ul","rendererConfig","overrideHookState","overrideHookStateDeletePath","overrideHookStateRenamePath","overrideProps","overridePropsDeletePath","overridePropsRenamePath","setErrorHandler","setSuspenseHandler","scheduleUpdate","currentDispatcherRef","findHostInstanceByFiber","findHostInstancesForRefresh","scheduleRefresh","scheduleRoot","setRefreshHandler","getCurrentFiber","reconcilerVersion","__REACT_DEVTOOLS_GLOBAL_HOOK__","vl","isDisabled","supportsFiber","inject","createPortal","cl","createRoot","unstable_strictMode","findDOMNode","flushSync","hydrate","hydrateRoot","hydratedSources","_getVersion","_source","unmountComponentAtNode","unstable_batchedUpdates","unstable_renderSubtreeIntoContainer","checkDCE","__self","__source","Fragment","jsx","jsxs","setState","forceUpdate","escape","_status","_result","default","Children","map","toArray","only","Component","Profiler","PureComponent","StrictMode","Suspense","act","cloneElement","createContext","_currentValue2","_threadCount","Provider","Consumer","_defaultValue","_globalName","createFactory","createRef","forwardRef","isValidElement","lazy","memo","startTransition","unstable_act","sortIndex","performance","setImmediate","startTime","expirationTime","priorityLevel","navigator","scheduling","isInputPending","MessageChannel","port2","port1","onmessage","postMessage","unstable_Profiling","unstable_continueExecution","unstable_forceFrameRate","floor","unstable_getFirstCallbackNode","unstable_next","unstable_pauseExecution","unstable_runWithPriority","delay","unstable_wrapCallback","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","__esModule","definition","o","obj","prop","toStringTag","imageMap","player_0","playerIcon0","player_1","playerIcon1","player_2","playerIcon2","player_3","playerIcon3","player_4","playerIcon4","player_5","playerIcon5","player_6","playerIcon6","player_7","playerIcon7","player_8","playerIcon8","player_9","playerIcon9","player_10","playerIcon10","human_1","humanIcon1","human_2","humanIcon2","dwarf_1","dwarfIcon1","dwarf_2","dwarfIcon2","elf_1","elfIcon1","elf_2","elfIcon2","halfOrc_1","halfOrcIcon1","halfOrc_2","halfOrcIcon2","halfElf_1","halfElfIcon1","halfElf_2","halfElfIcon2","halfling_1","halflingIcon1","halfling_2","halflingIcon2","main_menu","mainMenuBG","default_bg","defaultBg","campaign_bg","campaignBg","gameroom_bg","gameroomBg","cult_of_the_deep_1","cultOfTheDeep1","trolls_1","trolls1","millstone_mystery_1","millstoneMystery1","mountain_mystery","mm_l_oldMill","mm_TheOldMill","mm_l_quarry","mm_l_road","mm_l_entrance","mm_l_tunnel","mm_l_bridge","mm_l_beach","mm_l_townville","mm_e_millstone","mm_millstone","mm_e_road","mm_e_quarry","mm_e_tunnels","mm_e_bandits","mm_e_beach","mm_e_shipwreck","mm_e_fire","mm_e_townville","cd_l_underthewell","cd_l_lakeside","cd_l_lakesidebrewery","cd_l_lakesidecliffs","cd_l_sagewoodtavern","cd_l_sagewoodbrewery","cd_e_breweryexploration","cd_e_breweryfight","cd_e_bythelake","cd_e_lakesidecliffs","cd_e_underthewell","cd_e_sagewoodtavern","cd_e_sagewoodbrewery","mm_l_mountain_camp","mm_l_elven_town","mm_e_up_the_mountain","mm_e_pointed","mm_l_witch","mm_e_cabin","mm_l_tunnel23","mm_l_tunnel3","mm_e_dwarves","mm_e_fairlight","mm_l_fairlight","tutorial_mascot","imp","chat_imp","imp_icon","chat_dm","dm_icon","chat_die","number_die_4","number_die_6","number_die_8","number_die_10","number_die_12","number_die_20","number_die_100","combat_human","combat_cultists","combat_dragons","combat_dwarves","combat_elves","combat_goblins","combat_halflings","combat_humans","combat_orcs","combat_undead","combat_half_elves","combat_bandits","combat_beasts","combat_deer","combat_bear","icon_treasure1","icon_dmpoint","icon_playerpoint","event_combat","event_roleplay","event_puzzle","event_dungeon","event_perception","event_town","event_travel","event_challenge","event_trap","event_exposition","event_exploration","die_d4","die_d6","die_d20","rickyrose","theface","_ref","imageId","path","_jsx","alt","className","RACE","CHARACTER_CLASS","AVAILABILITY_RANGE","ENCOUNTER_EVENT_TYPE","LEVELUP_OPTION","PLAYER_EXP_LEVEL","daysOfWeek","abbreviation","fullName","availabiltyLegend","percentage","getColorFromPercentage","getSymbolForPercentage","dayData","legend","_jsxs","day","getDayPercentage","dayIndex","backgroundColor","legendEntry","classname","AppManagerContext","DataManagerContext","CampaignManagerContext","SessionManagerContext","PartyManagerContext","UiManagerContext","CharacterManagerContext","PlayerManagerContext","CharacterManagerProvider","manager","PlayerManagerProvider","_ref2","AppManagerProvider","_ref3","DataManagerProvider","_ref4","CampaignManagerProvider","_ref5","SessionManagerProvider","_ref6","PartyManagerProvider","_ref7","UiManagerProvider","_ref8","useCharacterManager","usePlayerManager","useAppManager","useCampaignManager","usePartyManager","useUiManager","APP_STATE","DEFAULT_STATE_CONFIG","nextState","MAIN_MENU","showCharacterBar","background_image_id","bg_transition_mode","secondary_bg_image_id","secondary_image_pos","STATE_CONFIG","CAMPAIGN_SETUP","CHARACTER_CREATION","SESSION_OVERVIEW","SESSION","SCORE","CHARACTER_READINESS_THRESHOLDS","VERY_UNREADY","UNREADY","READY_START","READY_END","PERFECT_START","PERFECT_END","READY_SECOND_START","READY_SECOND_END","OVERREADY","CHARACTER_READINESS_LEVEL","getCharacterReadinessLevel","experience","READY","PERFECT","getCharacterReadinessSymbol","GEAR","SWORD_1","attributes","COMBAT","MIRROR_SHIELD","WAND_5","HELPFUL_IMP","STONECUTTER","CLOAK_OF_LEVITATION","WAND_OF_MISSILES","GLOVES_OF_THE_SPIDER","getRaceAttributes","character","race","DWARF","ELF","HUMAN","HALFLING","HALF_ORC","HALF_ELF","NPC","getCombinedAttributes","includeHeroState","raceAttributes","gearAttributes","gear","_gear$attributes$ATTR","_gear$attributes$ATTR2","_gear$attributes$ATTR3","getGearAttributes","classAttributes","baseAttribute","level","getClassAttributes","character_class","getCombinedClassAttributes","combinedAttributes","_character$attributeL","_character$attributeL2","_character$attributeL3","attributeLoss","characterClass","oddLevel","evenLevel","CLERIC","DRUID","FIGHTER","PALADIN","ROGUE","WIZARD","isHeroCombatant","hero","AttributeDisplay","lostAttributes","collapsed","showAttributeLoss","characterManager","generateIcons","attributeType","icons","symbol","getUFAttributeSymbol","allIcons","flatMap","getUFAttributeName","overviewDisplay","combatManager","getCombatManager","npcAttributes","npcTag","getNPCAttributes","generateNPC","combinedattributesWithLoss","getGenericAttributesDisplay","getGearAttributesDisplay","getAttributesDisplay","_","ALL","getBackstoryElement","backstory","nbCompleted","filter","bs","completed","placeholdersNeeded","isSelected","onSelect","showAbilities","isAssigned","isAssignedToOther","uiManager","clickedMoreInfo","showBasicNotebook","showInfoOnClick","Cimage","icon","getUFInitials","MoreInfo","getUFRace","getUFClass","abilities","ability","totalSegments","filledSegments","label","buttonWhenFilled","onClickFilled","filledLabel","labelStyle","previousFilledRef","animatingSegments","setAnimatingSegments","previousFilled","newSegments","timer","segments","isFilled","isAnimating","filled","themeClass","delightColors","delightBorderColors","delightColors2","delightBorderColors2","player","parentUpdate","showCharacters","showSchedule","showPreferences","overlayStyle","showStats","appManager","update","setUpdate","showTooltipLikes","setShowTooltipLikes","showTooltipHates","setShowTooltipHates","showTooltipTraits","setShowTooltipTraits","prevEnjoyment","setPrevEnjoyment","playerStats","enjoyment","isFlashing","setIsFlashing","mainLike","preferences","reduce","prev","mainHate","allLikes","pref","allHates","overlay","playerManager","unassignCharacter","toggleSinglePlayerForCharacter","borderColor","showNotebookForPlayer","Schedule","schedule","traits","onMouseEnter","handleMouseEnterTraits","onMouseLeave","handleMouseLeaveTraits","trait","idx","description","handleMouseEnterLikes","handleMouseLeaveLikes","like","title","handleMouseEnterHates","handleMouseLeaveHates","hate","boxShadow","FillBar","involvement","characters","CharacterCard","assignedCharClicked","highlighted","showTooltip","tooltipText","tooltipClassName","tooltipVisible","setTooltipVisible","tagRef","tagManager","getTagManager","flavorTag","tooltip","querySelector","classList","getBoundingClientRect","tooltipRect","right","innerWidth","transform","getTooltipContent","campaignTooltip","getTooltipText","PLOT","PLAYERS","BACKSTORY","FORESHADOWING","getTagClasses","classes","NONE","playerAttitudeStyle","getPlayerAttitudesStyle","handleClick","renderTag","mainChild","CImage","DM_POINT","FORESHADOWING_RANDOM","ENCOUNTER_EXPECTED","renderEncounterMedallion","expected","pointerEvents","FlavorTagPill","encounterInfo","encounter","combinedTags","encounterTagsExpected","branches","Cbox","TagPill","content","maxWidth","visible","trigger","preservePositioning","showHelpIcon","translate","isVisible","setIsVisible","coordinates","setCoordinates","tooltipRef","containerRef","timeoutRef","shouldShow","containerStyle","getComputedStyle","visibility","containerRect","scrollX","scrollY","bottom","windowWidth","windowHeight","innerHeight","hideTooltip","toggleTooltip","onFocus","onBlur","ranges","onHover","onLeave","showTooltips","getSegmentStyle","segmentIndex","find","fillColor","baseText","segment","handleSegmentHover","TooltipWrapper","_characterInfo$charac","_characterInfo$charac2","characterInfo","clickChar","getPlayer","getPlayerAssignedCharacter","injury","RangedFillBar","max","story","locationInfo","playerInfo","singleColumn","likesList","hatesList","maxEnjoyment","maxInvolvement","stress","stressBuffer","clickCharacter","groupInfo","playerGroup","setPlayerGroup","players","groupAttitudes","setGroupAttitudes","getGroupAttitudes","setDayData","aggregateSchedule","likes","conflicted","hates","GroupSchedule","dayDataToSymbol","tutorialInfo","nextIndex","showNext","prevIndex","showPrev","tutorialManager","getTutorialManager","nextOrClose","closeTutorial","disableTutorial","prevClicked","showTutorialPage","nextClicked","notebookPages","pageIndex","notebookIndex","setNotebookIndex","React","closeNotebook","currentNotebookPage","removePlayerButton","removePlayer","notebookTabs","page","NotebookTutorial","getNotebookContent","NotebookEncounter","NotebookCharacter","NotebookLocation","NotebookPlayer","NotebookGroup","buttonList","highlight","navClicked","navEntry","buttonName","highlightClass","renderButton","selectedPlayers","setSelectedPlayers","getSelectedPlayerIds","groupNotebookContent","setGroupNotebookContent","recruitablePlayers","getRecruitablePlayers","numberOfSelectedPlayers","notebookTitle","secondaryEntries","makeGroupNotebookContent","handleRemovePlayer","prevSelectedPlayers","newSelectedPlayers","Notebook","NavBar","PlayerCard","toggleSelectPlayer","playerId","selectedPlayer","setSelectedPlayer","setPlayers","getPlayers","setCharacters","getCharacterReferences","forceRender","isAssignedToOtherPlayer","some","handlePlayerSelect","_selectedPlayer$chara","removeCharacterFromPlayer","assignCharactersToPlayer","assignOrUnassignCharacter","themes","handleClicked","getEventIcon","processedEncounters","encounterRow","rowIndex","encounterIndex","EncounterDisplay","campaign","nbCharacters","nbSessions","iconOnly","onAccept","onCancel","acceptText","_Fragment","CampaignDisplayHeader","CampaignDisplayBody","openCampaign","campaignManager","availableCampaigns","getAvailableCampaigns","selectedCampaign","setSelectedCampaign","CampaignDisplay","setMySelectedCampaign","handleAcceptCampaign","campaignId","startCampaign","readyForGame","THEME","GENERIC_ENCOUNTER_EVENTS","ROLEPLAY","PUZZLE","PERCEPTION","TRAVEL","CHALLENGE","TRAP","CHARACTER_BACKSTORY","STORY","EXPOSITION","CAMPAIGN_TAG","BREWER_KEVIN","KIDNAPPING","OLD_LAKE","CULT_LEADER","CAMPAIGN_BUILDINGS","TEMPLE","nbTags","HEAL","RESURRECT","SHOP","allowMagicItems","REPLENISH_TOOLS","ADD_TENSION","addFriendlyTags","TAVERN","ADD_ENJOYMENT","GUILD_HALL","LEVEL_UP","REPLENISH_MAGIC","CONFRONTATION","LOCATIONS","SAGEWOOD_TAVERN","UNDER_THE_WELL","LAKESIDE_BREWERY","LAKESIDE","LAKESIDE_CLIFFS","ENCOUNTERS","SAGEWOOD","flavorText","combat","nbEnemies","challenge","town","buildings","MARKETPLACE","CONFRONTATION2","nbBuildings","BREWERY_FIGHT","BREWERY_EXPLORATION","BY_THE_LAKE","cultOfTheDeep","startingEncounter","finaleEncounter","encounters","values","plotHooks","tooltipTags","chatTriggers","speaker","OLD_MILL","STARTING_LOCATION","QUARRY","ROAD","UNDER_THE_MOUNTAIN","TUNNELS","BRIDGE","BEACH","TOWNVILLE","FINALE_LOCATION","INTRO_IN_TOWN","SOCIAL","INTRO_AT_MILL","ROAD_TO_QUARRY","BORING","QUARRY_INVESTIGATION","MOUNTAIN_ENTRANCE","EXPLORING_THE_TUNNELS","BANDITS_ON_THE_BRIDGE","BEACH_TRAVEL","EXPLORE_SHIPWRECK","TOWNVILLE_FIRE","millstoneMystery","VILLAGE_ELDER","DANCING","ELVEN_PRIEST","required","maxCapacity","INJURE","FAIRLIGHT","WINDY_MOUNTAIN_PATH","ELVEN_VILLAGE","WITCH_CABIN","DWARVEN_TUNNEL","SMOKEY_CAVE","FAIRLIGHT_FESTIVAL","ELDERS_HOME","SPECIAL_SHOP","successText","skillThresholds","magic","revealTag","generateRandomAssistTags","assistTags","UP_THE_MOUNTAIN","BEAR","POINTED_CONVERSATIONS","ELVEN_TEMPLE","ELVEN_SHOP","MASSAGE","GATHERING_AREA","NASTY_FALL","SLUMS","BELL_SMOKE","TUNNEL_23","SMOKEY","FINALE","CAMPAIGNS","DM","score","direction","dice","totalScore","remaining","d20Count","d6Count","calculateDiceRepresentation","die","renderDie","baseClass","encounterScore","campaignScore","DiceScore","getCurrentCampaign","getCampaignProgress","EncounterOverview","setEncounter","getCurrentEncounter","expectedEncounterTags","setExpectedEncounterTags","getOutstandingEncounterTags","establishedEncounterTags","setEstablishedEncounterTags","encounterTagsCollected","locationTagsEstablished","setLocationTagsEstablished","locationTagsCollected","locationTags","setLocationTags","getEncounterLocationTags","completedEvents","setCompletedEvents","getCompletedEvents","campaignModalVisible","setCampaignModalVisible","setCampaignScore","getCampaignScore","setEncounterScore","getEncounterPoints","remainingSnacks","setRemainingSnacks","getRemainingSnacks","remainingBreaks","setRemainingBreaks","getRemainingBreaks","setSceneTags","sort","updateEncounterState","getExpectedEncounterTags","handleShowQuestTerminal","showQuestTerminalModal","quest","updateDMAbilities","sortedSetSceneTags","localeCompare","uniqueEventTypes","currentLocationTheme","preferredEventIndex","getPreferredEventIndex","getEventDescription","eventType","encTag","encounterTagSatisfied","useSnacks","hasHostingAbility","getMaxSnacks","useBreak","getMaxBreaks","CampaignHeader","clickEvent","isPreferred","encounterEventSelected","addEncounterPoints","branch","showNextEncounterModal","expectedTags","collectedTags","totalSlots","fillerTags","fill","collected","FORESHADOWING_EXPECTED","nbExpectedTags","NB_EXPECTED_ENCOUNTER_TAGS","advanceEncounter","getEncounterAdvanceReadinessText","setEvents","eventIndex","EncounterEventDisplay","isGrim","leftPosition","baseDie","displayNumber","modifierCallback","side","combatState","usedTags","tagSet","onTagClick","NumberDie","spendDMPoints","combatantCallback","friendlyTags","hostileTags","onFriendlyTagClick","onHostileTagClick","dangerLabels_default","stressLabels_default","engagementBase","combatBarArrayLength","partyManager","getPartyManager","getChatManager","getCampaignManager","getRange","riskCenter","getCollectedTones","stressLabels","setStressLabels","dangerLabels","setDangerLabels","engagementLabels","setEngagementLabels","setRange","highlightedSegment","setHighlightedSegment","setIsAnimating","combatResultIndex","setCombatResultIndex","randomResult","setRandomResult","applyGrimEffect","grim","labelsRef","danger","engagement","setCombatBarAnimating","round","phase","newRange","modifyCombatRangeCenter","blah","setEngagement","setPeril","newCombatState","pickRandomInRange","enemyStrength","enemyStats","attack","partyStrength","getPartyStrength","dangerCoefficient","perilLabels","risk","calcRisk","setStress","stressArray","getStressForPeril","peril","engagementArray","maxEngagement","basicEngagement","roundedEngagement","result","animateRangePicker","setPerilResult","generateColorsFromLabels","numbers","generateColorFromValue","dangerColors","stressColors","engagementColors","getSegments","segmentColors","labels","initialSetup","finalNumber","currentIndex","animate","_combatManager$getCom","getCombatState","combatModifiersCallback","modifier","flavor","combatant","AddCombatants","CombatModifiers","RangeCard","ENEMIES","defense","magic_defense","health","defaultStats","CombatManager","super","chatManager","getCombatMessage","barAnimating","enemyType","perilResult","DANGER","combatMessage","getCharacterManager","getPlayerManager","getUiManager","generateCombatRewards","rewards","generateCombatState","combatIndex","_this$appManager","_this$campaignManager","_this$campaignManager2","enemies","attacker","currentCharacterIndex","currentEnemyIndex","getHostileCombatantTags","getFriendlyCombatantTags","npcs","heroAttacks","enemyStatsInstance","updateCombatState","GetDefaultCombatState","applyPerilResultsToParty","_this$partyManager","STRESS","addPartyTension","advanceRound","_this$chatManager","_this$partyManager2","generateEnemyAttributeInstance","generateHeroAttacks","combatIntroMessage","_this$uiManager","showRewardModal","perilCheck","exhaustParty","getAttackActionCost","_this$combatState","chanceOfPeril","randomRoll","_this$chatManager2","activatePeril","dmMessage","_this$partyManager3","combatants","generateHeroes","injuredIndex","_this$chatManager3","_this$chatManager4","_this$partyManager4","addInjury","_this$getCombatState","_this$getCombatState2","_this$getCombatState3","attributeIndex","enemyAttributes","_this$partyManager5","_this$combatState2","heroes","generateAttack","heroRethinkAttack","_this$campaignManager3","_this$chatManager5","currentAttack","maxRetries","chatMessage","getHeroAttackDecisionText","_this$combatState3","attackType","allAbilities","_this$characterManage","heroAttack","_this$characterManage2","_hero$character","_this$characterManage3","_this$playerManager","_this$partyManager6","_this$partyManager7","_this$chatManager6","playersTakeAction","stressAction","playerMessage","fullAbilities","actualDamage","damageType","nbIcons","crit","damage","toolsDamage","setAttributeUsed","nbSpells","spellDamage","attackString","reduceEnemies","_this$campaignManager4","increaseEnemies","_this$campaignManager5","_this$chatManager7","sayCombatModifiedMessage","clickedCombatant","setEnemyType","colors","negative","neutral","positive","padStart","ThemedButton","WrappedComponent","setTheme","randomTheme","regenerateKey","combinedClassName","themedUiClicked","_encounter$combat$","_combatManager$getCom3","_combatManager$getCom4","_combatManager$getCom5","swapVisible","setSwapVisible","setEnemyAttributes","setNbEnemies","combatBarAnimating","setCombatMessage","setRewards","heroCombatants","setHeroCombatants","heroActed","setHeroActed","getEnemyAttributeInstance","_combatManager$getCom2","modifyEnemies","CombatBar","generateEnemy","getRoundAdvanceLabel","every","heroAttackPressed","newHeroActed","getHeroFirstName","leftContent","rightContent","centerContent","instructions","childClass","ConditionalTooltip","allCharacters","getAllPlayerCharacters","perceptionRevealed","setPerceptionRevealed","perceptionAccepted","setPerceptionAccepted","perceptionTags","setPerceptionTags","revealOrRerollCharacterPerceptions","newPerceptionRevealed","newPerceptionTags","getPerceptionTags","perceptionEventReveal","getTooltipMessage","perceptionTagsIndex","tagIndex","messageString","encounterTooltip","getCampaignTooltipForTag","CURRENT_LOCATION","BRANCH_LOCATION","CHARACTER_BACKSTORY_PROGRESS","MAGIC_ITEM","getPerceptionTagTypeDisplay","indexb","Tooltip","expectsMagicItem","magicItemRumors","perceptionTag","PLOT_HOOK","getCampaignName","getCampaignIcon","getNextPlotHookText","EncounterHeader","rerollCharacterPerception","acceptCharacterPerception","newPerceptionAccepted","acceptPerceptionTags","perceptionEvent","instruction","bandLabels","_campaignManager$getC","positions","setPositions","flavorTags","setFlavorTags","generateRoleplayEventTags","freeTags","setFreeTags","newPositions","bands","isOverlap","pos","abs","parseFloat","overlap","currentTry","bandIndex","band","adjustTooltips","container","elementRect","spaceAbove","spaceBelow","spaceLeft","spaceRight","debug","timeoutId","handleTagClick","topPercentage","getScoreForPosition","collectEncounterPoints","selectRoleplayFlavorTag","getCurrentEvent","InstructionsPanel","backToOverview","_flavorTag$character","_playerManager$getPla","_flavorTag$character2","mini","characterId","_building$position","_building$position2","_building$size","_building$size2","building","isSelectable","buildingId","onCharacterClick","renderPositionEffect","getTownManager","effect","isIcon","iconText","iconId","textClass","CAMPAIGN_POINT","ADD_TREASURE","renderEffect","effectString","effectClass","USE_TOOLS","USE_MAGIC","capacity","currentVisitors","CharacterToken","positionEffects","isHighlighted","selectedCharacter","exhaustion","onRandomClick","onEndClick","BARRACKS","LIBRARY","DEFAULT_TOWN_BUILDINGS","townManager","setBuildings","setSelectedCharacter","getCharacters","setExhaustion","assignedCharacters","setAssignedCharacters","townResultsVisible","setTownResultsVisible","selectedBuilding","setSelectedBuilding","remainingTags","setRemainingTags","townResultConfig","setTownResultConfig","animatingCharacter","setAnimatingCharacter","autoAssign","setAutoAssign","getAvailableBuildings","generateTownBuildings","_encounter$town","_encounter$town$","_encounter$town2","_encounter$town2$","_encounter$town3","_encounter$town3$","generatedBuildings","minBuildings","maxBuildings","numBuildings","cellHeight","usedCells","availableBuildings","requiredBuildings","randomBuilding","cellX","cellY","getTagsForBuilding","resolvedTags","getPositionEffects","closeResultModal","exposeTag","updatedBuildings","updatedBuilding","buildingElement","remove","townResultTagClick","closeModal","showTagModal","results","selectedTags","remainingClicks","tagInstructions","onClose","randomEffect","assignCharacterToBuilding","fromRect","buildingRect","slotIndex","toRect","getSlotPosition","requestAnimationFrame","animatingElement","townResults","townBuildingResolved","startX","DOMRect","handleCharacterClick","townBuildingAssigned","CharacterSelector","randomCharacter","characterElement","characterRect","BuildingCard","handleBuildingClick","_campaignManager$curr","setPhase","trapResults","setTrapResults","minRoll","maxRoll","dmRewards","characterRolls","setCharacterRolls","usedDisarmAttempts","setUsedDisarmAttempts","highlightedCells","setHighlightedCells","showResults","setShowResults","resultConfig","setResultConfig","boredomRisks","setBoredomRisks","currentEncounter","collectedLocationTags","unexposedLocationTags","initializeTrap","calculateBoredomRisks","newTrapResults","successRange","successChance","baseBoredomRisk","risks","getDisarmChance","baseChance","getRemainingAttributes","isTagExposed","getAssignedLocationTag","characterIndex","handleReactToTrap","rolls","roll","dmReward","processCharacterRolls","totalDmRewards","object","class","boredomRisk","updateAttention","addDmExp","showResultsModal","travelOption","boredom","repeatable","info","rollValue","charIndex","renderDifficultyAdjustment","deathChance","injuryChance","getDeathAndInjuryPercentages","deathRange","injuredRange","tension","getTensionFromDifficulty","toFixed","disarmChance","isUsed","assignedTag","getTheme","handleDisarmAttempt","success","findIndex","addPlayerExp","currentTools","toolsLost","newResults","_result$effects","effectIndex","variant","containerClasses","Boolean","ANIMATION_TIMINGS","CSPOT_TYPE","_tagManager$generateR","challengeLength","authoredTag","onComplete","authoredAssistTags","config","challengeRows","setChallengeRows","characterPositions","setCharacterPositions","successTag","generateRelevantFlavorTags","skillTotals","setSkillTotals","setAssistTags","currentRewardLevel","setCurrentRewardLevel","movesCompleted","setMovesCompleted","challengeComplete","setChallengeComplete","assistBonus","setAssistBonus","isFailureState","skillsCompleted","highlightedSpot","setHighlightedSpot","finalSelectedSpot","setFinalSelectedSpot","rewardLevels","tensionChange","attentionChange","scoreBonus","getIconForSpotType","getIconForTheme","getThemeColorClass","USE_ATTRIBUTE_COMBAT","USE_ATTRIBUTE_MAGIC","USE_ATTRIBUTE_TOOLS","UNLOCK_ASSIST","renderDicePips","points","appliedAssistBonus","totalPoints","isAssistBonus","getAttributeForChallengeRowType","canPlayerAffordRow","getAttributeCostText","getUserFacingTheme","initializeAssistTags","isTagCollected","isLocationTag","getOutstandingLocationTags","getCollectedLocationTags","tagsToAdd","totalUnlockSpotsNeeded","rows","totalUnlockSpotsAdded","rowSpots","spotType","otherTypes","scorePoints","challengePoints","used","cspots","randomRowIndex","row","availablePositions","spot","initializeChallengeField","nbAvailableAssistTags","resolveSpotSelection","s","renderAssistOptionsResults","skillKey","getSkillKeyForType","addUsedAttribute","newCount","updateRewardLevel","moves","skills","getCurrentRewardLevel","handleAcceptChallenge","currentReward","tagToEncounterFlavorTag","unavailableAssistTags","tagsForModal","assistTag","getPotentialTagSource","at","isActive","CContainer","totalAttributes","combatUsed","magicUsed","toolsUsed","combatTotal","magicTotal","toolsTotal","active","isRowDisabled","canAffordRow","animatingSelection","async","availableSpots","randomSpotIndex","targetSpot","targetSpotIndex","currentHighlightIndex","shouldStop","cycleInterval","setInterval","spotIndex","clearInterval","handleRowClick","_characters$find","isFinalSelected","tagId","clickedTag","triggerChallengeAssistChat","handleAssistTagClick","renderAssistTags","border","dotIndex","_encounter$challenge","challengeConfig","EnhancedSkillChallenge","handleChallengeComplete","SHORT_PAUSE_MS","currentPhase","setCurrentPhase","difficulty","setDifficulty","hintsCount","setHintsCount","getGridConfig","diff","cols","extraFrustration","grid","setGrid","currentScore","setCurrentScore","soCloseUsed","setSoCloseUsed","soCloseCount","setSoCloseCount","playerPosition","setPlayerPosition","usedPlayers","setUsedPlayers","buttonsEnabled","setButtonsEnabled","currentStep","setCurrentStep","adjustHintsMode","setAdjustHintsMode","floatingIconPosition","setFloatingIconPosition","currentStepPlayerIcon","setCurrentStepPlayerIcon","gridPlayerIcon","setGridPlayerIcon","generatedHintTags","setGeneratedHintTags","getSoCloseRemaining","hasHintSquares","calculateScore","hints","calculateAbandonmentCost","attitude","getValidHintDirections","gridConfig","directions","getNextDirection","valid","nextDir","getTensionDisplay","getAvailableHintTags","allCollectedTags","getCollectedTags","currentLocationTagsCollected","locTag","generatePinnedGrid","_campaignManager$getC2","_campaignManager$getC3","newGrid","createEmptyGrid","visited","pinned","scoreReward","isAnswer","isFrustration","isTemporaryFrustration","totalCells","usedPositions","currentLocationTags","outstandingLocationTags","currentAnswerTag","getRandomEmptyPosition","emptyCells","PUZZLE_ANSWER","isExposed","validDirections","randomDirection","hintDirection","hintsToAdd","hintTag","totalFrustration","allPositions","targetScoreSquares","shuffledPositions","guaranteedRewards","bigPrize","remainingSquares","answerPos","pinnedGrid","hintTags","maxAvailableHints","handlePresentPuzzle","getExhaustionCost","handlePlayersAttempt","fullGrid","baseGrid","cell","nonPinnedPositions","relevantTags","QUEST","QUEST_TERMINAL","tensionLevel","generateNonPinnedCells","handleHintDirectionChange","currentDirection","nextDirection","prevGrid","startSolvingAttempt","currentGrid","validSquares","randomSquare","activateGridSquare","shouldAnimate","animateIconToGridSquare","_cell$tag","_cell$tag2","_cell$tag3","randomMessages","playerIcon","processGridCellActivation","gridSquareX","gridSquareY","targetRow","targetCol","handleHintActivation","handleFrustrationActivation","handleAnswerActivation","handleUnexposedTagActivation","handleDirectionlessActivation","getTensionValue","nextPos","getNextPosition","addEnjoyment","showModal","effectData","playerActionString","handleSoClose","_grid$playerPosition$","highlightCells","getDiagonalAndOrthogonalPositions","handleAbandonPuzzle","collectedScore","cost","handleAdjustHints","handleNextPlayer","convertDirectionlessToHints","getPuzzleHintCost","getGridCellTooltipText","_cell$tag4","_cell$tag6","_cell$tag7","_cell$tag5","_cell$tag8","renderGridCell","isPlayerPosition","isClickable","cursor","handlePlayerStoppedHintRotation","getPuzzleTitle","renderGrid","gridTemplateRows","gridTemplateColumns","colIndex","renderSetupPhase","effectiveMaxHints","hintTagsToShow","iconSquares","diffConfig","renderInstructionsPhase","_campaignManager$getC4","_campaignManager$getC5","_campaignManager$getC6","abandonmentCost","renderSolvingPhase","availablePlayers","renderPlayerStoppedPhase","_effectData$effects","gainsDisplay","attributeGains","gains","renderAttributeGains","parse","renderResultInfo","EffectDisplay","tagUsed","travelOptionType","eventTag","getEventTag","hasTravelTag","displayValue","isLocked","EXPLORE_CURRENT_LOCATION","EXPLORE_UPCOMING_LOCATION","AMBUSH","AMBUSH2","TRADERS","SIDE_QUEST","MAGIC_CACHE","getTagClassType","usedTravelOptionIds","setUsedTravelOptionIds","bigRewardSection","setBigRewardSection","smallRewardSections","setSmallRewardSections","travelOptions","getTravelOptions","selectedOption","setSelectedOption","setSelectedTags","journeyLength","setJourneyLength","boredomLevel","setBoredomLevel","travelResultsVisible","setTravelResultsVisible","travelResultConfig","setTravelResultConfig","targetCharacter","setTargetCharacter","nbTagClicks","setNbTagClicks","randomizeRewards","journeySections","bigRewardIndex","bigReward","smallRewards","section","getJourneyDetails","rating","getTensionLevel","handleTravelOption","option","_travelOptionResult$t","optionCopy","travelOptionResult","selectTravelOption","travelOptionResultCharacter","travelResults","filteredTravelTags","travelTags","assignBackstory","getFilteredOptions","filtered","shortTravelOptions","mediumTravelOptions","longTravelOptions","mark","ResultsDisplay","TravelOptionDisplay","SHORT","MEDIUM","LONG","handleAcceptJourney","currentRating","TreeShape","borderRadius","SCENERY_THEME_CONFIGS","shapes","minSize","maxSize","rotate","forest","brewery","mountain","cave","dungeon","generateShapes","regenKey","themeConfig","shape","totalRooms","barMaxHeight","currentRoomIndex","setCurrentRoomIndex","dungeonRooms","setDungeonRooms","currentRoomOptions","setCurrentRoomOptions","dungeonTotals","setDungeonTotals","tools","hoveredTotals","setHoveredTotals","nextRoomOptions","setNextRoomOptions","tagActivated","setTagActivated","initializeDungeon","isCompleted","generateRoomOptions","partyOption","calculatePartyCombinedAttribute","numCharacters","selectedCharacters","j","randomChar","sum","generateNextRoomOptions","roomOptions","room","generateRandomRoom","roomTemplates","template","useGeneratedTag","handleStartingRoomOk","updatedRooms","handleTagActivate","currentRoom","newTotals","involvedPlayerIds","showDungeonCompleteModal","handleResultsClose","handleRoomComplete","_dungeonRooms$current","renderCurrentRoom","handleOptionSelect","handleNextRoomSelect","renderDungeonTotalsUI","totalsToShow","showOverview","encounterState","setEncounterState","getEncounterState","showImageForEvent","setShowImageForEvent","eventImageOpacity","setEventImageOpacity","getEventImageOpacity","newState","sessionState","updateEvent","getCurrentEventComponent","GameEncounterCombat","GameEncounterRoleplay","GameEncounterPuzzle","GameEncounterPerception","GameEncounterTown","GameEncounterTravel","GameEncounterSkillChallenge","GameEncounterTrap","GameEncounterStory","GameEncounterExploration","GameEncounterDungeonCrawl","GameEncounterOverview","EncounterScenery","getCurrentEventComponentParent","INTRO_EVENTS","INTRO_MAIN","MAIN_EVENTS","INTRO_EXIT","EXIT_EVENTS","EXIT","REWARD_ITEMS","XP","rewardsAcceptedCallback","setVisible","rewardTotal","setRewardTotal","selectedItems","setSelectedItems","currentTotal","item","currentAvailableRewards","setCurrentAvailableRewards","nextEventOnAccept","setNextEventOnAccept","getPanelState","availableRewards","expectedGear","ITEM","handleShowRewards","advanceEvent","handleCloseCallback","getPanelLowText","getPanelHighText","toggleItem","GameTable","GameEncounter","RewardModal","rewardsAccepted","describeArc","radius","startAngle","endAngle","polarToCartesian","largeArcFlag","centerX","centerY","angleInDegrees","angleInRadians","PI","cos","sin","descriptions","segmentRanges","angleRange","needleStyle","transformOrigin","viewBox","preserveAspectRatio","generateArcs","arcs","previousMax","segmentsToProcess","segmentMax","pathData","stroke","segmentAngle","x1","y1","x2","y2","cx","cy","getTensionColor","getTensionDescription","BottomBar","_tagManager$encounter","needleGaugeUpdate","setNeedleGaugeUpdate","partyTension","setPartyTension","getPartyTension","updateEncounterScore","updateNeedleGauge","establishedLocationTags","encounterBranches","totalEncounterTags","totalLocationTags","collectedEncounterTags","totalTags","percentComplete","renderTagDots","total","dots","LOCATION_EXPECTED","renderScoringSection","StressInfo","NeedleGauge","getTensionColors","getTensionDescriptions","desc","getTensionRanges","branchCollectedTags","branchExpectedTags","ct","_tagManager$encounter2","_tagManager$encounter3","branchTotalTags","newMessage","getMessageIconId","speakerName","getMessageSpeakerName","getEventTypeClass","_event$data","CAMPAIGN_START","ENCOUNTER_EVENT","LOCATION_CHANGE","COMBAT_START","COMBAT_END","subtitle","Chat","animationIntervalRef","chatEventManager","getChatEventManager","messages","setMessages","getRecentMessages","chatEvents","setChatEvents","getEventHistory","currentMessage","setCurrentMessage","displayedText","setDisplayedText","hasMoreMessages","setHasMoreMessages","highlightedMessages","setHighlightedMessages","isUserScrolling","setIsUserScrolling","scrollTimeoutRef","handleNewMessage","msgId","pulsing","animateMessage","handleNewEvent","handleScroll","scrollHeight","clientHeight","syncMessages","managerMessages","syncInterval","words","wordIndex","visibleWords","word","handleMessageClick","advanceQueue","renderChatContent","allItems","msg","timestamp","originalIndex","ChatEventTile","isCurrentMessage","isLastMessage","messageToDisplay","messageId","highlightState","cssClasses","showEllipsis","ellipsisClass","ChatMessageDisplay","renderMessage","maxSegments","onRedeem","getTooltipForTone","COMEDIC","DRAMATIC","HEROIC","GRIM","ROMANTIC","FANTASY","HORROR","entries","isEmbedded","activeFilter","setActiveFilter","completedCollections","incompleteCollections","tagSortAsc","setTagSortAsc","collectionSortAsc","setCollectionSortAsc","showIntroduced","setShowIncomplete","filterTag","sortedTags","sortedCompleted","sortedIntroduced","expectedBackstoryTags","getOutstandingBackstoryTags","expectedMagicItemTags","discoveredMagicItemTags","renderQuestClues","outstandingQuestTags","getQuestManager","getOutstandingQuestTags","renderEstablishedTopics","COLLECTION_COLLECTED","renderEstablishedThemes","isCollectionCashedIn","handleCashInCollection","collectionName","cashInCollection","spendDMAbilityPoints","getDMAbilityPoints","owned","COLLECTION","renderIntroducedThemes","MAGIC_ITEM_EXPECTED","PROPS_SCORES","PROPS_ENCOUNTER_SCORES","COMFORT_EXHAUSTION_BONUS","TENSION_DESCRIPTIONS","scoreMultiplier","stressIncrease","DMAbilitiesScreen","availablePoints","setAvailablePoints","abilityMeters","setAbilityMeters","consumables","setConsumables","gameMasteries","setGameMasteries","initialMeters","maxLevel","currentLevel","getDMAbilityMeterLevel","hoverText","pointsPerLevel","initialGameMasteries","getDMGameMasteryLevel","rankLabels","initialConsumables","unlockedBy","unlockLevel","getCurrentProps","getCurrentVenue","handleAbilitiesUpdate","consumable","newValue","renderAbilityMeter","meter","progress","canUpgrade","meterId","upgradeDMAbilityMeter","handleAbilityUpgrade","_meter$hoverText","ComingSoon","mastery","currentRank","masteryId","upgradeDMGameMastery","handleGameMasteryUpgrade","propsArray","comfortArray","currentDescription","currentEffect","upgradeButtonText","getConsumableInfo","unlocked","isDMUpgradeUnlocked","isUnlocked","canPurchase","isAtMaxLevel","consumableId","purchaseDMConsumable","handleConsumablePurchase","initialView","activeView","setActiveView","renderContent","TagCollectionsScreen","isOpen","llmService","getLLMService","apiKey","setApiKey","baseUrl","setBaseUrl","model","setModel","testStatus","setTestStatus","testMessage","setTestMessage","savedApiKey","localStorage","getItem","savedBaseUrl","savedModel","htmlFor","onChange","placeholder","rel","setConfiguration","testResponse","generateContextualResponse","gameContext","handleSave","setItem","ChatRuleEngine","rules","debugMode","setDebugMode","enabled","isDebugMode","ChatRuleTestPanel","testContext","setTestContext","speakerType","playerAttitude","mood","testResults","setTestResults","parseInt","runTest","rule","resetRules","duration","isComplete","isCollected","getTagSource","getTagTheme","newTag","RightSidebar","questManager","flavorTagThemes","setFlavorTagThemes","partyExhaustion","setPartyExhaustion","getPartyExhaustion","showDMCollectionsModal","setShowDMCollectionsModal","dmModalInitialView","setDMModalInitialView","showLLMConfig","setShowLLMConfig","showChatRuleTest","setShowChatRuleTest","dmAbilityPoints","setDMAbilityPoints","gameToasts","setGameToasts","processedTagsRef","updateGameInfo","handleToastComplete","updateFlavorTags","updateDMAbilityPoints","handleTagUpdate","currentCollectedTags","currentTagCount","lastKnownCount","processedTagsList","newlyCollectedTags","collection","toastData","createCollectionToastData","collectionData","collectedTag","GLOW","handleShowQuestToast","questData","completedTags","currentNode","isQuestComplete","getAllQuestTags","allTags","createQuestToastData","getTensionDescription2","getMaxPartyExhaustion","ToneTracker","redeemTheme","getAvailableCollectionRewards","activateQuest","showActiveQuestsModal","getActiveQuests","isEnabled","DMCollectionsModal","LLMConfigModal","GameToast","showPlayerTooltip","setShowPlayerTooltip","showCharacterTooltip","setShowCharacterTooltip","setEnjoyment","attention","setAttention","getStatColor","updateStats","playerLikes","playerHates","playerTraits","treasureLevel","treasurePoints","getTreasureThreshold","nextThreshold","nextReward","getTreasureReward","getReadinessClass","onToggle","hoverTooltip","setHoverTooltip","readinessClass","rangeLabel","handleLeave","line","onCharacterToggle","hasSelectedCharacter","CharacterLevelRow","setSelectedCharacters","handleCharacterToggle","newSelected","generateLevelUpEffects","addResult","existingResult","charactersToLevelUp","getCharacterById","playersWithLevelingChars","owner","readinessLevel","newLevel","currentLevelAttributes","nextLevelAttributes","getAttributeGains","happinessBonus","penalty","handleBackdropClick","playersWithCharacters","PlayerCharacterLevelRow","handleLevelUp","charId","overviewMode","isLevelUpModalOpen","setIsLevelUpModalOpen","setTreasureLevel","getTreasureLevel","setTreasurePoints","getTreasurePoints","PlayerDisplay","LevelUpButton","getPlayerCharacters","TreasureDisplay","PartyLevelUpModal","SessionControlComponent","GameRoom","handleQuickStart","initiateQuickStartSetup","transitioning","setTransitioning","transitionComplete","setTransitionComplete","showImage","setShowImage","dataManager","getDataManager","handleStateChange","updateState","getBackgroundClass","getStateProps","backgroundRepeat","MainMenuComponent","PlayerRecruitmentComponent","CharacterCreationComponent","CampaignSetupComponent","getOpenCampaignIndex","SessionPrepComponent","SessionRunComponent","FinalStatsComponent","getModeComponent","modalConfig","onOptionSelect","sceneData","ConversationDisplay","speedUp","currentMessageIndex","setCurrentMessageIndex","messageStates","setMessageStates","intervalRef","complete","animateCurrentMessage","animateWords","displayText","newStates","pauseDelay","messageIdx","messageState","hasMessages","calculateTotalScore","scoreEntries","entry","multiplier","initialCampaignScore","newScore","onRewardClaim","claimedRewards","onDMPointClaim","claimedDMPoints","showScore","onThresholdCrossed","finalCampaignScore","animatingScore","setAnimatingScore","flashingThresholds","setFlashingThresholds","MAX_SCORE","displayedScore","rewardThresholds","threshold","dmPointThresholds","availableDMPoints","hasUnclaimedReward","hasUnclaimedDMPoint","targetScore","thresholdsCrossed","fillPercentage","bubblePosition","milestones","markers","dmPointIndex","isDMPoint","isAvailableDMPoint","handleDMPointClaim","firstAvailableDMPoint","milestone","handleRewardClaim","firstAvailableReward","ScoringLedger","currentCampaignScore","newTotalCampaignScore","visibleEntries","setVisibleEntries","showTotal","setShowTotal","_modalConfig$tagData","_modalConfig$tagData2","_modalConfig$tagData3","_encounter$tags","_modalConfig$options$2","conversationComplete","setConversationComplete","scoringComplete","setScoringComplete","setSpeedUp","setClaimedRewards","setClaimedDMPoints","tagData","chatTrigger","conversation","scoringData","getEncounterScoring","isPositive","nbEncounterTagsSatisfied","canProceed","ConversationSection","RewardFillBar","rewardIndex","showSelectQuestModal","addDMAbilityPoints","handleClickContinue","_modalConfig$options$","bankCampaignScore","clearEncounterScore","encounterData","preferredEncounters","notWantedEncounters","evaluateEncounterPreferences","explorationPenalties","calculateIncompleteExplorationPenalties","hasExplorationPenalties","totalStressPenalty","totalAttentionPenalty","isOnlyOneOption","createFlavorTag","branchName","penaltyPlayers","getPenaltyPlayers","encounterTagPenalty","playersAffectedByRailroading","GameInfoPanel","handleOpenCampaignNotes","getConversationById","displayNewEncounter","handleContinue","tagModalConfig","configOnClose","handleClose","Modal","useModal","setModalConfig","handleModalStateChanged","optionId","handleModalOptionSelected","SetSceneModal","EncounterTagModal","NextEncounterModal","TagModal","travelConfig","WelcomeModal","getRewardDisplayConfig","amount","tagConfig","quests","activeQuestIds","onQuestSelect","RewardDisplay","currentConversation","setCurrentConversation","playerPreferences","attitudes","LIKE","HATE","NEUTRAL","playerChoices","randomAttitude","optionIndex","getAttitudeColor","getPlayerIcon","choice","handleOptionClick","prefIndex","selectedTagForConversation","setSelectedTagForConversation","findNodeByTag","found","tagNode","startingNode","availableTagsForConversation","array","activeQuest","aq","defaultTag","isStartingTag","handleAccept","completeQuest","treasureReward","addTreasurePoints","activeQuests","getCollectedTagsForQuest","countTags","getAllTagsForQuest","progressPercentage","GlobalUi","notebookState","setNotebookState","tutorialPage","setTutorialPage","selectQuestModalVisible","setSelectQuestModalVisible","activeQuestsModalVisible","setActiveQuestsModalVisible","questTerminalModal","setQuestTerminalModal","questProgressModalQuestId","setQuestProgressModalQuestId","handleSetNotebookState","handleTutorialPage","handleShowSelectQuestModal","show","handleShowActiveQuestsModal","handleShowQuestTerminalModal","handleShowQuestProgressModal","questId","getStateComponent","SelectQuestModal","getAvailableQuests","questSelected","hideSelectQuestModal","ActiveQuestsModal","hideActiveQuestsModal","showQuestProgressModal","QuestTerminalModal","advanceQuest","hideQuestTerminalModal","QuestProgressModal","availableQuest","hideQuestProgressModal","launchQuest","ModeContainer","TRAVEL_OPTIONS_SHORT","TRAVEL_OPTIONS_MEDIUM","TRAVEL_OPTIONS_LONG","CampaignManager","currentCampaign","collectedTreasure","establishedTags","rumorTags","expectedTagsForBranches","resolvedTagsForBranches","encounterSetScene","dmTricks","dmPoints","campaignProgress","toneCounts","completedEventIndexes","dmLevel","dmExperience","encounterPrepBonus","encounterPoints","tensionDescriptions","maxSnacks","maxBreaks","dmAbilities","tones","pointsSpent","hosting","storytelling","roleplaying","maxProps","currentProps","maxVenue","currentVenue","rewardDifference","addPartyEnjoyment","multiplyPartyTension","replenishPartyTools","levelUpLowestCharacter","getRandomPlayer","getRandomCharacterForPlayer","assignGear","_reward$tag","collectPlotHook","healRandomCharacter","raiseRandomFromDead","replenishPartyMagic","resetConsumables","hostingLevel","updateAllAttention","adjustTensionMeterForGrimTone","adjustTensionMeterForRomanticTone","continueTheme","updateFlavorTagThemesTally","addTheme","addDMPoints","getDMPoints","setMaxSnacks","setMaxBreaks","showSnacksModal","showBreakModal","generateSnacksEffects","generateBreakEffects","getMaxProps","setMaxProps","getMaxVenue","setMaxVenue","getDMPropLevel","setDMPropLevel","getDMComfortLevel","setDMComfortLevel","_this$dmAbilities$abi","setDMAbilityMeterLevel","previousLevel","pointCost","_this$dmAbilities$gam","setDMGameMasteryLevel","getDMConsumableValue","setDMConsumableValue","getDMAbilitiesPurchaseHistory","getTotalDMAbilityPointsSpent","requiredAbility","requiredLevel","resetDMAbilities","hasToneUnlocked","toneIndex","getUnlockedTones","tonesLevel","abilityIndex","hasStorytellingAbility","canUseSnacks","canUseBreaks","getPropsBonus","getRoleplayingBonus","getCombatBonus","getTravelBonus","setTensionDescription","newDescription","existingIndex","_TENSION_DESCRIPTIONS","_TENSION_DESCRIPTIONS2","_TENSION_DESCRIPTIONS3","_TENSION_DESCRIPTIONS4","_descriptions","resetTensionDescriptions","applyDramaticNarrationEffect","testTensionDescriptionModifications","exhaustForRoleplayAction","_this$currentEncounte","perceptionTagType","branchTags","getRandomGear","curLocationName","nbLocationTags","outstandingBackstoryTags","getAllExpectedBackstoryTags","getNewBackstoryTags","expectedGearTags","gearTag","randomBackstoryTags","flat","exposeEncounterTag","collectLocationTag","setCampaignProgress","handleExpositionClicked","_this$currentEncounte2","upcomingBranches","possibleTags","randomIndex","getUpcomingEncounterTags","activePlayer","_this$currentEncounte3","getQuestForTag","advancedNode","fireNewChatMessage","speed","hasPlayerChoices","triggerBasicChat","getCharactersWithBackstoryTag","triggerCharacterBackstoryResponse","addMagicItemRumor","collectEncounterTag","possibleBranchesToAssignRandomTagTo","tagAssigned","collectUpcomingEncounterTag","couldAssignRandomTagToBranch","introduceNewTagForUpcomingBranch","triggerAddRandomTagToEncounterConversation","collectTag","authoredChatTrigger","getEncounterChatTrigger","triggerEnhancedChatFromTag","triggerChatFromTag","trackRecentTopic","rpFlavorTag","triggerSpecialRPTagChat","convertRpTagToFlavorTag","randomRpTags","includeCharacter","flavortag","charTag","treasureTag","setDefaultTravelOptions","setTravelOptions","getEstablishedCombatantTags","getPotentialCombatantsTags","getEstablishedFriendlyTags","randomIndex2","getRandomFriendlyTags","getResultTags","randomPlayer","getRandomTags","ENEMY","getRandomMagicItemTag","travelResultCharacter","getRandomCharacter","injuryResult","magicReduced","useHalfRemainingAttributes","gearReduced","tensionAmount","_campaign$tooltipTags","_this$currentEncounte4","_campaign$tooltipTags2","_this$currentEncounte5","getEncounterTagPrefix","getThemePostFix","getColorForEncounterByName","_this$currentCampaign","_this$currentCampaign2","plotHookIndex","getDmTricks","getNextEncounters","_this$currentEncounte6","getEncounterEvents","_this$currentEncounte7","_this$currentEncounte8","getEncounterTags","_this$currentEncounte9","_this$currentEncounte10","getTagsForUpcomingEncounters","_this$currentEncounte11","upcomingTags","calculateEncounterTotalScore","currentEncounterSceneSet","setCurrentEncounterSceneComplete","showSetSceneModal","triggerSetSceneModal","getEncounterExpositionText","filteredName","getCampaignChatTriggers","getEncounterChatTriggers","campaignTriggers","encounterTriggers","initiateQuickStart","_CAMPAIGNS$index","addCampaignStartEvent","initializeNewCampaign","initializeNewEncounter","setSessionState","validateTags","getDmLevel","getDmExp","isInitialEncounter","_this$currentEncounte12","_this$currentCampaign3","_this$currentCampaign4","_this$currentEncounte13","currentEncounterEstablished","someBranchesReady","allBranchesReady","currentEvent","addEncounterEvent","_this$currentEncounte14","_this$currentEncounte15","_this$currentEncounte16","_this$currentEncounte17","_this$currentEncounte18","getGameContextManager","logEvent","details","outcome","potentialBranches","branchWithMoreExpectedTags","logEncounterStart","currentEncounterBranches","currentTagsForBranch","getTensionMultiplier","tensionValue","tensionDesc","getEncounterPrepBonus","collectTreasure","getCollectedTreasure","nbHappyPlayers","propsNames","currentTensionDesc","tensionMultiplier","getTotalEncounterScore","NAMES","randomElement","someArray","generateName","CHARACTER_NAMES","PLAYER_NAMES","PLAYER_TRAITS","TEAM_PLAYER","GRUMPY","FORMER_DM","MIN_MAXER","ROLE_PLAYER","LOGICIAN","WEALTHY","BLOODTHIRSTY","QUICKSTART_CHARACTERS","QUICKSTART_PLAYERS","uniqueID","_currentPlayerIndex","getCurrentPlayer","isCurrentPlayerLast","generateAvailablePlayers","stressPlayers","updateParty","getSelectedPlayers","getPlayerById","generateIcon","generateSchedule","nbPlayer","newPlayer","generatePreferences","generatePlayerTraits","getMaxCharactersPerPlayer","acceptSelectedPlayers","getPlayerWithAttitudeForTag","playersWithAttitude","allTraits","startTags","mainTags","getRandomPreferences","selectedPreferences","randomTag","randomValue","randomLikesCount","randomHatesCount","randomLikes","randomHates","_this$uiManager2","thePlayer","isCharacterAssigned","dayValue","feel","CONFLICTED","getGroupAttitudeForTag","getPartyAttitudeForTag","allPlayersHaveCharacter","_this$uiManager3","expNeededForLevel","getAllPlayerPreferences","allPreferences","allowDead","aliveCharacters","refreshPlayer","_this$uiManager4","getPlayerLevelUpOption","levelUpOption","randomStat","rand","MAX_HAPPINESS","_this$uiManager5","MAX_ATTENTION","_this$uiManager6","STRESS_BUFFER","_this$uiManager7","getFancyLevelUpOption","generateRandomCharacter","_this$uiManager8","_this$uiManager9","levelUpOptions","REFRESH","playerEncounterScores","_encounter$location","_encounter$location$t","scores","maxLikeScore","preferredEncounterNames","encounterName","netScore","selectedEncounter","applyEncounterSelectionEffects","outstandingEncounterTags","locationTagPenalty","applyIncompleteExplorationPenalties","handleNextEncounterSelection","selectedBranch","allBranches","startSession","PartyManager","_this$playerManager2","strength","playersAttended","_this$playerManager3","reduceAllOthers","addAmount","_this$playerManager4","_this$playerManager5","takeBreak","addPartyEngagement","_this$playerManager6","updateAllStress","_this$playerManager7","_this$uiManager10","updatePlayersStress","_this$uiManager11","_this$playerManager8","_this$uiManager12","_this$uiManager13","_this$uiManager14","treasureLevelUp","_this$playerManager9","_this$playerManager10","_this$uiManager15","replenishTools","_this$playerManager11","_this$uiManager16","_this$playerManager12","injuredCharacters","healParty","_this$playerManager13","_this$uiManager17","healCharacter","_this$uiManager18","_this$playerManager14","deadCharacters","_this$playerManager15","_this$uiManager19","replenishMagic","_this$uiManager20","_this$playerManager16","lowestCharacter","lowestLevel","levelUp","affectedPlayers","_this$playerManager17","_this$uiManager21","getStressIncrease","npc","heroCombatant","getTensionScoreMultiplier","mult","getScoreMultiplier","_this$campaignManager6","getStressColors","_this$playerManager18","preferredPlayers","notWantedPlayers","_this$playerManager19","penalties","stressPenalty","attentionPenalty","_this$campaignManager7","UiManager","renderImageForEvent","activeModal","_this$activeModal","showWelcomeModal","_this$activeModal2","opt","showNotebook","newNotebookStateArray","changeEventTimer","showResultModal","hideResultModal","toggleImageForEvent","questExhaustion","getExhaustionForQuest","HELPER","getShortenedName","charName","showTutorialMessage","tutorialStep","showAcceptCampaignModal","campaignID","timeDt","getPlayerEmail","playerName","seed","hashString","seededRandom","randomDigit","getPlayerPhone","str","hash","charCodeAt","getGraph","campaignGraph","stateConfigs","initStates","_this$stateConfigs$ge","classId","raceId","attributeId","generateRandomCharacters","getCharacterByIndex","remainingAttributes","reductionAmount","getSelectedCharacters","getRandomRace","races","getRandomClass","getRandomIconNumber","getRandomIcon","characterRace","generateStartingGear","gearNames","gearName","backstoryTags","existingBackstory","newBackstory","generateSingleCharacter","cclass","crace","nbChars","characterAction","expToAdd","TUTORIALS","withHTML","TutorialManager","seenTutorials","turnOffTutorials","startTutorial","tutorialId","force","PROMPT_CHANCE","loadConfiguration","process","REACT_APP_OPENAI_API_KEY","request","prompt","buildPrompt","response","callLLM","parseResponse","getGameContextPrompt","challengeDescription","attribute","participants","recentTopics","themeString","tensionString","locationString","recentTopic","fetch","method","headers","role","temperature","max_tokens","status","statusText","json","choices","responseText","parsed","speakerId","confidence","generateFallbackResponse","topic","contextualResponses","toLLMResponseToChatMessage","chatType","debugSuffix","debugInfo","GameContextManager","gameEvents","maxEvents","gameEvent","generateEventId","getGameContext","_this$gameEvents$","currentLocation","recentEvents","discoveredTags","activeCharacters","currentTheme","sessionDuration","inferCurrentMood","getContextSummary","summary","recentTags","reverse","_event$details$tag","substr","logTagDiscovered","logCombatStart","logCombatEnd","logConversation","ChatManager","_tagManager","gameContextManager","messageQueue","isProcessingQueue","messageDelay","currentTimeout","messageHistory","recentMessages","conversationMessageIds","isInConversation","conversations","WELCOME_CONVERSATION","LLMService","messagesWithSpeed","_speed","formattedMessage","processMessageQueue","hasMoreInQueue","wasInConversation","cleanMessage","messageWithTimestamp","isNewConversation","conversationIds","isLastInConversation","shouldDelay","isFastSpeed","launchNewConversationById","convoid","launchNewConversation","startSessionEvent","campaignChatTrigerred","tagResolved_badFunctionDontUse","chance","percentChance","tagSource","chatId","chatSpeaker","magicItemConversation","themeConversation","_player$id","_player","_player2$id","player2","player2Id","conflictedConversation","randomTagConversations","randomTagConversation1","magicItem","newChat","playerToSpeak","startWelcomeConversation","conversationId","fallbackFunction","_currentEncounter$loc","_currentEncounter$cha","llmResponse","triggerCollectionCompleteChat","challengeMessage","getMessageHistory","tagToFlavorTag","assistMessage","ChatEventManager","eventHistory","addEvent","campaignName","eventName","getEncounterEventDescription","addLocationChangeEvent","locationName","addCombatStartEvent","enemyName","addCombatEndEvent","magicTags","upcomingEncounterTags","nbRandomTags","randomTagSet","getFormattedSource","allEffects","characterEffects","partyEffects","playerEffects","effectStr","formatBuildingEffect","getBuildingEffectClass","applyBuildingEffect","ADD_REWARDS","_locationTagsCollected","locationTagsExpected","_locationTagsExpected","_encounterTagsCollected","_encounterTagsExpected","_magicItemRumors","_collectedTags","_this$encounterTagsCo","satisfiedNeededTag","triggerEncounterTagModal","_this$encounterTagsCo2","_this$appManager$getQ","allowCollected","collectedFriendlyTags","uncollectedFriendlyTags","combatantTags","cashedInCollections","_cashedInCollections","formattedSource","isCurrentEncounterTag","isUpcomingEncounterTag","setChatManager","RUMOR","baseTag","getCollectedEncounterTags","_this$encounterTagsCo3","upcomingEncounters","triggerNextEncounterModal","couldAssignRandomTag","couldAssignRandomTagToAnyBranch","rpTag","omitSources","_this$appManager2","_this$appManager2$get","upcomingEncounterTagsToAdd","magicItemsToAdd","backstoryTagsToAdd","playerPreferenceTagsToAdd","questTagsToAdd","getCurrentQuestTags","allTagsSoFar","locationFlavorTags","encounterFlavorTags","randomEncounterTag","upcomingEncounterFlavorTags","magicItemFlavorTags","backstoryFlavorTags","generateExtraRandomFlavorTags","existingTags","getAllAllTags","randomPlayerTags","initialExtraFlavorTags","randomPlayerFlavorTags","allFlavorTags","randomizedTags","shortfall","filteredAdditionalTags","ft","tagList","omittedTags","omittedNames","availableTones","branchPreferences","calculateBranchPreferences","calculatePlayerBranchScore","prefs","randomBranch","collectedCount","RICKY","RICKY2","QuestManager","availableQuests","isQuestActive","questTags","isTerminal","outstandingTags","getQuestById","totalCost","matchingChild","foundNode","generatePlayerPreferences","numOptions","getNextQuestNode","findCompletedTags","AppManager","_state","lastTime","sessionManager","PlayerManager","CharacterManager","SessionManager","DataManager","TagManager","TownManager","startGameLoop","gameLoop","currentTime","LOCATION_INTRO","advanceState","_this$dataManager","getSessionManager","ReactDOM","getElementById","App"],"sourceRoot":""}